<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Lupinus</title>
  
  <subtitle>Re：从零开始的go学习生活(｀・ω・´)</subtitle>
  <link href="/atom.xml" rel="self"/>
  
  <link href="http://yoursite.com/"/>
  <updated>2020-07-20T23:28:33.000Z</updated>
  <id>http://yoursite.com/</id>
  
  <author>
    <name>Lupinus</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>[Redis搭建]</title>
    <link href="http://yoursite.com/2020/07/21/Redis%E6%90%AD%E5%BB%BA/"/>
    <id>http://yoursite.com/2020/07/21/Redis%E6%90%AD%E5%BB%BA/</id>
    <published>2020-07-20T23:28:32.000Z</published>
    <updated>2020-07-20T23:28:33.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="3-redis"><a href="#3-redis" class="headerlink" title="3. redis"></a>3. redis</h1><p>window系统的redis是微软团队根据官方的linux版本高仿的</p><p>官方原版: <a href="https://redis.io/" target="_blank" rel="noopener">https://redis.io/</a></p><p>中文官网: <a href="http://www.redis.cn" target="_blank" rel="noopener">http://www.redis.cn</a></p><h2 id="3-1-redis下载和安装"><a href="#3-1-redis下载和安装" class="headerlink" title="3.1 redis下载和安装"></a>3.1 redis下载和安装</h2><p>下载地址： <a href="https://github.com/MicrosoftArchive/redis/releases" target="_blank" rel="noopener">https://github.com/MicrosoftArchive/redis/releases</a></p><p><img src="/images/867021-20190120213315530-199992307.png" alt=""></p><p><img src="/images/867021-20190120213337245-1919434508.png" alt=""></p><p><img src="/images/867021-20190120213351947-466120029.png" alt=""></p><p><img src="/images/867021-20190120213613576-1092651557.png" alt=""></p><p><img src="/images/867021-20190120213732137-1070050780.png" alt=""></p><p><img src="/images/867021-20190120213836094-663215847.png" alt=""></p><p><img src="/images/867021-20190120213850621-1280736381.png" alt=""></p><p><img src="/images/867021-20190120214101037-1456534345.png" alt=""></p><p><img src="/images/867021-20190120214000974-189830387.png" alt=""></p><p>使用以下命令启动redis服务端</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">redis-server C:/tool/redis/redis.windows.conf</span><br></pre></td></tr></table></figure><p><img src="/images/1553244955947.png" alt=""></p><p>关闭上面这个cmd窗口就关闭redis服务器服务了。</p><p><strong>redis作为windows服务启动方式</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">redis-server --service-install redis.windows.conf</span><br></pre></td></tr></table></figure><p>启动服务：redis-server –service-start 停止服务：redis-server –service-stop</p><p>启动内置客户端连接redis服务：</p><p><img src="/images/867021-20190120215300667-1673204066.png" alt=""></p><h2 id="3-2-redis的配置"><a href="#3-2-redis的配置" class="headerlink" title="3.2 redis的配置"></a>3.2 redis的配置</h2><p>redis 安装成功以后,window下的配置文件保存在软件 安装目录下,如果是mac或者linux,则默认安装/etc/redis/redis.conf</p><h3 id="3-2-1-redis的核心配置选项"><a href="#3-2-1-redis的核心配置选项" class="headerlink" title="3.2.1 redis的核心配置选项"></a>3.2.1 redis的核心配置选项</h3><ul><li><p>绑定ip：如果需要远程访问，可将此⾏注释，或绑定⼀个真实ip</p><blockquote><p>bind 127.0.0.1</p></blockquote></li><li><p>端⼝，默认为6379</p><blockquote><p>port 6379</p></blockquote></li><li><p>是否以守护进程运⾏[这里的配置主要是linux和mac下面需要配置的]</p><ul><li>如果以守护进程运⾏，则不会在命令⾏阻塞，类似于服务</li><li>如果以⾮守护进程运⾏，则当前终端被阻塞</li><li>设置为yes表示守护进程，设置为no表示⾮守护进程</li><li>推荐设置为yes</li></ul><blockquote><p>daemonize yes</p></blockquote></li><li><p>数据⽂件</p><blockquote><p>dbfilename dump.rdb</p></blockquote></li><li><p>数据⽂件存储路径</p><blockquote><p>dir .</p></blockquote></li><li><p>⽇志⽂件</p><blockquote><p>logfile “C:/tool/redis/redis-server.log”</p></blockquote></li><li><p>数据库，默认有16个</p><blockquote><p>database 16</p></blockquote></li><li><p>主从复制，类似于双机备份。</p><blockquote><p>slaveof</p></blockquote></li></ul><h3 id="3-2-2-Redis的使用"><a href="#3-2-2-Redis的使用" class="headerlink" title="3.2.2 Redis的使用"></a>3.2.2 Redis的使用</h3><p>Redis 是一个高性能的key-value数据格式的内存缓存，NoSQL数据库。</p><p>NOSQL：not only sql，泛指非关系型数据库。</p><p>关系型数据库: (mysql, oracle, sql server, sqlite)</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">1. 数据存放在表中，表之间有关系。</span><br><span class="line">2. 通用的SQL操作语言。</span><br><span class="line">3. 大部分支持事务。</span><br></pre></td></tr></table></figure><p>非关系型数据库[ redis，hadoop，mangoDB]:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">1. 没有数据表的概念，不同的nosql数据库存放数据位置不同。</span><br><span class="line">2. nosql数据库没有通用的操作语言。</span><br><span class="line">3. 基本不支持事务。   redis支持简单事务</span><br></pre></td></tr></table></figure><p>redis： 内存型(数据存放在内存中)的非关系型(nosql)key-value(键值存储)数据库， 支持数据的持久化(注: 数据持久化时将数据存放到文件中，每次启动redis之后会先将文 件中数据加载到内存)，经常用来做缓存(用来缓存一些经常用到的数据，提高读写速度)。</p><p>redis是一款基于CS架构的数据库，所以redis有客户端，也有服务端。</p><p>其中，客户端可以使用python等编程语言，也可以终端命令行工具</p><p><img src="/images/1553246999266.png" alt=""></p><p>redis客户端连接服务器:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">redis-cli -h &#96;redis服务器ip&#96; -p &#96;redis服务器port&#96;</span><br></pre></td></tr></table></figure><h2 id="3-3-redis数据类型"><a href="#3-3-redis数据类型" class="headerlink" title="3.3 redis数据类型"></a>3.3 redis数据类型</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">1. string类型:</span><br><span class="line">    字符串类型是 Redis 中最为基础的数据存储类型，它在 Redis 中是二进制安全的，也就是byte类型</span><br><span class="line">    最大容量是512M。</span><br><span class="line">2. hash类型:</span><br><span class="line">        hash用于存储对象，对象的结构为属性、值，值的类型为string。</span><br><span class="line">        key:&#123;</span><br><span class="line">            域:值[这里的值只能是字符串]，</span><br><span class="line">            域:值，            </span><br><span class="line">            域:值，</span><br><span class="line">            域:值，</span><br><span class="line">            ...</span><br><span class="line">        &#125;</span><br><span class="line">3. list类型:</span><br><span class="line">        列表的元素类型为string。</span><br><span class="line">        key:[ 值1，值2,值3..... ]</span><br><span class="line">4. set类型:</span><br><span class="line">    无序集合，元素为string类型，元素唯一不重复，没有修改操作。</span><br><span class="line">    &#123;值1,值4,值3,值5&#125;</span><br><span class="line">5. zset类型:</span><br><span class="line">    有序集合，元素为string类型，元素唯一不重复，没有修改操作。</span><br></pre></td></tr></table></figure><h3 id="3-4-string"><a href="#3-4-string" class="headerlink" title="3.4 string"></a>3.4 string</h3><p>如果设置的键不存在则为添加，如果设置的键已经存在则修改</p><ul><li><p>设置键值</p><blockquote><p>set key value</p></blockquote></li><li><p>例1：设置键为<code>name</code>值为<code>xiaoming</code>的数据</p><blockquote><p>set name xiaoming</p></blockquote></li></ul><p><img src="/images/1553478355927.png" alt=""></p><ul><li><p>设置键值及过期时间，以秒为单位</p><blockquote><p>setex key seconds value</p></blockquote></li><li><p>例2：设置键为<code>aa</code>值为<code>aa</code>过期时间为3秒的数据</p><blockquote><p>setex name 20 xiaoming</p></blockquote></li></ul><p>关于设置保存数据的有效期</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"># setex 添加保存数据到redis，同时设置有效期</span><br><span class="line">格式：</span><br><span class="line">    setex key time value</span><br><span class="line"># expire 给已有的数据重新设置有效期</span><br><span class="line">格式：</span><br><span class="line">    expire key time</span><br></pre></td></tr></table></figure><ul><li><p>设置多个键值</p><blockquote><p>mset key1 value1 key2 value2 …</p></blockquote></li><li><p>例3：设置键为<code>a1</code>值为<code>python</code>、键为<code>a2</code>值为<code>java</code>、键为<code>a3</code>值为<code>c</code></p><blockquote><p>mset a1 python a2 java a3 c</p></blockquote></li><li><p>追加值</p><blockquote><p>append key value</p></blockquote></li><li><p>例4：向键为<code>a1</code>中追加值<code>haha</code></p><blockquote><p>append a1 haha</p></blockquote></li><li><p>获取：根据键获取值，如果不存在此键则返回<code>nil</code></p><blockquote><p>get key</p></blockquote></li><li><p>例5：获取键<code>name</code>的值</p><blockquote><p>get name</p></blockquote></li><li><p>根据多个键获取多个值</p><blockquote><p>mget key1 key2 …</p></blockquote></li><li><p>例6：获取键<code>a1、a2、a3</code>的值</p><blockquote><p>mget a1 a2 a3</p></blockquote></li></ul><h3 id="3-5-键操作"><a href="#3-5-键操作" class="headerlink" title="3.5 键操作"></a>3.5 键操作</h3><ul><li><p>查找键，参数⽀持正则表达式</p><blockquote><p>keys pattern</p></blockquote></li><li><p>例1：查看所有键</p><blockquote><p>keys *</p></blockquote></li><li><p>例2：查看名称中包含<code>a</code>的键</p><blockquote><p>keys a*</p></blockquote></li><li><p>判断键是否存在，如果存在返回<code>1</code>，不存在返回<code>0</code></p><blockquote><p>exists key1</p></blockquote></li><li><p>例3：判断键<code>a1</code>是否存在</p><blockquote><p>exists a1</p></blockquote></li><li><p>查看键对应的<code>value</code>的类型</p><blockquote><p>type key</p></blockquote></li><li><p>例4：查看键<code>a1</code>的值类型，为redis⽀持的五种类型中的⼀种</p><blockquote><p>type a1</p></blockquote></li><li><p>删除键及对应的值</p><blockquote><p>del key1 key2 …</p></blockquote></li><li><p>例5：删除键<code>a2、a3</code></p><blockquote><p>del a2 a3</p></blockquote></li><li><p>查看有效时间，以秒为单位</p><blockquote><p>ttl key</p></blockquote></li><li><p>例7：查看键<code>bb</code>的有效时间</p><blockquote><p>ttl bb</p></blockquote></li></ul><h3 id="3-6-hash"><a href="#3-6-hash" class="headerlink" title="3.6 hash"></a>3.6 hash</h3><p>结构：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">键key:&#123;</span><br><span class="line">    域field:值value</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li><p>设置单个属性</p><blockquote><p>hset key field value</p></blockquote></li><li><p>例1：设置键 <code>user</code>的属性<code>name</code>为<code>xiaohong</code></p><blockquote><p>hset user name xiaohong</p></blockquote></li><li><p>设置多个属性</p><blockquote><p>hmset key field1 value1 field2 value2 …</p></blockquote></li><li><p>例2：设置键<code>u2</code>的属性<code>name</code>为<code>xiaohong</code>、属性<code>age</code>为<code>11</code></p><blockquote><p>hmset u2 name xiaohongage 11</p></blockquote></li><li><p>获取指定键所有的属性</p><blockquote><p>hkeys key</p></blockquote></li><li><p>例3：获取键u2的所有属性</p><blockquote><p>hkeys u2</p></blockquote></li><li><p>获取⼀个属性的值</p><blockquote><p>hget key field</p></blockquote></li><li><p>例4：获取键<code>u2</code>属性<code>name</code>的值</p><blockquote><p>hget u2 name</p></blockquote></li><li><p>获取多个属性的值</p><blockquote><p>hmget key field1 field2 …</p></blockquote></li><li><p>例5：获取键<code>u2</code>属性<code>name</code>、<code>age</code>的值</p><blockquote><p>hmget u2 name age</p></blockquote></li><li><p>获取所有属性的值</p><blockquote><p>hvals key</p></blockquote></li><li><p>例6：获取键<code>u2</code>所有属性的值</p><blockquote><p>hvals u2</p></blockquote></li><li><p>删除属性，属性对应的值会被⼀起删除</p><blockquote><p>hdel key field1 field2 …</p></blockquote></li><li><p>例7：删除键<code>u2</code>的属性<code>age</code></p><blockquote><p>hdel u2 age</p></blockquote></li></ul><h3 id="3-7-list"><a href="#3-7-list" class="headerlink" title="3.7 list"></a>3.7 list</h3><p>列表的元素类型为string</p><p>按照插⼊顺序排序</p><ul><li><p>在左侧插⼊数据</p><blockquote><p>lpush key value1 value2 …</p></blockquote></li><li><p>例1：从键为<code>a1</code>的列表左侧加⼊数据<code>a 、 b 、c</code></p><blockquote><p>lpush a1 a b c</p></blockquote></li><li><p>在右侧插⼊数据</p><blockquote><p>rpush key value1 value2 …</p></blockquote></li><li><p>例2：从键为<code>a1</code>的列表右侧加⼊数据<code>0、1</code></p><blockquote><p>rpush a1 0 1</p></blockquote></li><li><p>在指定元素的前或后插⼊新元素</p><blockquote><p>linsert key before或after 现有元素 新元素</p></blockquote></li><li><p>例3：在键为<code>a1</code>的列表中元素<code>b</code>前加⼊<code>3</code></p><blockquote><p>linsert a1 before b 3</p></blockquote></li></ul><p>设置指定索引位置的元素值</p><ul><li><p>索引从左侧开始，第⼀个元素为0</p></li><li><p>索引可以是负数，表示尾部开始计数，如<code>-1</code>表示最后⼀个元素</p><blockquote><p>lset key index value</p></blockquote></li><li><p>例5：修改键为<code>a1</code>的列表中下标为<code>1</code>的元素值为<code>z</code></p><blockquote><p>lset a 1 z</p></blockquote></li><li><p>删除指定元素</p><ul><li>将列表中前<code>count</code>次出现的值为<code>value</code>的元素移除</li><li>count &gt; 0: 从头往尾移除</li><li>count &lt; 0: 从尾往头移除</li><li>count = 0: 移除所有</li></ul><blockquote><p>lrem key count value</p></blockquote><p><img src="/images/1553479815621.png" alt=""></p></li><li><p>例6.1：向列表<code>a2</code>中加⼊元素<code>a、b、a、b、a、b</code></p><blockquote><p>lpush a2 a b a b a b</p></blockquote></li><li><p>例6.2：从<code>a2</code>列表右侧开始删除2个<code>b</code></p><blockquote><p>lrem a2 -2 b</p></blockquote></li><li><p>例6.3：查看列表<code>a2</code>的所有元素</p><blockquote><p>lrange a2 0 -1</p></blockquote></li></ul><h3 id="3-8-set"><a href="#3-8-set" class="headerlink" title="3.8 set"></a>3.8 set</h3><ul><li><p>添加元素</p><blockquote><p>sadd key member1 member2 …</p></blockquote></li><li><p>例1：向键<code>a3</code>的集合中添加元素<code>zhangsan</code>、<code>lisi</code>、<code>wangwu</code></p><blockquote><p>sadd a3 zhangsan sili wangwu</p></blockquote></li><li><p>返回所有的元素</p><blockquote><p>smembers key</p></blockquote></li><li><p>例2：获取键<code>a3</code>的集合中所有元素</p><blockquote><p>smembers a3</p></blockquote></li><li><p>删除指定元素</p><blockquote><p>srem key value</p></blockquote></li><li><p>例3：删除键<code>a3</code>的集合中元素<code>wangwu</code></p><blockquote><p>srem a3 wangwu</p></blockquote></li></ul><h3 id="3-9-redis的几个站点地址"><a href="#3-9-redis的几个站点地址" class="headerlink" title="3.9 redis的几个站点地址"></a>3.9 redis的几个站点地址</h3><p>中文官网： <a href="http://www.redis.cn/" target="_blank" rel="noopener">http://www.redis.cn/</a></p><p>英文官网：<a href="https://redis.io" target="_blank" rel="noopener">https://redis.io</a></p><p>参考命令：<a href="http://doc.redisfans.com/" target="_blank" rel="noopener">http://doc.redisfans.com/</a></p><h3 id="针对redis中的内容扩展"><a href="#针对redis中的内容扩展" class="headerlink" title="针对redis中的内容扩展"></a>针对redis中的内容扩展</h3><p>flushall 清空数据库中的所有数据</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">针对各种数据类型它们的特性，使用场景如下:</span><br><span class="line">字符串string: 用于保存一些项目中的普通数据，只要键值对的都可以保存，例如，保存 session,定时记录状态</span><br><span class="line">哈希hash：用于保存项目中的一些字典数据，但是不能保存多维的字典，例如，商城的购物车</span><br><span class="line">列表list：用于保存项目中的列表数据，但是也不能保存多维的列表，例如，队列，秒杀，医院的挂号</span><br><span class="line">无序集合set:用于保存项目中的一些不能重复的数据，可以用于过滤，例如，投票海选的时候，过滤候选人</span><br><span class="line">有序集合zset：用于保存项目中一些不能重复，但是需要进行排序的数据，分数排行榜.</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      window系统的redis是微软团队根据官方的linux版本高仿的...
    
    </summary>
    
    
      <category term="数据库" scheme="http://yoursite.com/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/"/>
    
    
      <category term="Redis" scheme="http://yoursite.com/tags/Redis/"/>
    
  </entry>
  
  <entry>
    <title>[用Hexo+Github搭建个人博客]</title>
    <link href="http://yoursite.com/2020/07/08/%E7%94%A8Hexo-Github%E6%90%AD%E5%BB%BA%E4%B8%AA%E4%BA%BA%E5%8D%9A%E5%AE%A2/"/>
    <id>http://yoursite.com/2020/07/08/%E7%94%A8Hexo-Github%E6%90%AD%E5%BB%BA%E4%B8%AA%E4%BA%BA%E5%8D%9A%E5%AE%A2/</id>
    <published>2020-07-08T12:50:38.000Z</published>
    <updated>2020-07-10T12:50:39.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="hexo框架搭建个人博客"><a href="#hexo框架搭建个人博客" class="headerlink" title="hexo框架搭建个人博客"></a>hexo框架搭建个人博客</h1><h2 id="1-github配置"><a href="#1-github配置" class="headerlink" title="1. github配置"></a>1. github配置</h2><h3 id="下载安装git"><a href="#下载安装git" class="headerlink" title="下载安装git"></a>下载安装git</h3><h3 id="https-git-scm-com"><a href="#https-git-scm-com" class="headerlink" title="https://git-scm.com/"></a><a href="https://git-scm.com/" target="_blank" rel="noopener">https://git-scm.com/</a></h3><h3 id="桌面右击打开Git-Bash-Here"><a href="#桌面右击打开Git-Bash-Here" class="headerlink" title="桌面右击打开Git Bash Here"></a>桌面右击打开Git Bash Here</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ git config --global user.name <span class="string">"用户名"</span></span><br><span class="line"></span><br><span class="line">$ git config --global user.email <span class="string">"邮箱"</span></span><br></pre></td></tr></table></figure><h3 id="登录github"><a href="#登录github" class="headerlink" title="登录github"></a>登录github</h3><p><img src="/images/github.png" alt="github.png"></p><h3 id="创建新仓库"><a href="#创建新仓库" class="headerlink" title="创建新仓库"></a>创建新仓库</h3><p><img src="/images/hexo%20b6a26e944b45432b84f717029640e041.png" alt="hexo%20b6a26e944b45432b84f717029640e041.png"></p><h3 id="仓库名是固定的，用户名-github-io，这边已经创建过，所以飘红"><a href="#仓库名是固定的，用户名-github-io，这边已经创建过，所以飘红" class="headerlink" title="仓库名是固定的，用户名+github.io，这边已经创建过，所以飘红"></a>仓库名是固定的，用户名+github.io，这边已经创建过，所以飘红</h3><p><img src="/images/2.png" alt="2.png"></p><h3 id="生成key，在到ssh-key位置"><a href="#生成key，在到ssh-key位置" class="headerlink" title="生成key，在到ssh-key位置"></a>生成key，在到ssh-key位置</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ ssh-keygen -t -rsa -C <span class="string">"fastsword66@gmail.com"</span></span><br></pre></td></tr></table></figure><p><img src="/images/ssh-keygen.png" alt="ssh-keygen.png"></p><h3 id="找到ssh-keygen目录，复制id-rsa-pub中的内容"><a href="#找到ssh-keygen目录，复制id-rsa-pub中的内容" class="headerlink" title="找到ssh-keygen目录，复制id_rsa.pub中的内容"></a>找到ssh-keygen目录，复制id_rsa.pub中的内容</h3><p><img src="/images/ssh-keygen%201.png" alt="ssh-keygen%201.png"></p><h3 id="到github的settings中设置ssh-keys，把复制的内容copy进去"><a href="#到github的settings中设置ssh-keys，把复制的内容copy进去" class="headerlink" title="到github的settings中设置ssh-keys，把复制的内容copy进去"></a>到github的settings中设置ssh-keys，把复制的内容copy进去</h3><p><img src="/images/ssh.png" alt="ssh.png"></p><p><img src="/images/copy-key.png" alt="copy-key.png"></p><h3 id="确认key是否能够使用"><a href="#确认key是否能够使用" class="headerlink" title="确认key是否能够使用"></a>确认key是否能够使用</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ ssh -T git@github.com</span><br></pre></td></tr></table></figure><h2 id="2-hexo框架"><a href="#2-hexo框架" class="headerlink" title="2. hexo框架"></a>2. hexo框架</h2><h3 id="查看npm版本号"><a href="#查看npm版本号" class="headerlink" title="查看npm版本号"></a>查看npm版本号</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ npm -v</span><br></pre></td></tr></table></figure><h3 id="如果有就通过npm安装hexo"><a href="#如果有就通过npm安装hexo" class="headerlink" title="如果有就通过npm安装hexo"></a>如果有就通过npm安装hexo</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install -g hexo</span><br></pre></td></tr></table></figure><p><img src="/images/hexo.png" alt="hexo.png"></p><h3 id="选个位置创建个新文件夹myblog，在文件夹中右键打开Git-Bash-Here，初始化hexo"><a href="#选个位置创建个新文件夹myblog，在文件夹中右键打开Git-Bash-Here，初始化hexo" class="headerlink" title="选个位置创建个新文件夹myblog，在文件夹中右键打开Git Bash Here，初始化hexo"></a>选个位置创建个新文件夹myblog，在文件夹中右键打开Git Bash Here，初始化hexo</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo init</span><br></pre></td></tr></table></figure><h3 id="安装hexo-deploy-git，方便以后用hexo-deoloy去部署网站"><a href="#安装hexo-deploy-git，方便以后用hexo-deoloy去部署网站" class="headerlink" title="安装hexo-deploy-git，方便以后用hexo-deoloy去部署网站"></a>安装hexo-deploy-git，方便以后用hexo-deoloy去部署网站</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install hexo-deployer-git --save</span><br></pre></td></tr></table></figure><h3 id="本地测试是否能预览博客，复制地址"><a href="#本地测试是否能预览博客，复制地址" class="headerlink" title="本地测试是否能预览博客，复制地址"></a>本地测试是否能预览博客，复制地址</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></table></figure><p><img src="/images/hexo%20b6a26e944b45432b84f717029640e041%201.png" alt="hexo%20b6a26e944b45432b84f717029640e041%201.png"></p><h3 id="打开-config设置deployment"><a href="#打开-config设置deployment" class="headerlink" title="打开_config设置deployment"></a>打开_config设置deployment</h3><p><img src="/images/deployment.png" alt="deployment.png"></p><h3 id="repository从你的仓库中copy"><a href="#repository从你的仓库中copy" class="headerlink" title="repository从你的仓库中copy"></a>repository从你的仓库中copy</h3><p><img src="/images/1593523025(1).png" alt="1593523025(1).png"></p><h3 id="生成静态文件"><a href="#生成静态文件" class="headerlink" title="生成静态文件"></a>生成静态文件</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ctrl+c 退出server</span><br><span class="line"></span><br><span class="line">$ hexo generate</span><br></pre></td></tr></table></figure><h2 id="3-更换主题"><a href="#3-更换主题" class="headerlink" title="3. 更换主题"></a>3. 更换主题</h2><h3 id="到hexo官网：-https-hexo-io-zh-cn"><a href="#到hexo官网：-https-hexo-io-zh-cn" class="headerlink" title="到hexo官网： https://hexo.io/zh-cn/"></a>到hexo官网： <a href="https://hexo.io/zh-cn/" target="_blank" rel="noopener">https://hexo.io/zh-cn/</a></h3><p><img src="/images/hexo%20b6a26e944b45432b84f717029640e041%202.png" alt="hexo%20b6a26e944b45432b84f717029640e041%202.png"></p><p><img src="/images/2%201.png" alt="2%201.png"></p><h3 id="下载主题"><a href="#下载主题" class="headerlink" title="下载主题"></a>下载主题</h3><p><img src="/images/hexo%20b6a26e944b45432b84f717029640e041%203.png" alt="hexo%20b6a26e944b45432b84f717029640e041%203.png"></p><h3 id="解压后放到myblog中的themes"><a href="#解压后放到myblog中的themes" class="headerlink" title="解压后放到myblog中的themes"></a>解压后放到myblog中的themes</h3><p><img src="/images/1593525431(1).png" alt="1593525431(1).png"></p><h3 id="打开-config设置主题，名称是主题文件夹名字，可以更改"><a href="#打开-config设置主题，名称是主题文件夹名字，可以更改" class="headerlink" title="打开_config设置主题，名称是主题文件夹名字，可以更改"></a>打开_config设置主题，名称是主题文件夹名字，可以更改</h3><p><img src="/images/hexo%20b6a26e944b45432b84f717029640e041%204.png" alt="hexo%20b6a26e944b45432b84f717029640e041%204.png"></p><h3 id="生成静态文件-1"><a href="#生成静态文件-1" class="headerlink" title="生成静态文件"></a>生成静态文件</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo generate</span><br></pre></td></tr></table></figure><h3 id="部署发布"><a href="#部署发布" class="headerlink" title="部署发布"></a>部署发布</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo deploy</span><br></pre></td></tr></table></figure><h3 id="完成，是不是非常简单"><a href="#完成，是不是非常简单" class="headerlink" title="完成，是不是非常简单"></a>完成，是不是非常简单</h3><p><img src="/images/hexo%20b6a26e944b45432b84f717029640e041%205.png" alt="hexo%20b6a26e944b45432b84f717029640e041%205.png"></p><h2 id="Ending…"><a href="#Ending…" class="headerlink" title="Ending…"></a>Ending…</h2>]]></content>
    
    <summary type="html">
    
      hexo框架搭建个人博客 1. github配置,下载安装git,桌面右击打开Git Bash Here 创建新仓库,仓库名是固定的，用户名+github.io，这边已经创建过，所以飘红...
    
    </summary>
    
    
      <category term="技能get" scheme="http://yoursite.com/categories/%E6%8A%80%E8%83%BDget/"/>
    
    
      <category term="博客搭建" scheme="http://yoursite.com/tags/%E5%8D%9A%E5%AE%A2%E6%90%AD%E5%BB%BA/"/>
    
  </entry>
  
  <entry>
    <title>[用PicGo+Gitee（码云）搭建Markdown图床]</title>
    <link href="http://yoursite.com/2020/07/08/%E7%94%A8PicGo-Gitee%EF%BC%88%E7%A0%81%E4%BA%91%EF%BC%89%E6%90%AD%E5%BB%BAMarkdown%E5%9B%BE%E5%BA%8A/"/>
    <id>http://yoursite.com/2020/07/08/%E7%94%A8PicGo-Gitee%EF%BC%88%E7%A0%81%E4%BA%91%EF%BC%89%E6%90%AD%E5%BB%BAMarkdown%E5%9B%BE%E5%BA%8A/</id>
    <published>2020-07-08T12:50:38.000Z</published>
    <updated>2020-07-08T12:50:39.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="用PicGo-Gitee（码云）搭建Markdown图床"><a href="#用PicGo-Gitee（码云）搭建Markdown图床" class="headerlink" title="用PicGo+Gitee（码云）搭建Markdown图床"></a>用PicGo+Gitee（码云）搭建Markdown图床</h1><h2 id="一：引言"><a href="#一：引言" class="headerlink" title="一：引言"></a>一：引言</h2><p>图床一般是指储存图片的服务器，有国内和国外之分。国外的图床由于有空间距离等因素决定访问速度很慢影响图片显示速度。国内也分为单线空间、多线空间和cdn加速三种。</p><p>简单来说，图床就是自动把本地图片转换成链接的一款工具，网络上有很多图床工具，就目前使用种类而言，PicGo 算得上一款比较优秀的图床工具。它是一款用 Electron-vue 开发的软件，可以支持微博，七牛云，腾讯云COS，又拍云，GitHub，阿里云OSS，<a href="http://sm.ms/" target="_blank" rel="noopener">SM.MS</a>，imgur 等8种常用图床，功能强大，简单易用，同时，它也支持Gitee（码云）。</p><h2 id="二：需要用到的软件"><a href="#二：需要用到的软件" class="headerlink" title="二：需要用到的软件"></a>二：需要用到的软件</h2><h3 id="1-Typora（Markdown文本编辑软件）"><a href="#1-Typora（Markdown文本编辑软件）" class="headerlink" title="1.Typora（Markdown文本编辑软件）"></a><strong>1.Typora（Markdown文本编辑软件）</strong></h3><h3 id="Typora-是一款支持实时预览的-Markdown-文本编辑器，并且完全免费。"><a href="#Typora-是一款支持实时预览的-Markdown-文本编辑器，并且完全免费。" class="headerlink" title="Typora 是一款支持实时预览的 Markdown 文本编辑器，并且完全免费。"></a><strong>Typora 是一款支持实时预览的 Markdown 文本编辑器，并且完全免费。</strong></h3><h3 id="下载地址：https-www-typora-io"><a href="#下载地址：https-www-typora-io" class="headerlink" title="下载地址：https://www.typora.io/"></a><strong>下载地址：<a href="https://www.typora.io/" target="_blank" rel="noopener">https://www.typora.io/</a></strong></h3><h3 id="使用教程：https-www-cnblogs-com-xuexianqi-p-13260516-html"><a href="#使用教程：https-www-cnblogs-com-xuexianqi-p-13260516-html" class="headerlink" title="使用教程：https://www.cnblogs.com/xuexianqi/p/13260516.html"></a><strong>使用教程：<a href="https://www.cnblogs.com/xuexianqi/p/13260516.html" target="_blank" rel="noopener">https://www.cnblogs.com/xuexianqi/p/13260516.html</a></strong></h3><h3 id="进入下载地址后，根据系统来选择安装包，下载完成后，直接无脑下一步即可，路径默认"><a href="#进入下载地址后，根据系统来选择安装包，下载完成后，直接无脑下一步即可，路径默认" class="headerlink" title="进入下载地址后，根据系统来选择安装包，下载完成后，直接无脑下一步即可，路径默认"></a><strong>进入下载地址后，根据系统来选择安装包，下载完成后，直接无脑下一步即可，路径默认</strong></h3><p><img src="/images/o_20070611481801.png" alt="o_20070611481801.png"></p><h3 id="2-PicGo（图床软件）"><a href="#2-PicGo（图床软件）" class="headerlink" title="2.PicGo（图床软件）"></a><strong>2.PicGo（图床软件）</strong></h3><h3 id="一个图床，一个用于快速上传图片并获取图片URL链接的工具，也完全免费。"><a href="#一个图床，一个用于快速上传图片并获取图片URL链接的工具，也完全免费。" class="headerlink" title="一个图床，一个用于快速上传图片并获取图片URL链接的工具，也完全免费。"></a><strong>一个图床，一个用于快速上传图片并获取图片URL链接的工具，也完全免费。</strong></h3><h3 id="官方指南：https-picgo-github-io-PicGo-Doc-zh-guide"><a href="#官方指南：https-picgo-github-io-PicGo-Doc-zh-guide" class="headerlink" title="官方指南：https://picgo.github.io/PicGo-Doc/zh/guide/"></a><strong>官方指南：<a href="https://picgo.github.io/PicGo-Doc/zh/guide/" target="_blank" rel="noopener">https://picgo.github.io/PicGo-Doc/zh/guide/</a></strong></h3><h3 id="下载地址：https-github-com-Molunerfinn-PicGo-releases"><a href="#下载地址：https-github-com-Molunerfinn-PicGo-releases" class="headerlink" title="下载地址：https://github.com/Molunerfinn/PicGo/releases"></a><strong>下载地址：<a href="https://github.com/Molunerfinn/PicGo/releases" target="_blank" rel="noopener">https://github.com/Molunerfinn/PicGo/releases</a></strong></h3><h3 id="GitHub网站进不去的点这里：https-www-cnblogs-com-xuexianqi-p-13219719-html"><a href="#GitHub网站进不去的点这里：https-www-cnblogs-com-xuexianqi-p-13219719-html" class="headerlink" title="GitHub网站进不去的点这里：https://www.cnblogs.com/xuexianqi/p/13219719.html"></a><strong>GitHub网站进不去的点这里：<a href="https://www.cnblogs.com/xuexianqi/p/13219719.html" target="_blank" rel="noopener">https://www.cnblogs.com/xuexianqi/p/13219719.html</a></strong></h3><h3 id="进入下载地址后，选择最新版本，Windows系统点击-exe文件进行下载，安装直接无脑下一步，路径默认即可（MacOS系统点击-dmg文件，Linux系统点击tar-gz下载）"><a href="#进入下载地址后，选择最新版本，Windows系统点击-exe文件进行下载，安装直接无脑下一步，路径默认即可（MacOS系统点击-dmg文件，Linux系统点击tar-gz下载）" class="headerlink" title="进入下载地址后，选择最新版本，Windows系统点击.exe文件进行下载，安装直接无脑下一步，路径默认即可（MacOS系统点击.dmg文件，Linux系统点击tar.gz下载）"></a><strong>进入下载地址后，选择最新版本，Windows系统点击.exe文件进行下载，安装直接无脑下一步，路径默认即可（MacOS系统点击.dmg文件，Linux系统点击tar.gz下载）</strong></h3><p><img src="/images/o_20070611482102.png" alt="o_20070611482102.png"></p><h3 id="3-Gitee（码云）"><a href="#3-Gitee（码云）" class="headerlink" title="3.Gitee（码云）"></a><strong>3.Gitee（码云）</strong></h3><h3 id="码云，一款基于-Git-的代码托管和研发协作平台官方，又称为国内的github。"><a href="#码云，一款基于-Git-的代码托管和研发协作平台官方，又称为国内的github。" class="headerlink" title="码云，一款基于 Git 的代码托管和研发协作平台官方，又称为国内的github。"></a><strong>码云，一款基于 Git 的代码托管和研发协作平台官方，又称为国内的github。</strong></h3><h3 id="官方网站：https-gitee-com"><a href="#官方网站：https-gitee-com" class="headerlink" title="官方网站：https://gitee.com/"></a><strong>官方网站：<a href="https://gitee.com/" target="_blank" rel="noopener">https://gitee.com/</a></strong></h3><h3 id="注册网址：https-gitee-com-signup"><a href="#注册网址：https-gitee-com-signup" class="headerlink" title="注册网址：https://gitee.com/signup"></a><strong>注册网址：<a href="http://www.baidu.com/link?url=Q9yIAdEvisuJfrmu8LQ_LZt3jRfQICY7Q4jyCEKyPdkDfh2x1FcKkIfyg-7bkdLc" target="_blank" rel="noopener">https://gitee.com/signup</a></strong></h3><h1 id="三：搭建教程"><a href="#三：搭建教程" class="headerlink" title="三：搭建教程"></a><strong>三：搭建教程</strong></h1><h3 id="1-创建好Gitee账号后，点击右上角加号-“-”，点击：新建仓库"><a href="#1-创建好Gitee账号后，点击右上角加号-“-”，点击：新建仓库" class="headerlink" title="1.创建好Gitee账号后，点击右上角加号 “+”，点击：新建仓库"></a>1.创建好Gitee账号后，点击右上角加号 “+”，点击：新建仓库</h3><h3 id="2-仓库名称（自定义）-路径（自定义）-公开-使用Readme文件初始化这个仓库-创建"><a href="#2-仓库名称（自定义）-路径（自定义）-公开-使用Readme文件初始化这个仓库-创建" class="headerlink" title="2.仓库名称（自定义） - 路径（自定义） - 公开 - 使用Readme文件初始化这个仓库 - 创建"></a>2.仓库名称（自定义） - 路径（自定义） - 公开 - 使用Readme文件初始化这个仓库 - 创建</h3><p><img src="/images/o_20070710300302.png" alt="o_20070710300302.png"></p><h3 id="3-点击右上角用户头像右边的下拉框，点击：设置"><a href="#3-点击右上角用户头像右边的下拉框，点击：设置" class="headerlink" title="3.点击右上角用户头像右边的下拉框，点击：设置"></a>3.点击右上角用户头像右边的下拉框，点击：设置</h3><h3 id="4-点击左侧-：私人令牌"><a href="#4-点击左侧-：私人令牌" class="headerlink" title="4.点击左侧 ：私人令牌"></a>4.点击左侧 ：私人令牌</h3><h3 id="5-点击：生成新令牌"><a href="#5-点击：生成新令牌" class="headerlink" title="5.点击：生成新令牌"></a>5.点击：生成新令牌</h3><h3 id="6-私人令牌描述（自定义）-选择-“peojects”-提交"><a href="#6-私人令牌描述（自定义）-选择-“peojects”-提交" class="headerlink" title="6.私人令牌描述（自定义） - 选择 “peojects” - 提交"></a>6.私人令牌描述（自定义） - 选择 “peojects” - 提交</h3><p><img src="/images/o_20070710303206.png" alt="o_20070710303206.png"></p><h3 id="7-Note-自定义一个名称，repo-打上-√"><a href="#7-Note-自定义一个名称，repo-打上-√" class="headerlink" title="7.Note 自定义一个名称，repo 打上 √"></a>7.Note 自定义一个名称，repo 打上 √</h3><h3 id="8-输入登录码云的密码，点击：验证"><a href="#8-输入登录码云的密码，点击：验证" class="headerlink" title="8.输入登录码云的密码，点击：验证"></a>8.输入登录码云的密码，点击：验证</h3><p><img src="/images/o_20070710303507.png" alt="o_20070710303507.png"></p><h3 id="9-现在生成的是一串Token，只会在现在显示一次，所以要妥善保管好，点击：复制-打勾“我已经了解…”-确认并关闭"><a href="#9-现在生成的是一串Token，只会在现在显示一次，所以要妥善保管好，点击：复制-打勾“我已经了解…”-确认并关闭" class="headerlink" title="9.现在生成的是一串Token，只会在现在显示一次，所以要妥善保管好，点击：复制 - 打勾“我已经了解…” - 确认并关闭"></a>9.现在生成的是一串Token，只会在现在显示一次，所以要妥善保管好，点击：复制 - 打勾“我已经了解…” - 确认并关闭</h3><p><img src="/images/o_20070710303808.png" alt="o_20070710303808.png"></p><h3 id="10-打开PicGo，点击左侧-插件设置-搜索框输入：gitee-点击右边的gitee-uploader：安装"><a href="#10-打开PicGo，点击左侧-插件设置-搜索框输入：gitee-点击右边的gitee-uploader：安装" class="headerlink" title="10.打开PicGo，点击左侧 - 插件设置 - 搜索框输入：gitee - 点击右边的gitee-uploader：安装"></a>10.打开PicGo，点击左侧 - 插件设置 - 搜索框输入：gitee - 点击右边的gitee-uploader：安装</h3><p><img src="/images/o_20070710304309.png" alt="o_20070710304309.png"></p><h3 id="11-点击左侧：图床设置-gitee，进行如下设置"><a href="#11-点击左侧：图床设置-gitee，进行如下设置" class="headerlink" title="11.点击左侧：图床设置 - gitee，进行如下设置"></a>11.点击左侧：图床设置 - gitee，进行如下设置</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">repo：  填写用户名/仓库名</span><br><span class="line"></span><br><span class="line">branch：  填写：master</span><br><span class="line"></span><br><span class="line">token：  填写刚才生成的那一串token</span><br><span class="line"></span><br><span class="line">path：  填写：img</span><br><span class="line"></span><br><span class="line">customPath：  默认即可，不用填写</span><br><span class="line"></span><br><span class="line">customUrl：  默认即可，不用填写</span><br></pre></td></tr></table></figure><p><img src="/images/1594124775(1).png" alt="1594124775(1).png"></p><h2 id="四：图片上传至图库的方法1（推荐）"><a href="#四：图片上传至图库的方法1（推荐）" class="headerlink" title="四：图片上传至图库的方法1（推荐）"></a><strong>四：图片上传至图库的方法1（推荐）</strong></h2><h3 id="1-打开Typora，点击左上角：文件-偏好设置"><a href="#1-打开Typora，点击左上角：文件-偏好设置" class="headerlink" title="1.打开Typora，点击左上角：文件 - 偏好设置"></a><strong>1.打开Typora，点击左上角：文件 - 偏好设置</strong></h3><h3 id="2-点击：图像-插入图片时（下拉选择：上传图片）-对网络位置的图片应用上述规则（可选可不选，选中就是图片也会复制到本地）-允许根据YAML设置自动上传图片-上传服务：下拉后选择-PicGo（app）-选择PicGo路径"><a href="#2-点击：图像-插入图片时（下拉选择：上传图片）-对网络位置的图片应用上述规则（可选可不选，选中就是图片也会复制到本地）-允许根据YAML设置自动上传图片-上传服务：下拉后选择-PicGo（app）-选择PicGo路径" class="headerlink" title="2.点击：图像 - 插入图片时（下拉选择：上传图片） - 对网络位置的图片应用上述规则（可选可不选，选中就是图片也会复制到本地） - 允许根据YAML设置自动上传图片 - 上传服务：下拉后选择 PicGo（app） - 选择PicGo路径"></a>2.点击：图像 - 插入图片时（下拉选择：上传图片） - 对网络位置的图片应用上述规则（可选可不选，选中就是图片也会复制到本地） - 允许根据YAML设置自动上传图片 - 上传服务：下拉后选择 PicGo（app） - 选择PicGo路径</h3><p><img src="/images/o_20070612482223.png" alt="o_20070612482223.png"></p><h3 id="3-找到PicGo的安装路径，默认是C-Program-Files-PicGo点击：打开"><a href="#3-找到PicGo的安装路径，默认是C-Program-Files-PicGo点击：打开" class="headerlink" title="3.找到PicGo的安装路径，默认是C:\Program Files\PicGo点击：打开"></a>3.找到PicGo的安装路径，默认是C:\Program Files\PicGo点击：打开</h3><p><img src="/images/o_20070612104519.png" alt="o_20070612104519.png"></p><h3 id="4-点击：验证图片上传选项，显示绿色字-“成功上床图片并获得新的URL”，点击：OK"><a href="#4-点击：验证图片上传选项，显示绿色字-“成功上床图片并获得新的URL”，点击：OK" class="headerlink" title="4.点击：验证图片上传选项，显示绿色字 “成功上床图片并获得新的URL”，点击：OK"></a>4.点击：验证图片上传选项，显示绿色字 “成功上床图片并获得新的URL”，点击：OK</h3><p><img src="/images/20200707184938.png" alt="20200707184938.png"></p><h3 id="5-此时，截完图之后，直接按粘贴快捷键（Ctrl-V）即可将图片上传到图库"><a href="#5-此时，截完图之后，直接按粘贴快捷键（Ctrl-V）即可将图片上传到图库" class="headerlink" title="5.此时，截完图之后，直接按粘贴快捷键（Ctrl+V）即可将图片上传到图库"></a>5.此时，截完图之后，直接按粘贴快捷键（Ctrl+V）即可将图片上传到图库</h3><h3 id="6-也成功显示出来了"><a href="#6-也成功显示出来了" class="headerlink" title="6.也成功显示出来了"></a>6.也成功显示出来了</h3><p><img src="/images/20200707185045.png" alt="20200707185045.png"></p><h1 id="五：图片上传至图库的方法2"><a href="#五：图片上传至图库的方法2" class="headerlink" title="五：图片上传至图库的方法2"></a><strong>五：图片上传至图库的方法2</strong></h1><h3 id="1-设置快捷键"><a href="#1-设置快捷键" class="headerlink" title="1.设置快捷键"></a>1.设置快捷键</h3><p><img src="/images/o_20070611485712.png" alt="o_20070611485712.png"></p><h3 id="2-点击：编辑"><a href="#2-点击：编辑" class="headerlink" title="2.点击：编辑"></a>2.点击：编辑</h3><p><img src="/images/o_20070611490013.png" alt="o_20070611490013.png"></p><h3 id="3-同时按住Ctrl、Shift、V-组合键（当然，也可以自定义），点击：确定"><a href="#3-同时按住Ctrl、Shift、V-组合键（当然，也可以自定义），点击：确定" class="headerlink" title="3.同时按住Ctrl、Shift、V 组合键（当然，也可以自定义），点击：确定"></a>3.同时按住Ctrl、Shift、V 组合键（当然，也可以自定义），点击：确定</h3><p><img src="/images/o_20070611490414.png" alt="o_20070611490414.png"></p><h3 id="4-我们截完图之后，直接按下快捷键（Ctrl-Shift-V）就把截图上传到图库了，并且自动复制了图片的外链，然后我们直接按下快捷键（Ctr-V）就可以粘贴了"><a href="#4-我们截完图之后，直接按下快捷键（Ctrl-Shift-V）就把截图上传到图库了，并且自动复制了图片的外链，然后我们直接按下快捷键（Ctr-V）就可以粘贴了" class="headerlink" title="4.我们截完图之后，直接按下快捷键（Ctrl+Shift+V）就把截图上传到图库了，并且自动复制了图片的外链，然后我们直接按下快捷键（Ctr+V）就可以粘贴了"></a>4.我们截完图之后，直接按下快捷键（Ctrl+Shift+V）就把截图上传到图库了，并且自动复制了图片的外链，然后我们直接按下快捷键（Ctr+V）就可以粘贴了</h3><p><img src="/images/20200707185135.png" alt="20200707185135.png"></p><h3 id="5-单击图片即可看到图片的外链"><a href="#5-单击图片即可看到图片的外链" class="headerlink" title="5.单击图片即可看到图片的外链"></a>5.单击图片即可看到图片的外链</h3><p><img src="/images/20200707185144.png" alt="20200707185144.png"></p><h2 id="Ending…"><a href="#Ending…" class="headerlink" title="Ending…."></a>Ending….</h2>]]></content>
    
    <summary type="html">
    
      一：引言,图床一般是指储存图片的服务器，有国内和国外之分。国外的图床由于有空间距离等因素决定访问速度很慢影响图片显示速度。国内也分为单线空间、多线空间和cdn加速三种...
    
    </summary>
    
    
      <category term="技能get" scheme="http://yoursite.com/categories/%E6%8A%80%E8%83%BDget/"/>
    
    
      <category term="图床制作" scheme="http://yoursite.com/tags/%E5%9B%BE%E5%BA%8A%E5%88%B6%E4%BD%9C/"/>
    
  </entry>
  
  <entry>
    <title>[Git安装与介绍]</title>
    <link href="http://yoursite.com/2020/05/21/Git%E5%AE%89%E8%A3%85%E4%B8%8E%E4%BB%8B%E7%BB%8D/"/>
    <id>http://yoursite.com/2020/05/21/Git%E5%AE%89%E8%A3%85%E4%B8%8E%E4%BB%8B%E7%BB%8D/</id>
    <published>2020-05-20T23:18:13.000Z</published>
    <updated>2020-05-20T23:19:13.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="如何多人协同开发同一个项目？"><a href="#如何多人协同开发同一个项目？" class="headerlink" title="如何多人协同开发同一个项目？"></a>如何多人协同开发同一个项目？</h1><p>使用代码版本控制[version control]软件,</p><p>目前市面上比较流行的代码版本控制器有: git,svn,csv</p><p>澄清一个问题：</p><blockquote><p>github，gitee和git之间的关系github和gitee是一个网站，git是一个代码版本控制软件。git是当初Linux系统的作者【林纳斯·托瓦兹】为了开发Linux代码所开发的一个开软软件。github是全球知名的一个开源源码托管平台，之所以叫github是因为他支持通过git上传和下载代码，同时因为git比较出名，所以借助了他的名气而已。他们之间的关系类似，张三和张三丰。gitee是一个国内知名的开源源码托管平台，和github出现的原因类似。</p></blockquote><h1 id="1-使用git管理代码版本"><a href="#1-使用git管理代码版本" class="headerlink" title="1. 使用git管理代码版本"></a>1. 使用git管理代码版本</h1><p>本项目使用git管理项目代码，代码库放在gitee码云平台。（注意，公司中通常放在gitlab私有服务器中）</p><h2 id="1-1-Git-的诞生"><a href="#1-1-Git-的诞生" class="headerlink" title="1.1 Git 的诞生"></a>1.1 Git 的诞生</h2><p>2005 年 4 月3 日，Git 是目前世界上最先进的分布式版本控制系统（没有之一）</p><p>作用：源代码管理</p><p><strong>为什么要进行源代码管理?</strong></p><ul><li>方便多人协同开发[防止代码冲突，相互覆盖]</li><li>方便版本控制[利于以后的开发人员快速了解项目的开发过程，利于需求变更的时候进行代码回滚]</li></ul><h2 id="1-2-git与svn区别"><a href="#1-2-git与svn区别" class="headerlink" title="1.2 git与svn区别"></a>1.2 git与svn区别</h2><p>SVN 都是集中控制管理的，也就是有一个中央服务器，大家都把代码提交到中央服务器，而 git 是分布式的版本控制工具，也就是说没有中央服务器，每个节点的地位平等。</p><p>SVN</p><p><img src="/image/1553208721216.png" alt=""></p><p>Git</p><p><img src="/image/1553208738888.png" alt=""></p><h2 id="Git的windows下安装"><a href="#Git的windows下安装" class="headerlink" title="Git的windows下安装"></a>Git的windows下安装</h2><p>官网地址：<a href="https://git-scm.com/download" target="_blank" rel="noopener">https://git-scm.com/download</a></p><p><img src="/image/1553220095452.png" alt=""></p><p><img src="/image/1553208779674.png" alt=""></p><p>下载到本地磁盘</p><p><img src="/image/1553208790623.png" alt=""></p><p>安装</p><p><img src="/image/1553208801316.png" alt=""></p><p>一路【next】就可以了</p><p><img src="/image/1553220218170.png" alt=""></p><p><img src="/image/1553220208875.png" alt=""></p><p><img src="/image/1553220240618.png" alt=""></p><p>注意：<strong>openssl 一定选它</strong></p><p>安装完成后，右击菜单栏，有如下菜单，表示安装完成</p><p><img src="/image/1553220425466.png" alt=""></p><p>进入git bash选项</p><p><img src="/image/1553220553963.png" alt=""></p><p>Git工作区、暂存区和版本库</p><p><img src="/image/1593749346903.png" alt=""></p><h2 id="1、工作区介绍"><a href="#1、工作区介绍" class="headerlink" title="1、工作区介绍"></a>1、工作区介绍</h2><p>就是在你本要电脑磁盘上能看到的目录。</p><h2 id="2、暂存区介绍"><a href="#2、暂存区介绍" class="headerlink" title="2、暂存区介绍"></a>2、暂存区介绍</h2><p>一般存放在【.git】目录下的index文件(.git/index) 中，所以我们把暂存区有时也叫作索引。</p><h2 id="3、版本库介绍"><a href="#3、版本库介绍" class="headerlink" title="3、版本库介绍"></a>3、版本库介绍</h2><p>工作区有一个隐藏目录.git，这个不算工作区，而是Git的版本库。git中的head/master是分支，是版本库。</p><h3 id="git项目仓库的本地搭建"><a href="#git项目仓库的本地搭建" class="headerlink" title="git项目仓库的本地搭建"></a>git项目仓库的本地搭建</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span>进入到自己希望存储代码的目录路径，并创建本地仓库.git</span><br><span class="line">新创建的本地仓库.git是个空仓库</span><br><span class="line"></span><br><span class="line">  <span class="built_in">cd</span> 目录路径</span><br><span class="line">  git init gitdemo  <span class="comment"># 如果没有声明目录,则自动把当前目录作为git仓库</span></span><br></pre></td></tr></table></figure><p>创建仓库</p><p><img src="/image/1553222861995.png" alt=""></p><h3 id="仓库目录的结构"><a href="#仓库目录的结构" class="headerlink" title="仓库目录的结构"></a>仓库目录的结构</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">branches&#x2F;   分支管理目录config      </span><br><span class="line">当前项目仓木的配置信息description </span><br><span class="line">当前项目的描述HEAD        </span><br><span class="line">当前项目仓库的当前版本信息hooks       </span><br><span class="line">当前项目仓库的钩子目录[可以利用这个目录下面的文件实现自己拉去代码到服务器]info        </span><br><span class="line">仓库相关信息objects     </span><br><span class="line">仓库版本信息refs        </span><br><span class="line">引用信息</span><br></pre></td></tr></table></figure><h3 id="配置用户名和邮箱"><a href="#配置用户名和邮箱" class="headerlink" title="配置用户名和邮箱"></a>配置用户名和邮箱</h3><blockquote><p>–global表示全局配置，配置信息默认保存到当前操作系统的用户家目录中的.gitconfig文件，可以通过命令cat ~/.gitconfig查看全局配置如果不加上这个参数，则默认配置信息保存到.git/config文件中，可以通过命令 cat 项目/.git/config查看仓库配置</p></blockquote><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">git config --global user.name <span class="string">'lisi'</span></span><br><span class="line">git config --global user.email <span class="string">'lisi@163.com'</span></span><br></pre></td></tr></table></figure><p><img src="/image/1553209118220.png" alt=""></p><h3 id="查看仓库状态"><a href="#查看仓库状态" class="headerlink" title="查看仓库状态"></a>查看仓库状态</h3><p>所以的仓库状态指代的就是开发者每次对于项目的文件/目录都会进行增删查改操作。每次对于文件/目录进行操作时，仓库的状态都会记录下来。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">git status</span><br><span class="line"></span><br><span class="line">git status –s 简约显示</span><br></pre></td></tr></table></figure><ul><li>红色表示新建文件或者新修改的文件,都在工作区.</li><li>绿色表示文件在暂存区</li><li>新建的<code>login.py</code>文件在工作区，需要添加到暂存区并提交到仓库区</li></ul><p><img src="/image/1553209157268.png" alt=""></p><p>上图表示： 暂时没有新文件需要提交到暂存区</p><h3 id="添加文件到暂存区"><a href="#添加文件到暂存区" class="headerlink" title="添加文件到暂存区"></a>添加文件到暂存区</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 添加项目中所有文件</span></span><br><span class="line">git add .</span><br><span class="line">或者</span><br><span class="line"><span class="comment"># 添加指定文件</span></span><br><span class="line">git add login.py</span><br></pre></td></tr></table></figure><p>例如： 创建3个文件 ，并查看状态.</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">touch 1.htmltouch 2.html 3.htmlgit statusgit add 1.html 2.html 3.html <span class="comment"># 或 git add .git status</span></span><br></pre></td></tr></table></figure><p>效果：</p><p><img src="/image/1593749524017.png" alt=""></p><p>如果要测试1.html，2.html的暂存状态，则</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git rm --cached 1.html 2.html</span><br></pre></td></tr></table></figure><p>结果就是只有3.html是被保留在了暂存区</p><p><img src="/image/1593749620435.png" alt=""></p><h3 id="提交到版本库"><a href="#提交到版本库" class="headerlink" title="提交到版本库"></a>提交到版本库</h3><p>要把文件/目录提交到版本库必须先把文件/目录添加到暂存库才可以。所以上述的3.html可以提交，1.html和2.html是不能被提交的。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git commit -m <span class="string">"版本描述"</span></span><br></pre></td></tr></table></figure><h3 id="手动删除文件"><a href="#手动删除文件" class="headerlink" title="手动删除文件"></a>手动删除文件</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">手动操作删除 或者 在命令行下 使用 rm 文件名 删除 都是表示在工作区删除.</span><br><span class="line">对于这种删除,如果还原,则可以使用 git reset --hard HEAD</span><br></pre></td></tr></table></figure><p><img src="/image/1553221937786.png" alt=""></p><h3 id="查看历史版本-查看日志"><a href="#查看历史版本-查看日志" class="headerlink" title="查看历史版本[查看日志]"></a>查看历史版本[查看日志]</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">git <span class="built_in">log</span>      <span class="comment"># 查看详细日志列表</span></span><br><span class="line">git reflog   <span class="comment"># 查看简单日志列表</span></span><br><span class="line"> </span><br><span class="line">过滤查看日志</span><br><span class="line">  git <span class="built_in">log</span> –p </span><br><span class="line">  退出按【q】键</span><br><span class="line">  ctrl+f 向下分页</span><br><span class="line">  ctrl+b 向上分页</span><br><span class="line"></span><br><span class="line">显示指定日期之后的日志   git <span class="built_in">log</span> --after  <span class="string">'2018-11-6'</span></span><br><span class="line">显示指定日期之前的日志   git <span class="built_in">log</span> --before <span class="string">'2018-11-6'</span></span><br><span class="line"></span><br><span class="line">指定显示指定开发者的日志  git <span class="built_in">log</span> --author <span class="string">'lisi'</span></span><br></pre></td></tr></table></figure><p><strong>回退版本</strong></p><ul><li><p><strong>方案一：</strong></p><ul><li><p><code>HEAD</code>表示当前最新版本</p></li><li><p><code>HEAD^</code>表示当前最新版本的前一个版本</p></li><li><p><code>HEAD^^</code>表示当前最新版本的前两个版本，<strong>以此类推…</strong></p></li><li><p><code>HEAD~1</code>表示当前最新版本的前一个版本</p></li><li><p><code>HEAD~10</code>表示当前最新版本的前10个版本，<strong>以此类推…</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git reset --hard HEAD^</span><br></pre></td></tr></table></figure></li></ul></li><li><p><strong>方案二：当版本非常多时可选择的方案</strong></p><ul><li><p>通过每个版本的版本号回退到指定版本</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git reset --hard 版本号</span><br></pre></td></tr></table></figure></li></ul></li></ul><h2 id="查看文件状态"><a href="#查看文件状态" class="headerlink" title="查看文件状态"></a>查看文件状态</h2><p><strong>针对与文件所处的不同分区，文件所处的状态:</strong></p><p>(1)未追踪, 文件第一次出现在工作区, 版本库还没有存储该文件的状态</p><p>(2)已追踪, 只要第一次,git add了文件, 文件就是已追踪</p><p>(3)未修改, 文件在工作区未被编辑</p><p>(4)已修改, 文件在工作区被修改</p><p>(5)未暂存, 文件已修改, 但是没有add到暂存区</p><p>(6)已暂存, 已经将修改的文件add到暂存区</p><p>(7)未提交, 已暂存的文件, 没有commit提交. 处于暂存区</p><p>(8)已提交, 提交到版本库的文件修改,只有commit以后才会有仓库的版本号生成</p><p>注意：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">公司一般使用git管理项目,往往会搭建一个gitlab自己内部管理代码,也有公司选择使用码云的企业版仓库来管理</span><br><span class="line"></span><br><span class="line">使用git开发项目时，有时候不一定通过https协议提交代码的。也有的公司是通过ssh协议提交,此时需要生成ssh公钥和提交公钥给仓库。[码云这些官网都会有详细的提示说明]</span><br><span class="line"></span><br><span class="line">生成SSH公钥【必须安装git bash才可以使用这个命令，而且还要把git bash添加到系统变量里面】</span><br><span class="line">  ssh-keygen -t rsa -C &quot;源码托管平台的账号&quot;</span><br><span class="line"></span><br><span class="line">参考：https:&#x2F;&#x2F;gitee.com&#x2F;help&#x2F;articles&#x2F;4180</span><br></pre></td></tr></table></figure><h1 id="2-在git平台创建工程"><a href="#2-在git平台创建工程" class="headerlink" title="2. 在git平台创建工程"></a>2. 在git平台创建工程</h1><p>1） 创建私有项目库</p><p><img src="/image/1553225634429.png" alt=""></p><p><img src="/image/1553225730511.png" alt=""></p><p>创建私有空仓库以后的界面:</p><p><img src="/image/1553225968558.png" alt=""></p><p>2）克隆项目到本地</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">git clone 仓库地址</span><br><span class="line">注意，如果当前目录下出现git仓库同名目录时，会克隆失败。</span><br></pre></td></tr></table></figure><p><img src="/image/1553227023342.png" alt=""></p><p>3）创建并切换分支到dev</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 分支管理的命令</span></span><br><span class="line">git branch            <span class="comment"># 查看当前项目的所有分支列表</span></span><br><span class="line">git bracn 分支名称     <span class="comment"># 新建一个分支</span></span><br><span class="line">git checkout 分支名称  <span class="comment"># 切换分支，让当前目录下显示对应分支里面的内容</span></span><br><span class="line">git checkout -d  分支名称  <span class="comment"># 删除指定名称的分支</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># git branch dev      # 创建本地分支dev,dev是自定义</span></span><br><span class="line"><span class="comment"># git checkout dev    # 切换本地分支代码</span></span><br><span class="line">git checkout -b dev   <span class="comment"># 这里是上面两句代码的简写</span></span><br></pre></td></tr></table></figure><p>git提交</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">git add 代码目录</span><br><span class="line">git status</span><br><span class="line">git commit -m <span class="string">'添加项目代码'</span></span><br></pre></td></tr></table></figure><p>推送到远端</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># git push origin 本地分支名称:线上分支名称</span></span><br><span class="line"><span class="comment"># 如果本地分支和线上分支名称一致，则可以简写 git push origin 分支名称</span></span><br><span class="line"><span class="comment"># 如果有的本地分支名称，但是线上没有，则代码推送时，线上会自动创建</span></span><br><span class="line">git push origin dev:dev</span><br></pre></td></tr></table></figure><p>如果推送代码,出现以下提示: git pull ….,则表示当前本地的代码和线上的代码版本不同.</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">1. 把线上的代码执行以下命令,拉取到本地,进行同步</span><br><span class="line">git pull</span><br><span class="line"></span><br><span class="line">2. 根据提示,移除多余的冲突的文件,也可以删除.</span><br><span class="line">完成这些步骤以后,再次add,commit,push,通知其他同事git pull即可.</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      github，gitee和git之间的关系github和gitee是一个网站，git是一个代码版本控制软件。git是当初Linux系统的作者[林纳斯·托瓦兹]为了开发Linux代码所开发的一个开软软件。github是全球知名...
    
    </summary>
    
    
      <category term="IT兵器谱" scheme="http://yoursite.com/categories/IT%E5%85%B5%E5%99%A8%E8%B0%B1/"/>
    
    
      <category term="Git" scheme="http://yoursite.com/tags/Git/"/>
    
  </entry>
  
  <entry>
    <title>[Git命令大全]</title>
    <link href="http://yoursite.com/2020/05/21/Git%E5%91%BD%E4%BB%A4%E5%A4%A7%E5%85%A8/"/>
    <id>http://yoursite.com/2020/05/21/Git%E5%91%BD%E4%BB%A4%E5%A4%A7%E5%85%A8/</id>
    <published>2020-05-20T23:15:12.000Z</published>
    <updated>2020-05-20T23:16:12.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="git-config"><a href="#git-config" class="headerlink" title="git config"></a>git config</h2><p>配置 Git 的相关参数。</p><p>Git 一共有3个配置文件：</p><p>\1. 仓库级的配置文件：在仓库的 <code>.git/.gitconfig</code>，该配置文件只对所在的仓库有效。 \2. 全局配置文件：Mac 系统在 <code>~/.gitconfig</code>，Windows 系统在 <code>C:\Users\&lt;用户名&gt;\.gitconfig</code>。 \3. 系统级的配置文件：在 Git 的安装目录下（Mac 系统下安装目录在 <code>/usr/local/git</code>）的 <code>etc</code> 文件夹中的 <code>gitconfig</code>。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 查看配置信息</span></span><br><span class="line"><span class="comment"># --local：仓库级，--global：全局级，--system：系统级</span></span><br><span class="line">$ git config &lt;--<span class="built_in">local</span> | --global | --system&gt; -l</span><br><span class="line"></span><br><span class="line"><span class="comment"># 查看当前生效的配置信息</span></span><br><span class="line">$ git config -l</span><br><span class="line"></span><br><span class="line"><span class="comment"># 编辑配置文件</span></span><br><span class="line"><span class="comment"># --local：仓库级，--global：全局级，--system：系统级</span></span><br><span class="line">$ git config &lt;--<span class="built_in">local</span> | --global | --system&gt; -e</span><br><span class="line"></span><br><span class="line"><span class="comment"># 添加配置项</span></span><br><span class="line"><span class="comment"># --local：仓库级，--global：全局级，--system：系统级</span></span><br><span class="line">$ git config &lt;--<span class="built_in">local</span> | --global | --system&gt; --add &lt;name&gt; &lt;value&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 获取配置项</span></span><br><span class="line">$ git config &lt;--<span class="built_in">local</span> | --global | --system&gt; --get &lt;name&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 删除配置项</span></span><br><span class="line">$ git config &lt;--<span class="built_in">local</span> | --global | --system&gt; --<span class="built_in">unset</span> &lt;name&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 配置提交记录中的用户信息</span></span><br><span class="line">$ git config --global user.name &lt;用户名&gt;</span><br><span class="line">$ git config --global user.email &lt;邮箱地址&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 更改Git缓存区的大小</span></span><br><span class="line"><span class="comment"># 如果提交的内容较大，默认缓存较小，提交会失败</span></span><br><span class="line"><span class="comment"># 缓存大小单位：B，例如：524288000（500MB）</span></span><br><span class="line">$ git config --global http.postBuffer &lt;缓存大小&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 调用 git status/git diff 命令时以高亮或彩色方式显示改动状态</span></span><br><span class="line">$ git config --global color.ui <span class="literal">true</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 配置可以缓存密码，默认缓存时间15分钟</span></span><br><span class="line">$ git config --global credential.helper cache</span><br><span class="line"></span><br><span class="line"><span class="comment"># 配置密码的缓存时间</span></span><br><span class="line"><span class="comment"># 缓存时间单位：秒</span></span><br><span class="line">$ git config --global credential.helper <span class="string">'cache --timeout=&lt;缓存时间&gt;'</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 配置长期存储密码</span></span><br><span class="line">$ git config --global credential.helper store</span><br></pre></td></tr></table></figure><h2 id="git-clone"><a href="#git-clone" class="headerlink" title="git clone"></a>git clone</h2><p>从远程仓库克隆一个版本库到本地。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 默认在当前目录下创建和版本库名相同的文件夹并下载版本到该文件夹下</span></span><br><span class="line">$ git <span class="built_in">clone</span> &lt;远程仓库的网址&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 指定本地仓库的目录</span></span><br><span class="line">$ git <span class="built_in">clone</span> &lt;远程仓库的网址&gt; &lt;本地目录&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment"># -b 指定要克隆的分支，默认是master分支</span></span><br><span class="line">$ git <span class="built_in">clone</span> &lt;远程仓库的网址&gt; -b &lt;分支名称&gt; &lt;本地目录&gt;</span><br></pre></td></tr></table></figure><h2 id="git-init"><a href="#git-init" class="headerlink" title="git init"></a>git init</h2><p>初始化项目所在目录，初始化后会在当前目录下出现一个名为 .git 的目录。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 初始化本地仓库，在当前目录下生成 .git 文件夹</span></span><br><span class="line">$ git init</span><br></pre></td></tr></table></figure><h2 id="git-status"><a href="#git-status" class="headerlink" title="git status"></a>git status</h2><p>查看本地仓库的状态。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 查看本地仓库的状态</span></span><br><span class="line">$ git status</span><br><span class="line"></span><br><span class="line"><span class="comment"># 以简短模式查看本地仓库的状态</span></span><br><span class="line"><span class="comment"># 会显示两列，第一列是文件的状态，第二列是对应的文件</span></span><br><span class="line"><span class="comment"># 文件状态：A 新增，M 修改，D 删除，?? 未添加到Git中</span></span><br><span class="line">$ git status -s</span><br></pre></td></tr></table></figure><h2 id="git-remote"><a href="#git-remote" class="headerlink" title="git remote"></a>git remote</h2><p>操作远程库。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 列出已经存在的远程仓库</span></span><br><span class="line">$ git remote</span><br><span class="line"></span><br><span class="line"><span class="comment"># 列出远程仓库的详细信息，在别名后面列出URL地址</span></span><br><span class="line">$ git remote -v</span><br><span class="line">$ git remote --verbose</span><br><span class="line"></span><br><span class="line"><span class="comment"># 添加远程仓库</span></span><br><span class="line">$ git remote add &lt;远程仓库的别名&gt; &lt;远程仓库的URL地址&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 修改远程仓库的别名</span></span><br><span class="line">$ git remote rename &lt;原远程仓库的别名&gt; &lt;新的别名&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 删除指定名称的远程仓库</span></span><br><span class="line">$ git remote remove &lt;远程仓库的别名&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 修改远程仓库的 URL 地址</span></span><br><span class="line">$ git remote <span class="built_in">set</span>-url &lt;远程仓库的别名&gt; &lt;新的远程仓库URL地址&gt;</span><br></pre></td></tr></table></figure><h2 id="git-branch"><a href="#git-branch" class="headerlink" title="git branch"></a>git branch</h2><p>操作 Git 的分支命令。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 列出本地的所有分支，当前所在分支以 "*" 标出</span></span><br><span class="line">$ git branch</span><br><span class="line"></span><br><span class="line"><span class="comment"># 列出本地的所有分支并显示最后一次提交，当前所在分支以 "*" 标出</span></span><br><span class="line">$ git branch -v</span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建新分支，新的分支基于上一次提交建立</span></span><br><span class="line">$ git branch &lt;分支名&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 修改分支名称</span></span><br><span class="line"><span class="comment"># 如果不指定原分支名称则为当前所在分支</span></span><br><span class="line">$ git branch -m [&lt;原分支名称&gt;] &lt;新的分支名称&gt;</span><br><span class="line"><span class="comment"># 强制修改分支名称</span></span><br><span class="line">$ git branch -M [&lt;原分支名称&gt;] &lt;新的分支名称&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 删除指定的本地分支</span></span><br><span class="line">$ git branch -d &lt;分支名称&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 强制删除指定的本地分支</span></span><br><span class="line">$ git branch -D &lt;分支名称&gt;</span><br></pre></td></tr></table></figure><h2 id="git-checkout"><a href="#git-checkout" class="headerlink" title="git checkout"></a>git checkout</h2><p>检出命令，用于创建、切换分支等。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 切换到已存在的指定分支</span></span><br><span class="line">$ git checkout &lt;分支名称&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建并切换到指定的分支，保留所有的提交记录</span></span><br><span class="line"><span class="comment"># 等同于 "git branch" 和 "git checkout" 两个命令合并</span></span><br><span class="line">$ git checkout -b &lt;分支名称&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建并切换到指定的分支，删除所有的提交记录</span></span><br><span class="line">$ git checkout --orphan &lt;分支名称&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 替换掉本地的改动，新增的文件和已经添加到暂存区的内容不受影响</span></span><br><span class="line">$ git checkout &lt;文件路径&gt;</span><br></pre></td></tr></table></figure><h2 id="git-cherry-pick"><a href="#git-cherry-pick" class="headerlink" title="git cherry-pick"></a>git cherry-pick</h2><p>把已经提交的记录合并到当前分支。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 把已经提交的记录合并到当前分支</span></span><br><span class="line">$ git cherry-pick &lt;commit ID&gt;</span><br></pre></td></tr></table></figure><h2 id="git-add"><a href="#git-add" class="headerlink" title="git add"></a>git add</h2><p>把要提交的文件的信息添加到暂存区中。当使用 git commit 时，将依据暂存区中的内容来进行文件的提交。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 把指定的文件添加到暂存区中</span></span><br><span class="line">$ git add &lt;文件路径&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 添加所有修改、已删除的文件到暂存区中</span></span><br><span class="line">$ git add -u [&lt;文件路径&gt;]</span><br><span class="line">$ git add --update [&lt;文件路径&gt;]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 添加所有修改、已删除、新增的文件到暂存区中，省略 &lt;文件路径&gt; 即为当前目录</span></span><br><span class="line">$ git add -A [&lt;文件路径&gt;]</span><br><span class="line">$ git add --all [&lt;文件路径&gt;]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 查看所有修改、已删除但没有提交的文件，进入一个子命令系统</span></span><br><span class="line">$ git add -i [&lt;文件路径&gt;]</span><br><span class="line">$ git add --interactive [&lt;文件路径&gt;]</span><br></pre></td></tr></table></figure><h2 id="git-commit"><a href="#git-commit" class="headerlink" title="git commit"></a>git commit</h2><p>将暂存区中的文件提交到本地仓库中。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 把暂存区中的文件提交到本地仓库，调用文本编辑器输入该次提交的描述信息</span></span><br><span class="line">$ git commit</span><br><span class="line"></span><br><span class="line"><span class="comment"># 把暂存区中的文件提交到本地仓库中并添加描述信息</span></span><br><span class="line">$ git commit -m <span class="string">"&lt;提交的描述信息&gt;"</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 把所有修改、已删除的文件提交到本地仓库中</span></span><br><span class="line"><span class="comment"># 不包括未被版本库跟踪的文件，等同于先调用了 "git add -u"</span></span><br><span class="line">$ git commit -a -m <span class="string">"&lt;提交的描述信息&gt;"</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 修改上次提交的描述信息</span></span><br><span class="line">$ git commit --amend</span><br></pre></td></tr></table></figure><h2 id="git-fetch"><a href="#git-fetch" class="headerlink" title="git fetch"></a>git fetch</h2><p>从远程仓库获取最新的版本到本地的 tmp 分支上。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 将远程仓库所有分支的最新版本全部取回到本地</span></span><br><span class="line">$ git fetch &lt;远程仓库的别名&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 将远程仓库指定分支的最新版本取回到本地</span></span><br><span class="line">$ git fetch &lt;远程主机名&gt; &lt;分支名&gt;</span><br></pre></td></tr></table></figure><h2 id="git-merge"><a href="#git-merge" class="headerlink" title="git merge"></a>git merge</h2><p>合并分支。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 把指定的分支合并到当前所在的分支下</span></span><br><span class="line">$ git merge &lt;分支名称&gt;</span><br></pre></td></tr></table></figure><h2 id="git-diff"><a href="#git-diff" class="headerlink" title="git diff"></a>git diff</h2><p>比较版本之间的差异。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 比较当前文件和暂存区中文件的差异，显示没有暂存起来的更改</span></span><br><span class="line">$ git diff</span><br><span class="line"></span><br><span class="line"><span class="comment"># 比较暂存区中的文件和上次提交时的差异</span></span><br><span class="line">$ git diff --cached</span><br><span class="line">$ git diff --staged</span><br><span class="line"></span><br><span class="line"><span class="comment"># 比较当前文件和上次提交时的差异</span></span><br><span class="line">$ git diff HEAD</span><br><span class="line"></span><br><span class="line"><span class="comment"># 查看从指定的版本之后改动的内容</span></span><br><span class="line">$ git diff &lt;commit ID&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 比较两个分支之间的差异</span></span><br><span class="line">$ git diff &lt;分支名称&gt; &lt;分支名称&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 查看两个分支分开后各自的改动内容</span></span><br><span class="line">$ git diff &lt;分支名称&gt;...&lt;分支名称&gt;</span><br></pre></td></tr></table></figure><h2 id="git-pull"><a href="#git-pull" class="headerlink" title="git pull"></a>git pull</h2><p>从远程仓库获取最新版本并合并到本地。 首先会执行 <code>git fetch</code>，然后执行 <code>git merge</code>，把获取的分支的 HEAD 合并到当前分支。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 从远程仓库获取最新版本。</span></span><br><span class="line">$ git pull</span><br></pre></td></tr></table></figure><h2 id="git-push"><a href="#git-push" class="headerlink" title="git push"></a>git push</h2><p>把本地仓库的提交推送到远程仓库。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 把本地仓库的分支推送到远程仓库的指定分支</span></span><br><span class="line">$ git push &lt;远程仓库的别名&gt; &lt;本地分支名&gt;:&lt;远程分支名&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 删除指定的远程仓库的分支</span></span><br><span class="line">$ git push &lt;远程仓库的别名&gt; :&lt;远程分支名&gt;</span><br><span class="line">$ git push &lt;远程仓库的别名&gt; --delete &lt;远程分支名&gt;</span><br></pre></td></tr></table></figure><h2 id="git-log"><a href="#git-log" class="headerlink" title="git log"></a>git log</h2><p>显示提交的记录。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 打印所有的提交记录</span></span><br><span class="line">$ git <span class="built_in">log</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 打印从第一次提交到指定的提交的记录</span></span><br><span class="line">$ git <span class="built_in">log</span> &lt;commit ID&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 打印指定数量的最新提交的记录</span></span><br><span class="line">$ git <span class="built_in">log</span> -&lt;指定的数量&gt;</span><br></pre></td></tr></table></figure><h2 id="git-reset"><a href="#git-reset" class="headerlink" title="git reset"></a>git reset</h2><p>还原提交记录。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 重置暂存区，但文件不受影响</span></span><br><span class="line"><span class="comment"># 相当于将用 "git add" 命令更新到暂存区的内容撤出暂存区，可以指定文件</span></span><br><span class="line"><span class="comment"># 没有指定 commit ID 则默认为当前 HEAD</span></span><br><span class="line">$ git reset [&lt;文件路径&gt;]</span><br><span class="line">$ git reset --mixed [&lt;文件路径&gt;]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 将 HEAD 的指向改变，撤销到指定的提交记录，文件未修改</span></span><br><span class="line">$ git reset &lt;commit ID&gt;</span><br><span class="line">$ git reset --mixed &lt;commit ID&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 将 HEAD 的指向改变，撤销到指定的提交记录，文件未修改</span></span><br><span class="line"><span class="comment"># 相当于调用 "git reset --mixed" 命令后又做了一次 "git add"</span></span><br><span class="line">$ git reset --soft &lt;commit ID&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 将 HEAD 的指向改变，撤销到指定的提交记录，文件也修改了</span></span><br><span class="line">$ git reset --hard &lt;commit ID&gt;</span><br></pre></td></tr></table></figure><h2 id="git-revert"><a href="#git-revert" class="headerlink" title="git revert"></a>git revert</h2><p>生成一个新的提交来撤销某次提交，此次提交之前的所有提交都会被保留。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 生成一个新的提交来撤销某次提交</span></span><br><span class="line">$ git revert &lt;commit ID&gt;</span><br></pre></td></tr></table></figure><h2 id="git-tag"><a href="#git-tag" class="headerlink" title="git tag"></a>git tag</h2><p>操作标签的命令。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 打印所有的标签</span></span><br><span class="line">$ git tag</span><br><span class="line"></span><br><span class="line"><span class="comment"># 添加轻量标签，指向提交对象的引用，可以指定之前的提交记录</span></span><br><span class="line">$ git tag &lt;标签名称&gt; [&lt;commit ID&gt;]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 添加带有描述信息的附注标签，可以指定之前的提交记录</span></span><br><span class="line">$ git tag -a &lt;标签名称&gt; -m &lt;标签描述信息&gt; [&lt;commit ID&gt;]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 切换到指定的标签</span></span><br><span class="line">$ git checkout &lt;标签名称&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 查看标签的信息</span></span><br><span class="line">$ git show &lt;标签名称&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 删除指定的标签</span></span><br><span class="line">$ git tag -d &lt;标签名称&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 将指定的标签提交到远程仓库</span></span><br><span class="line">$ git push &lt;远程仓库的别名&gt; &lt;标签名称&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 将本地所有的标签全部提交到远程仓库</span></span><br><span class="line">$ git push &lt;远程仓库的别名&gt; –tags</span><br></pre></td></tr></table></figure><h2 id="git-mv"><a href="#git-mv" class="headerlink" title="git mv"></a>git mv</h2><p>重命名文件或者文件夹。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 重命名指定的文件或者文件夹</span></span><br><span class="line">$ git mv &lt;源文件/文件夹&gt; &lt;目标文件/文件夹&gt;</span><br></pre></td></tr></table></figure><h2 id="git-rm"><a href="#git-rm" class="headerlink" title="git rm"></a>git rm</h2><p>删除文件或者文件夹。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 移除跟踪指定的文件，并从本地仓库的文件夹中删除</span></span><br><span class="line">$ git rm &lt;文件路径&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 移除跟踪指定的文件夹，并从本地仓库的文件夹中删除</span></span><br><span class="line">$ git rm -r &lt;文件夹路径&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 移除跟踪指定的文件，在本地仓库的文件夹中保留该文件</span></span><br><span class="line">$ git rm --cached</span><br></pre></td></tr></table></figure><h2 id="Git操作场景示例"><a href="#Git操作场景示例" class="headerlink" title="Git操作场景示例"></a>Git操作场景示例</h2><h3 id="1-删除掉本地不存在的远程分支"><a href="#1-删除掉本地不存在的远程分支" class="headerlink" title="1. 删除掉本地不存在的远程分支"></a>1. 删除掉本地不存在的远程分支</h3><p>多人合作开发时，如果远程的分支被其他开发删除掉，在本地执行 <code>git branch --all</code> 依然会显示该远程分支，可使用下列的命令进行删除：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 使用 pull 命令，添加 -p 参数</span></span><br><span class="line">$ git pull -p</span><br><span class="line"></span><br><span class="line"><span class="comment"># 等同于下面的命令</span></span><br><span class="line">$ git fetch -p</span><br><span class="line">$ git fetch --prune origin</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      配置 Git 的相关参数,1. 仓库级的配置文件：在仓库的 `.git/.gitconfig`，该配置文件只对所在的仓库有效。 \2. 全局配置文件：Mac 系统在 `~/.gitconfig`，Windows 系统...
    
    </summary>
    
    
      <category term="IT兵器谱" scheme="http://yoursite.com/categories/IT%E5%85%B5%E5%99%A8%E8%B0%B1/"/>
    
    
      <category term="Git" scheme="http://yoursite.com/tags/Git/"/>
    
  </entry>
  
  <entry>
    <title>[Go语言开发环境搭建]</title>
    <link href="http://yoursite.com/2020/05/14/Go%E8%AF%AD%E8%A8%80%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/"/>
    <id>http://yoursite.com/2020/05/14/Go%E8%AF%AD%E8%A8%80%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/</id>
    <published>2020-05-14T04:58:34.000Z</published>
    <updated>2020-05-14T05:32:21.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Go语言开发环境搭建"><a href="#Go语言开发环境搭建" class="headerlink" title="Go语言开发环境搭建"></a>Go语言开发环境搭建</h1><h1 id="安装Go语言及搭建Go语言开发环境"><a href="#安装Go语言及搭建Go语言开发环境" class="headerlink" title="安装Go语言及搭建Go语言开发环境"></a>安装Go语言及搭建Go语言开发环境</h1><p><strong>注意：</strong>Go语言1.14版本之后推荐使用go modules管理以来，也不再需要把代码写在GOPATH目录下了，之前旧版本的教程戳这个<a href="https://www.liwenzhou.com/posts/Go/install_go_dev_old/" target="_blank" rel="noopener">链接</a>。</p><table><strong><tr><td bgcolor=#DDEDEA align=center>**下载**</td></tr></strong></table><blockquote><p><strong>下载地址</strong></p></blockquote><p>Go官网下载地址：<a href="https://golang.org/dl/" target="_blank" rel="noopener">https://golang.org/dl/</a></p><p>Go官方镜像站（推荐）：<a href="https://golang.google.cn/dl/" target="_blank" rel="noopener">https://golang.google.cn/dl/</a></p><blockquote><p><strong>版本的选择</strong></p></blockquote><p>Windows平台和Mac平台推荐下载可执行文件版，Linux平台下载压缩文件版。</p><p><strong>下图中的版本号可能并不是最新的，但总体来说安装教程是类似的。Go语言更新迭代比较快，推荐使用较新版本，体验最新特性。</strong></p><p><img src="/images/download1.png" alt=""></p><hr><table><tr><td bgcolor=#FBE4E4 align=center bolder>**安装**  </td></tr></table>           <blockquote><p><strong>Windows安装</strong></p></blockquote><p>此安装实例以 <code>64位Win10</code>系统安装 <code>Go1.14.1可执行文件版本</code>为例。</p><p>将上一步选好的安装包下载到本地。</p><p>双击下载好的文件，然后按照下图的步骤安装即可。</p><p><img src="/images/install01.png" alt=""></p><blockquote><p><strong>Linux下安装</strong></p></blockquote><p>如果不是要在Linux平台敲go代码就不需要在Linux平台安装Go，我们开发机上写好的go代码只需要跨平台编译（详见文章末尾的跨平台编译）好之后就可以拷贝到Linux服务器上运行了，这也是go程序跨平台易部署的优势。</p><p>我们在版本选择页面选择并下载好<code>go1.14.1.linux-amd64.tar.gz</code>文件：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wget https://dl.google.com/go/go1.14.1.linux-amd64.tar.gz</span><br></pre></td></tr></table></figure><p>将下载好的文件解压到/usr/local目录下：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tar -zxvf go1.14.1.linux-amd64.tar.gz -C /usr/<span class="built_in">local</span>  <span class="comment"># 解压</span></span><br></pre></td></tr></table></figure><p>如果提示没有权限，加上<code>sudo</code>以root用户的身份再运行。执行完就可以在<code>/usr/local/</code>下看到<code>go</code>目录了。</p><p>配置环境变量： Linux下有两个文件可以配置环境变量，其中<code>/etc/profile</code>是对所有用户生效的；<code>$HOME/.profile</code>是对当前用户生效的，根据自己的情况自行选择一个文件打开，添加如下两行代码，保存退出。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">export</span> GOROOT=/usr/<span class="built_in">local</span>/go</span><br><span class="line"><span class="built_in">export</span> PATH=<span class="variable">$PATH</span>:<span class="variable">$GOROOT</span>/bin</span><br></pre></td></tr></table></figure><p>修改/etc/profile后要重启生效，修改$HOME/.profile后使用source命令加载$HOME/.profile文件即可生效。 检查：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">~ go version</span><br><span class="line">go version go1.14.1 linux/amd64</span><br></pre></td></tr></table></figure><blockquote><p><strong>Mac下安装</strong></p></blockquote><p>下载可执行文件版，直接点击下一步安装即可，默认会将go安装到<code>/usr/local/go</code>目录下。</p><p><img src="/images/mac_install_go.png" alt=""></p><blockquote><p><strong>检查</strong></p></blockquote><p>上一步安装过程执行完毕后，可以打开终端窗口，输入<code>go version</code>命令，查看安装的Go版本。</p><p><img src="/images/install06.png" alt=""></p><table><tr><td bgcolor=#D3EBF1 align=center bolder>**GOROOT和GOPATH**</td></tr></table>  <p><code>GOROOT</code>和<code>GOPATH</code>都是环境变量，其中<code>GOROOT</code>是我们安装go开发包的路径，而从Go 1.8版本开始，Go开发包在安装完成后会为<code>GOPATH</code>设置一个默认目录，参见下表。</p><p><strong>GOPATH在不同操作系统平台上的默认值</strong></p><table><thead><tr><th align="center">平台</th><th align="center">GOPATH默认值</th><th align="center">举例</th></tr></thead><tbody><tr><td align="center">Windows</td><td align="center">%USERPROFILE%/go</td><td align="center">C:\Users\用户名\go</td></tr><tr><td align="center">Unix</td><td align="center">$HOME/go</td><td align="center">/home/用户名/go</td></tr></tbody></table><p>可以通过以下方法查看默认的<code>GOPATH</code>目录：</p><p><img src="/images/env04.png" alt=""></p><blockquote><p><strong>GOPROXY</strong></p></blockquote><p>Go1.14版本之后，都推荐使用<code>go mod</code>模式来管理依赖环境了，也不再强制我们把代码必须写在<code>GOPATH</code>下面的src目录了，你可以在你电脑的任意位置编写go代码。（网上有些教程适用于1.11版本之前。）</p><p>默认GoPROXY配置是：<code>GOPROXY=https://proxy.golang.org,direct</code>，由于国内访问不到<code>https://proxy.golang.org</code>，所以我们需要换一个PROXY，这里推荐使用<code>https://goproxy.io</code>或<code>https://goproxy.cn</code>。</p><p>可以执行下面的命令修改GOPROXY：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">go env -w GOPROXY=https://goproxy.cn,direct</span><br></pre></td></tr></table></figure><table><tr><td bgcolor=#EAE4F2 align=center bolder>**Go开发编辑器**</td></tr></table><p>Go采用的是UTF-8编码的文本文件存放源代码，理论上使用任何一款文本编辑器都可以做Go语言开发，这里推荐使用<code>VS Code</code>和<code>Goland</code>。 <code>VS Code</code>是微软开源的编辑器，而<code>Goland</code>是jetbrains出品的付费IDE。</p><p>我们这里使用<code>VS Code</code> 加插件做为go语言的开发工具。</p><blockquote><p><strong>VS Code介绍</strong></p></blockquote><p><code>VS Code</code>全称<code>Visual Studio Code</code>，是微软公司开源的一款<strong>免费</strong>现代化轻量级代码编辑器，支持几乎所有主流的开发语言的语法高亮、智能代码补全、自定义热键、括号匹配、代码片段、代码对比 Diff、GIT 等特性，支持插件扩展，支持 Win、Mac 以及 Linux平台。</p><p>虽然不如某些IDE功能强大，但是它添加Go扩展插件后已经足够胜任我们日常的Go开发。</p><blockquote><p><strong>下载与安装</strong></p></blockquote><p><code>VS Code</code>官方下载地址：<a href="https://code.visualstudio.com/Download" target="_blank" rel="noopener">https://code.visualstudio.com/Download</a></p><p>三大主流平台都支持，请根据自己的电脑平台选择对应的安装包。</p><p><img src="/images/vscode_home.png" alt=""></p><p>双击下载好的安装文件，双击安装即可。</p><blockquote><p><strong>配置</strong></p></blockquote><h3 id="安装中文简体插件"><a href="#安装中文简体插件" class="headerlink" title="安装中文简体插件"></a>安装中文简体插件</h3><p>点击左侧菜单栏最后一项<code>管理扩展</code>，在<code>搜索框</code>中输入<code>chinese</code> ，选中结果列表第一项，点击<code>install</code>安装。</p><p>安装完毕后右下角会提示<code>重启VS Code</code>，重启之后你的VS Code就显示中文啦！</p><p>![]/images/vscode1.gif)</p><p>VSCode主界面介绍：</p><p><img src="/images/vscode_menu.png" alt=""></p><h3 id="安装go扩展"><a href="#安装go扩展" class="headerlink" title="安装go扩展"></a><strong>安装go扩展</strong></h3><p>现在我们要为我们的VS Code编辑器安装<code>Go</code>扩展插件，让它支持Go语言开发。</p><p><img src="/images/vscode_plugin.png" alt=""></p><table><tr><td bgcolor=#E9E5E3 align=center bolder>**第一个Go程序**</td></tr></table>       <blockquote><p>Hello World</p></blockquote><p>现在我们来创建第一个Go项目——<code>hello</code>。在我们桌面创建一个<code>hello</code>目录。</p><p>在该目录中创建一个<code>main.go</code>文件：</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main  <span class="comment">// 声明 main 包，表明当前是一个可执行程序</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">"fmt"</span>  <span class="comment">// 导入内置 fmt 包</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span>&#123;  <span class="comment">// main函数，是程序执行的入口</span></span><br><span class="line">fmt.Println(<span class="string">"Hello World!"</span>)  <span class="comment">// 在终端打印 Hello World!</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p><strong>go build</strong></p></blockquote><p><code>go build</code>表示将源代码编译成可执行文件。</p><p>在hello目录下执行：</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">go</span> build</span><br></pre></td></tr></table></figure><p>或者在其他目录执行以下命令：</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">go</span> build hello</span><br></pre></td></tr></table></figure><p>go编译器会去 <code>GOPATH</code>的src目录下查找你要编译的<code>hello</code>项目</p><p>编译得到的可执行文件会保存在执行编译命令的当前目录下，如果是windows平台会在当前目录下找到<code>hello.exe</code>可执行文件。</p><p>可在终端直接执行该<code>hello.exe</code>文件：</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">c:\desktop\hello&gt;hello.exe</span><br><span class="line">Hello World!</span><br></pre></td></tr></table></figure><p>我们还可以使用<code>-o</code>参数来指定编译后得到的可执行文件的名字。</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">go</span> build -o heiheihei.exe</span><br></pre></td></tr></table></figure><blockquote><p><strong>Windows下VSCode切换cmd.exe作为默认终端</strong></p></blockquote><p>如果你打开VS Code的终端界面出现如下图场景（注意观察红框圈中部分），那么你的<code>VS Code</code>此时正使用<code>powershell</code>作为默认终端：</p><p><img src="/images/vscode_shell1.png" alt=""></p><p>十分推荐你按照下面的步骤，选择cmd.exe作为默认的终端工具：</p><p><img src="/images/vscode_shell2.png" alt=""></p><p>此时，VS Code正上方中间位置会弹出如下界面，参照下图挪动鼠标使光标选中后缀为<code>cmd.exe</code>的那一个，然后点击鼠标左键。</p><p>最后<strong>重启VS Code中已经打开的终端</strong>或者<strong>直接重启VS Code</strong>就可以了。</p><p><img src="/images/vscode_shell3.png" alt=""></p><p>如果没有出现下拉三角，也没有关系，按下Ctrl+Shift+P，VS Code正上方会出现一个框，你按照下图输入shell，然后点击指定选项即可出现上面的界面了。</p><p><img src="/images/vscode_shell4.png" alt=""></p><p>补充说明：由于VS Code对go mod模式的支持暂时还不够完善，建议大家使用Goland编辑器。</p><blockquote><p><strong>go install</strong></p></blockquote><p><code>go install</code>表示安装的意思，它先编译源代码得到可执行文件，然后将可执行文件移动到<code>GOPATH</code>的bin目录下。因为我们的环境变量中配置了<code>GOPATH</code>下的bin目录，所以我们就可以在任意地方直接执行可执行文件了。</p><blockquote><p><strong>跨平台编译</strong></p></blockquote><p>默认我们<code>go build</code>的可执行文件都是当前操作系统可执行的文件，如果我想在windows下编译一个linux下可执行文件，那需要怎么做呢？</p><p>只需要指定目标操作系统的平台和处理器架构即可：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">SET CGO_ENABLED=0  // 禁用CGO</span><br><span class="line">SET GOOS=linux  // 目标平台是linux</span><br><span class="line">SET GOARCH=amd64  // 目标处理器架构是amd64</span><br></pre></td></tr></table></figure><p><em>使用了cgo的代码是不支持跨平台编译的</em></p><p>然后再执行<code>go build</code>命令，得到的就是能够在Linux平台运行的可执行文件了。</p><p>Mac 下编译 Linux 和 Windows平台 64位 可执行程序：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">CGO_ENABLED=0 GOOS=linux GOARCH=amd64 go build</span><br><span class="line">CGO_ENABLED=0 GOOS=windows GOARCH=amd64 go build</span><br></pre></td></tr></table></figure><p>Linux 下编译 Mac 和 Windows 平台64位可执行程序：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">CGO_ENABLED=0 GOOS=darwin GOARCH=amd64 go build</span><br><span class="line">CGO_ENABLED=0 GOOS=windows GOARCH=amd64 go build</span><br></pre></td></tr></table></figure><p>Windows下编译Mac平台64位可执行程序：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">SET CGO_ENABLED=0</span><br><span class="line">SET GOOS=darwin</span><br><span class="line">SET GOARCH=amd64</span><br><span class="line">go build</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      安装Go语言及搭建Go语言开发环境,注意：**Go语言1.14版本之后推荐使用go modules管理以来，也不再需要把代码写在GOPATH目录下了,前旧版本的教程...
    
    </summary>
    
    
      <category term="Go语言" scheme="http://yoursite.com/categories/Go%E8%AF%AD%E8%A8%80/"/>
    
    
      <category term="Go基础" scheme="http://yoursite.com/tags/Go%E5%9F%BA%E7%A1%80/"/>
    
  </entry>
  
  <entry>
    <title>[Django Rest Framework]</title>
    <link href="http://yoursite.com/2020/04/22/Django%20Rest%20Framework%E6%A1%86%E6%9E%B6/"/>
    <id>http://yoursite.com/2020/04/22/Django%20Rest%20Framework%E6%A1%86%E6%9E%B6/</id>
    <published>2020-04-22T14:16:13.000Z</published>
    <updated>2020-04-23T13:05:22.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="DRF框架"><a href="#DRF框架" class="headerlink" title="DRF框架"></a>DRF框架</h1><p>Django Rest Framework 是一个强大且灵活的工具包，用以构建Web API</p><p>为什么要使用Rest Framework</p><p>Django REST Framework可以在Django的基础上迅速实现API，并且自身还带有WEB的测试页面，可以方便的测试自己的API</p><p><a href="https://rogerxs80.github.io/2020/04/22/API%E8%A7%84%E8%8C%83%E4%B8%8Edrf%E5%AE%89%E8%A3%85/" target="_blank" rel="noopener">restful API规范与DRF安装</a></p><p><a href="https://rogerxs80.github.io/2020/04/22/%E5%BA%8F%E5%88%97%E5%8C%96%E5%99%A8-Serializer/" target="_blank" rel="noopener">序列化器-Serializer</a></p><p><a href="https://rogerxs80.github.io/2020/04/22/http%E8%AF%B7%E6%B1%82%E5%A4%84%E7%90%86/" target="_blank" rel="noopener">HTTP请求处理</a></p><p><a href="https://rogerxs80.github.io/2020/04/22/%E8%A7%86%E5%9B%BEView%E4%B8%8E%E8%B7%AF%E7%94%B1Router/" target="_blank" rel="noopener">视图View与路由Router</a></p><p><a href="https://rogerxs80.github.io/2020/04/22/DRF%E6%A1%86%E6%9E%B6%E4%B8%AD%E5%B8%B8%E7%94%A8%E7%9A%84%E7%BB%84%E4%BB%B6/" target="_blank" rel="noopener">DRF框架中常用的组件</a></p><p><a href="https://www.notion.so/xadmin-2047b48498d2461e9f91191fe07a8738" target="_blank" rel="noopener">xadmin</a></p>]]></content>
    
    <summary type="html">
    
      Django 是用Python开发的一个免费开源的Web框架，可以用于快速搭建高性能，优雅的网站！采用了MVC的框架模式，即模型M，视图V和控制器C，也可以称为MVT模式，模型M，视图V，模板T...
    
    </summary>
    
    
      <category term="python" scheme="http://yoursite.com/categories/python/"/>
    
    
      <category term="Django Rest_Framework" scheme="http://yoursite.com/tags/Django-Rest-Framework/"/>
    
  </entry>
  
  <entry>
    <title>[DRF框架中常用的组件]</title>
    <link href="http://yoursite.com/2020/04/22/DRF%E6%A1%86%E6%9E%B6%E4%B8%AD%E5%B8%B8%E7%94%A8%E7%9A%84%E7%BB%84%E4%BB%B6/"/>
    <id>http://yoursite.com/2020/04/22/DRF%E6%A1%86%E6%9E%B6%E4%B8%AD%E5%B8%B8%E7%94%A8%E7%9A%84%E7%BB%84%E4%BB%B6/</id>
    <published>2020-04-22T14:16:13.000Z</published>
    <updated>2020-04-23T13:05:22.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="DRF框架中常用的组件"><a href="#DRF框架中常用的组件" class="headerlink" title="DRF框架中常用的组件"></a>DRF框架中常用的组件</h1><p>为了方便接下来的学习，我们创建一个新的子应用 opt</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python manage.py startapp opt</span><br></pre></td></tr></table></figure><p>提前在总路由和配置文件中注册子应用和配置总路由。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># settings.py中注册子应用：</span></span><br><span class="line">INSTALLED_APPS = [</span><br><span class="line"><span class="comment"># ....</span></span><br><span class="line"><span class="string">'opt'</span>,        <span class="comment"># drf的常用组件</span></span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 总路由中加上：</span></span><br><span class="line">path(<span class="string">"opt/"</span>,include(<span class="string">"opt.urls"</span>)),</span><br></pre></td></tr></table></figure><p>因为接下来的功能中需要使用到登陆功能，所以我们使用django内置admin站点并创建一个管理员.</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python manage.py createsuperuser</span><br></pre></td></tr></table></figure><p><img src="/images/1557276390641.png" alt=""></p><p>创建管理员以后，访问admin站点，先修改站点的语言配置</p><p>settings.py</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">LANGUAGE_CODE = <span class="string">'zh-hans'</span></span><br><span class="line"></span><br><span class="line">TIME_ZONE = <span class="string">'Asia/Shanghai'</span></span><br></pre></td></tr></table></figure><p><img src="/images/1553043081445.png" alt=""></p><p>访问admin 站点效果：</p><p><img src="/images/1553043054133.png" alt=""></p><h1 id="1-认证Authentication"><a href="#1-认证Authentication" class="headerlink" title="1. 认证Authentication"></a>1. 认证Authentication</h1><p>可以在配置文件中配置全局默认的认证方案</p><p>/home/moluo/.virtualenvs/drfdemo/lib/python3.6/site-packages/rest_framework/settings.py</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 可以在项目的主应用的settings.py配置文件中加入以下配置覆盖全局默认的配置方案。</span></span><br><span class="line">REST_FRAMEWORK = &#123;</span><br><span class="line">    <span class="string">'DEFAULT_AUTHENTICATION_CLASSES'</span>: (</span><br><span class="line">        <span class="string">'rest_framework.authentication.SessionAuthentication'</span>,  <span class="comment"># session认证</span></span><br><span class="line">        <span class="string">'rest_framework.authentication.BasicAuthentication'</span>,    <span class="comment"># 基本认证</span></span><br><span class="line">    )</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>也可以在每个视图中通过设置authentication_classess类属性来设置</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> rest_framework.authentication <span class="keyword">import</span> SessionAuthentication, BasicAuthentication</span><br><span class="line"><span class="keyword">from</span> rest_framework.views <span class="keyword">import</span> APIView</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ExampleView</span><span class="params">(APIView)</span>:</span></span><br><span class="line">    <span class="comment"># 类属性</span></span><br><span class="line">    authentication_classes = [SessionAuthentication, BasicAuthentication]</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get</span><span class="params">(self,request)</span>:</span></span><br><span class="line">        <span class="keyword">pass</span></span><br></pre></td></tr></table></figure><p>认证失败会有两种可能的返回值，这个需要我们配合权限组件来使用：</p><ul><li>401 Unauthorized 未认证</li><li>403 Permission Denied 权限被禁止</li></ul><h1 id="2-权限Permissions"><a href="#2-权限Permissions" class="headerlink" title="2. 权限Permissions"></a>2. 权限Permissions</h1><p>权限控制可以限制用户对于视图的访问和对于具体数据对象的访问。</p><ul><li>在执行视图的as_view()方法的dispatch()方法前，会先进行视图访问权限的判断</li><li>在通过get_object()获取具体模型对象时，会进行模型对象访问权限的判断</li></ul><h3 id="提供的权限"><a href="#提供的权限" class="headerlink" title="提供的权限"></a>提供的权限</h3><ul><li>AllowAny 允许所有用户</li><li>IsAuthenticated 仅通过登录认证的用户</li><li>IsAdminUser 仅管理员用户</li><li>IsAuthenticatedOrReadOnly 已经登陆认证的用户可以对数据进行增删改操作，没有登陆认证的只能查看数据。</li></ul><h3 id="配置使用"><a href="#配置使用" class="headerlink" title="配置使用"></a>配置使用</h3><p>chorme浏览器进入无痕模式的快捷键，Ctrl+Shift+N</p><p>可以在配置文件settings.py中全局设置默认的权限管理类，如</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># drf的配置信息，需要卸载django的配置文件，而且必须写在REST_FRAMEWORK的字典中，才能被drf识别</span></span><br><span class="line">REST_FRAMEWORK = &#123;</span><br><span class="line">    ....</span><br><span class="line">    <span class="comment">#  权限[全局配置，所有的视图都会被影响到]</span></span><br><span class="line">    <span class="string">'DEFAULT_PERMISSION_CLASSES'</span>: (</span><br><span class="line">        <span class="string">'rest_framework.permissions.IsAuthenticated'</span>, <span class="comment"># 已经登录认证的用户才能访问</span></span><br><span class="line">    )</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>如果未指明，则采用如下默认配置</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">'DEFAULT_PERMISSION_CLASSES'</span>: (</span><br><span class="line">   <span class="string">'rest_framework.permissions.AllowAny'</span>,</span><br><span class="line">)</span><br></pre></td></tr></table></figure><p>也可以在具体的视图中通过permission_classes属性来设置，如</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> rest_framework.permissions <span class="keyword">import</span> IsAuthenticated</span><br><span class="line"><span class="keyword">from</span> rest_framework.views <span class="keyword">import</span> APIView</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ExampleView</span><span class="params">(APIView)</span>:</span></span><br><span class="line">    permission_classes = (IsAuthenticated,)</span><br><span class="line">    ...</span><br></pre></td></tr></table></figure><h3 id="举例"><a href="#举例" class="headerlink" title="举例"></a>举例</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> rest_framework.authentication <span class="keyword">import</span> SessionAuthentication</span><br><span class="line"><span class="keyword">from</span> rest_framework.permissions <span class="keyword">import</span> IsAuthenticated</span><br><span class="line"><span class="keyword">from</span> rest_framework.generics <span class="keyword">import</span> RetrieveAPIView</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">StudentAPIView</span><span class="params">(RetrieveAPIView)</span>:</span></span><br><span class="line">    queryset = Student.objects.all()</span><br><span class="line">    serializer_class = StudentSerializer</span><br><span class="line">    authentication_classes = [SessionAuthentication]</span><br><span class="line">    permission_classes = [IsAuthenticated]</span><br></pre></td></tr></table></figure><h3 id="自定义权限"><a href="#自定义权限" class="headerlink" title="自定义权限"></a>自定义权限</h3><p>如需自定义权限，需继承rest_framework.permissions.BasePermission父类，并实现以下两个任何一个方法或全部</p><ul><li><p><code>.has_permission(self, request, view)</code></p><p>是否可以访问视图， view表示当前视图对象</p></li><li><p><code>.has_object_permission(self, request, view, obj)</code></p><p>是否可以访问数据对象， view表示当前视图， obj为模型数据对象</p></li></ul><p>例如：</p><p>在当前子应用下，创建一个权限文件permissions.py中声明自定义权限类:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> rest_framework.permissions <span class="keyword">import</span> BasePermission</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">IsXiaoMingPermission</span><span class="params">(BasePermission)</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">has_permission</span><span class="params">(self, request, view)</span>:</span></span><br><span class="line">        <span class="keyword">if</span> request.user <span class="keyword">and</span> request.user.username == <span class="string">"xiaoming"</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">True</span></span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> .permissions <span class="keyword">import</span> IsXiaoMingPermission</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">StudentViewSet</span><span class="params">(ModelViewSet)</span>:</span></span><br><span class="line">    queryset = Student.objects.all()</span><br><span class="line">    serializer_class = StudentSerializer</span><br><span class="line">    permission_classes = [IsXiaoMingPermission]</span><br></pre></td></tr></table></figure><h1 id="3-限流Throttling"><a href="#3-限流Throttling" class="headerlink" title="3. 限流Throttling"></a>3. 限流Throttling</h1><p>可以对接口访问的频次进行限制，以减轻服务器压力，或者实现特定的业务。</p><p>一般用于付费购买次数,投票等场景使用.</p><h2 id="可选限流类"><a href="#可选限流类" class="headerlink" title="可选限流类"></a>可选限流类</h2><p>1） AnonRateThrottle</p><p>限制所有匿名未认证用户，使用IP区分用户。</p><p>使用<code>DEFAULT_THROTTLE_RATES[&#39;anon&#39;]</code> 来设置频次</p><p>2）UserRateThrottle</p><p>限制认证用户，使用User id 来区分。</p><p>使用<code>DEFAULT_THROTTLE_RATES[&#39;user&#39;]</code> 来设置频次</p><p>3）ScopedRateThrottle</p><p>限制用户对于每个视图的访问频次，使用ip或user id。</p><p>例如：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ContactListView</span><span class="params">(APIView)</span>:</span></span><br><span class="line">    throttle_scope = <span class="string">'contacts'</span></span><br><span class="line">    ...</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ContactDetailView</span><span class="params">(APIView)</span>:</span></span><br><span class="line">    throttle_scope = <span class="string">'contacts'</span></span><br><span class="line">    ...</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">UploadView</span><span class="params">(APIView)</span>:</span></span><br><span class="line">    throttle_scope = <span class="string">'uploads'</span></span><br><span class="line">    ...</span><br><span class="line">REST_FRAMEWORK = &#123;</span><br><span class="line">    <span class="string">'DEFAULT_THROTTLE_CLASSES'</span>: (</span><br><span class="line">        <span class="string">'rest_framework.throttling.ScopedRateThrottle'</span>,</span><br><span class="line">    ),</span><br><span class="line">    <span class="string">'DEFAULT_THROTTLE_RATES'</span>: &#123;</span><br><span class="line">        <span class="string">'contacts'</span>: <span class="string">'1000/day'</span>,</span><br><span class="line">        <span class="string">'uploads'</span>: <span class="string">'20/day'</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="使用"><a href="#使用" class="headerlink" title="使用"></a>使用</h2><p>可以在配置文件中，使用<code>DEFAULT_THROTTLE_CLASSES</code> 和 <code>DEFAULT_THROTTLE_RATES</code>进行全局配置，</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">REST_FRAMEWORK = &#123;</span><br><span class="line">    <span class="string">'DEFAULT_THROTTLE_CLASSES'</span>: ( <span class="comment"># 启用的限制类</span></span><br><span class="line">        <span class="string">'rest_framework.throttling.AnonRateThrottle'</span>,</span><br><span class="line">        <span class="string">'rest_framework.throttling.UserRateThrottle'</span></span><br><span class="line">    ),</span><br><span class="line">    <span class="string">'DEFAULT_THROTTLE_RATES'</span>: &#123;   <span class="comment"># 限制频率</span></span><br><span class="line">        <span class="string">'anon'</span>: <span class="string">'100/day'</span>,</span><br><span class="line">        <span class="string">'user'</span>: <span class="string">'1000/day'</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>DEFAULT_THROTTLE_RATES</code> 可以使用 <code>second</code>, <code>minute</code>, <code>hour</code> 或<code>day</code>来指明周期。</p><p>也可以在具体视图中通过throttle_classess属性来配置，如</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> rest_framework.throttling <span class="keyword">import</span> UserRateThrottle</span><br><span class="line"><span class="keyword">from</span> rest_framework.views <span class="keyword">import</span> APIView</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ExampleView</span><span class="params">(APIView)</span>:</span></span><br><span class="line">    throttle_classes = (UserRateThrottle,)</span><br><span class="line">    ...</span><br></pre></td></tr></table></figure><h2 id="实例"><a href="#实例" class="headerlink" title="实例"></a>实例</h2><p>全局配置中设置访问频率，settings.py代码：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">REST_FRAMEWORK = &#123;</span><br><span class="line">    <span class="comment"># 权限[全局配置，会被局部配置覆盖]</span></span><br><span class="line">    <span class="comment"># 'DEFAULT_PERMISSION_CLASSES': (</span></span><br><span class="line">    <span class="comment">#     'rest_framework.permissions.IsAuthenticated',</span></span><br><span class="line">    <span class="comment"># ),</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 限流</span></span><br><span class="line">    <span class="comment"># 'DEFAULT_THROTTLE_CLASSES': (  # 全局启用的限制类</span></span><br><span class="line">    <span class="comment">#     'rest_framework.throttling.AnonRateThrottle', # 匿名用户,游客</span></span><br><span class="line">    <span class="comment">#     'rest_framework.throttling.UserRateThrottle'  # 登录用户</span></span><br><span class="line">    <span class="comment"># ),</span></span><br><span class="line">    <span class="string">'DEFAULT_THROTTLE_RATES'</span>: &#123;  <span class="comment"># 限制频率</span></span><br><span class="line">        <span class="string">'anon'</span>: <span class="string">'3/minute'</span>,</span><br><span class="line">        <span class="string">'user'</span>: <span class="string">'10/minute'</span>,</span><br><span class="line">        <span class="string">'access'</span>: <span class="string">'5/minute'</span>, <span class="comment"># 这个是自定义限流的频率配置</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>视图代码：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> students.models <span class="keyword">import</span> Student</span><br><span class="line"><span class="keyword">from</span> students.serializers <span class="keyword">import</span> StudentModelSerializer</span><br><span class="line"><span class="keyword">from</span> rest_framework.viewsets <span class="keyword">import</span> ModelViewSet</span><br><span class="line"><span class="keyword">from</span> rest_framework.permissions <span class="keyword">import</span> AllowAny,IsAuthenticated,IsAuthenticatedOrReadOnly,IsAdminUser</span><br><span class="line"><span class="keyword">from</span> .permission <span class="keyword">import</span> ISMingGe</span><br><span class="line"><span class="keyword">from</span> rest_framework.throttling <span class="keyword">import</span> UserRateThrottle,AnonRateThrottle,ScopedRateThrottle</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Students8APIView</span><span class="params">(ModelViewSet)</span>:</span></span><br><span class="line">    serializer_class = StudentModelSerializer</span><br><span class="line">    queryset = Student.objects.all()</span><br><span class="line">    <span class="comment"># 权限配置</span></span><br><span class="line">    permission_classes = [AllowAny]</span><br><span class="line">    <span class="comment"># 限流配置</span></span><br><span class="line">    <span class="comment"># throttle_classes = [AnonRateThrottle,UserRateThrottle]</span></span><br><span class="line">    <span class="comment"># 自定义限流配置</span></span><br><span class="line">    throttle_classes = [ScopedRateThrottle]</span><br><span class="line">    throttle_scope = <span class="string">'access'</span></span><br></pre></td></tr></table></figure><h1 id="4-过滤Filtering"><a href="#4-过滤Filtering" class="headerlink" title="4. 过滤Filtering"></a>4. 过滤Filtering</h1><p>对于列表数据可能需要根据字段进行过滤，我们可以通过添加django-fitlter扩展来增强支持。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install django-filter</span><br></pre></td></tr></table></figure><p>在配置文件settings.py中增加过滤组件的设置：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">INSTALLED_APPS = [</span><br><span class="line">    ...</span><br><span class="line">    <span class="string">'django_filters'</span>,  <span class="comment"># 需要注册应用，</span></span><br><span class="line">]</span><br><span class="line"></span><br><span class="line">REST_FRAMEWORK = &#123;</span><br><span class="line">    ...</span><br><span class="line">    <span class="comment"># 全局配置，也可以使用局部配置</span></span><br><span class="line">    <span class="string">'DEFAULT_FILTER_BACKENDS'</span>: (<span class="string">'django_filters.rest_framework.DjangoFilterBackend'</span>,)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>在视图类中添加类属性filter_fields，指定可以过滤的字段</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">StudentListView</span><span class="params">(ListAPIView)</span>:</span></span><br><span class="line">    queryset = Student.objects.all()</span><br><span class="line">    serializer_class = StudentSerializer</span><br><span class="line">    filter_fields = (<span class="string">'age'</span>, <span class="string">'sex'</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 127.0.0.1:8000/opt/students/?sex=true  #单个过滤条件</span></span><br><span class="line"><span class="comment"># http://127.0.0.1:8000/opt/students/?sex=false&amp;age=27 # 多个并列的过滤条件</span></span><br></pre></td></tr></table></figure><h1 id="5-排序"><a href="#5-排序" class="headerlink" title="5. 排序"></a>5. 排序</h1><p>对于列表数据，REST framework提供了<strong>OrderingFilter</strong>过滤器来帮助我们快速指明数据按照指定字段进行排序。</p><p>使用方法：</p><p>在类视图中设置filter_backends，使用<code>rest_framework.filters.OrderingFilter</code>过滤器，REST framework会在请求的查询字符串参数中检查是否包含了ordering参数，如果包含了ordering参数，则按照ordering参数指明的排序字段对数据集进行排序。</p><p>前端可以传递的ordering参数的可选字段值需要在ordering_fields中指明。</p><p>示例：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">StudentListView</span><span class="params">(ListAPIView)</span>:</span></span><br><span class="line">    queryset = Student.objects.all()</span><br><span class="line">    serializer_class = StudentModelSerializer</span><br><span class="line">    filter_backends = [OrderingFilter]</span><br><span class="line">    ordering_fields = (<span class="string">'id'</span>, <span class="string">'age'</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 127.0.0.1:8000/books/?ordering=-age</span></span><br><span class="line"><span class="comment"># -id 表示针对id字段进行倒序排序</span></span><br><span class="line"><span class="comment"># id  表示针对id字段进行升序排序</span></span><br></pre></td></tr></table></figure><p>如果需要在过滤以后再次进行排序，则需要两者同步。要么一起写在全局配置中，要么一起写在视图类中。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> rest_framework.generics <span class="keyword">import</span> ListAPIView</span><br><span class="line"><span class="keyword">from</span> students.models <span class="keyword">import</span> Student</span><br><span class="line"><span class="keyword">from</span> .serializers <span class="keyword">import</span> StudentModelSerializer</span><br><span class="line"><span class="keyword">from</span> django_filters.rest_framework <span class="keyword">import</span> DjangoFilterBackend</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Student3ListView</span><span class="params">(ListAPIView)</span>:</span></span><br><span class="line">    queryset = Student.objects.all()</span><br><span class="line">    serializer_class = StudentModelSerializer</span><br><span class="line">    filter_fields = (<span class="string">'age'</span>, <span class="string">'sex'</span>)</span><br><span class="line">    <span class="comment"># 因为排序配置和过滤配置使用同一个类属性，所以当视图中需要使用排序和过滤时，</span></span><br><span class="line">    <span class="comment"># 要么大家一起在视图类中局部配置，要么大家一起在全局中配置，否则会出现过滤组件使用无效的情况</span></span><br><span class="line">    <span class="comment"># filter_backends = [DjangoFilterBackend,OrderingFilter]</span></span><br><span class="line">    ordering_fields = (<span class="string">'id'</span>, <span class="string">'age'</span>)</span><br></pre></td></tr></table></figure><p>配置文件：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 过滤组件[全局引入]</span></span><br><span class="line">    <span class="comment"># 'DEFAULT_FILTER_BACKENDS': ('django_filters.rest_framework.DjangoFilterBackend','rest_framework.filters.OrderingFilter')</span></span><br></pre></td></tr></table></figure><h1 id="6-分页Pagination"><a href="#6-分页Pagination" class="headerlink" title="6. 分页Pagination"></a>6. 分页Pagination</h1><p>REST framework提供了分页的支持。</p><p>我们可以在配置文件中设置全局的分页方式，如：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">REST_FRAMEWORK = &#123;</span><br><span class="line">    <span class="string">'DEFAULT_PAGINATION_CLASS'</span>:  <span class="string">'rest_framework.pagination.PageNumberPagination'</span>,</span><br><span class="line">    <span class="string">'PAGE_SIZE'</span>: <span class="number">100</span>  <span class="comment"># 每页数目</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">如果在配置settings.py文件中， 设置了全局分页，那么在drf中凡是调用了ListModelMixin的list()，</span><br><span class="line">都会自动分页。如果项目中出现大量需要分页的数据，只有少数部分的分页，则可以在少部分的视图类中关闭分页功能。</span><br><span class="line"><span class="class"><span class="keyword">class</span> 视图类<span class="params">(ListAPIView)</span>:</span></span><br><span class="line">pagination_class = <span class="literal">None</span></span><br></pre></td></tr></table></figure><p>也可通过自定义Pagination类，来为视图添加不同分页行为。在视图中通过<code>pagination_clas</code>属性来指明。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">LargeResultsSetPagination</span><span class="params">(PageNumberPagination)</span>:</span></span><br><span class="line">    page_size = <span class="number">1000</span></span><br><span class="line">    page_size_query_param = <span class="string">'page_size'</span></span><br><span class="line">    max_page_size = <span class="number">10000</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">BookDetailView</span><span class="params">(RetrieveAPIView)</span>:</span></span><br><span class="line">    queryset = BookInfo.objects.all()</span><br><span class="line">    serializer_class = BookInfoSerializer</span><br><span class="line">    pagination_class = LargeResultsSetPagination</span><br></pre></td></tr></table></figure><h2 id="可选分页器"><a href="#可选分页器" class="headerlink" title="可选分页器"></a>可选分页器</h2><p>1） <strong>PageNumberPagination</strong></p><p>前端访问网址形式：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">GET  http:&#x2F;&#x2F;127.0.0.1:8000&#x2F;students&#x2F;?page&#x3D;4</span><br></pre></td></tr></table></figure><p>可以在子类中定义的属性：</p><ul><li>page_size 每页数目</li><li>page_query_param 前端发送的页数关键字名，默认为“page”</li><li>page_size_query_param 前端发送的每页数目关键字名，默认为None</li><li>max_page_size 前端最多能设置的每页数量</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 声明分页的配置类</span></span><br><span class="line"><span class="keyword">from</span> rest_framework.pagination <span class="keyword">import</span> PageNumberPagination</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">StandardPageNumberPagination</span><span class="params">(PageNumberPagination)</span>:</span></span><br><span class="line">    <span class="comment"># 默认每一页显示的数据量</span></span><br><span class="line">    page_size = <span class="number">2</span></span><br><span class="line">    <span class="comment"># 允许客户端通过get参数来控制每一页的数据量</span></span><br><span class="line">    page_size_query_param = <span class="string">"size"</span></span><br><span class="line">    max_page_size = <span class="number">10</span></span><br><span class="line">    <span class="comment"># 自定义页码的参数名</span></span><br><span class="line">    page_query_param = <span class="string">"p"</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">StudentAPIView</span><span class="params">(ListAPIView)</span>:</span></span><br><span class="line">    queryset = Student.objects.all()</span><br><span class="line">    serializer_class = StudentModelSerializer</span><br><span class="line">    pagination_class = StandardPageNumberPagination</span><br><span class="line"></span><br><span class="line"><span class="comment"># 127.0.0.1/four/students/?p=1&amp;size=5</span></span><br></pre></td></tr></table></figure><p>2）<strong>LimitOffsetPagination</strong></p><p>前端访问网址形式：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">GET http:&#x2F;&#x2F;127.0.0.1&#x2F;four&#x2F;students&#x2F;?limit&#x3D;100&amp;offset&#x3D;100</span><br></pre></td></tr></table></figure><p>可以在子类中定义的属性：</p><ul><li>default_limit 默认限制，默认值与<code>PAGE_SIZE</code>设置一直</li><li>limit_query_param limit参数名，默认’limit’</li><li>offset_query_param offset参数名，默认’offset’</li><li>max_limit 最大limit限制，默认None</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> rest_framework.pagination <span class="keyword">import</span> LimitOffsetPagination</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">StandardLimitOffsetPagination</span><span class="params">(LimitOffsetPagination)</span>:</span></span><br><span class="line">    <span class="comment"># 默认每一页查询的数据量,类似上面的page_size</span></span><br><span class="line">    default_limit = <span class="number">2</span></span><br><span class="line">    limit_query_param = <span class="string">"size"</span></span><br><span class="line">    offset_query_param = <span class="string">"start"</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">StudentAPIView</span><span class="params">(ListAPIView)</span>:</span></span><br><span class="line">    queryset = Student.objects.all()</span><br><span class="line">    serializer_class = StudentModelSerializer</span><br><span class="line">    <span class="comment"># 调用页码分页类</span></span><br><span class="line">    <span class="comment"># pagination_class = StandardPageNumberPagination</span></span><br><span class="line">    <span class="comment"># 调用查询偏移分页类</span></span><br><span class="line">    pagination_class = StandardLimitOffsetPagination</span><br></pre></td></tr></table></figure><h1 id="7-异常处理-Exceptions"><a href="#7-异常处理-Exceptions" class="headerlink" title="7. 异常处理 Exceptions"></a>7. 异常处理 Exceptions</h1><p>REST framework提供了自定义异常处理，我们可以自定义的方式来编写异常处理函数。例如我们想在要创建一个自定义异常函数，</p><p>这个函数，我们保存到当前主应用中[注意在实际工作中，我们可以设置一个单独的独立的公共目录来保存这种公共的函数/工具/类库]。</p><p>drfdemo/exceptions.py，代码；</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> rest_framework.views <span class="keyword">import</span> exception_handler <span class="keyword">as</span> drf_exception_handler</span><br><span class="line"><span class="keyword">from</span> django.db <span class="keyword">import</span> DatabaseError</span><br><span class="line"><span class="keyword">from</span> rest_framework.response <span class="keyword">import</span> Response</span><br><span class="line"><span class="keyword">from</span> rest_framework <span class="keyword">import</span> status</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">custom_exception_handler</span><span class="params">(exc, context)</span>:</span></span><br><span class="line">    <span class="string">"""</span></span><br><span class="line"><span class="string">    自定义异常处理函数</span></span><br><span class="line"><span class="string">    :param exc: 异常对象，本次发生的异常对象</span></span><br><span class="line"><span class="string">    :param context: 字典，异常出现时的执行上下文环境</span></span><br><span class="line"><span class="string">    :return:</span></span><br><span class="line"><span class="string">    """</span></span><br><span class="line">    <span class="comment"># 先让drf进行异常判断</span></span><br><span class="line">    response = drf_exception_handler(exc, context)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 判断response对象是否为None</span></span><br><span class="line">    <span class="keyword">if</span> response <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">        <span class="string">"""出现drf不能处理的异常"""</span></span><br><span class="line">        <span class="keyword">if</span> isinstance(exc, DatabaseError):</span><br><span class="line">            view = context.get(<span class="string">"view"</span>)</span><br><span class="line">            print(<span class="string">'数据库报错，[%s]: %s'</span> % (view, exc))</span><br><span class="line">            <span class="keyword">return</span> Response(&#123;<span class="string">"detail"</span>:<span class="string">"服务器内部错误!"</span>&#125;, status=status.HTTP_507_INSUFFICIENT_STORAGE)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> isinstance(exc, ZeroDivisionError):</span><br><span class="line">            view = context.get(<span class="string">"view"</span>)</span><br><span class="line">            print(<span class="string">"0不能作为除数! [%s]: %s"</span> % (view, exc) )</span><br><span class="line">            <span class="keyword">return</span> Response(&#123;<span class="string">"detail"</span>:<span class="string">"服务器内部错误!"</span>&#125;, status=status.HTTP_500_INTERNAL_SERVER_ERROR)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> response</span><br></pre></td></tr></table></figure><p>在主应用的配置文件settings.py中声明自定义的异常处理</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">REST_FRAMEWORK = &#123;</span><br><span class="line">    <span class="comment"># 异常处理</span></span><br><span class="line">    <span class="string">'EXCEPTION_HANDLER'</span>: <span class="string">'drfdemo.exceptions.custom_exception_handler'</span>,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>如果未声明，会采用默认的方式，如下</p><p>rest_frame/settings.py</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">REST_FRAMEWORK = &#123;</span><br><span class="line">    <span class="string">'EXCEPTION_HANDLER'</span>: <span class="string">'rest_framework.views.exception_handler'</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="REST-framework定义的异常"><a href="#REST-framework定义的异常" class="headerlink" title="REST framework定义的异常"></a>REST framework定义的异常</h3><ul><li>APIException drf中所有异常的父类</li><li>ParseError 解析错误</li><li>AuthenticationFailed 认证失败</li><li>NotAuthenticated 尚未认证</li><li>PermissionDenied 权限受限</li><li>NotFound 未找到</li><li>MethodNotAllowed 请求方式不支持</li><li>NotAcceptable 要获取的数据格式不支持</li><li>Throttled 超过限流次数</li><li>ValidationError 校验失败</li></ul><p>也就是说，很多的没有在上面列出来的异常，就需要我们在自定义异常中自己处理了。</p><h1 id="8-自动生成接口文档"><a href="#8-自动生成接口文档" class="headerlink" title="8. 自动生成接口文档"></a>8. 自动生成接口文档</h1><p>官方文档：<a href="http://core-api.github.io/python-client/" target="_blank" rel="noopener">http://core-api.github.io/python-client/</a></p><p>REST framework可以自动帮助我们生成接口文档。</p><p>接口文档以网页的方式呈现。</p><p>自动接口文档能生成的是继承自<code>APIView</code>及其子类的视图。</p><h2 id="8-1-安装依赖"><a href="#8-1-安装依赖" class="headerlink" title="8.1. 安装依赖"></a>8.1. 安装依赖</h2><p>REST framewrok生成接口文档需要<code>coreapi</code>库的支持。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install coreapi</span><br></pre></td></tr></table></figure><h2 id="8-2-设置接口文档访问路径"><a href="#8-2-设置接口文档访问路径" class="headerlink" title="8.2. 设置接口文档访问路径"></a>8.2. 设置接口文档访问路径</h2><p>在settings.py中配置接口文档。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">REST_FRAMEWORK = &#123;</span><br><span class="line">    <span class="comment"># 。。。 其他选项</span></span><br><span class="line">    <span class="comment"># 接口文档</span></span><br><span class="line">    <span class="string">'DEFAULT_SCHEMA_CLASS'</span>: <span class="string">'rest_framework.schemas.AutoSchema'</span>,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>在总路由中添加接口文档路径。</p><p>文档路由对应的视图配置为<code>rest_framework.documentation.include_docs_urls</code>，</p><p>参数<code>title</code>为接口文档网站的标题。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> rest_framework.documentation <span class="keyword">import</span> include_docs_urls</span><br><span class="line"></span><br><span class="line">urlpatterns = [</span><br><span class="line">    ...</span><br><span class="line">    path(<span class="string">'docs/'</span>, include_docs_urls(title=<span class="string">'站点页面标题'</span>))</span><br><span class="line">]</span><br></pre></td></tr></table></figure><h2 id="8-3-文档描述说明的定义位置"><a href="#8-3-文档描述说明的定义位置" class="headerlink" title="8.3. 文档描述说明的定义位置"></a>8.3. 文档描述说明的定义位置</h2><p>1） 单一方法的视图，可直接使用类视图的文档字符串，如</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">BookListView</span><span class="params">(generics.ListAPIView)</span>:</span></span><br><span class="line">    <span class="string">"""</span></span><br><span class="line"><span class="string">    返回所有图书信息.</span></span><br><span class="line"><span class="string">    """</span></span><br></pre></td></tr></table></figure><p>2）包含多个方法的视图，在类视图的文档字符串中，分开方法定义，如</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">BookListCreateView</span><span class="params">(generics.ListCreateAPIView)</span>:</span></span><br><span class="line">    <span class="string">"""</span></span><br><span class="line"><span class="string">    get:</span></span><br><span class="line"><span class="string">    返回所有图书信息.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    post:</span></span><br><span class="line"><span class="string">    新建图书.</span></span><br><span class="line"><span class="string">    """</span></span><br></pre></td></tr></table></figure><p>3）对于视图集ViewSet，仍在类视图的文档字符串中封开定义，但是应使用action名称区分，如</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">BookInfoViewSet</span><span class="params">(mixins.ListModelMixin, mixins.RetrieveModelMixin, GenericViewSet)</span>:</span></span><br><span class="line">    <span class="string">"""</span></span><br><span class="line"><span class="string">    list:</span></span><br><span class="line"><span class="string">    返回图书列表数据</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    retrieve:</span></span><br><span class="line"><span class="string">    返回图书详情数据</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    latest:</span></span><br><span class="line"><span class="string">    返回最新的图书数据</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    read:</span></span><br><span class="line"><span class="string">    修改图书的阅读量</span></span><br><span class="line"><span class="string">    """</span></span><br></pre></td></tr></table></figure><h2 id="8-4-访问接口文档网页"><a href="#8-4-访问接口文档网页" class="headerlink" title="8.4. 访问接口文档网页"></a>8.4. 访问接口文档网页</h2><p>浏览器访问 127.0.0.1:8000/docs/，即可看到自动生成的接口文档。</p><p><img src="/images/drf%205%2089be22d379b34dacb463a31e54a46e7f.png" alt=""></p><h3 id="两点说明："><a href="#两点说明：" class="headerlink" title="两点说明："></a>两点说明：</h3><p>1） 视图集ViewSet中的retrieve名称，在接口文档网站中叫做read</p><p>2）参数的Description需要在模型类或序列化器类的字段中以help_text选项定义，如：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Student</span><span class="params">(models.Model)</span>:</span></span><br><span class="line">    ...</span><br><span class="line">    age = models.IntegerField(default=<span class="number">0</span>, verbose_name=<span class="string">'年龄'</span>, help_text=<span class="string">'年龄'</span>)</span><br><span class="line">    ...</span><br></pre></td></tr></table></figure><p>或</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">StudentSerializer</span><span class="params">(serializers.ModelSerializer)</span>:</span></span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">Meta</span>:</span></span><br><span class="line">        model = Student</span><br><span class="line">        fields = <span class="string">"__all__"</span></span><br><span class="line">        extra_kwargs = &#123;</span><br><span class="line">            <span class="string">'age'</span>: &#123;</span><br><span class="line">                <span class="string">'required'</span>: <span class="literal">True</span>,</span><br><span class="line">                <span class="string">'help_text'</span>: <span class="string">'年龄'</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      DRF框架中常用的组件，为了方便接下来的学习，我们创建一个新的子应用，提前在总路由和配置文件中注册子应用和配置总路由...
    
    </summary>
    
    
      <category term="python" scheme="http://yoursite.com/categories/python/"/>
    
    
      <category term="Django Rest_Framework" scheme="http://yoursite.com/tags/Django-Rest-Framework/"/>
    
  </entry>
  
  <entry>
    <title>[视图View与路由Router]</title>
    <link href="http://yoursite.com/2020/04/22/%E8%A7%86%E5%9B%BEView%E4%B8%8E%E8%B7%AF%E7%94%B1Router/"/>
    <id>http://yoursite.com/2020/04/22/%E8%A7%86%E5%9B%BEView%E4%B8%8E%E8%B7%AF%E7%94%B1Router/</id>
    <published>2020-04-22T13:16:11.000Z</published>
    <updated>2020-04-23T11:58:51.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="1-视图"><a href="#1-视图" class="headerlink" title="1. 视图"></a>1. 视图</h1><p>Django REST framwork 提供的视图的主要作用：</p><ul><li>控制序列化器的执行（检验、保存、转换数据）</li><li>控制数据库查询的执行[数据库的删除/查询代码写在视图中，更新和添加写在序列化器]</li></ul><h2 id="1-2-视图"><a href="#1-2-视图" class="headerlink" title="1.2 视图"></a>1.2 视图</h2><p>REST framework 提供了众多的通用视图基类与扩展类，以简化视图的编写。</p><h3 id="1-2-1-2个视图基类"><a href="#1-2-1-2个视图基类" class="headerlink" title="1.2.1 2个视图基类"></a>1.2.1 2个视图基类</h3><h3 id="1-2-1-1-APIView"><a href="#1-2-1-1-APIView" class="headerlink" title="1.2.1.1 APIView"></a>1.2.1.1 APIView</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rest_framework.views.APIView</span><br></pre></td></tr></table></figure><p><code>APIView</code>是REST framework提供的所有视图的基类，继承自Django的<code>View</code>父类。</p><p>drf的<code>APIView</code>与django<code>View</code>的不同之处在于：</p><ul><li>传入到视图方法中的是REST framework的<code>Request</code>对象，而不是Django的<code>HttpRequeset</code>对象；</li><li>视图方法可以返回REST framework的<code>Response</code>对象，视图会为响应数据设置（render）符合前端要求的格式；</li><li>任何<code>APIException</code>异常都会被捕获到，并且处理成合适的响应信息；</li><li>重写了as_view()，在进行dispatch()路由分发前，会对http请求进行身份认证、权限检查、访问流量控制。</li></ul><p>支持定义的类属性</p><ul><li><strong>authentication_classes</strong> 列表或元组，身份认证类</li><li><strong>permissoin_classes</strong> 列表或元组，权限检查类</li><li><strong>throttle_classes</strong> 列表或元祖，流量控制类</li></ul><p>在<code>APIView</code>中仍以常规的类视图定义方法来实现get() 、post() 或者其他请求方式的方法。</p><p>举例：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Create your views here.</span></span><br><span class="line"><span class="string">"""APIView是drf里面提供的所有视图类的父类</span></span><br><span class="line"><span class="string">   APIView提供的功能/属性/方法是最少的,所以使用APIView基本类似我们使用django的View</span></span><br><span class="line"><span class="string">"""</span></span><br><span class="line"><span class="string">"""</span></span><br><span class="line"><span class="string">GET   /students/ 获取多个学生信息 </span></span><br><span class="line"><span class="string">POST  /students/ 添加一个学生信息</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">GET    /students/&lt;pk&gt;/  获取一个学生信息 </span></span><br><span class="line"><span class="string">PUT    /students/&lt;pk&gt;/  修改一个学生信息</span></span><br><span class="line"><span class="string">DELETE /students/&lt;pk&gt;/  删除一个学生信息</span></span><br><span class="line"><span class="string">"""</span></span><br><span class="line"><span class="keyword">from</span> rest_framework.views <span class="keyword">import</span> APIView</span><br><span class="line"><span class="keyword">from</span> students.models <span class="keyword">import</span> Student</span><br><span class="line"><span class="keyword">from</span> .serializers <span class="keyword">import</span> StudentModelSerializer</span><br><span class="line"><span class="keyword">from</span> rest_framework.response <span class="keyword">import</span> Response</span><br><span class="line"><span class="keyword">from</span> rest_framework <span class="keyword">import</span> status</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">StudentAPIView</span><span class="params">(APIView)</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get</span><span class="params">(self,request)</span>:</span></span><br><span class="line">        <span class="comment"># 1. 获取学生信息的数据模型</span></span><br><span class="line">        student_list = Student.objects.all()</span><br><span class="line">        <span class="comment"># 2. 调用序列化器</span></span><br><span class="line">        serializer = StudentModelSerializer(instance=student_list, many=<span class="literal">True</span>)</span><br><span class="line">        <span class="comment"># 3. 返回数据</span></span><br><span class="line">        <span class="keyword">return</span> Response(serializer.data)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">post</span><span class="params">(self,request)</span>:</span></span><br><span class="line">        <span class="comment"># 1. 调用序列化器对用户提交的数据进行验证</span></span><br><span class="line">        serializer = StudentModelSerializer(data=request.data)</span><br><span class="line">        serializer.is_valid(raise_exception=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 2. 调用序列化器进行数据库操作</span></span><br><span class="line">        instance = serializer.save() <span class="comment"># save()方法返回的是添加成功以后的模型对象</span></span><br><span class="line"></span><br><span class="line">        serializer = StudentModelSerializer(instance=instance)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 3. 返回新增数据</span></span><br><span class="line">        <span class="keyword">return</span> Response(serializer.data, status=status.HTTP_201_CREATED)</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Student2APIView</span><span class="params">(APIView)</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get</span><span class="params">(self,request,pk)</span>:</span></span><br><span class="line">        <span class="comment"># 1. 根据pk获取模型对象</span></span><br><span class="line">        student = Student.objects.get(pk=pk)</span><br><span class="line">        <span class="comment"># 2. 序列化器转换数据</span></span><br><span class="line">        serializer = StudentModelSerializer(instance=student)</span><br><span class="line">        <span class="comment"># 3. 响应数据</span></span><br><span class="line">        <span class="keyword">return</span> Response(serializer.data)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">put</span><span class="params">(self,request,pk)</span>:</span></span><br><span class="line">        <span class="comment"># 1. 通过pk查询学生信息</span></span><br><span class="line">        student = Student.objects.get(pk=pk)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 3. 调用序列化器对客户端发送过来的数据进行验证</span></span><br><span class="line">        serializer = StudentModelSerializer(instance=student, data=request.data)</span><br><span class="line">        serializer.is_valid(raise_exception=<span class="literal">True</span>)</span><br><span class="line">        <span class="comment"># 4. 保存数据</span></span><br><span class="line">        instance = serializer.save()</span><br><span class="line"></span><br><span class="line">        serializer = StudentModelSerializer(instance=instance)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 5. 返回结果</span></span><br><span class="line">        <span class="keyword">return</span> Response(serializer.data, status=status.HTTP_201_CREATED)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">delete</span><span class="params">(self, request, pk)</span>:</span></span><br><span class="line">        <span class="comment"># 1. 通过pk查询学生信息</span></span><br><span class="line">        Student.objects.get(pk=pk).delete()</span><br><span class="line">        <span class="keyword">return</span> Response(&#123;<span class="string">"message"</span>:<span class="string">"ok"</span>&#125;, status=status.HTTP_204_NO_CONTENT)</span><br></pre></td></tr></table></figure><h3 id="1-2-1-2-GenericAPIView"><a href="#1-2-1-2-GenericAPIView" class="headerlink" title="1.2.1.2 GenericAPIView"></a>1.2.1.2 GenericAPIView</h3><p>通用视图类主要作用就是把视图中的独特的代码抽取出来，让视图方法中的代码更加通用，方便把通用代码进行简写。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rest_framework.generics.GenericAPIView</span><br></pre></td></tr></table></figure><p>继承自<code>APIView</code>，<strong>主要增加了操作序列化器和数据库查询的类属性，作用是为下面Mixin视图扩展类的执行提供方法支持。通常在使用时，可搭配一个或多个Mixin扩展类。</strong></p><p>提供的关于序列化器使用的属性与方法</p><ul><li><p>属性：</p><ul><li><strong>serializer_class</strong> 指明视图使用的序列化器类</li></ul></li><li><p>方法：</p><ul><li><p><strong>get_serializer_class(self)</strong></p><p>当出现一个视图类中调用多个序列化器时,那么可以通过条件判断在get_serializer_class方法中通过返回不同的序列化器类名就可以让视图方法执行不同的序列化器对象了。</p><p>返回序列化器类，默认返回<code>serializer_class</code>，可以重写，例如：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_serializer_class</span><span class="params">(self)</span>:</span></span><br><span class="line">    <span class="keyword">if</span> self.request.user.is_staff:</span><br><span class="line">        <span class="keyword">return</span> FullAccountSerializer</span><br><span class="line">    <span class="keyword">return</span> BasicAccountSerializer</span><br></pre></td></tr></table></figure></li><li><p>get_serializer(self, <em>args, *</em>kwargs)</p><p>返回序列化器对象，主要用来提供给Mixin扩展类使用，如果我们在视图中想要获取序列化器对象，也可以直接调用此方法。</p><p><strong>注意，该方法在提供序列化器对象的时候，会向序列化器对象的context属性补充三个数据：request、format、view，这三个数据对象可以在定义序列化器时使用。</strong></p><ul><li><strong>request</strong> 当前视图的请求对象</li><li><strong>view</strong> 当前请求的类视图对象</li><li>format 当前请求期望返回的数据格式</li></ul></li></ul></li></ul><p>提供的关于数据库查询的属性与方法</p><ul><li><p>属性：</p><ul><li><strong>queryset</strong> 指明使用的数据查询集</li></ul></li><li><p>方法：</p><ul><li><p><strong>get_queryset(self)</strong></p><p>返回视图使用的查询集，主要用来提供给Mixin扩展类使用，是列表视图与详情视图获取数据的基础，默认返回<code>queryset</code>属性，可以重写，例如：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_queryset</span><span class="params">(self)</span>:</span></span><br><span class="line">    user = self.request.user</span><br><span class="line">    <span class="keyword">return</span> user.accounts.all()</span><br></pre></td></tr></table></figure></li><li><p><strong>get_object(self)</strong></p><p>返回详情视图所需的模型类数据对象，主要用来提供给Mixin扩展类使用。</p><p>在试图中可以调用该方法获取详情信息的模型类对象。</p><p><strong>若详情访问的模型类对象不存在，会返回404。</strong></p><p>该方法会默认使用APIView提供的check_object_permissions方法检查当前对象是否有权限被访问。</p><p>举例：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># url(r'^books/(?P&lt;pk&gt;\d+)/$', views.BookDetailView.as_view()),</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">BookDetailView</span><span class="params">(GenericAPIView)</span>:</span></span><br><span class="line">    queryset = BookInfo.objects.all()</span><br><span class="line">    serializer_class = BookInfoSerializer</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get</span><span class="params">(self, request, pk)</span>:</span></span><br><span class="line">        book = self.get_object() <span class="comment"># get_object()方法根据pk参数查找queryset中的数据对象</span></span><br><span class="line">        serializer = self.get_serializer(book)</span><br><span class="line">        <span class="keyword">return</span> Response(serializer.data)</span><br></pre></td></tr></table></figure></li></ul></li></ul><p>其他可以设置的属性</p><ul><li><strong>pagination_class</strong> 指明分页控制类</li><li><strong>filter_backends</strong> 指明过滤控制后端</li></ul><p>为了方便学习上面的GenericAPIView通用视图类，我们新建一个子应用。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python manage.py startapp gen</span><br></pre></td></tr></table></figure><p>代码：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> rest_framework.generics <span class="keyword">import</span> GenericAPIView</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> students.models <span class="keyword">import</span> Student</span><br><span class="line"><span class="keyword">from</span> .serializers <span class="keyword">import</span> StudentModelSerializer, StudentModel2Serializer</span><br><span class="line"><span class="keyword">from</span> rest_framework.response <span class="keyword">import</span> Response</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">StudentsGenericAPIView</span><span class="params">(GenericAPIView)</span>:</span></span><br><span class="line">    <span class="comment"># 本次视图类中要操作的数据[必填]</span></span><br><span class="line">    queryset = Student.objects.all()</span><br><span class="line">    <span class="comment"># 本次视图类中要调用的默认序列化器[玄天]</span></span><br><span class="line">    serializer_class = StudentModelSerializer</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get</span><span class="params">(self, request)</span>:</span></span><br><span class="line">        <span class="string">"""获取所有学生信息"""</span></span><br><span class="line">        serializer = self.get_serializer(instance=self.get_queryset(), many=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> Response(serializer.data)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">post</span><span class="params">(self,request)</span>:</span></span><br><span class="line"></span><br><span class="line">        data = request.data</span><br><span class="line"></span><br><span class="line">        serializer = self.get_serializer(data=data)</span><br><span class="line"></span><br><span class="line">        serializer.is_valid(raise_exception=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line">        instance = serializer.save()</span><br><span class="line"></span><br><span class="line">        serializer = self.get_serializer(instance=instance)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> Response(serializer.data)</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">StudentGenericAPIView</span><span class="params">(GenericAPIView)</span>:</span></span><br><span class="line">    queryset = Student.objects.all()</span><br><span class="line">    serializer_class = StudentModelSerializer</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get_serializer_class</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="string">"""重写获取序列化器类的方法"""</span></span><br><span class="line">        <span class="keyword">if</span> self.request.method == <span class="string">"GET"</span>:</span><br><span class="line">            <span class="keyword">return</span> StudentModel2Serializer</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">return</span> StudentModelSerializer</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 在使用GenericAPIView视图获取或操作单个数据时,视图方法中的代表主键的参数最好是pk</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get</span><span class="params">(self,request,pk)</span>:</span></span><br><span class="line">        <span class="string">"""获取一条数据"""</span></span><br><span class="line">        serializer = self.get_serializer(instance=self.get_object())</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> Response(serializer.data)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">put</span><span class="params">(self,request,pk)</span>:</span></span><br><span class="line"></span><br><span class="line">        data = request.data</span><br><span class="line"></span><br><span class="line">        serializer = self.get_serializer(instance=self.get_object(),data=data)</span><br><span class="line"></span><br><span class="line">        serializer.is_valid(raise_exception=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line">        serializer.save()</span><br><span class="line"></span><br><span class="line">        serializer = self.get_serializer(instance=self.get_object())</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> Response(serializer.data)</span><br></pre></td></tr></table></figure><p>序列化器类：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> rest_framework <span class="keyword">import</span> serializers</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> students.models <span class="keyword">import</span> Student</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">StudentModelSerializer</span><span class="params">(serializers.ModelSerializer)</span>:</span></span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">Meta</span>:</span></span><br><span class="line">        model= Student</span><br><span class="line">        fields = <span class="string">"__all__"</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">StudentModel2Serializer</span><span class="params">(serializers.ModelSerializer)</span>:</span></span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">Meta</span>:</span></span><br><span class="line">        model= Student</span><br><span class="line">        fields = (<span class="string">"name"</span>,<span class="string">"class_null"</span>)</span><br></pre></td></tr></table></figure><h3 id="1-2-2-5个视图扩展类"><a href="#1-2-2-5个视图扩展类" class="headerlink" title="1.2.2 5个视图扩展类"></a>1.2.2 5个视图扩展类</h3><p>作用：</p><p>提供了几种后端视图（对数据资源进行曾删改查）处理流程的实现，如果需要编写的视图属于这五种，则视图可以通过继承相应的扩展类来复用代码，减少自己编写的代码量。</p><p>这五个扩展类需要搭配GenericAPIView父类，因为五个扩展类的实现需要调用GenericAPIView提供的序列化器与数据库查询的方法。</p><h3 id="1）ListModelMixin"><a href="#1）ListModelMixin" class="headerlink" title="1）ListModelMixin"></a>1）ListModelMixin</h3><p>列表视图扩展类，提供<code>list(request, *args, **kwargs)</code>方法快速实现列表视图，返回200状态码。</p><p>该Mixin的list方法会对数据进行过滤和分页。</p><p>源代码：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ListModelMixin</span><span class="params">(object)</span>:</span></span><br><span class="line">    <span class="string">"""</span></span><br><span class="line"><span class="string">    List a queryset.</span></span><br><span class="line"><span class="string">    """</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">list</span><span class="params">(self, request, *args, **kwargs)</span>:</span></span><br><span class="line">        <span class="comment"># 过滤</span></span><br><span class="line">        queryset = self.filter_queryset(self.get_queryset())</span><br><span class="line">        <span class="comment"># 分页</span></span><br><span class="line">        page = self.paginate_queryset(queryset)</span><br><span class="line">        <span class="keyword">if</span> page <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>:</span><br><span class="line">            serializer = self.get_serializer(page, many=<span class="literal">True</span>)</span><br><span class="line">            <span class="keyword">return</span> self.get_paginated_response(serializer.data)</span><br><span class="line">        <span class="comment"># 序列化</span></span><br><span class="line">        serializer = self.get_serializer(queryset, many=<span class="literal">True</span>)</span><br><span class="line">        <span class="keyword">return</span> Response(serializer.data)</span><br></pre></td></tr></table></figure><p>举例：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> rest_framework.mixins <span class="keyword">import</span> ListModelMixin</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">BookListView</span><span class="params">(ListModelMixin, GenericAPIView)</span>:</span></span><br><span class="line">    queryset = BookInfo.objects.all()</span><br><span class="line">    serializer_class = BookInfoSerializer</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get</span><span class="params">(self, request)</span>:</span></span><br><span class="line">        <span class="keyword">return</span> self.list(request)</span><br></pre></td></tr></table></figure><h3 id="2）CreateModelMixin"><a href="#2）CreateModelMixin" class="headerlink" title="2）CreateModelMixin"></a>2）CreateModelMixin</h3><p>创建视图扩展类，提供<code>create(request, *args, **kwargs)</code>方法快速实现创建资源的视图，成功返回201状态码。</p><p>如果序列化器对前端发送的数据验证失败，返回400错误。</p><p>源代码：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">CreateModelMixin</span><span class="params">(object)</span>:</span></span><br><span class="line">    <span class="string">"""</span></span><br><span class="line"><span class="string">    Create a model instance.</span></span><br><span class="line"><span class="string">    """</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">create</span><span class="params">(self, request, *args, **kwargs)</span>:</span></span><br><span class="line">        <span class="comment"># 获取序列化器</span></span><br><span class="line">        serializer = self.get_serializer(data=request.data)</span><br><span class="line">        <span class="comment"># 验证</span></span><br><span class="line">        serializer.is_valid(raise_exception=<span class="literal">True</span>)</span><br><span class="line">        <span class="comment"># 保存</span></span><br><span class="line">        self.perform_create(serializer)</span><br><span class="line">        headers = self.get_success_headers(serializer.data)</span><br><span class="line">        <span class="keyword">return</span> Response(serializer.data, status=status.HTTP_201_CREATED, headers=headers)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">perform_create</span><span class="params">(self, serializer)</span>:</span></span><br><span class="line">        serializer.save()</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get_success_headers</span><span class="params">(self, data)</span>:</span></span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            <span class="keyword">return</span> &#123;<span class="string">'Location'</span>: str(data[api_settings.URL_FIELD_NAME])&#125;</span><br><span class="line">        <span class="keyword">except</span> (TypeError, KeyError):</span><br><span class="line">            <span class="keyword">return</span> &#123;&#125;</span><br></pre></td></tr></table></figure><h3 id="3）RetrieveModelMixin"><a href="#3）RetrieveModelMixin" class="headerlink" title="3）RetrieveModelMixin"></a>3）RetrieveModelMixin</h3><p>详情视图扩展类，提供<code>retrieve(request, *args, **kwargs)</code>方法，可以快速实现返回一个存在的数据对象。</p><p>如果存在，返回200， 否则返回404。</p><p>源代码：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">RetrieveModelMixin</span><span class="params">(object)</span>:</span></span><br><span class="line">    <span class="string">"""</span></span><br><span class="line"><span class="string">    Retrieve a model instance.</span></span><br><span class="line"><span class="string">    """</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">retrieve</span><span class="params">(self, request, *args, **kwargs)</span>:</span></span><br><span class="line">        <span class="comment"># 获取对象，会检查对象的权限</span></span><br><span class="line">        instance = self.get_object()</span><br><span class="line">        <span class="comment"># 序列化</span></span><br><span class="line">        serializer = self.get_serializer(instance)</span><br><span class="line">        <span class="keyword">return</span> Response(serializer.data)</span><br></pre></td></tr></table></figure><p>举例：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">BookDetailView</span><span class="params">(RetrieveModelMixin, GenericAPIView)</span>:</span></span><br><span class="line">    queryset = BookInfo.objects.all()</span><br><span class="line">    serializer_class = BookInfoSerializer</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get</span><span class="params">(self, request, pk)</span>:</span></span><br><span class="line">        <span class="keyword">return</span> self.retrieve(request)</span><br></pre></td></tr></table></figure><h3 id="4）UpdateModelMixin"><a href="#4）UpdateModelMixin" class="headerlink" title="4）UpdateModelMixin"></a>4）UpdateModelMixin</h3><p>更新视图扩展类，提供<code>update(request, *args, **kwargs)</code>方法，可以快速实现更新一个存在的数据对象。</p><p>同时也提供<code>partial_update(request, *args, **kwargs)</code>方法，可以实现局部更新。</p><p>成功返回200，序列化器校验数据失败时，返回400错误。</p><p>源代码：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">UpdateModelMixin</span><span class="params">(object)</span>:</span></span><br><span class="line">    <span class="string">"""</span></span><br><span class="line"><span class="string">    Update a model instance.</span></span><br><span class="line"><span class="string">    """</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">update</span><span class="params">(self, request, *args, **kwargs)</span>:</span></span><br><span class="line">        partial = kwargs.pop(<span class="string">'partial'</span>, <span class="literal">False</span>)</span><br><span class="line">        instance = self.get_object()</span><br><span class="line">        serializer = self.get_serializer(instance, data=request.data, partial=partial)</span><br><span class="line">        serializer.is_valid(raise_exception=<span class="literal">True</span>)</span><br><span class="line">        self.perform_update(serializer)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> getattr(instance, <span class="string">'_prefetched_objects_cache'</span>, <span class="literal">None</span>):</span><br><span class="line">            <span class="comment"># If 'prefetch_related' has been applied to a queryset, we need to</span></span><br><span class="line">            <span class="comment"># forcibly invalidate the prefetch cache on the instance.</span></span><br><span class="line">            instance._prefetched_objects_cache = &#123;&#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> Response(serializer.data)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">perform_update</span><span class="params">(self, serializer)</span>:</span></span><br><span class="line">        serializer.save()</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">partial_update</span><span class="params">(self, request, *args, **kwargs)</span>:</span></span><br><span class="line">        kwargs[<span class="string">'partial'</span>] = <span class="literal">True</span></span><br><span class="line">        <span class="keyword">return</span> self.update(request, *args, **kwargs)</span><br></pre></td></tr></table></figure><h3 id="5）DestroyModelMixin"><a href="#5）DestroyModelMixin" class="headerlink" title="5）DestroyModelMixin"></a>5）DestroyModelMixin</h3><p>删除视图扩展类，提供<code>destroy(request, *args, **kwargs)</code>方法，可以快速实现删除一个存在的数据对象。</p><p>成功返回204，不存在返回404。</p><p>源代码：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">DestroyModelMixin</span><span class="params">(object)</span>:</span></span><br><span class="line">    <span class="string">"""</span></span><br><span class="line"><span class="string">    Destroy a model instance.</span></span><br><span class="line"><span class="string">    """</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">destroy</span><span class="params">(self, request, *args, **kwargs)</span>:</span></span><br><span class="line">        instance = self.get_object()</span><br><span class="line">        self.perform_destroy(instance)</span><br><span class="line">        <span class="keyword">return</span> Response(status=status.HTTP_204_NO_CONTENT)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">perform_destroy</span><span class="params">(self, instance)</span>:</span></span><br><span class="line">        instance.delete()</span><br></pre></td></tr></table></figure><p>使用GenericAPIView和视图扩展类，实现api接口，代码：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">"""GenericAPIView结合视图扩展类实现api接口"""</span></span><br><span class="line"><span class="keyword">from</span> rest_framework.mixins <span class="keyword">import</span> ListModelMixin,CreateModelMixin</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Students2GenericAPIView</span><span class="params">(GenericAPIView,ListModelMixin,CreateModelMixin)</span>:</span></span><br><span class="line">    <span class="comment"># 本次视图类中要操作的数据[必填]</span></span><br><span class="line">    queryset = Student.objects.all()</span><br><span class="line">    <span class="comment"># 本次视图类中要调用的默认序列化器[玄天]</span></span><br><span class="line">    serializer_class = StudentModelSerializer</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get</span><span class="params">(self, request)</span>:</span></span><br><span class="line">        <span class="string">"""获取多个学生信息"""</span></span><br><span class="line">        <span class="keyword">return</span> self.list(request)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">post</span><span class="params">(self,request)</span>:</span></span><br><span class="line">        <span class="string">"""添加学生信息"""</span></span><br><span class="line">        <span class="keyword">return</span> self.create(request)</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> rest_framework.mixins <span class="keyword">import</span> RetrieveModelMixin,UpdateModelMixin,DestroyModelMixin</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Student2GenericAPIView</span><span class="params">(GenericAPIView,RetrieveModelMixin,UpdateModelMixin,DestroyModelMixin)</span>:</span></span><br><span class="line">    queryset = Student.objects.all()</span><br><span class="line"></span><br><span class="line">    serializer_class = StudentModelSerializer</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 在使用GenericAPIView视图获取或操作单个数据时,视图方法中的代表主键的参数最好是pk</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get</span><span class="params">(self,request,pk)</span>:</span></span><br><span class="line">        <span class="string">"""获取一条数据"""</span></span><br><span class="line">        <span class="keyword">return</span> self.retrieve(request,pk)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">put</span><span class="params">(self,request,pk)</span>:</span></span><br><span class="line">        <span class="string">"""更新一条数据"""</span></span><br><span class="line">        <span class="keyword">return</span> self.update(request,pk)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">delete</span><span class="params">(self,request,pk)</span>:</span></span><br><span class="line">        <span class="string">"""删除一条数据"""</span></span><br><span class="line">        <span class="keyword">return</span> self.destroy(request,pk)</span><br></pre></td></tr></table></figure><h3 id="1-2-3-GenericAPIView的视图子类"><a href="#1-2-3-GenericAPIView的视图子类" class="headerlink" title="1.2.3 GenericAPIView的视图子类"></a>1.2.3 GenericAPIView的视图子类</h3><h3 id="1）CreateAPIView"><a href="#1）CreateAPIView" class="headerlink" title="1）CreateAPIView"></a>1）CreateAPIView</h3><p>提供 post 方法</p><p>继承自： GenericAPIView、CreateModelMixin</p><h3 id="2）ListAPIView"><a href="#2）ListAPIView" class="headerlink" title="2）ListAPIView"></a>2）ListAPIView</h3><p>提供 get 方法</p><p>继承自：GenericAPIView、ListModelMixin</p><h3 id="3）RetrieveAPIView"><a href="#3）RetrieveAPIView" class="headerlink" title="3）RetrieveAPIView"></a>3）RetrieveAPIView</h3><p>提供 get 方法</p><p>继承自: GenericAPIView、RetrieveModelMixin</p><h3 id="4）DestoryAPIView"><a href="#4）DestoryAPIView" class="headerlink" title="4）DestoryAPIView"></a>4）DestoryAPIView</h3><p>提供 delete 方法</p><p>继承自：GenericAPIView、DestoryModelMixin</p><h3 id="5）UpdateAPIView"><a href="#5）UpdateAPIView" class="headerlink" title="5）UpdateAPIView"></a>5）UpdateAPIView</h3><p>提供 put 和 patch 方法</p><p>继承自：GenericAPIView、UpdateModelMixin</p><h3 id="6）RetrieveUpdateAPIView"><a href="#6）RetrieveUpdateAPIView" class="headerlink" title="6）RetrieveUpdateAPIView"></a>6）RetrieveUpdateAPIView</h3><p>提供 get、put、patch方法</p><p>继承自： GenericAPIView、RetrieveModelMixin、UpdateModelMixin</p><h3 id="7）RetrieveUpdateDestoryAPIView"><a href="#7）RetrieveUpdateDestoryAPIView" class="headerlink" title="7）RetrieveUpdateDestoryAPIView"></a>7）RetrieveUpdateDestoryAPIView</h3><p>提供 get、put、patch、delete方法</p><p>继承自：GenericAPIView、RetrieveModelMixin、UpdateModelMixin、DestoryModelMixin</p><h2 id="1-3-视图集ViewSet"><a href="#1-3-视图集ViewSet" class="headerlink" title="1.3 视图集ViewSet"></a>1.3 视图集ViewSet</h2><p>使用视图集ViewSet，可以将一系列逻辑相关的动作放到一个类中：</p><ul><li>list() 提供一组数据</li><li>retrieve() 提供单个数据</li><li>create() 创建数据</li><li>update() 保存数据</li><li>destory() 删除数据</li></ul><p>ViewSet视图集类不再实现get()、post()等方法，而是实现动作 <strong>action</strong> 如 list() 、create() 等。</p><p>视图集只在使用as_view()方法的时候，才会将<strong>action</strong>动作与具体请求方式对应上。如：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">BookInfoViewSet</span><span class="params">(viewsets.ViewSet)</span>:</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">list</span><span class="params">(self, request)</span>:</span></span><br><span class="line">        books = BookInfo.objects.all()</span><br><span class="line">        serializer = BookInfoSerializer(books, many=<span class="literal">True</span>)</span><br><span class="line">        <span class="keyword">return</span> Response(serializer.data)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">retrieve</span><span class="params">(self, request, pk=None)</span>:</span></span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            books = BookInfo.objects.get(id=pk)</span><br><span class="line">        <span class="keyword">except</span> BookInfo.DoesNotExist:</span><br><span class="line">            <span class="keyword">return</span> Response(status=status.HTTP_404_NOT_FOUND)</span><br><span class="line">        serializer = BookInfoSerializer(books)</span><br><span class="line">        <span class="keyword">return</span> Response(serializer.data)</span><br></pre></td></tr></table></figure><p>在设置路由时，我们可以如下操作</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">urlpatterns = [</span><br><span class="line">    url(<span class="string">r'^books/$'</span>, BookInfoViewSet.as_view(&#123;<span class="string">'get'</span>:<span class="string">'list'</span>&#125;),</span><br><span class="line">    url(<span class="string">r'^books/(?P&lt;pk&gt;\d+)/$'</span>, BookInfoViewSet.as_view(&#123;<span class="string">'get'</span>: <span class="string">'retrieve'</span>&#125;)</span><br><span class="line">]</span><br></pre></td></tr></table></figure><h3 id="1-3-1-常用视图集父类"><a href="#1-3-1-常用视图集父类" class="headerlink" title="1.3.1 常用视图集父类"></a>1.3.1 常用视图集父类</h3><h3 id="1）-ViewSet"><a href="#1）-ViewSet" class="headerlink" title="1） ViewSet"></a>1） ViewSet</h3><p>继承自<code>APIView</code>与<code>ViewSetMixin</code>，作用也与APIView基本类似，提供了身份认证、权限校验、流量管理等。</p><p><strong>ViewSet主要通过继承ViewSetMixin来实现在调用as_view()时传入字典（如{‘get’:‘list’}）的映射处理工作。</strong></p><p>在ViewSet中，没有提供任何动作action方法，需要我们自己实现action方法。</p><h3 id="2）GenericViewSet"><a href="#2）GenericViewSet" class="headerlink" title="2）GenericViewSet"></a>2）GenericViewSet</h3><p>使用ViewSet通常并不方便，因为list、retrieve、create、update、destory等方法都需要自己编写，而这些方法与前面讲过的Mixin扩展类提供的方法同名，所以我们可以通过继承Mixin扩展类来复用这些方法而无需自己编写。但是Mixin扩展类依赖与<code>GenericAPIView</code>，所以还需要继承<code>GenericAPIView</code>。</p><p><strong>GenericViewSet</strong>就帮助我们完成了这样的继承工作，继承自<code>GenericAPIView</code>与<code>ViewSetMixin</code>，在实现了调用as_view()时传入字典（如<code>{&#39;get&#39;:&#39;list&#39;}</code>）的映射处理工作的同时，还提供了<code>GenericAPIView</code>提供的基础方法，可以直接搭配Mixin扩展类使用。</p><p>举例：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> rest_framework.viewsets <span class="keyword">import</span> GenericViewSet</span><br><span class="line"><span class="keyword">from</span> rest_framework.mixins <span class="keyword">import</span> ListModelMixin,CreateModelMixin,RetrieveModelMixin,UpdateModelMixin,DestroyModelMixin</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Student4ViewSet</span><span class="params">(GenericViewSet,ListModelMixin,CreateModelMixin,RetrieveModelMixin,UpdateModelMixin,DestroyModelMixin)</span>:</span></span><br><span class="line">    queryset = Student.objects.all()</span><br><span class="line">    serializer_class = StudentModelSerializer</span><br></pre></td></tr></table></figure><p>url的定义</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">urlpatterns = [</span><br><span class="line">    path(<span class="string">"students7/"</span>, views.Student4ViewSet.as_view(&#123;<span class="string">"get"</span>: <span class="string">"list"</span>, <span class="string">"post"</span>: <span class="string">"create"</span>&#125;)),</span><br><span class="line">    re_path(<span class="string">"students7/(?P&lt;pk&gt;\d+)/"</span>, views.Student4ViewSet.as_view(&#123;<span class="string">"get"</span>: <span class="string">"retrieve"</span>,<span class="string">"put"</span>:<span class="string">"update"</span>,<span class="string">"delete"</span>:<span class="string">"destroy"</span>&#125;)),</span><br><span class="line"></span><br><span class="line">]</span><br></pre></td></tr></table></figure><h3 id="3）ModelViewSet"><a href="#3）ModelViewSet" class="headerlink" title="3）ModelViewSet"></a>3）ModelViewSet</h3><p>继承自<code>GenericViewSet</code>，同时包括了ListModelMixin、RetrieveModelMixin、CreateModelMixin、UpdateModelMixin、DestoryModelMixin。</p><h3 id="4）ReadOnlyModelViewSet"><a href="#4）ReadOnlyModelViewSet" class="headerlink" title="4）ReadOnlyModelViewSet"></a>4）ReadOnlyModelViewSet</h3><p>继承自<code>GenericViewSet</code>，同时包括了ListModelMixin、RetrieveModelMixin。</p><h3 id="1-3-2-视图集中定义附加action动作"><a href="#1-3-2-视图集中定义附加action动作" class="headerlink" title="1.3.2 视图集中定义附加action动作"></a>1.3.2 视图集中定义附加action动作</h3><p>在视图集中，除了上述默认的方法动作外，还可以添加自定义动作。</p><p>举例：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> rest_framework.viewsets <span class="keyword">import</span> ModelViewSet,ReadOnlyModelViewSet</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">StudentModelViewSet</span><span class="params">(ModelViewSet)</span>:</span></span><br><span class="line">    queryset = Student.objects.all()</span><br><span class="line">    serializer_class = StudentModelSerializer</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">login</span><span class="params">(self,request)</span>:</span></span><br><span class="line">        <span class="string">"""学生登录功能"""</span></span><br><span class="line">        <span class="keyword">return</span> Response(&#123;<span class="string">"message"</span>:<span class="string">"登录成功"</span>&#125;)</span><br></pre></td></tr></table></figure><p>url的定义</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">urlpatterns = [</span><br><span class="line">    path(<span class="string">"students8/"</span>, views.StudentModelViewSet.as_view(&#123;<span class="string">"get"</span>: <span class="string">"list"</span>, <span class="string">"post"</span>: <span class="string">"create"</span>&#125;)),</span><br><span class="line">    re_path(<span class="string">"students8/(?P&lt;pk&gt;\d+)/"</span>,</span><br><span class="line">            views.StudentModelViewSet.as_view(&#123;<span class="string">"get"</span>: <span class="string">"retrieve"</span>, <span class="string">"put"</span>: <span class="string">"update"</span>, <span class="string">"delete"</span>: <span class="string">"destroy"</span>&#125;)),</span><br><span class="line"></span><br><span class="line">    path(<span class="string">"stu/login/"</span>,views.StudentModelViewSet.as_view(&#123;<span class="string">"get"</span>:<span class="string">"login"</span>&#125;))</span><br><span class="line"></span><br><span class="line">]</span><br></pre></td></tr></table></figure><h3 id="1-3-3-action属性"><a href="#1-3-3-action属性" class="headerlink" title="1.3.3 action属性"></a>1.3.3 action属性</h3><p>在视图集中，我们可以通过action对象属性来获取当前请求视图集时的action动作是哪个。</p><p>例如：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> rest_framework.viewsets <span class="keyword">import</span> ModelViewSet</span><br><span class="line"><span class="keyword">from</span> students.models <span class="keyword">import</span> Student</span><br><span class="line"><span class="keyword">from</span> .serializers <span class="keyword">import</span> StudentModelSerializer</span><br><span class="line"><span class="keyword">from</span> rest_framework.response <span class="keyword">import</span> Response</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">StudentModelViewSet</span><span class="params">(ModelViewSet)</span>:</span></span><br><span class="line">    queryset = Student.objects.all()</span><br><span class="line">    serializer_class = StudentModelSerializer</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get_new_5</span><span class="params">(self,request)</span>:</span></span><br><span class="line">        <span class="string">"""获取最近添加的5个学生信息"""</span></span><br><span class="line">        <span class="comment"># 操作数据库</span></span><br><span class="line">        print(self.action) <span class="comment"># 获取本次请求的视图方法名</span></span><br><span class="line">        </span><br><span class="line">        </span><br><span class="line">通过路由访问到当前方法中.可以看到本次的action就是请求的方法名</span><br></pre></td></tr></table></figure><h1 id="2-路由Routers"><a href="#2-路由Routers" class="headerlink" title="2. 路由Routers"></a>2. 路由Routers</h1><p>对于视图集ViewSet，我们除了可以自己手动指明请求方式与动作action之间的对应关系外，还可以使用Routers来帮助我们快速实现路由信息。</p><p>REST framework提供了两个router</p><ul><li><strong>SimpleRouter</strong></li><li><strong>DefaultRouter</strong></li></ul><h2 id="2-1-使用方法"><a href="#2-1-使用方法" class="headerlink" title="2.1 使用方法"></a>2.1 使用方法</h2><p>1） 创建router对象，并注册视图集，例如</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> rest_framework <span class="keyword">import</span> routers</span><br><span class="line"></span><br><span class="line">router = routers.DefaultRouter()</span><br><span class="line">router.register(<span class="string">r'router_stu'</span>, StudentModelViewSet, base_name=<span class="string">'student'</span>)</span><br></pre></td></tr></table></figure><p>register(prefix, viewset, base_name)</p><ul><li>prefix 该视图集的路由前缀</li><li>viewset 视图集</li><li>base_name 路由别名的前缀</li></ul><p>如上述代码会形成的路由如下：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">^books/$    name: book-list</span><br><span class="line">^books/&#123;pk&#125;/$   name: book-detail</span><br></pre></td></tr></table></figure><p>2）添加路由数据</p><p>可以有两种方式：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">urlpatterns = [</span><br><span class="line">    ...</span><br><span class="line">]</span><br><span class="line">urlpatterns += router.urls</span><br></pre></td></tr></table></figure><p>或</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">urlpatterns = [</span><br><span class="line">    ...</span><br><span class="line">    url(<span class="string">r'^'</span>, include(router.urls))</span><br><span class="line">]</span><br></pre></td></tr></table></figure><p>使用路由类给视图集生成了路由地址</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> rest_framework.viewsets <span class="keyword">import</span> ModelViewSet,ReadOnlyModelViewSet</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">StudentModelViewSet</span><span class="params">(ModelViewSet)</span>:</span></span><br><span class="line">    queryset = Student.objects.all()</span><br><span class="line">    serializer_class = StudentModelSerializer</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">login</span><span class="params">(self,request)</span>:</span></span><br><span class="line">        <span class="string">"""学生登录功能"""</span></span><br><span class="line">        print(self.action)</span><br><span class="line">        <span class="keyword">return</span> Response(&#123;<span class="string">"message"</span>:<span class="string">"登录成功"</span>&#125;)</span><br></pre></td></tr></table></figure><p>路由代码：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> django.urls <span class="keyword">import</span> path, re_path</span><br><span class="line"><span class="keyword">from</span> . <span class="keyword">import</span> views</span><br><span class="line">urlpatterns = [</span><br><span class="line">    ...</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"><span class="string">"""使用drf提供路由类router给视图集生成路由列表"""</span></span><br><span class="line"><span class="comment"># 实例化路由类</span></span><br><span class="line"><span class="comment"># drf提供一共提供了两个路由类给我们使用,他们用法一致,功能几乎一样</span></span><br><span class="line"><span class="keyword">from</span> rest_framework.routers <span class="keyword">import</span> DefaultRouter</span><br><span class="line">router = DefaultRouter()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 注册视图集</span></span><br><span class="line"><span class="comment"># router.register("路由前缀",视图集类)</span></span><br><span class="line">router.register(<span class="string">"router_stu"</span>,views.StudentModelViewSet)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 把生成的路由列表追加到urlpatterns</span></span><br><span class="line">print( router.urls )</span><br><span class="line">urlpatterns += router.urls</span><br></pre></td></tr></table></figure><p>上面的代码就成功生成了路由地址[增/删/改/查一条/查多条的功能]，但是不会自动我们在视图集自定义方法的路由。</p><p>所以我们如果也要给自定义方法生成路由，则需要进行action动作的声明。</p><h2 id="2-2-视图集中附加action的声明"><a href="#2-2-视图集中附加action的声明" class="headerlink" title="2.2 视图集中附加action的声明"></a>2.2 视图集中附加action的声明</h2><p>在视图集中，如果想要让Router自动帮助我们为自定义的动作生成路由信息，需要使用<code>rest_framework.decorators.action</code>装饰器。</p><p>以action装饰器装饰的方法名会作为action动作名，与list、retrieve等同。</p><p>action装饰器可以接收两个参数：</p><ul><li><p><strong>methods</strong>: 声明该action对应的请求方式，列表传递</p></li><li><p>detail声明该action的路径是否与单一资源对应，及是否是</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">xxx/&lt;pk&gt;/action方法名/</span><br></pre></td></tr></table></figure><ul><li>True 表示路径格式是<code>xxx/&lt;pk&gt;/action方法名/</code></li><li>False 表示路径格式是<code>xxx/action方法名/</code></li></ul></li></ul><p>举例：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> rest_framework.viewsets <span class="keyword">import</span> ModelViewSet</span><br><span class="line"><span class="keyword">from</span> rest_framework.decorators <span class="keyword">import</span> action</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">StudentModelViewSet</span><span class="params">(ModelViewSet)</span>:</span></span><br><span class="line">    queryset = Student.objects.all()</span><br><span class="line">    serializer_class = StudentModelSerializer</span><br><span class="line"></span><br><span class="line">    <span class="comment"># methods 设置当前方法允许哪些http请求访问当前视图方法</span></span><br><span class="line">    <span class="comment"># detail 设置当前视图方法是否是操作一个数据</span></span><br><span class="line">    <span class="comment"># detail为True，表示路径名格式应该为 router_stu/&#123;pk&#125;/login/</span></span><br><span class="line"><span class="meta">    @action(methods=['get'], detail=True)</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">login</span><span class="params">(self, request,pk)</span>:</span></span><br><span class="line">        <span class="string">"""登录"""</span></span><br><span class="line">        ...</span><br><span class="line"></span><br><span class="line">    <span class="comment"># detail为False 表示路径名格式应该为 router_stu/get_new_5/</span></span><br><span class="line"><span class="meta">    @action(methods=['put'], detail=False)</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get_new_5</span><span class="params">(self, request)</span>:</span></span><br><span class="line">        <span class="string">"""获取最新添加的5个学生信息"""</span></span><br><span class="line">        ...</span><br></pre></td></tr></table></figure><p>由路由器自动为此视图集自定义action方法形成的路由会是如下内容：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">^router_stu/get_new_5/$    name: router_stu-get_new_5</span><br><span class="line">^router_stu/&#123;pk&#125;/login/$   name: router_stu-login</span><br></pre></td></tr></table></figure><h2 id="2-3-路由router形成URL的方式"><a href="#2-3-路由router形成URL的方式" class="headerlink" title="2.3 路由router形成URL的方式"></a>2.3 路由router形成URL的方式</h2><p>1） SimpleRouter</p><p><img src="/imamges/SimpleRouter.png" alt=""></p><p>2）DefaultRouter</p><p><img src="/imamges/DefaultRouter.png" alt=""></p><p>DefaultRouter与SimpleRouter的区别是，DefaultRouter会多附带一个默认的API根视图，返回一个包含所有列表视图的超链接响应数据。</p>]]></content>
    
    <summary type="html">
    
      Django REST framwork 提供的视图的主要作用：控制序列化器的执行（检验、保存、转换数据）,控制数据库查询的执行[数据库的删除/查询代码写在视图中，更新和添加写在序列化器]...
    
    </summary>
    
    
      <category term="python" scheme="http://yoursite.com/categories/python/"/>
    
    
      <category term="Django Rest_Framework" scheme="http://yoursite.com/tags/Django-Rest-Framework/"/>
    
  </entry>
  
  <entry>
    <title>[HTTP请求处理]</title>
    <link href="http://yoursite.com/2020/04/22/HTTP%E8%AF%B7%E6%B1%82%E5%A4%84%E7%90%86/"/>
    <id>http://yoursite.com/2020/04/22/HTTP%E8%AF%B7%E6%B1%82%E5%A4%84%E7%90%86/</id>
    <published>2020-04-22T11:43:11.000Z</published>
    <updated>2020-04-23T11:53:33.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="1-http请求处理"><a href="#1-http请求处理" class="headerlink" title="1. http请求处理"></a>1. http请求处理</h1><p>drf除了在数据序列化部分简写代码以外，还在视图中提供了简写操作。所以在django原有的django.views.View类基础上，drf封装了多个视图子类出来提供给我们使用。</p><p>Django REST framwork 提供的视图的主要作用：</p><ul><li>控制序列化器的执行（检验、保存、转换数据）</li><li>控制数据库查询的执行</li><li>调用请求类和响应类[这两个类也是由drf帮我们再次扩展了一些功能类。]</li></ul><p>为了方便我们学习，所以先创建一个子应用req</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python manage.py startapp req</span><br></pre></td></tr></table></figure><p>注册子引用：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">INSTALLED_APPS = [</span><br><span class="line">    <span class="string">'django.contrib.admin'</span>,</span><br><span class="line">    <span class="string">'django.contrib.auth'</span>,</span><br><span class="line">    <span class="string">'django.contrib.contenttypes'</span>,</span><br><span class="line">    <span class="string">'django.contrib.sessions'</span>,</span><br><span class="line">    <span class="string">'django.contrib.messages'</span>,</span><br><span class="line">    <span class="string">'django.contrib.staticfiles'</span>,</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 注册 rest_framework　的子应用</span></span><br><span class="line">    <span class="string">'rest_framework'</span>,</span><br><span class="line"></span><br><span class="line">    <span class="string">'students'</span>,</span><br><span class="line">    <span class="string">'sers'</span>,</span><br><span class="line">    <span class="string">'unsers'</span>,</span><br><span class="line">    <span class="string">'homework'</span>,</span><br><span class="line">    <span class="string">'req'</span>,     <span class="comment"># 请求与响应</span></span><br><span class="line">]</span><br></pre></td></tr></table></figure><p>注册路由</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 子应用路由</span></span><br><span class="line"><span class="keyword">from</span> django.urls <span class="keyword">import</span> path</span><br><span class="line"><span class="keyword">from</span> . <span class="keyword">import</span> views</span><br><span class="line">urlpatterns = [</span><br><span class="line"></span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 总路由</span></span><br><span class="line"><span class="keyword">from</span> django.contrib <span class="keyword">import</span> admin</span><br><span class="line"><span class="keyword">from</span> django.urls <span class="keyword">import</span> path,include</span><br><span class="line"></span><br><span class="line">urlpatterns = [</span><br><span class="line">    path(<span class="string">'admin/'</span>, admin.site.urls),</span><br><span class="line">    path(<span class="string">'students/'</span>, include(<span class="string">"students.urls"</span>)),</span><br><span class="line">    path(<span class="string">'sers/'</span>, include(<span class="string">"sers.urls"</span>)),</span><br><span class="line">    path(<span class="string">'unsers/'</span>, include(<span class="string">"unsers.urls"</span>)),</span><br><span class="line">    path(<span class="string">'req/'</span>, include(<span class="string">"req.urls"</span>)),</span><br><span class="line">]</span><br></pre></td></tr></table></figure><h2 id="1-1-请求与响应"><a href="#1-1-请求与响应" class="headerlink" title="1.1. 请求与响应"></a>1.1. 请求与响应</h2><h3 id="1-1-1-Request"><a href="#1-1-1-Request" class="headerlink" title="1.1.1 Request"></a>1.1.1 Request</h3><p>REST framework 传入视图的request对象不再是Django默认的HttpRequest对象，而是REST framework提供的扩展了HttpRequest类的<strong>Request</strong>类的对象。</p><p>REST framework 提供了<strong>Parser</strong>解析器，在接收到请求后会自动根据Content-Type指明的请求数据类型（如JSON、表单等）将请求数据进行parse解析，解析为类字典[QueryDict]对象保存到<strong>Request</strong>对象中。</p><p><strong>Request对象的数据是自动根据前端发送数据的格式进行解析之后的结果。</strong></p><p>无论前端发送的哪种格式的数据，我们都可以以统一的方式读取数据。</p><h3 id="1-1-1-1-常用属性"><a href="#1-1-1-1-常用属性" class="headerlink" title="1.1.1.1 常用属性"></a>1.1.1.1 常用属性</h3><h3 id="1）-data"><a href="#1）-data" class="headerlink" title="1）.data"></a>1）.data</h3><p><code>request.data</code> 返回解析之后的请求体数据。类似于Django中标准的<code>request.POST</code>和 <code>request.FILES</code>属性，但提供如下特性：</p><ul><li>包含了解析之后的文件和非文件数据</li><li>包含了对POST、PUT、PATCH请求方式解析后的数据</li><li>利用了REST framework的parsers解析器，不仅支持表单类型数据，也支持JSON数据</li></ul><h3 id="2）-query-params"><a href="#2）-query-params" class="headerlink" title="2）.query_params"></a>2）.query_params</h3><p><code>request.query_params</code>返回解析之后的查询字符串数据</p><p><code>request.query_params</code>与Django标准的<code>request.GET</code>相同，只是更换了更正确的名称而已。</p><h3 id="1-1-2-Response"><a href="#1-1-2-Response" class="headerlink" title="1.1.2 Response"></a>1.1.2 Response</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rest_framework.response.Response</span><br></pre></td></tr></table></figure><p>REST framework提供了一个响应类<code>Response</code>，使用该类构造响应对象时，响应的具体数据内容会被转换（render渲染器）成符合前端需求的类型。</p><p>REST framework提供了<code>Renderer</code> 渲染器，用来根据请求头中的<code>Accept</code>（接收数据类型声明）来自动转换响应数据到对应格式。如果前端请求中未进行Accept声明，则会采用默认方式处理响应数据，我们可以通过配置来修改默认响应格式。【简而言之，就是Renderer能通过请求找的Accept查询出客户端支持和希望的数据类型，把视图的结果以客户端能识别的格式返回】</p><p>可以在<strong>rest_framework.settings.py</strong>查找所有的drf默认配置项</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">REST_FRAMEWORK = &#123;</span><br><span class="line">    <span class="string">'DEFAULT_RENDERER_CLASSES'</span>: (  <span class="comment"># 默认响应渲染类</span></span><br><span class="line">        <span class="string">'rest_framework.renderers.JSONRenderer'</span>,  <span class="comment"># json渲染器</span></span><br><span class="line">        <span class="string">'rest_framework.renderers.BrowsableAPIRenderer'</span>,  <span class="comment"># 浏览器API渲染器</span></span><br><span class="line">    )</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="1-1-2-1-构造方式"><a href="#1-1-2-1-构造方式" class="headerlink" title="1.1.2.1 构造方式"></a>1.1.2.1 构造方式</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Response(data, status=<span class="literal">None</span>, template_name=<span class="literal">None</span>, headers=<span class="literal">None</span>, content_type=<span class="literal">None</span>)</span><br></pre></td></tr></table></figure><p><code>data</code>数据不要是render处理之后的数据，只需传递python的内建类型数据即可，REST framework会使用<code>renderer</code>渲染器处理<code>data</code>。</p><p><code>data</code>不能是复杂结构的数据，如Django的模型类对象，对于这样的数据我们可以使用<code>Serializer</code>序列化器序列化处理后（转为了Python字典类型）再传递给<code>data</code>参数。</p><p>参数说明：</p><ul><li><code>data</code>: 为响应准备的序列化处理后的数据；</li><li><code>status</code>: 状态码，默认200；</li><li><code>template_name</code>: 模板名称，如果使用<code>HTMLRenderer</code> 时需指明；</li><li><code>headers</code>: 用于存放响应头信息的字典；</li><li><code>content_type</code>: 响应数据的Content-Type，通常此参数无需传递，REST framework会根据前端所需类型数据来设置该参数。</li></ul><h3 id="1-1-2-2-常用属性"><a href="#1-1-2-2-常用属性" class="headerlink" title="1.1.2.2 常用属性"></a>1.1.2.2 常用属性</h3><h3 id="1）-data-1"><a href="#1）-data-1" class="headerlink" title="1）.data"></a>1）.data</h3><p>传给response对象的序列化后，但尚未render处理的数据</p><h3 id="2）-status-code"><a href="#2）-status-code" class="headerlink" title="2）.status_code"></a>2）.status_code</h3><p>状态码的数字</p><h3 id="3）-content"><a href="#3）-content" class="headerlink" title="3）.content"></a>3）.content</h3><p>经过render处理后的响应数据</p><h3 id="1-1-2-3-状态码"><a href="#1-1-2-3-状态码" class="headerlink" title="1.1.2.3 状态码"></a>1.1.2.3 状态码</h3><p>为了方便设置状态码，REST framewrok在<code>rest_framework.status</code>模块中提供了常用状态码常量。</p><h3 id="1）信息告知-1xx"><a href="#1）信息告知-1xx" class="headerlink" title="1）信息告知 - 1xx"></a>1）信息告知 - 1xx</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">HTTP_100_CONTINUE</span><br><span class="line">HTTP_101_SWITCHING_PROTOCOLS</span><br></pre></td></tr></table></figure><h3 id="2）成功-2xx"><a href="#2）成功-2xx" class="headerlink" title="2）成功 - 2xx"></a>2）成功 - 2xx</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">HTTP_200_OK</span><br><span class="line">HTTP_201_CREATED</span><br><span class="line">HTTP_202_ACCEPTED</span><br><span class="line">HTTP_203_NON_AUTHORITATIVE_INFORMATION</span><br><span class="line">HTTP_204_NO_CONTENT</span><br><span class="line">HTTP_205_RESET_CONTENT</span><br><span class="line">HTTP_206_PARTIAL_CONTENT</span><br><span class="line">HTTP_207_MULTI_STATUS</span><br></pre></td></tr></table></figure><h3 id="3）重定向-3xx"><a href="#3）重定向-3xx" class="headerlink" title="3）重定向 - 3xx"></a>3）重定向 - 3xx</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">HTTP_300_MULTIPLE_CHOICES</span><br><span class="line">HTTP_301_MOVED_PERMANENTLY</span><br><span class="line">HTTP_302_FOUND</span><br><span class="line">HTTP_303_SEE_OTHER</span><br><span class="line">HTTP_304_NOT_MODIFIED</span><br><span class="line">HTTP_305_USE_PROXY</span><br><span class="line">HTTP_306_RESERVED</span><br><span class="line">HTTP_307_TEMPORARY_REDIRECT</span><br></pre></td></tr></table></figure><h3 id="4）客户端错误-4xx"><a href="#4）客户端错误-4xx" class="headerlink" title="4）客户端错误 - 4xx"></a>4）客户端错误 - 4xx</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">HTTP_400_BAD_REQUEST</span><br><span class="line">HTTP_401_UNAUTHORIZED</span><br><span class="line">HTTP_402_PAYMENT_REQUIRED</span><br><span class="line">HTTP_403_FORBIDDEN</span><br><span class="line">HTTP_404_NOT_FOUND</span><br><span class="line">HTTP_405_METHOD_NOT_ALLOWED</span><br><span class="line">HTTP_406_NOT_ACCEPTABLE</span><br><span class="line">HTTP_407_PROXY_AUTHENTICATION_REQUIRED</span><br><span class="line">HTTP_408_REQUEST_TIMEOUT</span><br><span class="line">HTTP_409_CONFLICT</span><br><span class="line">HTTP_410_GONE</span><br><span class="line">HTTP_411_LENGTH_REQUIRED</span><br><span class="line">HTTP_412_PRECONDITION_FAILED</span><br><span class="line">HTTP_413_REQUEST_ENTITY_TOO_LARGE</span><br><span class="line">HTTP_414_REQUEST_URI_TOO_LONG</span><br><span class="line">HTTP_415_UNSUPPORTED_MEDIA_TYPE</span><br><span class="line">HTTP_416_REQUESTED_RANGE_NOT_SATISFIABLE</span><br><span class="line">HTTP_417_EXPECTATION_FAILED</span><br><span class="line">HTTP_422_UNPROCESSABLE_ENTITY</span><br><span class="line">HTTP_423_LOCKED</span><br><span class="line">HTTP_424_FAILED_DEPENDENCY</span><br><span class="line">HTTP_428_PRECONDITION_REQUIRED</span><br><span class="line">HTTP_429_TOO_MANY_REQUESTS</span><br><span class="line">HTTP_431_REQUEST_HEADER_FIELDS_TOO_LARGE</span><br><span class="line">HTTP_451_UNAVAILABLE_FOR_LEGAL_REASONS</span><br></pre></td></tr></table></figure><h3 id="5）服务器错误-5xx"><a href="#5）服务器错误-5xx" class="headerlink" title="5）服务器错误 - 5xx"></a>5）服务器错误 - 5xx</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">HTTP_500_INTERNAL_SERVER_ERROR</span><br><span class="line">HTTP_501_NOT_IMPLEMENTED</span><br><span class="line">HTTP_502_BAD_GATEWAY</span><br><span class="line">HTTP_503_SERVICE_UNAVAILABLE</span><br><span class="line">HTTP_504_GATEWAY_TIMEOUT</span><br><span class="line">HTTP_505_HTTP_VERSION_NOT_SUPPORTED</span><br><span class="line">HTTP_507_INSUFFICIENT_STORAGE</span><br><span class="line">HTTP_511_NETWORK_AUTHENTICATION_REQUIRED</span><br></pre></td></tr></table></figure><p>为了方便演示，所以视图里面的内容知识，我们另外创建一个子应用来展示</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python manage.py startapp demo</span><br></pre></td></tr></table></figure><p>注册子应用</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">INSTALLED_APPS = [</span><br><span class="line">    <span class="string">'django.contrib.admin'</span>,</span><br><span class="line">    <span class="string">'django.contrib.auth'</span>,</span><br><span class="line">    <span class="string">'django.contrib.contenttypes'</span>,</span><br><span class="line">    <span class="string">'django.contrib.sessions'</span>,</span><br><span class="line">    <span class="string">'django.contrib.messages'</span>,</span><br><span class="line">    <span class="string">'django.contrib.staticfiles'</span>,</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 注册 rest_framework　的子应用</span></span><br><span class="line">    <span class="string">'rest_framework'</span>,</span><br><span class="line"></span><br><span class="line">    <span class="string">'students'</span>,</span><br><span class="line">    <span class="string">'sers'</span>,</span><br><span class="line">    <span class="string">'unsers'</span>,</span><br><span class="line">    <span class="string">'homework'</span>,</span><br><span class="line">    <span class="string">'req'</span>,     <span class="comment"># 请求与响应</span></span><br><span class="line">    <span class="string">'demo'</span>,     <span class="comment"># 视图类的学习</span></span><br><span class="line">]</span><br></pre></td></tr></table></figure><p>注册路由，</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> django.contrib <span class="keyword">import</span> admin</span><br><span class="line"><span class="keyword">from</span> django.urls <span class="keyword">import</span> path,include</span><br><span class="line"><span class="comment"># 新版的django把url拆分成了2个路由函数</span></span><br><span class="line"><span class="comment"># django.urls.path 专门编写字符串路由</span></span><br><span class="line"><span class="comment"># django.urls.re_path 专门编写正则路由</span></span><br><span class="line">urlpatterns = [</span><br><span class="line">    path(<span class="string">'admin/'</span>, admin.site.urls),</span><br><span class="line">    path(<span class="string">'students/'</span>, include(<span class="string">"students.urls"</span>)),</span><br><span class="line">    path(<span class="string">'sers/'</span>, include(<span class="string">"sers.urls"</span>)),</span><br><span class="line">    path(<span class="string">'unsers/'</span>, include(<span class="string">"unsers.urls"</span>)),</span><br><span class="line">    path(<span class="string">'req/'</span>, include(<span class="string">"req.urls"</span>)),</span><br><span class="line">    path(<span class="string">"demo/"</span>,include(<span class="string">"demo.urls"</span>)),</span><br><span class="line">]</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      drf除了在数据序列化部分简写代码以外，还在视图中提供了简写操作。所以在django原有的django.views.View类基础上，drf封装了多个视图子类出来提供给我们使用...
    
    </summary>
    
    
      <category term="python" scheme="http://yoursite.com/categories/python/"/>
    
    
      <category term="Django Rest_Framework" scheme="http://yoursite.com/tags/Django-Rest-Framework/"/>
    
  </entry>
  
  <entry>
    <title>[序列化器-Serializer]</title>
    <link href="http://yoursite.com/2020/04/22/%E5%BA%8F%E5%88%97%E5%8C%96%E5%99%A8-Serializer/"/>
    <id>http://yoursite.com/2020/04/22/%E5%BA%8F%E5%88%97%E5%8C%96%E5%99%A8-Serializer/</id>
    <published>2020-04-22T10:11:52.000Z</published>
    <updated>2020-04-23T10:53:33.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="7-序列化器-Serializer"><a href="#7-序列化器-Serializer" class="headerlink" title="7. 序列化器-Serializer"></a>7. 序列化器-Serializer</h1><p>作用：</p><ol><li>序列化,序列化器会把模型对象转换成字典,将来提供给视图经过response以后变成json字符串</li><li>反序列化,把客户端发送过来的数据,经过视图调用request以后变成python字典,序列化器可以把字典转成模型</li><li>反序列化,完成数据校验功能和操作数据库</li></ol><h2 id="7-1-定义序列化器"><a href="#7-1-定义序列化器" class="headerlink" title="7.1 定义序列化器"></a>7.1 定义序列化器</h2><p>Django REST framework中的Serializer使用类来定义，须继承自rest_framework.serializers.Serializer。</p><p>接下来，为了方便演示序列化器的使用，我们另外创建一个新的子应用sers</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python manage.py startapp sers</span><br></pre></td></tr></table></figure><p>先注册子应用到项目中，settings.py，代码：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">INSTALLED_APPS = [</span><br><span class="line">    <span class="string">'django.contrib.admin'</span>,</span><br><span class="line">    <span class="string">'django.contrib.auth'</span>,</span><br><span class="line">    <span class="string">'django.contrib.contenttypes'</span>,</span><br><span class="line">    <span class="string">'django.contrib.sessions'</span>,</span><br><span class="line">    <span class="string">'django.contrib.messages'</span>,</span><br><span class="line">    <span class="string">'django.contrib.staticfiles'</span>,</span><br><span class="line"></span><br><span class="line">    <span class="string">'rest_framework'</span>, <span class="comment"># 把drf框架注册到django项目中</span></span><br><span class="line"></span><br><span class="line">    <span class="string">'students'</span>, <span class="comment"># 注册子应用</span></span><br><span class="line">    <span class="string">'sers'</span>,</span><br><span class="line">]</span><br></pre></td></tr></table></figure><p>因为我们已有了一个数据库模型类students/Student，我们直接在接下来的演示中使用这个模型。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Student</span><span class="params">(models.Model)</span>:</span></span><br><span class="line">    <span class="comment"># 模型字段</span></span><br><span class="line">    name = models.CharField(max_length=<span class="number">100</span>,verbose_name=<span class="string">"姓名"</span>)</span><br><span class="line">    sex = models.BooleanField(default=<span class="number">1</span>,verbose_name=<span class="string">"性别"</span>)</span><br><span class="line">    age = models.IntegerField(verbose_name=<span class="string">"年龄"</span>)</span><br><span class="line">    class_number = models.CharField(max_length=<span class="number">5</span>,verbose_name=<span class="string">"班级编号"</span>)</span><br><span class="line">    description = models.TextField(max_length=<span class="number">1000</span>,verbose_name=<span class="string">"个性签名"</span>)</span><br><span class="line"></span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">Meta</span>:</span></span><br><span class="line">        db_table=<span class="string">"tb_student"</span></span><br><span class="line">        verbose_name = <span class="string">"学生"</span></span><br><span class="line">        verbose_name_plural = verbose_name</span><br></pre></td></tr></table></figure><p>我们想为这个模型类提供一个序列化器，可以命名为<code>StudentSerializer</code>，</p><p>我们都会把序列化器代码保存到当前子应用下的serializers.py模块中，</p><p>可以定义如下：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> rest_framework <span class="keyword">import</span> serializers</span><br><span class="line"></span><br><span class="line"><span class="comment"># 声明序列化器，所有的序列化器都要直接或者间接继承于 Serializer</span></span><br><span class="line"><span class="comment"># 其中，ModelSerializer是Serializer的子类，ModelSerializer在Serializer的基础上进行了代码简化</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">StudentSerializer</span><span class="params">(serializers.Serializer)</span>:</span></span><br><span class="line">    <span class="string">"""学生信息序列化器"""</span></span><br><span class="line">    <span class="comment"># 1. 需要进行数据转换的字段</span></span><br><span class="line">    id = serializers.IntegerField()</span><br><span class="line">    name = serializers.CharField()</span><br><span class="line">    age = serializers.IntegerField()</span><br><span class="line">    sex = serializers.BooleanField()</span><br><span class="line">    description = serializers.CharField()</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 2. 如果序列化器集成的是ModelSerializer，则需要声明调用的模型信息</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 3. 验证代码</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 4. 编写添加和更新模型的代码</span></span><br></pre></td></tr></table></figure><p><strong>注意：serializer不是只能为数据库模型类定义，也可以为非数据库模型类的数据定义。</strong>serializer是独立于数据库之外的存在。</p><p><strong>常用字段类型</strong>：</p><table><thead><tr><th>字段</th><th>字段构造方式</th></tr></thead><tbody><tr><td><strong>BooleanField</strong></td><td>BooleanField()</td></tr><tr><td><strong>NullBooleanField</strong></td><td>NullBooleanField()</td></tr><tr><td><strong>CharField</strong></td><td>CharField(max_length=None, min_length=None, allow_blank=False, trim_whitespace=True)</td></tr><tr><td><strong>EmailField</strong></td><td>EmailField(max_length=None, min_length=None, allow_blank=False)</td></tr><tr><td><strong>RegexField</strong></td><td>RegexField(regex, max_length=None, min_length=None, allow_blank=False)</td></tr><tr><td><strong>SlugField</strong></td><td>SlugField(max<em>length=50, min_length=None, allow_blank=False) 正则字段，验证正则模式 [a-zA-Z0-9</em>-]+</td></tr><tr><td><strong>URLField</strong></td><td>URLField(max_length=200, min_length=None, allow_blank=False)</td></tr><tr><td><strong>UUIDField</strong></td><td>UUIDField(format=’hex_verbose’)  format:  1) <code>&#39;hex_verbose&#39;</code> 如<code>&quot;5ce0e9a5-5ffa-654b-cee0-1238041fb31a&quot;</code>  2） <code>&#39;hex&#39;</code> 如 <code>&quot;5ce0e9a55ffa654bcee01238041fb31a&quot;</code>  3）<code>&#39;int&#39;</code> - 如: <code>&quot;123456789012312313134124512351145145114&quot;</code>  4）<code>&#39;urn&#39;</code> 如: <code>&quot;urn:uuid:5ce0e9a5-5ffa-654b-cee0-1238041fb31a&quot;</code></td></tr><tr><td><strong>IPAddressField</strong></td><td>IPAddressField(protocol=’both’, unpack_ipv4=False, **options)</td></tr><tr><td><strong>IntegerField</strong></td><td>IntegerField(max_value=None, min_value=None)</td></tr><tr><td><strong>FloatField</strong></td><td>FloatField(max_value=None, min_value=None)</td></tr><tr><td><strong>DecimalField</strong></td><td>DecimalField(max_digits, decimal_places, coerce_to_string=None, max_value=None, min_value=None) max_digits: 最多位数 decimal_palces: 小数点位置</td></tr><tr><td><strong>DateTimeField</strong></td><td>DateTimeField(format=api_settings.DATETIME_FORMAT, input_formats=None)</td></tr><tr><td><strong>DateField</strong></td><td>DateField(format=api_settings.DATE_FORMAT, input_formats=None)</td></tr><tr><td><strong>TimeField</strong></td><td>TimeField(format=api_settings.TIME_FORMAT, input_formats=None)</td></tr><tr><td><strong>DurationField</strong></td><td>DurationField()</td></tr><tr><td><strong>ChoiceField</strong></td><td>ChoiceField(choices) choices与Django的用法相同</td></tr><tr><td><strong>MultipleChoiceField</strong></td><td>MultipleChoiceField(choices)</td></tr><tr><td><strong>FileField</strong></td><td>FileField(max_length=None, allow_empty_file=False, use_url=UPLOADED_FILES_USE_URL)</td></tr><tr><td><strong>ImageField</strong></td><td>ImageField(max_length=None, allow_empty_file=False, use_url=UPLOADED_FILES_USE_URL)</td></tr><tr><td><strong>ListField</strong></td><td>ListField(child=, min_length=None, max_length=None)</td></tr><tr><td><strong>DictField</strong></td><td>DictField(child=)</td></tr></tbody></table><p><strong>选项参数：</strong></p><table><thead><tr><th>参数名称</th><th>作用</th></tr></thead><tbody><tr><td><strong>max_length</strong></td><td>最大长度[适用于字符串，列表，文件]</td></tr><tr><td><strong>min_lenght</strong></td><td>最小长度[适用于字符串，列表，文件]</td></tr><tr><td><strong>allow_blank</strong></td><td>是否允许数据的值为空，如果使用这个选项，则前端传递过来的数据必须有这个属性。</td></tr><tr><td><strong>trim_whitespace</strong></td><td>是否截断空白字符</td></tr><tr><td><strong>max_value</strong></td><td>【数值】最小值</td></tr><tr><td><strong>min_value</strong></td><td>【数值】最大值</td></tr></tbody></table><p>通用参数：</p><table><thead><tr><th>参数名称</th><th>说明</th></tr></thead><tbody><tr><td><strong>read_only</strong></td><td>表明该字段仅用于序列化输出，默认False</td></tr><tr><td><strong>write_only</strong></td><td>表明该字段仅用于反序列化输入，默认False</td></tr><tr><td><strong>required</strong></td><td>表明该字段在反序列化时必须输入，默认True</td></tr><tr><td><strong>default</strong></td><td>反序列化时使用的默认值</td></tr><tr><td><strong>allow_null</strong></td><td>表明该字段是否允许传入None，默认False</td></tr><tr><td><strong>validators</strong></td><td>该字段使用的验证器</td></tr><tr><td><strong>error_messages</strong></td><td>包含错误编号与错误信息的字典</td></tr><tr><td><strong>label</strong></td><td>用于HTML展示API页面时，显示的字段名称</td></tr><tr><td><strong>help_text</strong></td><td>用于HTML展示API页面时，显示的字段帮助提示信息</td></tr></tbody></table><h2 id="7-2-创建Serializer对象"><a href="#7-2-创建Serializer对象" class="headerlink" title="7.2 创建Serializer对象"></a>7.2 创建Serializer对象</h2><p>定义好Serializer类后，就可以创建Serializer对象了。</p><p>Serializer的构造方法为：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Serializer(instance=<span class="literal">None</span>, data=empty, **kwarg)</span><br></pre></td></tr></table></figure><p>说明：</p><p>1）用于序列化时，将模型类对象传入<strong>instance</strong>参数</p><p>2）用于反序列化时，将要被反序列化的数据传入<strong>data</strong>参数</p><p>3）除了instance和data参数外，在构造Serializer对象时，还可通过<strong>context</strong>参数额外添加数据，如</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">serializer = StudentSerializer(student, context=&#123;<span class="string">'request'</span>: request&#125;,many=<span class="literal">False</span>)</span><br></pre></td></tr></table></figure><p><strong>通过context参数附加的数据，可以通过Serializer对象的self.context属性获取。</strong></p><ol><li>使用序列化器的时候一定要注意，序列化器声明了以后，不会自动执行，需要我们在视图中进行调用才可以。</li><li>序列化器无法直接接收客户端的请求数据，需要我们在视图中创建序列化器对象时把使用的数据传递过来。</li><li>序列化器的字段声明类似于我们前面使用过的表单系统。</li><li>开发restful api时，序列化器会帮我们把模型数据转换成字典.</li><li>drf提供的视图会帮我们把字典转换成json,或者把客户端发送过来的数据转换字典.</li></ol><h2 id="7-3-序列化器的使用"><a href="#7-3-序列化器的使用" class="headerlink" title="7.3 序列化器的使用"></a>7.3 序列化器的使用</h2><p>序列化器的使用分两个阶段：</p><ol><li>在客户端请求时，使用序列化器可以完成对数据的反序列化。</li><li>在服务器响应时，使用序列化器可以完成对数据的序列化。</li></ol><h3 id="7-3-1-序列化"><a href="#7-3-1-序列化" class="headerlink" title="7.3.1 序列化"></a>7.3.1 序列化</h3><h3 id="7-3-1-1-基本使用"><a href="#7-3-1-1-基本使用" class="headerlink" title="7.3.1.1 基本使用"></a>7.3.1.1 基本使用</h3><p>1） 先查询出一个学生对象</p><p>视图中获取模型对象，代码：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> students.models <span class="keyword">import</span> Student</span><br><span class="line"></span><br><span class="line">student = Student.objects.get(pk=<span class="number">3</span>)</span><br></pre></td></tr></table></figure><p>2） 构造序列化器对象</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> .serializers <span class="keyword">import</span> StudentSerializer</span><br><span class="line"></span><br><span class="line">serializer = StudentSerializer(instance=student)</span><br></pre></td></tr></table></figure><p>3）获取序列化数据</p><p>通过data属性可以获取序列化后的数据</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">serializer.data</span><br><span class="line"><span class="comment"># &#123;'id': 4, 'name': '小张', 'age': 18, 'sex': True, 'description': '猴赛雷'&#125;</span></span><br></pre></td></tr></table></figure><p>完整视图代码：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Student2APIView</span><span class="params">(View)</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get</span><span class="params">(self,request)</span>:</span></span><br><span class="line">        <span class="string">"""返回一个学生信息"""</span></span><br><span class="line">        <span class="comment"># 读取模型对象</span></span><br><span class="line">        student = Student.objects.get(pk=<span class="number">1</span>)</span><br><span class="line">        <span class="comment"># 实例化序列化器</span></span><br><span class="line">        serializer = StudentSerializer(instance=student)</span><br><span class="line">        print( serializer.data )</span><br><span class="line">        <span class="string">"""打印效果：</span></span><br><span class="line"><span class="string">        &#123;'id': 1, 'name': '张三', 'sex': True, 'age': 18&#125;</span></span><br><span class="line"><span class="string">        """</span></span><br><span class="line">        <span class="keyword">return</span> JsonResponse(serializer.data)</span><br></pre></td></tr></table></figure><p>4）如果要被序列化的是包含多条数据的查询集QuerySet，可以通过添加<strong>many=True</strong>参数补充说明</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">"""</span></span><br><span class="line"><span class="string">目前我们先学习序列化器，所以我们还是使用原来django内置的视图类和路由。</span></span><br><span class="line"><span class="string">使用序列化器对数据进行序列化器，一般用于返回数据给客户端。</span></span><br><span class="line"><span class="string">"""</span></span><br><span class="line"><span class="keyword">from</span> django.views <span class="keyword">import</span> View</span><br><span class="line"><span class="keyword">from</span> .serializers <span class="keyword">import</span> StudentSerializer</span><br><span class="line"><span class="keyword">from</span> students.models <span class="keyword">import</span> Student</span><br><span class="line"><span class="keyword">from</span> django.http.response <span class="keyword">import</span> JsonResponse</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Student1APIView</span><span class="params">(View)</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get</span><span class="params">(self,request)</span>:</span></span><br><span class="line">        <span class="string">"""返回所有学生给客户端"""</span></span><br><span class="line">        <span class="string">"""</span></span><br><span class="line"><span class="string">        序列化器对象初始化有３个参数:</span></span><br><span class="line"><span class="string">        1. instance，模型对象或者模型对象组成的列表，用于对数据进行序列化，把模型转换成字典</span></span><br><span class="line"><span class="string">        2. data，字典，用于对数据进行反序列化，把数据进行验证和保存到数据库</span></span><br><span class="line"><span class="string">        3. context，字典，用于把路由或者视图的自定义参数传递到序列化器里面使用</span></span><br><span class="line"><span class="string">                 context将来作为序列化器对象的子属性</span></span><br><span class="line"><span class="string">        4. many，当序列化器进行序列化时，如果模型有多个，则many必须为True</span></span><br><span class="line"><span class="string">        """</span></span><br><span class="line">        student_list = Student.objects.all()</span><br><span class="line">        serializer = StudentSerializer(instance=student_list, many=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line">        print(<span class="string">'student_list===&gt;'</span>,student_list)</span><br><span class="line">        print(<span class="string">'serializer===&gt;'</span>, serializer)</span><br><span class="line">        print(<span class="string">'转换的结果===&gt;'</span>, serializer.data)</span><br><span class="line">        <span class="string">"""打印效果：</span></span><br><span class="line"><span class="string">        [</span></span><br><span class="line"><span class="string">            OrderedDict([('name', '张三'), ('sex', True), ('age', 18), ('class_null', '3011')]), </span></span><br><span class="line"><span class="string">            OrderedDict([('name', '张三'), ('sex', True), ('age', 18), ('class_null', '309')]), </span></span><br><span class="line"><span class="string">            OrderedDict([('name', '张三'), ('sex', True), ('age', 18), ('class_null', '309')]), </span></span><br><span class="line"><span class="string">            ....    </span></span><br><span class="line"><span class="string">        ]</span></span><br><span class="line"><span class="string">        </span></span><br><span class="line"><span class="string">        说明：</span></span><br><span class="line"><span class="string">        OrderedDict是python内置的高级数据类型，表示有序字典，因为普通数据类型中的字典是无序的.</span></span><br><span class="line"><span class="string">        有序字典的成员读取方式，和无序字典一样</span></span><br><span class="line"><span class="string">        导入路径：</span></span><br><span class="line"><span class="string">        from collections import OrderedDict</span></span><br><span class="line"><span class="string">        """</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"># jsonResponse的第一个参数如果是列表则必须声明safe=False，否则报错如下：</span></span><br><span class="line">        <span class="comment"># In order to allow non-dict objects to be serialized set the safe parameter to False.</span></span><br><span class="line">        <span class="keyword">return</span> JsonResponse(serializer.data, safe=<span class="literal">False</span>)</span><br></pre></td></tr></table></figure><h3 id="7-3-2-反序列化"><a href="#7-3-2-反序列化" class="headerlink" title="7.3.2 反序列化"></a>7.3.2 反序列化</h3><h3 id="7-3-2-1-数据验证"><a href="#7-3-2-1-数据验证" class="headerlink" title="7.3.2.1 数据验证"></a>7.3.2.1 数据验证</h3><p>开发中，用户的数据都是不可信任的。</p><p>使用序列化器进行反序列化时，需要对数据进行验证后，才能获取验证成功的数据或保存成模型类对象。</p><p>在获取反序列化的客户端数据前，必须在视图中调用序列化对象的<strong>is_valid()</strong>方法，序列化器内部是在<strong>is_valid</strong>方法内部调用验证选项和验证方法进行验证，验证成功返回True，否则返回False。</p><p>验证失败，可以通过序列化器对象的<strong>errors</strong>属性获取错误信息，返回字典，包含了字段和字段的错误提示。如果是非字段错误，可以通过修改REST framework配置中的<strong>NON_FIELD_ERRORS_KEY</strong>来控制错误字典中的键名。</p><p>验证成功，可以通过序列化器对象的<strong>validated_data</strong>属性获取数据。</p><p>在定义序列化器时，指明每个字段的序列化类型和选项参数，本身就是一种验证行为。</p><p>为了方便演示，我们这里采用另一个图书模型来完成反序列化的学习。当然也创建一个新的子应用unsers。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python manage.py startapp unsers</span><br></pre></td></tr></table></figure><p>注册子应用，setting.py注册子应用，代码：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">INSTALLED_APPS = [</span><br><span class="line">    <span class="string">'django.contrib.admin'</span>,</span><br><span class="line">    <span class="string">'django.contrib.auth'</span>,</span><br><span class="line">    <span class="string">'django.contrib.contenttypes'</span>,</span><br><span class="line">    <span class="string">'django.contrib.sessions'</span>,</span><br><span class="line">    <span class="string">'django.contrib.messages'</span>,</span><br><span class="line">    <span class="string">'django.contrib.staticfiles'</span>,</span><br><span class="line"></span><br><span class="line">    <span class="string">'rest_framework'</span>, <span class="comment"># 把drf框架注册到django项目中</span></span><br><span class="line"></span><br><span class="line">    <span class="string">'students'</span>, <span class="comment"># 注册子应用</span></span><br><span class="line">    <span class="string">'sers'</span>,     <span class="comment"># 演示序列化</span></span><br><span class="line">    <span class="string">'unsers'</span>,     <span class="comment"># 演示反序列化</span></span><br><span class="line">]</span><br></pre></td></tr></table></figure><p>注意：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">接下来的内容涉及到postman post提交数据，所以在此时我们没有学习到drf视图方法时，我i们把settings.py中的中间件的csrf关闭.</span><br><span class="line"></span><br><span class="line">MIDDLEWARE = [</span><br><span class="line">    <span class="string">'django.middleware.security.SecurityMiddleware'</span>,</span><br><span class="line">    <span class="string">'django.contrib.sessions.middleware.SessionMiddleware'</span>,</span><br><span class="line">    <span class="string">'django.middleware.common.CommonMiddleware'</span>,</span><br><span class="line">    <span class="comment"># 'django.middleware.csrf.CsrfViewMiddleware',</span></span><br><span class="line">    <span class="string">'django.contrib.auth.middleware.AuthenticationMiddleware'</span>,</span><br><span class="line">    <span class="string">'django.contrib.messages.middleware.MessageMiddleware'</span>,</span><br><span class="line">    <span class="string">'django.middleware.clickjacking.XFrameOptionsMiddleware'</span>,</span><br><span class="line">]</span><br></pre></td></tr></table></figure><p>模型代码：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> django.db <span class="keyword">import</span> models</span><br><span class="line"></span><br><span class="line"><span class="comment"># Create your models here.</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">BookInfo</span><span class="params">(models.Model)</span>:</span></span><br><span class="line">    <span class="string">"""图书信息"""</span></span><br><span class="line">    title = models.CharField(max_length=<span class="number">20</span>, verbose_name=<span class="string">'标题'</span>)</span><br><span class="line">    pub_date = models.DateField(verbose_name=<span class="string">'发布日期'</span>)</span><br><span class="line">    image = models.ImageField(verbose_name=<span class="string">'图书封面'</span>)</span><br><span class="line">    price = models.DecimalField(max_digits=<span class="number">8</span>, decimal_places=<span class="number">2</span>, verbose_name=<span class="string">"价格"</span>)</span><br><span class="line">    read = models.IntegerField(verbose_name=<span class="string">'阅读量'</span>)</span><br><span class="line">    comment = models.IntegerField(verbose_name=<span class="string">'评论量'</span>)</span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">Meta</span>:</span></span><br><span class="line">        <span class="comment"># db_table = "表名"</span></span><br><span class="line">        db_table = <span class="string">"tb_book_info"</span></span><br><span class="line">        verbose_name = <span class="string">"图书"</span></span><br><span class="line">        verbose_name_plural = verbose_name</span><br></pre></td></tr></table></figure><p>注意：因为当前模型中， 设置到图片上传处理，所以我们需要安装<code>PIL</code>库</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install Pillow</span><br></pre></td></tr></table></figure><p>数据迁移</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python manage.py makemigrationspython manage.py migrate</span><br></pre></td></tr></table></figure><p>经过上面的准备工作，我们接下来就可以给图书信息增加图书的功能，那么我们需要对来自客户端的数据进行处理，例如，验证和保存到数据库中，此时，我们就可以使用序列化器的反序列化器，接下来，我们就可以参考之前定义学生信息的序列化器那样，定义一个图书的序列化器，当然，不同的是，接下来的序列化器主要用于反序列化器阶段，在unsers子应用，创建serializers.py，代码如下：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> rest_framework <span class="keyword">import</span> serializers</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">BookInfoSerializer</span><span class="params">(serializers.Serializer)</span>:</span></span><br><span class="line">    <span class="comment"># 这里声明的字段用于进行反序列化器</span></span><br><span class="line">    <span class="comment"># 字段名 = serializers.字段类型(验证选项)</span></span><br><span class="line">    title = serializers.CharField(max_length=<span class="number">20</span>, label=<span class="string">"标题"</span>, help_text=<span class="string">"标题"</span>)</span><br><span class="line">    <span class="comment"># required=True 当前字段必填</span></span><br><span class="line">    pub_date = serializers.DateField(required=<span class="literal">True</span>,label=<span class="string">"发布日期"</span>, help_text=<span class="string">"发布日期"</span>)</span><br><span class="line">    image = serializers.ImageField(max_length=<span class="number">3</span>*<span class="number">1024</span>*<span class="number">1024</span>, label=<span class="string">"图书封面"</span>, help_text=<span class="string">"图书封面"</span>)</span><br><span class="line">    price = serializers.DecimalField(max_digits=<span class="number">8</span>, decimal_places=<span class="number">2</span>, required=<span class="literal">True</span>, label=<span class="string">"价格"</span>, help_text=<span class="string">"价格"</span>)</span><br><span class="line">    read  = serializers.IntegerField(min_value=<span class="number">0</span>, default=<span class="number">0</span>, label=<span class="string">"阅读量"</span>, help_text=<span class="string">"阅读量"</span>)</span><br><span class="line">    comment = serializers.IntegerField(min_value=<span class="number">0</span>, default=<span class="number">0</span>, label=<span class="string">"评论量"</span>, help_text=<span class="string">"评论量"</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 关于继承数据库选项</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 验证部分的代码</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 数据库</span></span><br></pre></td></tr></table></figure><p>通过构造序列化器对象，并将要反序列化的数据传递给data构造参数，进而进行验证</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Create your views here.</span></span><br><span class="line"><span class="keyword">from</span> django.views <span class="keyword">import</span> View</span><br><span class="line"><span class="keyword">from</span> django.http.response <span class="keyword">import</span> HttpResponse</span><br><span class="line"><span class="keyword">from</span> .serializers <span class="keyword">import</span> BookInfoSerializer</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">BookInfoView</span><span class="params">(View)</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get</span><span class="params">(self,request)</span>:</span></span><br><span class="line">        <span class="string">"""模拟客户端发送过来的数据"""</span></span><br><span class="line">        data = &#123;</span><br><span class="line">            <span class="string">"title"</span>:<span class="string">"西厢记"</span>,</span><br><span class="line">            <span class="string">"pub_date"</span>:<span class="string">"1980-10-10"</span>,</span><br><span class="line">            <span class="string">"price"</span>: <span class="number">19.80</span>,</span><br><span class="line">            <span class="string">"read"</span>: <span class="number">100</span>,</span><br><span class="line">            <span class="string">"comment"</span>: <span class="number">-1</span>,</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 对上面的数据进行反序列化器处理</span></span><br><span class="line">        <span class="comment"># 1. 初始化，填写data属性</span></span><br><span class="line">        serializer = BookInfoSerializer(data=data)</span><br><span class="line">        <span class="comment"># 2. 调用序列化器提供的is_valid方法进行验证</span></span><br><span class="line">        <span class="comment"># raise_exception=True 表示终断程序，直接抛出错误</span></span><br><span class="line">        ret = serializer.is_valid(raise_exception=<span class="literal">True</span>)</span><br><span class="line">        print(ret) <span class="comment"># is_valid的方法值就是验证结果，只会是True/False</span></span><br><span class="line">        <span class="keyword">if</span> ret:</span><br><span class="line">            <span class="comment"># 3.1 验证通过后，可以通过validated_data得到数据</span></span><br><span class="line">            print(<span class="string">"验证成功，ret=%s"</span> % ret)</span><br><span class="line">            print(serializer.validated_data)  <span class="comment"># 验证处理后的数据</span></span><br><span class="line">            <span class="string">"""打印结果：</span></span><br><span class="line"><span class="string">            OrderedDict([('title', '西厢记'), ('pub_date', datetime.date(1980, 10, 10)), ('price', Decimal('19.80')), ('read', 100), ('comment', 15)])</span></span><br><span class="line"><span class="string">            """</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            print(<span class="string">"验证失败，ret=%s"</span> % ret)</span><br><span class="line">            <span class="comment"># 3.1 验证没通过，可以通过</span></span><br><span class="line">            print( serializer.errors )</span><br><span class="line">            <span class="string">"""打印结果：</span></span><br><span class="line"><span class="string">            &#123;'comment': [ErrorDetail(string='Ensure this value is greater than or equal to 0.', code='min_value')]&#125;</span></span><br><span class="line"><span class="string">            """</span></span><br><span class="line">        <span class="keyword">return</span> HttpResponse(<span class="string">"ok"</span>)</span><br></pre></td></tr></table></figure><p>is_valid()方法还可以在验证失败时抛出异常serializers.ValidationError，可以通过传递<strong>raise_exception=True</strong>参数开启，REST framework接收到此异常，会向前端返回HTTP 400 Bad Request响应。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Return a 400 response if the data was invalid.</span></span><br><span class="line">serializer.is_valid(raise_exception=<span class="literal">True</span>)</span><br></pre></td></tr></table></figure><p>如果觉得这些还不够，需要再补充定义验证行为，可以使用以下三种方法：</p><h3 id="1-validate-字段名"><a href="#1-validate-字段名" class="headerlink" title="1) validate_字段名"></a>1) validate_字段名</h3><p>对<code>&lt;field_name&gt;</code>字段进行验证，如</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">BookInfoSerializer</span><span class="params">(serializers.Serializer)</span>:</span></span><br><span class="line">    <span class="string">"""图书数据序列化器"""</span></span><br><span class="line">    ...</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 单个字段的验证，方法名必须： validate_&lt;字段名&gt;(self,data)    # data 就是当前字段中客户端提交的数据</span></span><br><span class="line">    <span class="comment"># validate_price 会被is_valid调用</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">validate_price</span><span class="params">(self, data)</span>:</span></span><br><span class="line">        <span class="string">""""""</span></span><br><span class="line">        <span class="keyword">if</span> data &lt; <span class="number">0</span>:</span><br><span class="line">            <span class="keyword">raise</span> serializers.ValidationError(<span class="string">"对不起，价格不能低于0元"</span>)</span><br><span class="line">        <span class="comment"># 验证通过以后，必须要返回验证的结果数据，否则序列化器的validated_data无法得到当前字段的结果</span></span><br><span class="line">        <span class="keyword">return</span> data</span><br></pre></td></tr></table></figure><p>把前面的例子的price改为-19.80，运行就可以测试了。</p><h3 id="2-validate"><a href="#2-validate" class="headerlink" title="2) validate"></a>2) validate</h3><p>在序列化器中需要同时对多个字段进行比较验证时，可以定义validate方法来验证，如</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">BookInfoSerializer</span><span class="params">(serializers.Serializer)</span>:</span></span><br><span class="line">    <span class="string">"""图书数据序列化器"""</span></span><br><span class="line">    ...</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 多个字段的验证，必须方法名叫 "validate"</span></span><br><span class="line">    <span class="comment"># data 表示客户端发送过来的所有数据，字典格式</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">validate</span><span class="params">(self, data)</span>:</span></span><br><span class="line">        <span class="comment"># 判断图书的阅读量不能低于评论量</span></span><br><span class="line">        read = data.get(<span class="string">"read"</span>)</span><br><span class="line">        comment = data.get(<span class="string">"comment"</span>)</span><br><span class="line">        <span class="keyword">if</span> read &lt; comment:</span><br><span class="line">            <span class="keyword">raise</span> serializers.ValidationError(<span class="string">"对不起，阅读量不能低于评论量"</span>)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> data</span><br></pre></td></tr></table></figure><p>运行之前的例子，把read改为1，comment改为100，访问测试。</p><h3 id="3-validators验证器"><a href="#3-validators验证器" class="headerlink" title="3) validators验证器"></a>3) validators验证器</h3><p>验证器类似于验证方法，但是验证方法只属于当前序列化器，如果有多个序列化器共用同样的验证功能，则可以把验证代码分离到序列化器外部，作为一个普通函数，由validators加载到序列化器中使用。</p><p>在字段中添加validators选项参数，也可以补充验证行为，如</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> rest_framework <span class="keyword">import</span> serializers</span><br><span class="line"></span><br><span class="line"><span class="comment"># 可以把验证函数进行多次使用，提供不用的字段或者不同的序列化器里面使用</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">about_django</span><span class="params">(data)</span>:</span></span><br><span class="line">    <span class="keyword">if</span> <span class="string">"django"</span> <span class="keyword">in</span> data:</span><br><span class="line">        <span class="keyword">raise</span> serializers.ValidationError(<span class="string">"对不起，图书标题不能出现关键字django"</span>)</span><br><span class="line">    <span class="comment"># 返回验证以后的数据</span></span><br><span class="line">    <span class="keyword">return</span> data</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">BookInfoSerializer</span><span class="params">(serializers.Serializer)</span>:</span></span><br><span class="line">    <span class="comment"># 这里声明的字段用于进行反序列化器</span></span><br><span class="line">    <span class="comment"># 字段名 = serializers.字段类型(验证选项)</span></span><br><span class="line">    title = serializers.CharField(max_length=<span class="number">20</span>,validators=[about_django], label=<span class="string">"标题"</span>, help_text=<span class="string">"标题"</span>)</span><br><span class="line">    <span class="comment"># required=True 当前字段必填</span></span><br><span class="line">    pub_date = serializers.DateField(required=<span class="literal">True</span>, label=<span class="string">"发布日期"</span>, help_text=<span class="string">"发布日期"</span>)</span><br><span class="line">    <span class="comment"># max_length 文件的大小</span></span><br><span class="line">    <span class="comment"># allow_null=True 允许传递的image数据为None</span></span><br><span class="line">    image = serializers.ImageField(required=<span class="literal">False</span>, allow_null=<span class="literal">True</span>, max_length=<span class="number">3</span>*<span class="number">1024</span>*<span class="number">1024</span>, label=<span class="string">"图书封面"</span>, help_text=<span class="string">"图书封面"</span>)</span><br><span class="line">    price = serializers.DecimalField(max_digits=<span class="number">8</span>, decimal_places=<span class="number">2</span>, required=<span class="literal">True</span>, label=<span class="string">"价格"</span>, help_text=<span class="string">"价格"</span>)</span><br><span class="line">    <span class="comment"># min_value 数值大小</span></span><br><span class="line">    <span class="comment"># default 设置默认值</span></span><br><span class="line">    read  = serializers.IntegerField(min_value=<span class="number">0</span>, default=<span class="number">0</span>, label=<span class="string">"阅读量"</span>, help_text=<span class="string">"阅读量"</span>)</span><br><span class="line">    comment = serializers.IntegerField(min_value=<span class="number">0</span>, default=<span class="number">0</span>, label=<span class="string">"评论量"</span>, help_text=<span class="string">"评论量"</span>)</span><br></pre></td></tr></table></figure><p>把前面的例子修改成title=“西厢记django版本”，然后运行测试</p><p>视图代码：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Create your views here.</span></span><br><span class="line"><span class="keyword">from</span> django.views <span class="keyword">import</span> View</span><br><span class="line"><span class="keyword">from</span> django.http.response <span class="keyword">import</span> HttpResponse</span><br><span class="line"><span class="keyword">from</span> .serializers <span class="keyword">import</span> BookInfoSerializer</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">BookInfoView</span><span class="params">(View)</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get</span><span class="params">(self,request)</span>:</span></span><br><span class="line">        <span class="string">"""模拟客户端发送过来的数据"""</span></span><br><span class="line">        data = &#123;</span><br><span class="line">            <span class="string">"title"</span>:<span class="string">"西厢记django版本"</span>,</span><br><span class="line">            <span class="string">"pub_date"</span>:<span class="string">"1980-10-10"</span>,</span><br><span class="line">            <span class="string">"price"</span>: <span class="number">19.80</span>,</span><br><span class="line">            <span class="string">"read"</span>: <span class="number">10000</span>,</span><br><span class="line">            <span class="string">"comment"</span>: <span class="number">100</span>,</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 对上面的数据进行反序列化器处理</span></span><br><span class="line">        <span class="comment"># 1. 初始化，填写data属性</span></span><br><span class="line">        serializer = BookInfoSerializer(data=data)</span><br><span class="line">        <span class="comment"># 2. 调用序列化器提供的is_valid方法进行验证</span></span><br><span class="line">        <span class="comment"># raise_exception=True 表示终断程序，直接抛出错误</span></span><br><span class="line">        ret = serializer.is_valid(raise_exception=<span class="literal">True</span>)</span><br><span class="line">        print(ret) <span class="comment"># is_valid的方法值就是验证结果，只会是True/False</span></span><br><span class="line">        <span class="keyword">if</span> ret:</span><br><span class="line">            <span class="comment"># 3.1 验证通过后，可以通过validated_data得到数据</span></span><br><span class="line">            print(<span class="string">"验证成功，ret=%s"</span> % ret)</span><br><span class="line">            print(serializer.validated_data)  <span class="comment"># 验证处理后的数据</span></span><br><span class="line">            <span class="string">"""打印结果：</span></span><br><span class="line"><span class="string">            OrderedDict([('title', '西厢记'), ('pub_date', datetime.date(1980, 10, 10)), ('price', Decimal('19.80')), ('read', 100), ('comment', 15)])</span></span><br><span class="line"><span class="string">            """</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            print(<span class="string">"验证失败，ret=%s"</span> % ret)</span><br><span class="line">            <span class="comment"># 3.1 验证没通过，可以通过</span></span><br><span class="line">            print( serializer.errors )</span><br><span class="line">            <span class="string">"""打印结果：</span></span><br><span class="line"><span class="string">            &#123;'comment': [ErrorDetail(string='Ensure this value is greater than or equal to 0.', code='min_value')]&#125;</span></span><br><span class="line"><span class="string">            """</span></span><br><span class="line">        <span class="keyword">return</span> HttpResponse(<span class="string">"ok"</span>)</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">is_valid实际上内部执行了三种不同的验证方式：</span><br><span class="line"><span class="number">1.</span> 先执行了字段内置的验证选项</span><br><span class="line"><span class="number">2.</span> 在执行了validators自定义选项</span><br><span class="line"><span class="number">3.</span> 最后执行了validate自定义验证方法[包含了validate_&lt;字段&gt;, validate]</span><br></pre></td></tr></table></figure><h3 id="7-3-2-2-数据保存"><a href="#7-3-2-2-数据保存" class="headerlink" title="7.3.2.2 数据保存"></a>7.3.2.2 数据保存</h3><p>通过序列化器来完成数据的更新或者添加，把视图中对于模型中的操作代码移出视图中，放入到序列化器。</p><p>前面的验证数据成功后,我们可以使用序列化器来完成数据反序列化的过程.这个过程可以把数据转成模型类对象.</p><p>可以通过实现create()和update()两个方法来实现。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> rest_framework <span class="keyword">import</span> serializers</span><br><span class="line"></span><br><span class="line"><span class="comment"># 可以把验证函数进行多次使用，提供不用的字段或者不同的序列化器里面使用</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">about_django</span><span class="params">(data)</span>:</span></span><br><span class="line">    <span class="keyword">if</span> <span class="string">"django"</span> <span class="keyword">in</span> data:</span><br><span class="line">        <span class="keyword">raise</span> serializers.ValidationError(<span class="string">"对不起，图书标题不能出现关键字django"</span>)</span><br><span class="line">    <span class="comment"># 返回验证以后的数据</span></span><br><span class="line">    <span class="keyword">return</span> data</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">BookInfoSerializer</span><span class="params">(serializers.Serializer)</span>:</span></span><br><span class="line">    <span class="comment"># 这里声明的字段用于进行反序列化器</span></span><br><span class="line">    <span class="comment"># 字段名 = serializers.字段类型(验证选项)</span></span><br><span class="line">    title = serializers.CharField(max_length=<span class="number">20</span>,validators=[about_django], label=<span class="string">"标题"</span>, help_text=<span class="string">"标题"</span>)</span><br><span class="line">    <span class="comment"># required=True 当前字段必填</span></span><br><span class="line">    pub_date = serializers.DateField(required=<span class="literal">True</span>, label=<span class="string">"发布日期"</span>, help_text=<span class="string">"发布日期"</span>)</span><br><span class="line">    <span class="comment"># max_length 文件的大小</span></span><br><span class="line">    <span class="comment"># allow_null=True 允许传递的image数据为None</span></span><br><span class="line">    image = serializers.ImageField(required=<span class="literal">False</span>, allow_null=<span class="literal">True</span>, max_length=<span class="number">3</span>*<span class="number">1024</span>*<span class="number">1024</span>, label=<span class="string">"图书封面"</span>, help_text=<span class="string">"图书封面"</span>)</span><br><span class="line">    price = serializers.DecimalField(max_digits=<span class="number">8</span>, decimal_places=<span class="number">2</span>, required=<span class="literal">True</span>, label=<span class="string">"价格"</span>, help_text=<span class="string">"价格"</span>)</span><br><span class="line">    <span class="comment"># min_value 数值大小</span></span><br><span class="line">    <span class="comment"># default 设置默认值</span></span><br><span class="line">    read  = serializers.IntegerField(min_value=<span class="number">0</span>, default=<span class="number">0</span>, label=<span class="string">"阅读量"</span>, help_text=<span class="string">"阅读量"</span>)</span><br><span class="line">    comment = serializers.IntegerField(min_value=<span class="number">0</span>, default=<span class="number">0</span>, label=<span class="string">"评论量"</span>, help_text=<span class="string">"评论量"</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 关于继承数据库选项</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 自定义验证的代码</span></span><br><span class="line">    <span class="comment"># 单个字段的验证，方法名必须： validate_&lt;字段名&gt;(self,data)    # data 就是当前字段中客户端提交的数据</span></span><br><span class="line">    <span class="comment"># validate_price 会被is_valid调用</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">validate_price</span><span class="params">(self, data)</span>:</span></span><br><span class="line">        <span class="string">""""""</span></span><br><span class="line">        <span class="keyword">if</span> data &lt; <span class="number">0</span>:</span><br><span class="line">            <span class="keyword">raise</span> serializers.ValidationError(<span class="string">"对不起，价格不能低于0元"</span>)</span><br><span class="line">        <span class="comment"># 验证通过以后，必须要返回验证的结果数据，否则序列化器的validated_data无法得到当前字段的结果</span></span><br><span class="line">        <span class="keyword">return</span> data</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 多个字段的验证，必须方法名叫 "validate"</span></span><br><span class="line">    <span class="comment"># data 表示客户端发送过来的所有数据，字典格式</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">validate</span><span class="params">(self, data)</span>:</span></span><br><span class="line">        <span class="comment"># 判断图书的阅读量不能低于评论量</span></span><br><span class="line">        read = data.get(<span class="string">"read"</span>)</span><br><span class="line">        comment = data.get(<span class="string">"comment"</span>)</span><br><span class="line">        <span class="keyword">if</span> read &lt; comment:</span><br><span class="line">            <span class="keyword">raise</span> serializers.ValidationError(<span class="string">"对不起，阅读量不能低于评论量"</span>)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> data</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 数据库操作</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">create</span><span class="params">(self, validated_data)</span>:</span> <span class="comment"># 这里会在调用时，由序列化器补充验证成功以后的数据进来</span></span><br><span class="line">        <span class="string">"""完成添加操作"""</span></span><br><span class="line">        print(validated_data) <span class="comment"># 字典</span></span><br><span class="line">        <span class="comment"># 导入模型</span></span><br><span class="line">        <span class="keyword">from</span> .models <span class="keyword">import</span> BookInfo</span><br><span class="line">        <span class="comment"># 添加数据</span></span><br><span class="line">        book = BookInfo.objects.create(</span><br><span class="line">            title=validated_data.get(<span class="string">"title"</span>),</span><br><span class="line">            price=validated_data.get(<span class="string">"price"</span>),</span><br><span class="line">            pub_date=validated_data.get(<span class="string">"pub_date"</span>),</span><br><span class="line">            read=validated_data.get(<span class="string">"read"</span>),</span><br><span class="line">            comment=validated_data.get(<span class="string">"comment"</span>),</span><br><span class="line">        )</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> book</span><br><span class="line"></span><br><span class="line">    <span class="comment"># instance就是要修改的模型，系统会自动从对象初始化时的instance提取过来</span></span><br><span class="line">    <span class="comment"># validated_data 就是经过验证以后的客户端提交的数据</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">update</span><span class="params">(self, instance, validated_data)</span>:</span></span><br><span class="line">        <span class="string">"""更新操作"""</span></span><br><span class="line">        instance.title = validated_data.get(<span class="string">'title'</span>)</span><br><span class="line">        instance.pub_date = validated_data.get(<span class="string">'pub_date'</span>)</span><br><span class="line">        instance.comment = validated_data.get(<span class="string">'comment'</span>)</span><br><span class="line">        instance.price = validated_data.get(<span class="string">'price'</span>)</span><br><span class="line">        instance.read = validated_data.get(<span class="string">'read'</span>)</span><br><span class="line">        instance.save()</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> instance</span><br><span class="line"></span><br><span class="line"><span class="comment"># 编写的create和update方法都是对于数据库的操作，所以不能保证百分百的操作成功,那么此时我们应该在数据库操作中进行容错处理</span></span><br><span class="line"><span class="comment"># try...except...，当然自然也需要抛出异常提供给视图,由视图转发给客户端,抛出异常则使用raise serializers.ValidationError</span></span><br></pre></td></tr></table></figure><p>视图代码：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Create your views here.</span></span><br><span class="line"><span class="keyword">from</span> django.views <span class="keyword">import</span> View</span><br><span class="line"><span class="keyword">from</span> django.http.response <span class="keyword">import</span> HttpResponse</span><br><span class="line"><span class="keyword">from</span> .serializers <span class="keyword">import</span> BookInfoSerializer</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">BookInfoView</span><span class="params">(View)</span>:</span></span><br><span class="line">    <span class="comment"># ...</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get</span><span class="params">(self,request)</span>:</span></span><br><span class="line">        <span class="string">"""保存数据[更新]"""</span></span><br><span class="line">        <span class="comment"># 客户端提交数据过来</span></span><br><span class="line">        id = <span class="number">2</span></span><br><span class="line">        data = &#123; <span class="comment"># 模拟客户端发送过来的数据</span></span><br><span class="line">            <span class="string">"title"</span>: <span class="string">"东游记"</span>,</span><br><span class="line">            <span class="string">"pub_date"</span>: <span class="string">"1998-10-01"</span>,</span><br><span class="line">            <span class="string">"price"</span>: <span class="number">19.98</span>,</span><br><span class="line">            <span class="string">"read"</span>: <span class="number">330</span>,</span><br><span class="line">            <span class="string">"comment"</span>: <span class="number">100</span>,</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">from</span> .models <span class="keyword">import</span> BookInfo</span><br><span class="line">        book = BookInfo.objects.get(pk=id)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 使用序列化器验证数据[如果是更新操作，需要传入2个参数，分别是instance和data]</span></span><br><span class="line">        serializer = BookInfoSerializer(instance=book,data=data)</span><br><span class="line">        serializer.is_valid()</span><br><span class="line">        book = serializer.save() <span class="comment"># 此时，我们必须在序列化器中预先声明update方法</span></span><br><span class="line">        <span class="string">"""</span></span><br><span class="line"><span class="string">        serailzier对象调用的save方法是什么？怎么做到自动调用update和create?</span></span><br><span class="line"><span class="string">        1. 这里的save不是数据库ORM模型对象的save，是BaseSerializer定义的。</span></span><br><span class="line"><span class="string">        2. save方法中根据实例化serializer时是否传入instance参数来判断执行update还是create的</span></span><br><span class="line"><span class="string">           当传入instance时，则instance.save调用的就是update方法</span></span><br><span class="line"><span class="string">           没有传入instance，则instance.save调用的就是create方法</span></span><br><span class="line"><span class="string">        3. serializer.save使用前提是必须在序列化器中声明create或者update方法，否则报错！！！</span></span><br><span class="line"><span class="string">        """</span></span><br><span class="line">        print(book)</span><br><span class="line">        <span class="string">"""打印结果：</span></span><br><span class="line"><span class="string">        BookInfo object (2)</span></span><br><span class="line"><span class="string">        """</span></span><br><span class="line">        <span class="keyword">return</span> HttpResponse(<span class="string">"ok"</span>)</span><br></pre></td></tr></table></figure><p>在序列化器实现了create和update两个方法后，在反序列化数据的时候，就可以通过save()方法返回一个数据对象实例了</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">book = serializer.save()</span><br></pre></td></tr></table></figure><p>如果创建序列化器对象的时候，没有传递instance实例，则调用save()方法的时候，create()被调用，相反，如果传递了instance实例，则调用save()方法的时候，update()被调用。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">serailzier对象调用的save方法是什么？怎么做到自动调用update和create?</span><br><span class="line"><span class="number">1.</span> 这里的save不是数据库ORM模型对象的save，是BaseSerializer定义的。</span><br><span class="line"><span class="number">2.</span> save方法中根据实例化serializer时是否传入instance参数来判断执行update还是create的</span><br><span class="line">当传入instance时，则instance.save调用的就是update方法</span><br><span class="line">没有传入instance，则instance.save调用的就是create方法</span><br><span class="line"><span class="number">3.</span> serializer.save使用前提是必须在序列化器中声明create或者update方法，否则报错！！！</span><br></pre></td></tr></table></figure><p>BaseSerializer中定义的save方法源码：</p><p><img src="/images/1582086563954.png" alt=""></p><h3 id="7-3-2-3-附加参数说明"><a href="#7-3-2-3-附加参数说明" class="headerlink" title="7.3.2.3 附加参数说明"></a>7.3.2.3 附加参数说明</h3><p>1） 在对序列化器进行save()保存时，可以额外传递数据，这些数据可以在create()和update()中的validated_data参数获取到</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 可以传递任意参数到数据保存方法中</span></span><br><span class="line"><span class="comment"># 例如：request.user 是django中记录当前登录用户的模型对象</span></span><br><span class="line">serializer.save(owner=request.user)</span><br></pre></td></tr></table></figure><p>2）默认序列化器必须传递所有必填字段[required=True]，否则会抛出验证异常。但是我们可以使用partial参数来允许部分字段更新</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Update `BookInfo` with partial data</span></span><br><span class="line"><span class="comment"># partial=True 设置序列化器只是针对客户端提交的字段进行验证，没有提交的字段，即便有验证选项或方法也不进行验证。</span></span><br><span class="line">serializer = BookInfoSerializer(book, data=data, partial=<span class="literal">True</span>)</span><br></pre></td></tr></table></figure><h3 id="7-3-3-模型类序列化器"><a href="#7-3-3-模型类序列化器" class="headerlink" title="7.3.3 模型类序列化器"></a>7.3.3 模型类序列化器</h3><p>如果我们想要使用序列化器对应的是Django的模型类，DRF为我们提供了ModelSerializer模型类序列化器来帮助我们快速创建一个Serializer类。</p><p>ModelSerializer与常规的Serializer相同，但提供了：</p><ul><li>基于模型类自动生成一系列序列化器字段</li><li>基于模型类自动为Serializer生成validators，比如unique_together</li><li>包含默认的create()和update()的实现</li></ul><h3 id="7-3-3-1-定义"><a href="#7-3-3-1-定义" class="headerlink" title="7.3.3.1 定义"></a>7.3.3.1 定义</h3><p>比如我们创建一个BookInfoSerializer</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">BookInfoSerializer</span><span class="params">(serializers.ModelSerializer)</span>:</span></span><br><span class="line">    <span class="string">"""图书数据序列化器"""</span></span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">Meta</span>:</span></span><br><span class="line">        model = BookInfo</span><br><span class="line">        fields = <span class="string">'__all__'</span></span><br></pre></td></tr></table></figure><ul><li>model 指明参照哪个模型类</li><li>fields 指明为模型类的哪些字段生成</li></ul><p>我们可以在python manage.py shell中查看自动生成的BookInfoSerializer的具体实现</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">from</span> booktest.serializers <span class="keyword">import</span> BookInfoSerializer</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>serializer = BookInfoSerializer()</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>serializer</span><br><span class="line">BookInfoSerializer():</span><br><span class="line">    id = IntegerField(label=<span class="string">'ID'</span>, read_only=<span class="literal">True</span>)</span><br><span class="line">    btitle = CharField(label=<span class="string">'名称'</span>, max_length=<span class="number">20</span>)</span><br><span class="line">    bpub_date = DateField(allow_null=<span class="literal">True</span>, label=<span class="string">'发布日期'</span>, required=<span class="literal">False</span>)</span><br><span class="line">    bread = IntegerField(label=<span class="string">'阅读量'</span>, max_value=<span class="number">2147483647</span>, min_value=<span class="number">-2147483648</span>, required=<span class="literal">False</span>)</span><br><span class="line">    bcomment = IntegerField(label=<span class="string">'评论量'</span>, max_value=<span class="number">2147483647</span>, min_value=<span class="number">-2147483648</span>, required=<span class="literal">False</span>)</span><br><span class="line">    image = ImageField(allow_null=<span class="literal">True</span>, label=<span class="string">'图片'</span>, max_length=<span class="number">100</span>, required=<span class="literal">False</span>)</span><br></pre></td></tr></table></figure><h3 id="7-3-3-2-指定字段"><a href="#7-3-3-2-指定字段" class="headerlink" title="7.3.3.2 指定字段"></a>7.3.3.2 指定字段</h3><ul><li>使用<strong>fields</strong>来明确字段，<code>__all__</code>表名包含所有字段，也可以写明具体哪些字段，如</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">BookInfoSerializer</span><span class="params">(serializers.ModelSerializer)</span>:</span></span><br><span class="line">    <span class="string">"""图书数据序列化器"""</span></span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">Meta</span>:</span></span><br><span class="line">        model = BookInfo</span><br><span class="line">        fields = (<span class="string">'id'</span>, <span class="string">'btitle'</span>, <span class="string">'bpub_date'</span>)</span><br></pre></td></tr></table></figure><ul><li>使用<strong>exclude</strong>可以明确排除掉哪些字段</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">BookInfoSerializer</span><span class="params">(serializers.ModelSerializer)</span>:</span></span><br><span class="line">    <span class="string">"""图书数据序列化器"""</span></span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">Meta</span>:</span></span><br><span class="line">        model = BookInfo</span><br><span class="line">        exclude = (<span class="string">'image'</span>,)</span><br></pre></td></tr></table></figure><ul><li>显示指明字段，如：</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">HeroInfoSerializer</span><span class="params">(serializers.ModelSerializer)</span>:</span></span><br><span class="line">    hbook = BookInfoSerializer()</span><br><span class="line"></span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">Meta</span>:</span></span><br><span class="line">        model = HeroInfo</span><br><span class="line">        fields = (<span class="string">'id'</span>, <span class="string">'hname'</span>, <span class="string">'hgender'</span>, <span class="string">'hcomment'</span>, <span class="string">'hbook'</span>)</span><br></pre></td></tr></table></figure><ul><li>指明只读字段</li></ul><p>可以通过<strong>read_only_fields</strong>指明只读字段，即仅用于序列化输出的字段</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">BookInfoSerializer</span><span class="params">(serializers.ModelSerializer)</span>:</span></span><br><span class="line">    <span class="string">"""图书数据序列化器"""</span></span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">Meta</span>:</span></span><br><span class="line">        model = BookInfo</span><br><span class="line">        fields = (<span class="string">'id'</span>, <span class="string">'title'</span>, <span class="string">'pub_date'</span>， <span class="string">'read'</span>, <span class="string">'comment'</span>)</span><br><span class="line">        read_only_fields = (<span class="string">'id'</span>, <span class="string">'read'</span>, <span class="string">'comment'</span>)</span><br></pre></td></tr></table></figure><h3 id="7-3-3-3-添加额外参数"><a href="#7-3-3-3-添加额外参数" class="headerlink" title="7.3.3.3 添加额外参数"></a>7.3.3.3 添加额外参数</h3><p>我们可以使用<strong>extra_kwargs</strong>参数为ModelSerializer添加或修改原有的选项参数</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">BookInfoSerializer</span><span class="params">(serializers.ModelSerializer)</span>:</span></span><br><span class="line">    <span class="string">"""图书数据序列化器"""</span></span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">Meta</span>:</span></span><br><span class="line">        model = BookInfo</span><br><span class="line">        fields = (<span class="string">'id'</span>, <span class="string">'btitle'</span>, <span class="string">'bpub_date'</span>, <span class="string">'bread'</span>, <span class="string">'bcomment'</span>)</span><br><span class="line">        extra_kwargs = &#123;</span><br><span class="line">            <span class="string">'bread'</span>: &#123;<span class="string">'min_value'</span>: <span class="number">0</span>, <span class="string">'required'</span>: <span class="literal">True</span>&#125;,</span><br><span class="line">            <span class="string">'bcomment'</span>: &#123;<span class="string">'min_value'</span>: <span class="number">0</span>, <span class="string">'required'</span>: <span class="literal">True</span>&#125;,</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># BookInfoSerializer():</span></span><br><span class="line"><span class="comment">#    id = IntegerField(label='ID', read_only=True)</span></span><br><span class="line"><span class="comment">#    btitle = CharField(label='名称', max_length=20)</span></span><br><span class="line"><span class="comment">#    bpub_date = DateField(allow_null=True, label='发布日期', required=False)</span></span><br><span class="line"><span class="comment">#    bread = IntegerField(label='阅读量', max_value=2147483647, min_value=0, required=True)</span></span><br><span class="line"><span class="comment">#    bcomment = IntegerField(label='评论量', max_value=2147483647, min_value=0, required=True)</span></span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      序列化器 作用：1. 序列化,序列化器会把模型对象转换成字典,将来提供给视图经过response以后变成json字符串2. 反序列化,把客户端发送过来的数据,经过视图调用request以后变成python字典,序列化器可以把字典转成...
    
    </summary>
    
    
      <category term="python" scheme="http://yoursite.com/categories/python/"/>
    
    
      <category term="Django Rest_Framework" scheme="http://yoursite.com/tags/Django-Rest-Framework/"/>
    
  </entry>
  
  <entry>
    <title>[restful API规范与DRF安装]</title>
    <link href="http://yoursite.com/2020/04/22/API%E8%A7%84%E8%8C%83%E4%B8%8Edrf%E5%AE%89%E8%A3%85/"/>
    <id>http://yoursite.com/2020/04/22/API%E8%A7%84%E8%8C%83%E4%B8%8Edrf%E5%AE%89%E8%A3%85/</id>
    <published>2020-04-22T08:03:56.000Z</published>
    <updated>2020-04-23T10:52:33.000Z</updated>
    
    <content type="html"><![CDATA[<p>程序的客户端有很多：硬件设备，游戏，APP，软件，其他的外部服务端。</p><h1 id="1-Web应用模式"><a href="#1-Web应用模式" class="headerlink" title="1. Web应用模式"></a>1. Web应用模式</h1><p>在开发Web应用中，有两种应用模式：</p><ol><li><p>前后端不分离[客户端看到的内容和所有界面效果都是由服务端提供出来的。]</p><p>这种情况下，前端页面中会出现很多涉及到服务端的模板语法。</p></li></ol><p><img src="/images/depended_frontend_backend.png" alt=""></p><p>前后端不分离</p><ol><li><p>前后端分离【把前端的界面效果(html，css，js分离到另一个项目中，python服务端只需要返回数据即可)】</p><p>前端形成一个独立的网站，服务端构成一个独立的网站</p></li></ol><p><img src="/images/indepent_frontend_backend.png" alt=""></p><p>前后端分离</p><p>django，一般都是做web网站，如果可以利用django实现前后端分离，则django就可以完成地铁站的运营调度系统，路由的终端系统，pos机的服务端系统，游戏的服务端后台，软件的服务端后台。</p><h1 id="2-api接口"><a href="#2-api接口" class="headerlink" title="2. api接口"></a>2. api接口</h1><p>为了在团队内部形成共识、防止个人习惯差异引起的混乱，我们需要找到一种大家都觉得很好的接口实现规范，而且这种规范能够让后端写的接口，用途一目了然，减少双方之间的合作成本。</p><p>目前市面上大部分公司开发人员使用的接口服务架构主要有：restful、rpc，soap。</p><p>rpc: 翻译成中文:远程过程调用[远程服务调用].</p><p>服务端提供单一的请求数据的api地址：<a href="http://api.renran.cn/" target="_blank" rel="noopener">http://api.renran.cn/</a></p><p>post请求</p><p>action=get_all_student&amp;class=301&amp;sex=1</p><p>优势：</p><ol><li>不需要管当前操作是什么http请求，也不需要操作url地址的编写，对接简单</li></ol><p>缺点：</p><ol><li>接口多了,对应函数名和参数就多了,前端在请求api接口时,就会比较难找.容易出现重复的接口</li></ol><p>restful: 翻译成中文: 资源状态转换.</p><p>把后端所有的数据/文件都看成资源.</p><p>那么接口请求数据,本质上来说就是对资源的操作了.</p><p>web项目中操作资源,无非就是增删查改.所以要求在地址栏中声明要操作的资源是什么,然后通过http请求动词来说明对资源进行哪一种操作.</p><p>POST <a href="http://www.renran.cn/api/students/" target="_blank" rel="noopener">http://www.renran.cn/api/students/</a> 添加学生数据</p><p>GET <a href="http://www.renran.cn/api/students/" target="_blank" rel="noopener">http://www.renran.cn/api/students/</a> 获取所有学生</p><p>DELETE <a href="http://www.renran.cn/api/students//" target="_blank" rel="noopener">http://www.renran.cn/api/students//</a> 删除id=pk的一个学生</p><p>PUT <a href="http://www.renran.cn/api/students//" target="_blank" rel="noopener">http://www.renran.cn/api/students//</a> 修改一个学生的全部信息 [id,name,sex,age,]</p><p>PATCH <a href="http://www.renran.cn/api/students//" target="_blank" rel="noopener">http://www.renran.cn/api/students//</a> 修改一个学生的部分信息[age]</p><p>优点：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1. 维护开发简单，可以保证后期的开发不会出现太多重复接口</span><br></pre></td></tr></table></figure><p>缺点：</p><ol><li>有部分接口不会有明确的增删查改这种区分的，所以会出现一些不伦不类的接口。会因为这些语义不明，不伦不类的接口导致后期的维护成本上升。</li><li>因为restful把对于资源的操作都理解成了增删查改，建议使用http，所以restful接口天生局限于web开发。</li></ol><h1 id="3-RESTful-API规范"><a href="#3-RESTful-API规范" class="headerlink" title="3. RESTful API规范"></a>3. RESTful API规范</h1><p><img src="/images/restful.gif" alt=""></p><p>REST全称是Representational State Transfer，中文意思是表述（编者注：通常译为表征）性状态转移。 它首次出现在2000年Roy Fielding的博士论文中。</p><p>RESTful是一种定义Web API接口的设计风格，尤其适用于前后端分离的应用模式中。</p><p>这种风格的理念认为后端开发任务就是提供数据的，对外提供的是数据资源的访问接口，所以在定义接口时，客户端访问的URL路径就表示这种要操作的数据资源。</p><p>而对于数据资源分别使用POST、DELETE、GET、UPDATE等请求动作来表达对数据的增删查改。</p><p><a href="/images/d114eb0f25d14d698081068cdb57094a"></a></p><p>事实上，我们可以使用任何一个框架都可以实现符合restful规范的API接口。</p><p>参考文档：<a href="http://www.runoob.com/w3cnote/restful-architecture.html" target="_blank" rel="noopener">http://www.runoob.com/w3cnote/restful-architecture.html</a></p><p>接口实施过程中，会存在幂等性。所谓幂等性是指代客户端发起多次请求是否对于服务端里面的资源产生不同结果。如果多次请求，服务端结果还是一样，则属于幂等接口，如果多次请求，服务端产生结果是不一样的，则属于非幂等接口。在http请求，get/put/patch/delete都属于幂等性接口，post属于非幂等接口。</p><p>为什么要考虑幂等性？主要就是接口操作的安全性问题。</p><p>delete /api/students/1</p><p>get /api/students/</p><p>post /api/students/</p><h1 id="4-序列化"><a href="#4-序列化" class="headerlink" title="4. 序列化"></a>4. 序列化</h1><p>api接口开发，最核心最常见的一个过程就是序列化，所谓序列化就是把<strong>数据转换格式</strong>，序列化可以分两个阶段：</p><p><strong>序列化</strong>： 把我们识别的数据转换成指定的格式提供给别人。</p><p>例如：我们在django中获取到的数据默认是模型对象，但是模型对象数据无法直接提供给前端或别的平台使用，所以我们需要把数据进行序列化，变成字符串或者json数据，提供给前端或者其他平台。</p><p><strong>反序列化</strong>：把别人提供的数据转换/还原成我们需要的格式。</p><p>例如：前端js提供过来的json数据，对于python而言就是字符串，我们需要进行反序列化换成模型类对象，这样我们才能把数据保存到数据库中。</p><h1 id="5-Django-Rest-Framework"><a href="#5-Django-Rest-Framework" class="headerlink" title="5. Django Rest_Framework"></a>5. Django Rest_Framework</h1><p>核心思想: 缩减编写api接口的代码</p><p>Django REST framework是一个建立在Django基础之上的Web 应用开发框架,本质上就是一个内置在django里面的子应用，可以快速的开发REST API接口应用。</p><p>在REST framework中，提供了序列化器对象Serialzier的定义，可以帮助我们简化序列化与反序列化的过程，不仅如此，还提供丰富的类视图、扩展类、视图集来简化视图的编写工作。REST framework还提供了认证、权限、限流、过滤、分页、接口文档等功能支持。REST framework提供了一个用于测试API接口 的可视化Web界面【可以浏览器直接访问接口，drf的api接口测试页面非常美观】。</p><p><img src="/images/drf_logo.png" alt=""></p><p>中文文档：<a href="https://q1mi.github.io/Django-REST-framework-documentation/#django-rest-framework" target="_blank" rel="noopener">https://q1mi.github.io/Django-REST-framework-documentation/#django-rest-framework</a></p><p>github: <a href="https://github.com/encode/django-rest-framework/tree/master" target="_blank" rel="noopener">https://github.com/encode/django-rest-framework/tree/master</a></p><h3 id="特点"><a href="#特点" class="headerlink" title="特点"></a>特点</h3><ul><li>提供了定义序列化器Serializer的方法，可以快速根据 Django ORM 或者其它库自动序列化/反序列化；</li><li>提供了丰富的类视图、Mixin扩展类，简化视图的编写；</li><li>丰富的定制层级：函数视图、类视图、视图集合到自动生成 API，满足各种需要；</li><li>多种身份认证和权限认证方式的支持；[jwt Json web token]</li><li>内置了限流系统；</li><li>直观的 API web 界面；【方便我们调试开发api接口】</li><li>可扩展性，插件丰富</li></ul><h1 id="6-环境安装与配置"><a href="#6-环境安装与配置" class="headerlink" title="6. 环境安装与配置"></a>6. 环境安装与配置</h1><p>DRF需要以下依赖：</p><ul><li>Python (2.7, 3.2以上)</li><li>Django (1.10, 1.11, 2.0以上)</li></ul><p><strong>DRF是以Django扩展应用的方式提供的，所以我们可以直接利用已有的Django环境而无需从新创建。（若没有Django环境，需要先创建环境安装Django）</strong></p><h2 id="6-1-安装DRF"><a href="#6-1-安装DRF" class="headerlink" title="6.1 安装DRF"></a>6.1 安装DRF</h2><p>前提是已经安装了django，建议安装在虚拟环境</p><p>windows的复制粘贴在linux终端是无效的，在ubuntu终端下粘贴的快捷键是 shift+insert</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># mkvirtualenv drfdemo -p python3</span></span><br><span class="line"><span class="comment"># pip install django==2.2.0  -i https://pypi.douban.com/simple</span></span><br><span class="line"></span><br><span class="line">pip install djangorestframework -i https://pypi.douban.com/simple</span><br><span class="line"></span><br><span class="line"><span class="comment"># 因为我们需要接下来，需要开发api接口肯定要操作数据，所以安装pymysql</span></span><br><span class="line">pip install pymysql -i https://pypi.douban.com/simple</span><br></pre></td></tr></table></figure><p>linux的终端下 粘贴内容 快捷键： shift+insert</p><h3 id="6-1-1-创建django项目"><a href="#6-1-1-创建django项目" class="headerlink" title="6.1.1 创建django项目"></a>6.1.1 创建django项目</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> ~/Desktop</span><br><span class="line">django-admin startproject drfdemo</span><br></pre></td></tr></table></figure><p><img src="/images/1557022536078.png" alt=""></p><p>使用pycharm打开项目，设置虚拟环境的解析器，并修改manage.py中的后缀参数。</p><p><img src="d/images/1592883758431.png" alt=""></p><h2 id="6-2-添加rest-framework应用"><a href="#6-2-添加rest-framework应用" class="headerlink" title="6.2 添加rest_framework应用"></a>6.2 添加rest_framework应用</h2><p>在<strong>settings.py</strong>的<strong>INSTALLED_APPS</strong>中添加’rest_framework’。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">INSTALLED_APPS = [    ...    <span class="string">'rest_framework'</span>,]</span><br></pre></td></tr></table></figure><p>接下来就可以使用DRF提供的功能进行api接口开发了。在项目中如果使用rest_framework框架实现API接口，主要有以下三个步骤：</p><ul><li>将请求的数据（如JSON格式）转换为模型类对象</li><li>通过模型类对象进行数据库操作，完成客户端请求的增删查改</li><li>将模型类对象转换为响应的数据（如JSON格式）</li></ul><p>接下来，我们快速体验下四天后我们学习完成drf以后的开发代码。接下来代码不需要理解，看步骤。</p><h2 id="6-3-体验drf完全简写代码的过程"><a href="#6-3-体验drf完全简写代码的过程" class="headerlink" title="6.3 体验drf完全简写代码的过程"></a>6.3 体验drf完全简写代码的过程</h2><h3 id="6-3-0-创建子应用"><a href="#6-3-0-创建子应用" class="headerlink" title="6.3.0 创建子应用"></a>6.3.0 创建子应用</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 项目根目录下创建子应用，用于展示当前例子。</span></span><br><span class="line"></span><br><span class="line">python manage.py startapp students</span><br></pre></td></tr></table></figure><h3 id="6-3-1-创建模型操作类"><a href="#6-3-1-创建模型操作类" class="headerlink" title="6.3.1. 创建模型操作类"></a>6.3.1. 创建模型操作类</h3><p>子应用的models.py文件中创建模型对象。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> django.db <span class="keyword">import</span> models</span><br><span class="line"></span><br><span class="line"><span class="comment"># Create your models here.</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Student</span><span class="params">(models.Model)</span>:</span></span><br><span class="line">    <span class="comment"># 表字段声明</span></span><br><span class="line">    <span class="comment"># 字段名=models.数据类型(字段约束)</span></span><br><span class="line">    name = models.CharField(null=<span class="literal">False</span>, max_length=<span class="number">32</span>, verbose_name=<span class="string">"姓名"</span>)</span><br><span class="line">    sex  = models.BooleanField(default=<span class="literal">True</span>, verbose_name=<span class="string">"性别"</span>)</span><br><span class="line">    age  = models.IntegerField(verbose_name=<span class="string">"年龄"</span>)</span><br><span class="line">    class_num = models.CharField(max_length=<span class="number">5</span>, verbose_name=<span class="string">"班级编号"</span>)</span><br><span class="line">    description = models.TextField(max_length=<span class="number">1000</span>, verbose_name=<span class="string">"个性签名"</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 表信息</span></span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">Meta</span>:</span></span><br><span class="line">        <span class="comment"># 设置表名</span></span><br><span class="line">        db_table=<span class="string">"tb_students"</span></span><br><span class="line">        verbose_name=<span class="string">"学生"</span></span><br><span class="line">        verbose_name_plural=verbose_name</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 模型的操作方法</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__str__</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="keyword">return</span> self.name</span><br></pre></td></tr></table></figure><p>为了方便测试，所以我们可以先创建一个数据库。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">create database students charset=utf8;</span><br></pre></td></tr></table></figure><p><img src="/images/1557023744365.png" alt=""></p><h3 id="6-3-1-1-执行数据迁移"><a href="#6-3-1-1-执行数据迁移" class="headerlink" title="6.3.1.1 执行数据迁移"></a>6.3.1.1 执行数据迁移</h3><p>把students子应用添加到INSTALL_APPS中</p><p><img src="/images/1557023819604.png" alt=""></p><p>初始化数据库连接</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">安装pymysql</span><br><span class="line">pip install pymysql</span><br></pre></td></tr></table></figure><p>主引用中<code>__init__.py</code>设置使用pymysql作为数据库驱动</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pymysqlpymysql.install_as_MySQLdb()</span><br></pre></td></tr></table></figure><p>settings.py配置文件中设置mysql的账号密码</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">DATABASES = &#123;</span><br><span class="line">    <span class="comment"># 'default': &#123;</span></span><br><span class="line">    <span class="comment">#     'ENGINE': 'django.db.backends.sqlite3',</span></span><br><span class="line">    <span class="comment">#     'NAME': os.path.join(BASE_DIR, 'db.sqlite3'),</span></span><br><span class="line">    <span class="comment"># &#125;,</span></span><br><span class="line">    <span class="string">'default'</span>: &#123;</span><br><span class="line">        <span class="string">'ENGINE'</span>: <span class="string">'django.db.backends.mysql'</span>,</span><br><span class="line">        <span class="string">'NAME'</span>: <span class="string">"students"</span>,</span><br><span class="line">        <span class="string">"HOST"</span>: <span class="string">"127.0.0.1"</span>,</span><br><span class="line">        <span class="string">"PORT"</span>: <span class="number">3306</span>,</span><br><span class="line">        <span class="string">"USER"</span>: <span class="string">"root"</span>,</span><br><span class="line">        <span class="string">"PASSWORD"</span>:<span class="string">"123"</span>,</span><br><span class="line">    &#125;,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>终端下，执行数据迁移。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">python manage.py makemigrations</span><br><span class="line">python manage.py migrate</span><br></pre></td></tr></table></figure><p>错误列表</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"># 执行数据迁移 python manage.py makemigrations 报错如下：</span><br></pre></td></tr></table></figure><p><img src="/images/1557024349366.png" alt=""></p><p>解决方案：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">注释掉 backends&#x2F;mysql&#x2F;base.py中的35和36行代码。</span><br></pre></td></tr></table></figure><p><img src="/images/1557025991751.png" alt=""></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"># 执行数据迁移发生以下错误：</span><br></pre></td></tr></table></figure><p><img src="/images/1557026113769.png" alt=""></p><p>解决方法：</p><p>backends/mysql/operations.py146行里面把decode换成encode：</p><p><img src="/images/1592885187223.png" alt=""></p><h3 id="6-3-2-创建序列化器"><a href="#6-3-2-创建序列化器" class="headerlink" title="6.3.2. 创建序列化器"></a>6.3.2. 创建序列化器</h3><p>在students应用目录中新建serializers.py用于保存该应用的序列化器。</p><p>创建一个StudentModelSerializer用于序列化与反序列化。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 创建序列化器类，回头会在试图中被调用</span></span><br><span class="line"><span class="keyword">from</span> rest_framework <span class="keyword">import</span> serializers</span><br><span class="line"><span class="keyword">from</span> .models <span class="keyword">import</span> Student</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">StudentModelSerializer</span><span class="params">(serializers.ModelSerializer)</span>:</span></span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">Meta</span>:</span></span><br><span class="line">        model = Student</span><br><span class="line">        fields = <span class="string">"__all__"</span></span><br></pre></td></tr></table></figure><ul><li><strong>model</strong> 指明该序列化器处理的数据字段从模型类BookInfo参考生成</li><li><strong>fields</strong> 指明该序列化器包含模型类中的哪些字段，’<strong>all</strong>’指明包含所有字段</li></ul><h3 id="6-3-3-编写视图"><a href="#6-3-3-编写视图" class="headerlink" title="6.3.3. 编写视图"></a>6.3.3. 编写视图</h3><p>在students应用的views.py中创建视图StudentViewSet，这是一个视图集合。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> rest_framework.viewsets <span class="keyword">import</span> ModelViewSet</span><br><span class="line"><span class="keyword">from</span> .models <span class="keyword">import</span> Student</span><br><span class="line"><span class="keyword">from</span> .serializers <span class="keyword">import</span> StudentModelSerializer</span><br><span class="line"><span class="comment"># Create your views here.</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">StudentViewSet</span><span class="params">(ModelViewSet)</span>:</span></span><br><span class="line">    queryset = Student.objects.all()</span><br><span class="line">    serializer_class = StudentModelSerializer</span><br></pre></td></tr></table></figure><ul><li><strong>queryset</strong> 指明该视图集在查询数据时使用的查询集</li><li><strong>serializer_class</strong> 指明该视图在进行序列化或反序列化时使用的序列化器</li></ul><h3 id="6-3-4-定义路由"><a href="#6-3-4-定义路由" class="headerlink" title="6.3.4. 定义路由"></a>6.3.4. 定义路由</h3><p>在students应用的urls.py中定义路由信息。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> . <span class="keyword">import</span> views</span><br><span class="line"><span class="keyword">from</span> rest_framework.routers <span class="keyword">import</span> DefaultRouter</span><br><span class="line"></span><br><span class="line"><span class="comment"># 路由列表</span></span><br><span class="line">urlpatterns = []</span><br><span class="line"></span><br><span class="line">router = DefaultRouter()  <span class="comment"># 可以处理视图的路由器</span></span><br><span class="line">router.register(<span class="string">'students'</span>, views.StudentViewSet)  <span class="comment"># 向路由器中注册视图集</span></span><br><span class="line"></span><br><span class="line">urlpatterns += router.urls  <span class="comment"># 将路由器中的所以路由信息追到到django的路由列表中</span></span><br></pre></td></tr></table></figure><p>最后把students子应用中的路由文件加载到总路由文件中.</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> django.contrib <span class="keyword">import</span> admin</span><br><span class="line"><span class="keyword">from</span> django.urls <span class="keyword">import</span> path,include</span><br><span class="line"></span><br><span class="line">urlpatterns = [</span><br><span class="line">    path(<span class="string">'admin/'</span>, admin.site.urls),</span><br><span class="line">    path(<span class="string">"student/"</span>,include(<span class="string">"students.urls"</span>)),</span><br><span class="line">]</span><br></pre></td></tr></table></figure><h3 id="6-3-5-运行测试"><a href="#6-3-5-运行测试" class="headerlink" title="6.3.5. 运行测试"></a>6.3.5. 运行测试</h3><p>运行当前程序（与运行Django一样）</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python manage.py runserver</span><br></pre></td></tr></table></figure><p>在浏览器中输入网址127.0.0.1:8000，可以看到DRF提供的API Web浏览页面：</p><p><img src="/images/1557027948031.png" alt=""></p><p>1）点击链接127.0.0.1:8000/stu/students 可以访问<strong>获取所有数据的接口</strong>，呈现如下页面：</p><p><img src="/images/1557027878963.png" alt=""></p><p>2）在页面底下表单部分填写学生信息，可以访问<strong>添加新学生的接口</strong>，保存学生信息：</p><p><img src="/images/1557027999506.png" alt=""></p><p>点击POST后，返回如下页面信息：</p><p><img src="/images/1557028072470.png" alt=""></p><p>3）在浏览器中输入网址127.0.0.1:8000/stu/students/5/，可以访问<strong>获取单一学生信息的接口</strong>（id为5的学生），呈现如下页面：</p><p><img src="/images/1557028115925.png" alt=""></p><p>4）在页面底部表单中填写学生信息，可以访问<strong>修改学生的接口</strong>：</p><p><img src="/images/1557028168350.png" alt=""></p><p>点击PUT，返回如下页面信息：</p><p><img src="/images/1557028208243.png" alt=""></p><p>5）点击DELETE按钮，可以访问<strong>删除学生的接口</strong>：</p><p><img src="/images/1557028242637.png" alt=""></p><p>返回，如下页面：</p><p><img src="/images/1557028266190.png" alt=""></p>]]></content>
    
    <summary type="html">
    
      在开发Web应用中，有两种应用模式：1. 前后端不分离[客户端看到的内容和所有界面效果都是由服务端提供出来的。],这种情况下，前端页面中会出现很多涉及到服务端的模板语法...
    
    </summary>
    
    
      <category term="python" scheme="http://yoursite.com/categories/python/"/>
    
    
      <category term="Django Rest_Framework" scheme="http://yoursite.com/tags/Django-Rest-Framework/"/>
    
  </entry>
  
  <entry>
    <title>[前端Vue框架]</title>
    <link href="http://yoursite.com/2020/04/01/%E5%89%8D%E7%AB%AFVue%E6%A1%86%E6%9E%B6/"/>
    <id>http://yoursite.com/2020/04/01/%E5%89%8D%E7%AB%AFVue%E6%A1%86%E6%9E%B6/</id>
    <published>2020-04-01T12:50:38.000Z</published>
    <updated>2020-06-08T12:50:39.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Vue框架"><a href="#Vue框架" class="headerlink" title="Vue框架"></a>Vue框架</h1><p>Vue.js是一款流行的JavaScript前端框架，旨在更好地组织与简化Web开发。Vue所关注的核心是MVC模式中的视图层，同时，它也能方便地取得资料更新，并通过组件内部特定的方法实现视图与模型的互动。</p><p><a href="https://rogerxs80.github.io/2020/02/22/vue%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8%E4%BD%BF%E7%94%A8/" target="_blank" rel="noopener">vue快速入门使用</a></p><p><a href="https://rogerxs80.github.io/2020/02/23/vue%E5%AF%B9%E8%B1%A1%E7%9A%84%E5%B1%9E%E6%80%A7%E5%8A%9F%E8%83%BD/" target="_blank" rel="noopener">vue对象的属性功能</a></p><p><a href="https://rogerxs80.github.io/2020/02/23/axios%E4%B8%8E%E7%BB%84%E4%BB%B6%E5%8C%96%E5%BC%80%E5%8F%91/" target="_blank" rel="noopener">axios与组件化开发</a></p><p><a href="https://rogerxs80.github.io/2020/02/25/Vue%E8%87%AA%E5%8A%A8%E5%8C%96%E5%B7%A5%E5%85%B7%EF%BC%88Vue-cli%EF%BC%89/" target="_blank" rel="noopener">Vue自动化工具（Vue-cli）</a></p><p><a href="https://rogerxs80.github.io/2020/02/26/vue%E5%AE%A2%E6%88%B7%E7%AB%AF%E9%A1%B9%E7%9B%AE%E6%90%AD%E5%BB%BA/" target="_blank" rel="noopener">vue客户端项目搭建</a></p>]]></content>
    
    <summary type="html">
    
      Vue.js是一款流行的JavaScript前端框架，旨在更好地组织与简化Web开发。Vue所关注的核心是MVC模式中的视图层，同时，它也能方便地取...
    
    </summary>
    
    
      <category term="前端框架" scheme="http://yoursite.com/categories/%E5%89%8D%E7%AB%AF%E6%A1%86%E6%9E%B6/"/>
    
    
      <category term="vue框架" scheme="http://yoursite.com/tags/vue%E6%A1%86%E6%9E%B6/"/>
    
  </entry>
  
  <entry>
    <title>[荏苒商城注册登录功能]</title>
    <link href="http://yoursite.com/2020/03/25/%E8%8D%8F%E8%8B%92%E5%95%86%E5%9F%8E%E6%B3%A8%E5%86%8C%E7%99%BB%E5%BD%95%E5%8A%9F%E8%83%BD/"/>
    <id>http://yoursite.com/2020/03/25/%E8%8D%8F%E8%8B%92%E5%95%86%E5%9F%8E%E6%B3%A8%E5%86%8C%E7%99%BB%E5%BD%95%E5%8A%9F%E8%83%BD/</id>
    <published>2020-03-25T15:03:59.000Z</published>
    <updated>2020-05-23T15:03:56.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="2-登录注册"><a href="#2-登录注册" class="headerlink" title="2-登录注册"></a>2-登录注册</h1><h1 id="用户的登陆认证"><a href="#用户的登陆认证" class="headerlink" title="用户的登陆认证"></a>用户的登陆认证</h1><h2 id="前端显示登陆页面"><a href="#前端显示登陆页面" class="headerlink" title="前端显示登陆页面"></a>前端显示登陆页面</h2><h3 id="登录页组件"><a href="#登录页组件" class="headerlink" title="登录页组件"></a>登录页组件</h3><p>components/Login.vue</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br><span class="line">476</span><br><span class="line">477</span><br><span class="line">478</span><br><span class="line">479</span><br><span class="line">480</span><br><span class="line">481</span><br><span class="line">482</span><br><span class="line">483</span><br><span class="line">484</span><br><span class="line">485</span><br><span class="line">486</span><br><span class="line">487</span><br><span class="line">488</span><br><span class="line">489</span><br><span class="line">490</span><br><span class="line">491</span><br><span class="line">492</span><br><span class="line">493</span><br><span class="line">494</span><br><span class="line">495</span><br><span class="line">496</span><br><span class="line">497</span><br><span class="line">498</span><br><span class="line">499</span><br><span class="line">500</span><br><span class="line">501</span><br><span class="line">502</span><br><span class="line">503</span><br><span class="line">504</span><br><span class="line">505</span><br><span class="line">506</span><br><span class="line">507</span><br><span class="line">508</span><br><span class="line">509</span><br><span class="line">510</span><br><span class="line">511</span><br><span class="line">512</span><br><span class="line">513</span><br><span class="line">514</span><br><span class="line">515</span><br><span class="line">516</span><br><span class="line">517</span><br><span class="line">518</span><br><span class="line">519</span><br><span class="line">520</span><br><span class="line">521</span><br><span class="line">522</span><br><span class="line">523</span><br><span class="line">524</span><br><span class="line">525</span><br><span class="line">526</span><br><span class="line">527</span><br><span class="line">528</span><br><span class="line">529</span><br><span class="line">530</span><br><span class="line">531</span><br><span class="line">532</span><br><span class="line">533</span><br><span class="line">534</span><br><span class="line">535</span><br><span class="line">536</span><br><span class="line">537</span><br><span class="line">538</span><br><span class="line">539</span><br><span class="line">540</span><br><span class="line">541</span><br><span class="line">542</span><br><span class="line">543</span><br><span class="line">544</span><br><span class="line">545</span><br><span class="line">546</span><br><span class="line">547</span><br><span class="line">548</span><br><span class="line">549</span><br><span class="line">550</span><br><span class="line">551</span><br><span class="line">552</span><br><span class="line">553</span><br><span class="line">554</span><br><span class="line">555</span><br><span class="line">556</span><br><span class="line">557</span><br><span class="line">558</span><br><span class="line">559</span><br><span class="line">560</span><br><span class="line">561</span><br><span class="line">562</span><br><span class="line">563</span><br><span class="line">564</span><br><span class="line">565</span><br><span class="line">566</span><br><span class="line">567</span><br><span class="line">568</span><br><span class="line">569</span><br><span class="line">570</span><br><span class="line">571</span><br><span class="line">572</span><br><span class="line">573</span><br><span class="line">574</span><br><span class="line">575</span><br><span class="line">576</span><br><span class="line">577</span><br><span class="line">578</span><br><span class="line">579</span><br><span class="line">580</span><br><span class="line">581</span><br><span class="line">582</span><br><span class="line">583</span><br><span class="line">584</span><br><span class="line">585</span><br><span class="line">586</span><br><span class="line">587</span><br><span class="line">588</span><br><span class="line">589</span><br><span class="line">590</span><br><span class="line">591</span><br><span class="line">592</span><br><span class="line">593</span><br><span class="line">594</span><br><span class="line">595</span><br><span class="line">596</span><br><span class="line">597</span><br><span class="line">598</span><br><span class="line">599</span><br><span class="line">600</span><br><span class="line">601</span><br><span class="line">602</span><br><span class="line">603</span><br><span class="line">604</span><br><span class="line">605</span><br><span class="line">606</span><br><span class="line">607</span><br><span class="line">608</span><br><span class="line">609</span><br><span class="line">610</span><br><span class="line">611</span><br><span class="line">612</span><br><span class="line">613</span><br><span class="line">614</span><br><span class="line">615</span><br><span class="line">616</span><br><span class="line">617</span><br><span class="line">618</span><br><span class="line">619</span><br><span class="line">620</span><br><span class="line">621</span><br><span class="line">622</span><br><span class="line">623</span><br><span class="line">624</span><br><span class="line">625</span><br><span class="line">626</span><br><span class="line">627</span><br><span class="line">628</span><br><span class="line">629</span><br><span class="line">630</span><br><span class="line">631</span><br><span class="line">632</span><br><span class="line">633</span><br><span class="line">634</span><br><span class="line">635</span><br><span class="line">636</span><br><span class="line">637</span><br><span class="line">638</span><br><span class="line">639</span><br><span class="line">640</span><br><span class="line">641</span><br><span class="line">642</span><br><span class="line">643</span><br><span class="line">644</span><br><span class="line">645</span><br><span class="line">646</span><br><span class="line">647</span><br><span class="line">648</span><br><span class="line">649</span><br><span class="line">650</span><br><span class="line">651</span><br><span class="line">652</span><br><span class="line">653</span><br><span class="line">654</span><br><span class="line">655</span><br><span class="line">656</span><br><span class="line">657</span><br><span class="line">658</span><br><span class="line">659</span><br><span class="line">660</span><br><span class="line">661</span><br><span class="line">662</span><br><span class="line">663</span><br><span class="line">664</span><br><span class="line">665</span><br><span class="line">666</span><br><span class="line">667</span><br><span class="line">668</span><br><span class="line">669</span><br><span class="line">670</span><br><span class="line">671</span><br><span class="line">672</span><br><span class="line">673</span><br><span class="line">674</span><br><span class="line">675</span><br><span class="line">676</span><br><span class="line">677</span><br><span class="line">678</span><br><span class="line">679</span><br><span class="line">680</span><br><span class="line">681</span><br><span class="line">682</span><br><span class="line">683</span><br><span class="line">684</span><br><span class="line">685</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"sign"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"logo"</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"/"</span>&gt;</span><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">"/static/image/nav-logo.png"</span> <span class="attr">alt</span>=<span class="string">"Logo"</span>&gt;</span><span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"main"</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">h4</span> <span class="attr">class</span>=<span class="string">"title"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"normal-title"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">a</span> <span class="attr">class</span>=<span class="string">"active"</span> <span class="attr">href</span>=<span class="string">"/login"</span>&gt;</span>登录<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">b</span>&gt;</span>·<span class="tag">&lt;/<span class="name">b</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">a</span> <span class="attr">id</span>=<span class="string">"js-sign-up-btn"</span> <span class="attr">class</span>=<span class="string">""</span> <span class="attr">href</span>=<span class="string">"/register"</span>&gt;</span>注册<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">h4</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"js-sign-in-container"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">form</span> <span class="attr">id</span>=<span class="string">"new_session"</span> <span class="attr">action</span>=<span class="string">""</span> <span class="attr">method</span>=<span class="string">"post"</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"input-prepend restyle js-normal"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">placeholder</span>=<span class="string">"手机号或邮箱"</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">name</span>=<span class="string">"session[email_or_mobile_number]"</span> <span class="attr">id</span>=<span class="string">"session_email_or_mobile_number"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">i</span> <span class="attr">class</span>=<span class="string">"iconfont ic-user"</span>&gt;</span><span class="tag">&lt;/<span class="name">i</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 海外登录登录名输入框 --&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"input-prepend"</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">input</span> <span class="attr">placeholder</span>=<span class="string">"密码"</span> <span class="attr">type</span>=<span class="string">"password"</span> <span class="attr">name</span>=<span class="string">"password"</span> <span class="attr">id</span>=<span class="string">"session_password"</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">i</span> <span class="attr">class</span>=<span class="string">"iconfont ic-password"</span>&gt;</span><span class="tag">&lt;/<span class="name">i</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"remember-btn"</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"checkbox"</span> <span class="attr">value</span>=<span class="string">"true"</span> <span class="attr">checked</span>=<span class="string">"checked"</span> <span class="attr">name</span>=<span class="string">"remember_me"</span> <span class="attr">id</span>=<span class="string">"session_remember_me"</span>&gt;</span><span class="tag">&lt;<span class="name">span</span>&gt;</span>记住我<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"forget-btn"</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">a</span> <span class="attr">class</span>=<span class="string">""</span> <span class="attr">data-toggle</span>=<span class="string">"dropdown"</span> <span class="attr">href</span>=<span class="string">""</span>&gt;</span>登录遇到问题?<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">button</span> <span class="attr">class</span>=<span class="string">"sign-in-button"</span> <span class="attr">id</span>=<span class="string">"sign-in-form-submit-btn"</span> <span class="attr">type</span>=<span class="string">"button"</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">span</span> <span class="attr">id</span>=<span class="string">"sign-in-loading"</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">      登录</span><br><span class="line">    <span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- 更多登录方式 --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"more-sign"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h6</span>&gt;</span>社交帐号登录<span class="tag">&lt;/<span class="name">h6</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">ul</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">li</span> <span class="attr">id</span>=<span class="string">"weibo-link-wrap"</span> <span class="attr">class</span>=<span class="string">""</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">a</span> <span class="attr">class</span>=<span class="string">"weibo"</span> <span class="attr">id</span>=<span class="string">"weibo-link"</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">i</span> <span class="attr">class</span>=<span class="string">"iconfont ic-weibo"</span>&gt;</span><span class="tag">&lt;/<span class="name">i</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">id</span>=<span class="string">"weixin"</span> <span class="attr">class</span>=<span class="string">"weixin"</span> <span class="attr">target</span>=<span class="string">"_blank"</span> <span class="attr">href</span>=<span class="string">""</span>&gt;</span><span class="tag">&lt;<span class="name">i</span> <span class="attr">class</span>=<span class="string">"iconfont ic-wechat"</span>&gt;</span><span class="tag">&lt;/<span class="name">i</span>&gt;</span><span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">id</span>=<span class="string">"qq"</span> <span class="attr">class</span>=<span class="string">"qq"</span> <span class="attr">target</span>=<span class="string">"_blank"</span> <span class="attr">href</span>=<span class="string">""</span>&gt;</span><span class="tag">&lt;<span class="name">i</span> <span class="attr">class</span>=<span class="string">"iconfont ic-qq_connect"</span>&gt;</span><span class="tag">&lt;/<span class="name">i</span>&gt;</span><span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript">    <span class="keyword">export</span> <span class="keyword">default</span> &#123;</span></span><br><span class="line"><span class="actionscript">        name: <span class="string">"Login"</span></span></span><br><span class="line">    &#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span> <span class="attr">scoped</span>&gt;</span></span><br><span class="line">input&#123;</span><br><span class="line">  outline: none;</span><br><span class="line">&#125;</span><br><span class="line"><span class="css">*, <span class="selector-pseudo">:after</span>, <span class="selector-pseudo">:before</span> &#123;</span></span><br><span class="line">    box-sizing: border-box;</span><br><span class="line">&#125;</span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> &#123;</span></span><br><span class="line">    height: 100%;</span><br><span class="line">    min-height: 750px;</span><br><span class="line">    text-align: center;</span><br><span class="line">    font-size: 14px;</span><br><span class="line"><span class="css">    <span class="selector-tag">background-color</span>: <span class="selector-id">#f1f1f1</span></span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span><span class="selector-pseudo">:before</span> &#123;</span></span><br><span class="line">    content: "";</span><br><span class="line">    display: inline-block;</span><br><span class="line">    height: 85%;</span><br><span class="line">    vertical-align: middle</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.disable</span>,<span class="selector-class">.sign</span> <span class="selector-class">.disable-gray</span> &#123;</span></span><br><span class="line"><span class="css">    <span class="selector-tag">opacity</span>: <span class="selector-class">.5</span>;</span></span><br><span class="line">    pointer-events: none</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.disable-gray</span> &#123;</span></span><br><span class="line"><span class="css">    <span class="selector-tag">background-color</span>: <span class="selector-id">#969696</span></span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.tooltip-error</span> &#123;</span></span><br><span class="line">    font-size: 14px;</span><br><span class="line">    line-height: 25px;</span><br><span class="line">    white-space: nowrap;</span><br><span class="line">    background: none</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.tooltip-error</span> <span class="selector-class">.tooltip-inner</span> &#123;</span></span><br><span class="line">    max-width: 280px;</span><br><span class="line"><span class="css">    <span class="selector-tag">color</span>: <span class="selector-id">#333</span>;</span></span><br><span class="line"><span class="css">    <span class="selector-tag">border</span>: 1<span class="selector-tag">px</span> <span class="selector-tag">solid</span> <span class="selector-id">#ea6f5a</span>;</span></span><br><span class="line"><span class="css">    <span class="selector-tag">background-color</span>: <span class="selector-id">#fff</span></span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.tooltip-error</span> <span class="selector-class">.tooltip-inner</span> <span class="selector-tag">i</span> &#123;</span></span><br><span class="line">    position: static;</span><br><span class="line">    margin-right: 5px;</span><br><span class="line">    font-size: 20px;</span><br><span class="line"><span class="css">    <span class="selector-tag">color</span>: <span class="selector-id">#ea6f5a</span>;</span></span><br><span class="line">    vertical-align: middle</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.tooltip-error</span> <span class="selector-class">.tooltip-inner</span> <span class="selector-tag">span</span> &#123;</span></span><br><span class="line">    vertical-align: middle;</span><br><span class="line">    display: inline-block;</span><br><span class="line">    white-space: normal;</span><br><span class="line">    max-width: 230px</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.tooltip-error</span><span class="selector-class">.right</span> <span class="selector-class">.tooltip-arrow-border</span> &#123;</span></span><br><span class="line"><span class="css">    <span class="selector-tag">border-right-color</span>: <span class="selector-id">#ea6f5a</span></span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.tooltip-error</span><span class="selector-class">.right</span> <span class="selector-class">.tooltip-arrow-bg</span> &#123;</span></span><br><span class="line">    left: 2px;</span><br><span class="line"><span class="css">    <span class="selector-tag">border-right-color</span>: <span class="selector-id">#fff</span></span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.slide-error</span> &#123;</span></span><br><span class="line">    position: relative;</span><br><span class="line">    padding: 10px 0;</span><br><span class="line"><span class="css">    <span class="selector-tag">border</span>: 1<span class="selector-tag">px</span> <span class="selector-tag">solid</span> <span class="selector-id">#c8c8c8</span>;</span></span><br><span class="line">    border-radius: 4px</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.slide-error</span> <span class="selector-tag">i</span> &#123;</span></span><br><span class="line">    position: static!important;</span><br><span class="line">    margin-right: 10px;</span><br><span class="line"><span class="css">    <span class="selector-tag">color</span>: <span class="selector-id">#ea6f5a</span>!<span class="selector-tag">important</span>;</span></span><br><span class="line">    vertical-align: middle</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.slide-error</span> <span class="selector-tag">span</span> &#123;</span></span><br><span class="line">    font-size: 15px;</span><br><span class="line">    vertical-align: middle</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.slide-error</span> <span class="selector-tag">div</span> &#123;</span></span><br><span class="line">    margin-top: 10px;</span><br><span class="line">    font-size: 13px</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.slide-error</span> <span class="selector-tag">a</span> &#123;</span></span><br><span class="line"><span class="css">    <span class="selector-tag">color</span>: <span class="selector-id">#3194d0</span></span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.js-sign-up-forbidden</span> &#123;</span></span><br><span class="line"><span class="css">    <span class="selector-tag">color</span>: <span class="selector-id">#999</span>;</span></span><br><span class="line">    padding: 80px 0 100px</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.js-sign-up-container</span> <span class="selector-class">.slide-error</span> &#123;</span></span><br><span class="line">    border-bottom: none;</span><br><span class="line">    border-radius: 0</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.logo</span> &#123;</span></span><br><span class="line">    position: absolute;</span><br><span class="line">    top: 56px;</span><br><span class="line">    margin-left: 50px</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.logo</span> <span class="selector-tag">img</span> &#123;</span></span><br><span class="line">    width: 100px</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.main</span> &#123;</span></span><br><span class="line">    width: 400px;</span><br><span class="line">    margin: 60px auto 0;</span><br><span class="line">    padding: 50px 50px 30px;</span><br><span class="line"><span class="css">    <span class="selector-tag">background-color</span>: <span class="selector-id">#fff</span>;</span></span><br><span class="line">    border-radius: 4px;</span><br><span class="line"><span class="css">    <span class="selector-tag">box-shadow</span>: 0 0 8<span class="selector-tag">px</span> <span class="selector-tag">rgba</span>(0,0,0,<span class="selector-class">.1</span>);</span></span><br><span class="line">    vertical-align: middle;</span><br><span class="line">    display: inline-block</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.reset-title</span>,<span class="selector-class">.sign</span> <span class="selector-class">.title</span> &#123;</span></span><br><span class="line">    margin: 0 auto 50px;</span><br><span class="line">    padding: 10px;</span><br><span class="line">    font-weight: 400;</span><br><span class="line"><span class="css">    <span class="selector-tag">color</span>: <span class="selector-id">#969696</span></span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.reset-title</span> <span class="selector-tag">a</span>,<span class="selector-class">.sign</span> <span class="selector-class">.title</span> <span class="selector-tag">a</span> &#123;</span></span><br><span class="line">    padding: 10px;</span><br><span class="line"><span class="css">    <span class="selector-tag">color</span>: <span class="selector-id">#969696</span></span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.reset-title</span> <span class="selector-tag">a</span><span class="selector-pseudo">:hover</span>,<span class="selector-class">.sign</span> <span class="selector-class">.title</span> <span class="selector-tag">a</span><span class="selector-pseudo">:hover</span> &#123;</span></span><br><span class="line"><span class="css">    <span class="selector-tag">border-bottom</span>: 2<span class="selector-tag">px</span> <span class="selector-tag">solid</span> <span class="selector-id">#ea6f5a</span></span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.reset-title</span> <span class="selector-class">.active</span>,<span class="selector-class">.sign</span> <span class="selector-class">.title</span> <span class="selector-class">.active</span> &#123;</span></span><br><span class="line">    font-weight: 700;</span><br><span class="line"><span class="css">    <span class="selector-tag">color</span>: <span class="selector-id">#ea6f5a</span>;</span></span><br><span class="line"><span class="css">    <span class="selector-tag">border-bottom</span>: 2<span class="selector-tag">px</span> <span class="selector-tag">solid</span> <span class="selector-id">#ea6f5a</span></span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.reset-title</span> <span class="selector-tag">b</span>,<span class="selector-class">.sign</span> <span class="selector-class">.title</span> <span class="selector-tag">b</span> &#123;</span></span><br><span class="line">    padding: 10px</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.reset-title</span> &#123;</span></span><br><span class="line"><span class="css">    <span class="selector-tag">color</span>: <span class="selector-id">#333</span>;</span></span><br><span class="line">    font-weight: 700</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-tag">form</span> &#123;</span></span><br><span class="line">    margin-bottom: 30px</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-tag">form</span> <span class="selector-class">.input-prepend</span> &#123;</span></span><br><span class="line">    position: relative;</span><br><span class="line">    width: 100%</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-tag">form</span> <span class="selector-class">.input-prepend</span> <span class="selector-tag">input</span> &#123;</span></span><br><span class="line">    width: 100%;</span><br><span class="line">    height: 50px;</span><br><span class="line">    margin-bottom: 0;</span><br><span class="line">    padding: 4px 12px 4px 35px;</span><br><span class="line"><span class="css">    <span class="selector-tag">border</span>: 1<span class="selector-tag">px</span> <span class="selector-tag">solid</span> <span class="selector-id">#c8c8c8</span>;</span></span><br><span class="line">    border-radius: 0 0 4px 4px;</span><br><span class="line"><span class="css">    <span class="selector-tag">background-color</span>: <span class="selector-tag">hsla</span>(0,0%,71%,<span class="selector-class">.1</span>);</span></span><br><span class="line">    vertical-align: middle</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-tag">form</span> <span class="selector-class">.input-prepend</span> <span class="selector-tag">i</span> &#123;</span></span><br><span class="line">    position: absolute;</span><br><span class="line">    top: 14px;</span><br><span class="line">    left: 10px;</span><br><span class="line">    font-size: 18px;</span><br><span class="line"><span class="css">    <span class="selector-tag">color</span>: <span class="selector-id">#969696</span></span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-tag">form</span> <span class="selector-class">.input-prepend</span> <span class="selector-tag">span</span> &#123;</span></span><br><span class="line"><span class="css">    <span class="selector-tag">color</span>: <span class="selector-id">#333</span></span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-tag">form</span> <span class="selector-class">.input-prepend</span> <span class="selector-class">.ic-show</span> &#123;</span></span><br><span class="line">    top: 18px;</span><br><span class="line">    left: auto;</span><br><span class="line">    right: 8px;</span><br><span class="line">    font-size: 12px</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-tag">form</span> <span class="selector-class">.geetest-placeholder</span> &#123;</span></span><br><span class="line">    height: 44px;</span><br><span class="line">    border-radius: 4px;</span><br><span class="line"><span class="css">    <span class="selector-tag">background-color</span>: <span class="selector-tag">hsla</span>(0,0%,71%,<span class="selector-class">.1</span>);</span></span><br><span class="line">    text-align: center;</span><br><span class="line">    line-height: 44px;</span><br><span class="line">    font-size: 14px;</span><br><span class="line"><span class="css">    <span class="selector-tag">color</span>: <span class="selector-id">#999</span></span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-tag">form</span> <span class="selector-class">.restyle</span> &#123;</span></span><br><span class="line">    margin-bottom: 0</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-tag">form</span> <span class="selector-class">.restyle</span> <span class="selector-tag">input</span> &#123;</span></span><br><span class="line">    border-bottom: none;</span><br><span class="line">    border-radius: 4px 4px 0 0</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-tag">form</span> <span class="selector-class">.no-radius</span> <span class="selector-tag">input</span> &#123;</span></span><br><span class="line">    border-radius: 0</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-tag">form</span> <span class="selector-class">.slide-security-placeholder</span> &#123;</span></span><br><span class="line">    height: 32px;</span><br><span class="line"><span class="css">    <span class="selector-tag">background-color</span>: <span class="selector-tag">hsla</span>(0,0%,71%,<span class="selector-class">.1</span>);</span></span><br><span class="line">    border-radius: 4px</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-tag">form</span> <span class="selector-class">.slide-security-placeholder</span> <span class="selector-tag">p</span> &#123;</span></span><br><span class="line">    padding-top: 7px;</span><br><span class="line"><span class="css">    <span class="selector-tag">color</span>: <span class="selector-id">#999</span>;</span></span><br><span class="line">    margin-right: -7px</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.overseas-btn</span> &#123;</span></span><br><span class="line">    font-size: 14px;</span><br><span class="line"><span class="css">    <span class="selector-tag">color</span>: <span class="selector-id">#999</span></span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.overseas-btn</span><span class="selector-pseudo">:hover</span> &#123;</span></span><br><span class="line"><span class="css">    <span class="selector-tag">color</span>: <span class="selector-id">#2f2f2f</span></span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.remember-btn</span> &#123;</span></span><br><span class="line">    float: left;</span><br><span class="line">    margin: 15px 0</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.remember-btn</span> <span class="selector-tag">span</span> &#123;</span></span><br><span class="line">    margin-left: 5px;</span><br><span class="line">    font-size: 15px;</span><br><span class="line"><span class="css">    <span class="selector-tag">color</span>: <span class="selector-id">#969696</span>;</span></span><br><span class="line">    vertical-align: middle</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.forget-btn</span> &#123;</span></span><br><span class="line">    float: right;</span><br><span class="line">    position: relative;</span><br><span class="line">    margin: 15px 0;</span><br><span class="line">    font-size: 14px</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.forget-btn</span> <span class="selector-tag">a</span> &#123;</span></span><br><span class="line"><span class="css">    <span class="selector-tag">color</span>: <span class="selector-id">#999</span></span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.forget-btn</span> <span class="selector-tag">a</span><span class="selector-pseudo">:hover</span> &#123;</span></span><br><span class="line"><span class="css">    <span class="selector-tag">color</span>: <span class="selector-id">#333</span></span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.forget-btn</span> <span class="selector-class">.dropdown-menu</span> &#123;</span></span><br><span class="line">    top: 20px;</span><br><span class="line">    left: auto;</span><br><span class="line">    right: 0;</span><br><span class="line">    border-radius: 4px</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.forget-btn</span> <span class="selector-class">.dropdown-menu</span> <span class="selector-tag">a</span> &#123;</span></span><br><span class="line">    padding: 10px 20px;</span><br><span class="line"><span class="css">    <span class="selector-tag">color</span>: <span class="selector-id">#333</span></span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-id">#sign-in-loading</span> &#123;</span></span><br><span class="line">    position: relative;</span><br><span class="line">    width: 20px;</span><br><span class="line">    height: 20px;</span><br><span class="line">    vertical-align: middle;</span><br><span class="line">    margin-top: -4px;</span><br><span class="line">    margin-right: 2px;</span><br><span class="line">    display: none</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-id">#sign-in-loading</span><span class="selector-pseudo">:after</span> &#123;</span></span><br><span class="line">    content: "";</span><br><span class="line">    position: absolute;</span><br><span class="line">    left: 0;</span><br><span class="line">    top: 0;</span><br><span class="line">    width: 100%;</span><br><span class="line">    height: 100%;</span><br><span class="line">    background-color: transparent</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-id">#sign-in-loading</span><span class="selector-pseudo">:before</span> &#123;</span></span><br><span class="line">    content: "";</span><br><span class="line">    position: absolute;</span><br><span class="line">    top: 50%;</span><br><span class="line">    left: 50%;</span><br><span class="line">    width: 20px;</span><br><span class="line">    height: 20px;</span><br><span class="line">    margin: -10px 0 0 -10px;</span><br><span class="line">    border-radius: 10px;</span><br><span class="line"><span class="css">    <span class="selector-tag">border</span>: 2<span class="selector-tag">px</span> <span class="selector-tag">solid</span> <span class="selector-id">#fff</span>;</span></span><br><span class="line">    border-bottom-color: transparent;</span><br><span class="line">    vertical-align: middle;</span><br><span class="line"><span class="css">    <span class="selector-tag">-webkit-animation</span>: <span class="selector-tag">rolling</span> <span class="selector-class">.8s</span> <span class="selector-tag">infinite</span> <span class="selector-tag">linear</span>;</span></span><br><span class="line"><span class="css">    <span class="selector-tag">animation</span>: <span class="selector-tag">rolling</span> <span class="selector-class">.8s</span> <span class="selector-tag">infinite</span> <span class="selector-tag">linear</span>;</span></span><br><span class="line">    z-index: 1</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.sign-in-button</span>,<span class="selector-class">.sign</span> <span class="selector-class">.sign-up-button</span> &#123;</span></span><br><span class="line">    margin-top: 20px;</span><br><span class="line">    width: 100%;</span><br><span class="line">    padding: 9px 18px;</span><br><span class="line">    font-size: 18px;</span><br><span class="line">    border: none;</span><br><span class="line">    border-radius: 25px;</span><br><span class="line"><span class="css">    <span class="selector-tag">color</span>: <span class="selector-id">#fff</span>;</span></span><br><span class="line"><span class="css">    <span class="selector-tag">background</span>: <span class="selector-id">#42c02e</span>;</span></span><br><span class="line">    cursor: pointer;</span><br><span class="line">    outline: none;</span><br><span class="line">    display: block;</span><br><span class="line">    clear: both</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.sign-in-button</span><span class="selector-pseudo">:hover</span>,<span class="selector-class">.sign</span> <span class="selector-class">.sign-up-button</span><span class="selector-pseudo">:hover</span> &#123;</span></span><br><span class="line"><span class="css">    <span class="selector-tag">background</span>: <span class="selector-id">#3db922</span></span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.sign-in-button</span> &#123;</span></span><br><span class="line"><span class="css">    <span class="selector-tag">background</span>: <span class="selector-id">#3194d0</span></span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.sign-in-button</span><span class="selector-pseudo">:hover</span> &#123;</span></span><br><span class="line"><span class="css">    <span class="selector-tag">background</span>: <span class="selector-id">#187cb7</span></span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.btn-in-resend</span>,<span class="selector-class">.sign</span> <span class="selector-class">.btn-up-resend</span> &#123;</span></span><br><span class="line">    position: absolute;</span><br><span class="line">    top: 7px;</span><br><span class="line">    right: 7px;</span><br><span class="line">    width: 100px;</span><br><span class="line">    height: 36px;</span><br><span class="line">    font-size: 13px;</span><br><span class="line"><span class="css">    <span class="selector-tag">color</span>: <span class="selector-id">#fff</span>;</span></span><br><span class="line"><span class="css">    <span class="selector-tag">background-color</span>: <span class="selector-id">#42c02e</span>;</span></span><br><span class="line">    border-radius: 20px;</span><br><span class="line">    line-height: 36px</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.btn-in-resend</span> &#123;</span></span><br><span class="line"><span class="css">    <span class="selector-tag">background-color</span>: <span class="selector-id">#3194d0</span></span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.sign-up-msg</span> &#123;</span></span><br><span class="line">    margin: 10px 0;</span><br><span class="line">    padding: 0;</span><br><span class="line">    text-align: center;</span><br><span class="line">    font-size: 12px;</span><br><span class="line">    line-height: 20px;</span><br><span class="line"><span class="css">    <span class="selector-tag">color</span>: <span class="selector-id">#969696</span></span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.sign-up-msg</span> <span class="selector-tag">a</span>,<span class="selector-class">.sign</span> <span class="selector-class">.sign-up-msg</span> <span class="selector-tag">a</span><span class="selector-pseudo">:hover</span> &#123;</span></span><br><span class="line"><span class="css">    <span class="selector-tag">color</span>: <span class="selector-id">#3194d0</span></span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.overseas</span> <span class="selector-tag">input</span> &#123;</span></span><br><span class="line">    padding-left: 110px!important</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.overseas</span> <span class="selector-class">.overseas-number</span> &#123;</span></span><br><span class="line">    position: absolute;</span><br><span class="line">    top: 0;</span><br><span class="line">    left: 0;</span><br><span class="line">    width: 100px;</span><br><span class="line">    height: 50px;</span><br><span class="line">    font-size: 18px;</span><br><span class="line"><span class="css">    <span class="selector-tag">color</span>: <span class="selector-id">#969696</span>;</span></span><br><span class="line"><span class="css">    <span class="selector-tag">border-right</span>: 1<span class="selector-tag">px</span> <span class="selector-tag">solid</span> <span class="selector-id">#c8c8c8</span></span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.overseas</span> <span class="selector-class">.overseas-number</span> <span class="selector-tag">span</span> &#123;</span></span><br><span class="line">    margin-top: 17px;</span><br><span class="line">    padding-left: 35px;</span><br><span class="line">    text-align: left;</span><br><span class="line">    font-size: 14px;</span><br><span class="line">    display: block</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.overseas</span> <span class="selector-class">.dropdown-menu</span> &#123;</span></span><br><span class="line">    width: 100%;</span><br><span class="line">    max-height: 285px;</span><br><span class="line">    font-size: 14px;</span><br><span class="line">    border-radius: 0 0 4px 4px;</span><br><span class="line">    overflow-y: auto</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.overseas</span> <span class="selector-class">.dropdown-menu</span> <span class="selector-tag">li</span> <span class="selector-class">.nation-code</span> &#123;</span></span><br><span class="line">    width: 65px;</span><br><span class="line">    display: inline-block</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.overseas</span> <span class="selector-class">.dropdown-menu</span> <span class="selector-tag">li</span> <span class="selector-tag">a</span> &#123;</span></span><br><span class="line">    padding: 6px 20px;</span><br><span class="line">    font-size: 14px;</span><br><span class="line">    line-height: 20px</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.overseas</span> <span class="selector-class">.dropdown-menu</span> <span class="selector-tag">li</span> <span class="selector-tag">a</span><span class="selector-pseudo">::hover</span> &#123;</span></span><br><span class="line"><span class="css">    <span class="selector-tag">color</span>: <span class="selector-id">#fff</span>;</span></span><br><span class="line"><span class="css">    <span class="selector-tag">background-color</span>: <span class="selector-id">#f5f5f5</span></span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.more-sign</span> &#123;</span></span><br><span class="line">    margin-top: 50px</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.more-sign</span> <span class="selector-tag">h6</span> &#123;</span></span><br><span class="line">    position: relative;</span><br><span class="line">    margin: 0 0 10px;</span><br><span class="line">    font-size: 12px;</span><br><span class="line"><span class="css">    <span class="selector-tag">color</span>: <span class="selector-id">#b5b5b5</span></span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.more-sign</span> <span class="selector-tag">h6</span><span class="selector-pseudo">:before</span> &#123;</span></span><br><span class="line">    left: 30px</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.more-sign</span> <span class="selector-tag">h6</span><span class="selector-pseudo">:after</span>,<span class="selector-class">.sign</span> <span class="selector-class">.more-sign</span> <span class="selector-tag">h6</span><span class="selector-pseudo">:before</span> &#123;</span></span><br><span class="line">    content: "";</span><br><span class="line"><span class="css">    <span class="selector-tag">border-top</span>: 1<span class="selector-tag">px</span> <span class="selector-tag">solid</span> <span class="selector-id">#b5b5b5</span>;</span></span><br><span class="line">    display: block;</span><br><span class="line">    position: absolute;</span><br><span class="line">    width: 60px;</span><br><span class="line">    top: 5px</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.more-sign</span> <span class="selector-tag">h6</span><span class="selector-pseudo">:after</span> &#123;</span></span><br><span class="line">    right: 30px</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.more-sign</span> <span class="selector-tag">ul</span> &#123;</span></span><br><span class="line">    margin-bottom: 10px;</span><br><span class="line">    list-style: none</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.more-sign</span> <span class="selector-tag">ul</span> <span class="selector-tag">li</span> &#123;</span></span><br><span class="line">    margin: 0 5px;</span><br><span class="line">    display: inline-block</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.more-sign</span> <span class="selector-tag">ul</span> <span class="selector-tag">a</span> &#123;</span></span><br><span class="line">    width: 50px;</span><br><span class="line">    height: 50px;</span><br><span class="line">    line-height: 50px;</span><br><span class="line">    display: block</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.more-sign</span> <span class="selector-tag">ul</span> <span class="selector-tag">i</span> &#123;</span></span><br><span class="line">    font-size: 28px</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.more-sign</span> <span class="selector-class">.ic-weibo</span> &#123;</span></span><br><span class="line"><span class="css">    <span class="selector-tag">color</span>: <span class="selector-id">#e05244</span></span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.more-sign</span> <span class="selector-class">.ic-wechat</span> &#123;</span></span><br><span class="line"><span class="css">    <span class="selector-tag">color</span>: <span class="selector-id">#00bb29</span></span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.more-sign</span> <span class="selector-class">.ic-qq_connect</span> &#123;</span></span><br><span class="line"><span class="css">    <span class="selector-tag">color</span>: <span class="selector-id">#498ad5</span></span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.more-sign</span> <span class="selector-class">.ic-douban</span> &#123;</span></span><br><span class="line"><span class="css">    <span class="selector-tag">color</span>: <span class="selector-id">#00820f</span></span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.more-sign</span> <span class="selector-class">.ic-more</span> &#123;</span></span><br><span class="line"><span class="css">    <span class="selector-tag">color</span>: <span class="selector-id">#999</span></span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.more-sign</span> <span class="selector-class">.weibo-loading</span> &#123;</span></span><br><span class="line">    pointer-events: none;</span><br><span class="line">    cursor: pointer;</span><br><span class="line">    position: relative</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.more-sign</span> <span class="selector-class">.weibo-loading</span><span class="selector-pseudo">:after</span> &#123;</span></span><br><span class="line">    content: "";</span><br><span class="line">    position: absolute;</span><br><span class="line">    left: 0;</span><br><span class="line">    top: 0;</span><br><span class="line">    width: 100%;</span><br><span class="line">    height: 100%;</span><br><span class="line"><span class="css">    <span class="selector-tag">background-color</span>: <span class="selector-id">#fff</span></span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-tag">body</span><span class="selector-class">.reader-night-mode</span> <span class="selector-class">.sign</span> <span class="selector-class">.more-sign</span> <span class="selector-class">.weibo-loading</span><span class="selector-pseudo">:after</span> &#123;</span></span><br><span class="line"><span class="css">    <span class="selector-tag">background-color</span>: <span class="selector-id">#3f3f3f</span></span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.more-sign</span> <span class="selector-class">.weibo-loading</span><span class="selector-pseudo">:before</span> &#123;</span></span><br><span class="line">    content: "";</span><br><span class="line">    position: absolute;</span><br><span class="line">    top: 50%;</span><br><span class="line">    left: 50%;</span><br><span class="line">    width: 20px;</span><br><span class="line">    height: 20px;</span><br><span class="line">    margin: -10px 0 0 -10px;</span><br><span class="line">    border-radius: 10px;</span><br><span class="line"><span class="css">    <span class="selector-tag">border</span>: 2<span class="selector-tag">px</span> <span class="selector-tag">solid</span> <span class="selector-id">#e05244</span>;</span></span><br><span class="line">    border-bottom-color: transparent;</span><br><span class="line">    vertical-align: middle;</span><br><span class="line"><span class="css">    <span class="selector-tag">-webkit-animation</span>: <span class="selector-tag">rolling</span> <span class="selector-class">.8s</span> <span class="selector-tag">infinite</span> <span class="selector-tag">linear</span>;</span></span><br><span class="line"><span class="css">    <span class="selector-tag">animation</span>: <span class="selector-tag">rolling</span> <span class="selector-class">.8s</span> <span class="selector-tag">infinite</span> <span class="selector-tag">linear</span>;</span></span><br><span class="line">    z-index: 1</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="keyword">@keyframes</span> rolling &#123;</span></span><br><span class="line">    0% &#123;</span><br><span class="line">        -webkit-transform: rotate(0deg);</span><br><span class="line">        transform: rotate(0deg)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    to &#123;</span><br><span class="line">        -webkit-transform: rotate(1turn);</span><br><span class="line">        transform: rotate(1turn)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="keyword">@-webkit-keyframes</span> rolling &#123;</span></span><br><span class="line">    0% &#123;</span><br><span class="line">        -webkit-transform: rotate(0deg)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    to &#123;</span><br><span class="line">        -webkit-transform: rotate(1turn)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.reset-password-input</span> &#123;</span></span><br><span class="line">    border-radius: 4px!important</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.return</span> &#123;</span></span><br><span class="line">    margin-left: -8px;</span><br><span class="line"><span class="css">    <span class="selector-tag">color</span>: <span class="selector-id">#969696</span></span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.return</span><span class="selector-pseudo">:hover</span> &#123;</span></span><br><span class="line"><span class="css">    <span class="selector-tag">color</span>: <span class="selector-id">#333</span></span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.return</span> <span class="selector-tag">i</span> &#123;</span></span><br><span class="line">    margin-right: 5px</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.icheckbox_square-green</span> &#123;</span></span><br><span class="line">    display: inline-block;</span><br><span class="line">    *display: inline;</span><br><span class="line">    vertical-align: middle;</span><br><span class="line">    margin: 0;</span><br><span class="line">    padding: 0;</span><br><span class="line">    width: 18px;</span><br><span class="line">    height: 18px;</span><br><span class="line">    background: url(/static/image/green.png) no-repeat;</span><br><span class="line">    border: none;</span><br><span class="line">    cursor: pointer;</span><br><span class="line">    background-position: 0 0</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.icheckbox_square-green</span><span class="selector-class">.hover</span> &#123;</span></span><br><span class="line">    background-position: -20px 0</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.icheckbox_square-green</span><span class="selector-class">.checked</span> &#123;</span></span><br><span class="line">    background-position: -40px 0</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.icheckbox_square-green</span><span class="selector-class">.disabled</span> &#123;</span></span><br><span class="line">    background-position: -60px 0;</span><br><span class="line">    cursor: default</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.icheckbox_square-green</span><span class="selector-class">.checked</span><span class="selector-class">.disabled</span> &#123;</span></span><br><span class="line">    background-position: -80px 0</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.geetest_panel_box</span>&gt;* &#123;</span></span><br><span class="line">    box-sizing: content-box</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="keyword">@media</span> (<span class="attribute">max-width:</span><span class="number">768px</span>) &#123;</span></span><br><span class="line">    body &#123;</span><br><span class="line">        min-width: 0</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="css">    <span class="selector-class">.sign</span> &#123;</span></span><br><span class="line">        height: auto;</span><br><span class="line">        min-height: 0;</span><br><span class="line">        background-color: transparent</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="css">    <span class="selector-class">.sign</span> <span class="selector-class">.logo</span> &#123;</span></span><br><span class="line">        display: none</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="css">    <span class="selector-class">.sign</span> <span class="selector-class">.main</span> &#123;</span></span><br><span class="line">        position: absolute;</span><br><span class="line">        left: 50%;</span><br><span class="line">        margin: 0 0 0 -200px;</span><br><span class="line">        box-shadow: none</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br></pre></td></tr></table></figure><p>把素材中的iconfont.css和iconfont.eof字体文件,放到项目中引入进来,因为在别的页面也会使用到图标,所以我们直接的入口文件index.html或者main.js中全局引入.</p><p>main.js,代码:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">// 全局导入字体图标</span><br><span class="line"><span class="keyword">import</span> <span class="string">"../static/css/iconfont.css"</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="string">"../static/css/iconfont.eot"</span>;</span><br></pre></td></tr></table></figure><h3 id="绑定登陆页面路由地址"><a href="#绑定登陆页面路由地址" class="headerlink" title="绑定登陆页面路由地址"></a>绑定登陆页面路由地址</h3><p>router/index.js</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> Vue <span class="keyword">from</span> <span class="string">"vue"</span></span><br><span class="line"><span class="keyword">import</span> Router <span class="keyword">from</span> <span class="string">"vue-router"</span></span><br><span class="line"></span><br><span class="line">// 导入需要注册路由的组件</span><br><span class="line"><span class="keyword">import</span> Home <span class="keyword">from</span> <span class="string">"../components/Home"</span></span><br><span class="line"><span class="keyword">import</span> Login <span class="keyword">from</span> <span class="string">"../components/Login"</span></span><br><span class="line">Vue.use(Router);</span><br><span class="line"></span><br><span class="line">// 配置路由列表</span><br><span class="line">export default new Router(&#123;</span><br><span class="line">  mode:<span class="string">"history"</span>,</span><br><span class="line">  routes:[</span><br><span class="line">    // 路由列表</span><br><span class="line">...</span><br><span class="line">    &#123;</span><br><span class="line">      name:<span class="string">"Login"</span>,</span><br><span class="line">      path: <span class="string">"/login"</span>,</span><br><span class="line">      component:Login,</span><br><span class="line">    &#125;</span><br><span class="line">  ]</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><h3 id="调整首页头部子组件中登陆按钮的链接信息"><a href="#调整首页头部子组件中登陆按钮的链接信息" class="headerlink" title="调整首页头部子组件中登陆按钮的链接信息"></a>调整首页头部子组件中登陆按钮的链接信息</h3><p>Header.vue</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">router-link</span> <span class="attr">class</span>=<span class="string">"btn log-in"</span> <span class="attr">id</span>=<span class="string">"sign_in"</span> <span class="attr">to</span>=<span class="string">"/login"</span>&gt;</span>登录<span class="tag">&lt;/<span class="name">router-link</span>&gt;</span></span><br></pre></td></tr></table></figure><p>Login.vue</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"logo"</span>&gt;</span><span class="tag">&lt;<span class="name">router-link</span> <span class="attr">to</span>=<span class="string">"/"</span>&gt;</span><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">"/static/image/nav-logo.png"</span> <span class="attr">alt</span>=<span class="string">"Logo"</span>&gt;</span><span class="tag">&lt;/<span class="name">router-link</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">router-link</span> <span class="attr">class</span>=<span class="string">"active"</span> <span class="attr">to</span>=<span class="string">"/user/login"</span>&gt;</span>登录<span class="tag">&lt;/<span class="name">router-link</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="后端实现登陆认证"><a href="#后端实现登陆认证" class="headerlink" title="后端实现登陆认证"></a>后端实现登陆认证</h2><p>Django默认已经提供了认证系统Auth模块。认证系统包含：</p><ul><li>用户管理</li><li>权限系统【RBAC权限机制 Role-Base Access Control基于用户角色的访问控制机制】</li><li>用户组管理</li><li>密码哈希系统[密码加密和验证加密，无法解密]</li><li>用户登录或内容显示的表单和视图</li><li>一个可插拔的后台系统【admin后台运营站点，实际开发中大部分人使用的是xadmin后台运营站点】</li></ul><p>Django默认用户的认证机制依赖Session机制，我们在项目中将引入JWT认证机制，将用户的身份凭据存放在Token字符串中，然后对接Django的认证系统，帮助我们来实现：</p><ul><li>用户的数据模型</li><li>用户密码的加密与验证</li><li>用户的权限系统</li></ul><h3 id="Django用户模型类"><a href="#Django用户模型类" class="headerlink" title="Django用户模型类"></a>Django用户模型类</h3><p>django内置的用户模型文件： django/contrib/auth/model.py</p><p>Django认证系统中提供了用户模型类User保存用户的数据，默认的User包含以下常见的基本字段：</p><p><a href="https://www.notion.so/da82efa5e7a443ac8cb8d87017a9c026" target="_blank" rel="noopener">Untitled</a></p><h3 id="常用方法："><a href="#常用方法：" class="headerlink" title="常用方法："></a>常用方法：</h3><ul><li><p><code>set_password</code>(<em>raw_password</em>)</p><p>设置用户的密码为给定的原始字符串，并负责密码的。 不会保存<code>User</code> 对象。当<code>None</code>为<code>raw_password</code> 时，密码将设置为一个不可用的密码。</p></li><li><p><code>check_password</code>(<em>raw_password</em>)</p><p>如果给定的raw_password是用户的真实密码，则返回True，可以在校验用户密码时使用。</p></li></ul><h3 id="管理器方法："><a href="#管理器方法：" class="headerlink" title="管理器方法："></a>管理器方法：</h3><p>管理器方法即可以通过<code>User.objects.</code> 进行调用的方法。</p><ul><li><p><code>create_user</code>(<em>username</em>, <em>email=None</em>, <em>password=None</em>, <em>**extra_fields</em>)</p><p>创建、保存并返回一个<code>User</code>对象。</p></li><li><p><code>create_superuser</code>(<em>username</em>, <em>email</em>, <em>password</em>, <em>**extra_fields</em>)</p><p>与<code>create_user()</code> 相同，但是设置<code>is_staff</code> 和<code>is_superuser</code> 为<code>True</code>。</p></li></ul><h3 id="创建用户模块的子应用"><a href="#创建用户模块的子应用" class="headerlink" title="创建用户模块的子应用"></a>创建用户模块的子应用</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> renranapi/apps</span><br><span class="line">python ../../manage.py startapp users</span><br></pre></td></tr></table></figure><p>在settings/dev.py中注册users子应用。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">INSTALLED_APPS = [</span><br><span class="line">...</span><br><span class="line">  <span class="string">'users'</span>,</span><br><span class="line">]</span><br></pre></td></tr></table></figure><p>解决因为我们调整子应用保存目录以后导致django无法识别子应用的BUG</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 解决方案：通过把apps设置为导包路径即可解决。</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line"><span class="comment"># Build paths inside the project like this: os.path.join(BASE_DIR, ...)</span></span><br><span class="line">BASE_DIR = os.path.dirname(os.path.dirname(os.path.abspath(__file__)))</span><br><span class="line"></span><br><span class="line"><span class="comment"># 把网站子应用所在目录设置为了导报路径</span></span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line">sys.path.insert(<span class="number">0</span>,os.path.join(BASE_DIR, <span class="string">"apps"</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment"># Quick-start development settings - unsuitable for production</span></span><br><span class="line"><span class="comment"># See https://docs.djangoproject.com/en/2.2/howto/deployment/checklist/</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># SECURITY WARNING: keep the secret key used in production secret!</span></span><br><span class="line">SECRET_KEY = <span class="string">'%=l9-5s0i26qd9687f75&amp;wd60_f-9%*s9df4$l@x(34qey)n3b'</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># SECURITY WARNING: don't run with debug turned on in production!</span></span><br><span class="line">DEBUG = <span class="literal">True</span></span><br><span class="line"></span><br><span class="line">ALLOWED_HOSTS = [</span><br><span class="line">    <span class="string">"api.renran.cn"</span>,</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"><span class="comment"># CORS的白名单[只有在白名单里面的客户端地址才可以通过ajax访问服务端]</span></span><br><span class="line">CORS_ORIGIN_WHITELIST = (</span><br><span class="line">    <span class="string">'http://www.moluo.net:8080'</span>,</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 允许ajax跨域请求时携带cookie</span></span><br><span class="line">CORS_ALLOW_CREDENTIALS = <span class="literal">False</span> <span class="comment"># 表示禁止</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Application definition</span></span><br><span class="line"></span><br><span class="line">INSTALLED_APPS = [</span><br><span class="line">    <span class="string">'django.contrib.admin'</span>,</span><br><span class="line">    <span class="string">'django.contrib.auth'</span>,</span><br><span class="line">    <span class="string">'django.contrib.contenttypes'</span>,</span><br><span class="line">    <span class="string">'django.contrib.sessions'</span>,</span><br><span class="line">    <span class="string">'django.contrib.messages'</span>,</span><br><span class="line">    <span class="string">'django.contrib.staticfiles'</span>,</span><br><span class="line"></span><br><span class="line">    <span class="string">'corsheaders'</span>,</span><br><span class="line"></span><br><span class="line">    <span class="string">'users'</span>,</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"><span class="comment"># ...后面省略</span></span><br></pre></td></tr></table></figure><h3 id="创建自定义的用户模型类"><a href="#创建自定义的用户模型类" class="headerlink" title="创建自定义的用户模型类"></a>创建自定义的用户模型类</h3><p>Django认证系统中提供的用户模型类及方法很方便，我们可以使用这个模型类，但是字段有些无法满足项目需求，如本项目中需要保存用户的手机号，需要给模型类添加额外的字段。</p><p>Django提供了<code>django.contrib.auth.models.AbstractUser</code>用户抽象模型类允许我们继承，扩展字段来使用Django认证系统的用户模型类。</p><p><strong>我们可以在apps中创建Django应用users，并在配置文件中注册users应用。</strong></p><p>在创建好的应用models.py中定义用户的用户模型类。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> django.db <span class="keyword">import</span> models</span><br><span class="line"><span class="keyword">from</span> django.contrib.auth.models <span class="keyword">import</span> AbstractUser</span><br><span class="line"><span class="comment"># Create your models here.</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">User</span><span class="params">(AbstractUser)</span>:</span></span><br><span class="line">    <span class="string">"""用户模型类"""</span></span><br><span class="line">    mobile = models.CharField(max_length=<span class="number">15</span>, null=<span class="literal">True</span>, unique=<span class="literal">True</span>, help_text=<span class="string">"手机号码"</span>,verbose_name=<span class="string">"手机号码"</span>)</span><br><span class="line">    wxchat = models.CharField(max_length=<span class="number">100</span>, null=<span class="literal">True</span>, unique=<span class="literal">True</span>, help_text=<span class="string">"微信账号"</span>,verbose_name=<span class="string">"微信账号"</span>)</span><br><span class="line">    alipay = models.CharField(max_length=<span class="number">100</span>, null=<span class="literal">True</span>, unique=<span class="literal">True</span>, help_text=<span class="string">"支付宝账号"</span>,verbose_name=<span class="string">"支付宝账号"</span>)</span><br><span class="line">    qq_number = models.CharField(max_length=<span class="number">11</span>, null=<span class="literal">True</span>, unique=<span class="literal">True</span>, help_text=<span class="string">"QQ号"</span>,verbose_name=<span class="string">"QQ号"</span>)</span><br><span class="line">    <span class="comment"># 保存文件的子目录</span></span><br><span class="line">    avatar = models.ImageField(upload_to=<span class="string">"avatar"</span>, null=<span class="literal">True</span>, default=<span class="literal">None</span>, verbose_name=<span class="string">"头像"</span>)</span><br><span class="line"></span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">Meta</span>:</span></span><br><span class="line">        db_table = <span class="string">"rr_users"</span></span><br><span class="line">        verbose_name = <span class="string">"用户信息"</span></span><br><span class="line">        verbose_name_plural = verbose_name</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__str__</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="keyword">return</span> self.username</span><br></pre></td></tr></table></figure><p>我们自定义的用户模型类还不能直接被Django的认证系统所识别，需要在配置文件中告知Django认证系统使用我们自定义的模型类。</p><p>在配置文件settings/dev.py，中进行设置</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">AUTH_USER_MODEL = <span class="string">'users.User'</span></span><br></pre></td></tr></table></figure><p><code>AUTH_USER_MODEL</code> 参数的设置以<code>点.</code>来分隔，表示<code>应用名.模型类名</code>。</p><p><strong>注意：Django强烈建议我们对于AUTH_USER_MODEL参数的设置一定要在第一次数据库迁移之前就设置好，否则后续使用可能出现未知错误。</strong></p><p>执行数据库迁移</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">python manage.py makemigrations</span><br><span class="line">python manage.py migrate</span><br></pre></td></tr></table></figure><h3 id="Django-REST-framework-JWT"><a href="#Django-REST-framework-JWT" class="headerlink" title="Django REST framework JWT"></a>Django REST framework JWT</h3><blockquote><p>Json web token (JWT), 是为了在网络应用环境间传递声明而执行的一种基于JSON的开放标准（(RFC 7519).该token被设计为紧凑且安全的，特别适用于分布式站点的单点登录（SSO）场景。JWT的声明一般被用来在身份提供者和服务提供者间传递被认证的用户身份信息，以便于从资源服务器获取资源，也可以增加一些额外的其它业务逻辑所必须的声明信息，该token也可直接被用于认证，也可被加密。</p></blockquote><p>在用户注册或登录后，我们想记录用户的登录状态，或者为用户创建身份认证的凭证。我们不再使用Session认证机制，而使用Json Web Token认证机制。</p><h3 id="JWT的构成"><a href="#JWT的构成" class="headerlink" title="JWT的构成"></a>JWT的构成</h3><p>JWT就一段字符串，由三段信息构成的，将这三段信息文本用<code>.</code>链接一起就构成了Jwt字符串。就像这样:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMjM0NTY3ODkwIiwibmFtZSI6IkpvaG4gRG9lIiwiYWRtaW4iOnRydWV9.TJVA95OrM7E2cBab30RMHrHDcEfxjoYZgeFONFh7HgQ</span><br></pre></td></tr></table></figure><p>第一部分我们称它为头部（header),第二部分我们称其为载荷（payload, 类似于飞机上承载的物品)，第三部分是签证（signature).</p><h3 id="header"><a href="#header" class="headerlink" title="header"></a>header</h3><p>jwt的头部承载两部分信息：</p><ul><li>声明类型，这里是jwt</li><li>声明加密的算法 通常直接使用 HMAC SHA256</li></ul><p>完整的头部就像下面这样的JSON：</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  'typ': 'JWT',</span><br><span class="line">  'alg': 'HS256'</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>然后将头部进行base64加密（该加密是可以对称解密的),构成了第一部分.</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># python代码：</span></span><br><span class="line">headers = <span class="string">'&#123;"tpy":"JWT","alg":"HS256"&#125;'</span></span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line">header_str = base64.b64encode(headers.encode()).decode()</span><br><span class="line">print(header_str)</span><br><span class="line"><span class="comment"># 打印效果：</span></span><br><span class="line"><span class="comment"># eyJ0cHkiOiJKV1QiLCJhbGciOiJIUzI1NiJ9</span></span><br></pre></td></tr></table></figure><h3 id="payload"><a href="#payload" class="headerlink" title="payload"></a>payload</h3><p>载荷就是存放有效信息的地方。这个名字像是特指飞机上承载的货品，这些有效信息包含三个部分</p><ul><li>标准声明</li><li>公共声明</li><li>私有声明</li></ul><p><strong>标准中注册的声明</strong> (建议但不强制使用) ：</p><ul><li><strong>iss</strong>: jwt签发者</li><li><strong>sub</strong>: jwt所面向的用户</li><li><strong>aud</strong>: 接收jwt的一方</li><li><strong>exp</strong>: jwt的过期时间，这个过期时间必须要大于签发时间</li><li><strong>nbf</strong>: 定义在什么时间之前，该jwt都是不可用的.</li><li><strong>iat</strong>: jwt的签发时间</li><li><strong>jti</strong>: jwt的唯一身份标识，主要用来作为一次性token,从而回避重放攻击。</li></ul><p><strong>公共的声明</strong> ： 公共的声明可以添加任何的信息，一般添加用户的相关信息或其他业务需要的必要信息.但不建议添加敏感信息，因为该部分在客户端可解密.</p><p><strong>私有的声明</strong> ： 私有声明是提供者和消费者所共同定义的声明，一般不建议存放敏感信息，因为base64是对称解密的，意味着该部分信息可以归类为明文信息。</p><p>定义一个payload:</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">"sub"</span>: <span class="string">"1234567890"</span>,</span><br><span class="line">  <span class="attr">"name"</span>: <span class="string">"John Doe"</span>,</span><br><span class="line">  <span class="attr">"admin"</span>: <span class="literal">true</span>,</span><br><span class="line">  <span class="attr">"auth"</span>: <span class="string">"2dsg343sdaq223256ddd5454"</span>,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>然后将其进行base64加密，得到JWT的第二部分。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">eyJzdWIiOiIxMjM0NTY3ODkwIiwibmFtZSI6IkpvaG4gRG9lIiwiYWRtaW4iOnRydWV9</span><br></pre></td></tr></table></figure><h3 id="signature"><a href="#signature" class="headerlink" title="signature"></a>signature</h3><p>JWT的第三部分是一个签证信息，这个签证信息的主要作用并非防止解密，而是为了防止别人恶意串改，由三部分组成：</p><ul><li>header (base64后的)</li><li>payload (base64后的)</li><li>secret密钥</li></ul><p>这个部分需要base64加密后的header和base64加密后的payload使用<code>.</code>连接组成的字符串，然后通过header中声明的加密方式进行加盐<code>secret</code>组合加密，然后就构成了jwt的第三部分。</p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// javascript如果要模拟生成你的jwttoken，可能可以采用以下代码生成[注意：伪代码]</span></span><br><span class="line"><span class="keyword">var</span> encodedString = base64UrlEncode(header) + <span class="string">'.'</span> + base64UrlEncode(payload);</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> signature = HMACSHA256(encodedString, <span class="string">'secret'</span>); <span class="comment">// TJVA95OrM7E2cBab30RMHrHDcEfxjoYZgeFONFh7HgQ</span></span><br></pre></td></tr></table></figure><p>将这三部分用<code>.</code>连接成一个完整的字符串,构成了最终的jwt:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMjM0NTY3ODkwIiwibmFtZSI6IkpvaG4gRG9lIiwiYWRtaW4iOnRydWV9.TJVA95OrM7E2cBab30RMHrHDcEfxjoYZgeFONFh7HgQ</span><br></pre></td></tr></table></figure><p><strong>注意：secret是保存在服务器端的，jwt的签发生成也是在服务器端的，secret就是用来进行jwt的签发和jwt的验证，所以，它就是你服务端的私钥，在任何场景都不应该流露出去。一旦客户端得知这个secret, 那就意味着客户端是可以自我签发jwt了。</strong></p><p><strong>关于签发和核验JWT，我们可以使用Django REST framework JWT扩展来完成。</strong></p><p>文档网站<a href="http://getblimp.github.io/django-rest-framework-jwt/" target="_blank" rel="noopener">http://getblimp.github.io/django-rest-framework-jwt/</a></p><h3 id="安装配置JWT"><a href="#安装配置JWT" class="headerlink" title="安装配置JWT"></a>安装配置JWT</h3><p>安装</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install djangorestframework-jwt</span><br></pre></td></tr></table></figure><p>settings/dev.py配置文件</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">REST_FRAMEWORK = &#123;</span><br><span class="line">    <span class="string">'DEFAULT_AUTHENTICATION_CLASSES'</span>: (</span><br><span class="line">        <span class="string">'rest_framework_jwt.authentication.JSONWebTokenAuthentication'</span>,</span><br><span class="line">        <span class="string">'rest_framework.authentication.SessionAuthentication'</span>,</span><br><span class="line">        <span class="string">'rest_framework.authentication.BasicAuthentication'</span>,</span><br><span class="line">    ),</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> datetime</span><br><span class="line">JWT_AUTH = &#123;</span><br><span class="line">    <span class="string">'JWT_EXPIRATION_DELTA'</span>: datetime.timedelta(days=<span class="number">1</span>),</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>JWT_EXPIRATION_DELTA 指明token的有效期</li></ul><h3 id="手动生成jwt"><a href="#手动生成jwt" class="headerlink" title="手动生成jwt"></a>手动生成jwt</h3><p>Django REST framework JWT 扩展的说明文档中提供了手动签发JWT的方法</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">from rest_framework_jwt.settings import api_settings</span><br><span class="line"></span><br><span class="line">jwt_payload_handler &#x3D; api_settings.JWT_PAYLOAD_HANDLER</span><br><span class="line">jwt_encode_handler &#x3D; api_settings.JWT_ENCODE_HANDLER</span><br><span class="line"></span><br><span class="line">payload &#x3D; jwt_payload_handler(user)</span><br><span class="line">token &#x3D; jwt_encode_handler(payload)</span><br></pre></td></tr></table></figure><p>在用户注册或登录成功后，在序列化器中返回用户信息以后同时返回token即可。</p><h3 id="后端实现登陆认证接口"><a href="#后端实现登陆认证接口" class="headerlink" title="后端实现登陆认证接口"></a>后端实现登陆认证接口</h3><p>Django REST framework JWT提供了登录获取token的视图，可以直接使用</p><p>在子应用users路由urls.py中</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">from rest_framework_jwt.views import obtain_jwt_token</span><br><span class="line"></span><br><span class="line">urlpatterns &#x3D; [</span><br><span class="line">    path(&#39;login&#x2F;&#39;, obtain_jwt_token),</span><br><span class="line">]</span><br></pre></td></tr></table></figure><p>在主路由中，引入当前子应用的路由文件</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">urlpatterns &#x3D; [</span><br><span class="line">...</span><br><span class="line">    path(&#39;users&#x2F;&#39;, include(&quot;users.urls&quot;)),</span><br><span class="line">    # include 的值必须是 模块名.urls 格式,字符串中间只能出现一个圆点</span><br><span class="line">]</span><br></pre></td></tr></table></figure><p>接下来，我们可以通过postman来测试下功能</p><p>注意，测试之前因为我们上面自定义用户模型，所以删除了数据库信息，所以需要我们再次补充。</p><p><img src="/images/1553572597916.png" alt="1553572597916.png"></p><h2 id="前端实现登陆功能"><a href="#前端实现登陆功能" class="headerlink" title="前端实现登陆功能"></a>前端实现登陆功能</h2><p>在登陆组件中找到登陆按钮，绑定点击事件</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">button</span> <span class="attr">class</span>=<span class="string">"login_btn"</span> @<span class="attr">click</span>=<span class="string">"loginhander"</span>&gt;</span>登录<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br></pre></td></tr></table></figure><p>在methods中请求后端</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"sign"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"logo"</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"/"</span>&gt;</span><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">"/static/image/nav-logo.png"</span> <span class="attr">alt</span>=<span class="string">"Logo"</span>&gt;</span><span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"main"</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">h4</span> <span class="attr">class</span>=<span class="string">"title"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"normal-title"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">router-link</span> <span class="attr">class</span>=<span class="string">"active"</span> <span class="attr">to</span>=<span class="string">"/user/login"</span>&gt;</span>登录<span class="tag">&lt;/<span class="name">router-link</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">b</span>&gt;</span>·<span class="tag">&lt;/<span class="name">b</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">a</span> <span class="attr">id</span>=<span class="string">"js-sign-up-btn"</span> <span class="attr">class</span>=<span class="string">""</span> <span class="attr">href</span>=<span class="string">"/register"</span>&gt;</span>注册<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">h4</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"js-sign-in-container"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">form</span> <span class="attr">id</span>=<span class="string">"new_session"</span> <span class="attr">action</span>=<span class="string">""</span> <span class="attr">method</span>=<span class="string">"post"</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"input-prepend restyle js-normal"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">placeholder</span>=<span class="string">"登录账号或手机号或邮箱"</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">v-model</span>=<span class="string">"username"</span> <span class="attr">id</span>=<span class="string">"session_email_or_mobile_number"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">i</span> <span class="attr">class</span>=<span class="string">"iconfont ic-user"</span>&gt;</span><span class="tag">&lt;/<span class="name">i</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="comment">&lt;!-- 海外登录登录名输入框 --&gt;</span></span><br><span class="line"></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"input-prepend"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">placeholder</span>=<span class="string">"密码"</span> <span class="attr">type</span>=<span class="string">"password"</span> <span class="attr">v-model</span>=<span class="string">"password"</span> <span class="attr">id</span>=<span class="string">"session_password"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">i</span> <span class="attr">class</span>=<span class="string">"iconfont ic-password"</span>&gt;</span><span class="tag">&lt;/<span class="name">i</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"remember-btn"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"checkbox"</span> <span class="attr">value</span>=<span class="string">"true"</span> <span class="attr">checked</span>=<span class="string">"checked"</span> <span class="attr">v-model</span>=<span class="string">"remember_me"</span> <span class="attr">id</span>=<span class="string">"session_remember_me"</span>&gt;</span><span class="tag">&lt;<span class="name">span</span>&gt;</span>记住我<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"forget-btn"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">a</span> <span class="attr">class</span>=<span class="string">""</span> <span class="attr">href</span>=<span class="string">""</span>&gt;</span>登录遇到问题?<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">button</span> <span class="attr">class</span>=<span class="string">"sign-in-button"</span> <span class="attr">id</span>=<span class="string">"sign-in-form-submit-btn"</span> <span class="attr">type</span>=<span class="string">"button"</span> @<span class="attr">click.prevent</span>=<span class="string">"loginhander"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">span</span> <span class="attr">id</span>=<span class="string">"sign-in-loading"</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span>登录</span><br><span class="line">      <span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- 更多登录方式 --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"more-sign"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h6</span>&gt;</span>社交帐号登录<span class="tag">&lt;/<span class="name">h6</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">ul</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">li</span> <span class="attr">id</span>=<span class="string">"weibo-link-wrap"</span> <span class="attr">class</span>=<span class="string">""</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">a</span> <span class="attr">class</span>=<span class="string">"weibo"</span> <span class="attr">id</span>=<span class="string">"weibo-link"</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">i</span> <span class="attr">class</span>=<span class="string">"iconfont ic-weibo"</span>&gt;</span><span class="tag">&lt;/<span class="name">i</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">id</span>=<span class="string">"weixin"</span> <span class="attr">class</span>=<span class="string">"weixin"</span> <span class="attr">target</span>=<span class="string">"_blank"</span> <span class="attr">href</span>=<span class="string">""</span>&gt;</span><span class="tag">&lt;<span class="name">i</span> <span class="attr">class</span>=<span class="string">"iconfont ic-wechat"</span>&gt;</span><span class="tag">&lt;/<span class="name">i</span>&gt;</span><span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">id</span>=<span class="string">"qq"</span> <span class="attr">class</span>=<span class="string">"qq"</span> <span class="attr">target</span>=<span class="string">"_blank"</span> <span class="attr">href</span>=<span class="string">""</span>&gt;</span><span class="tag">&lt;<span class="name">i</span> <span class="attr">class</span>=<span class="string">"iconfont ic-qq_connect"</span>&gt;</span><span class="tag">&lt;/<span class="name">i</span>&gt;</span><span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript">    <span class="keyword">export</span> <span class="keyword">default</span> &#123;</span></span><br><span class="line"><span class="actionscript">        name: <span class="string">"Login"</span>,</span></span><br><span class="line">        data()&#123;</span><br><span class="line"><span class="actionscript">          <span class="keyword">return</span> &#123;</span></span><br><span class="line"><span class="actionscript">             username:<span class="string">""</span>,</span></span><br><span class="line"><span class="actionscript">             password:<span class="string">""</span>,</span></span><br><span class="line"><span class="actionscript">             remember_me: <span class="literal">false</span>,</span></span><br><span class="line">          &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        methods:&#123;</span><br><span class="line"><span class="actionscript">          <span class="comment">// 登录</span></span></span><br><span class="line">          loginhander()&#123;</span><br><span class="line"><span class="actionscript">            <span class="keyword">this</span>.$axios.post(<span class="keyword">this</span>.$settings.Host+<span class="string">"/users/login/"</span>,</span></span><br><span class="line">              &#123;</span><br><span class="line"><span class="actionscript">                <span class="string">"username"</span>:<span class="keyword">this</span>.username,</span></span><br><span class="line"><span class="actionscript">                <span class="string">"password"</span>:<span class="keyword">this</span>.password</span></span><br><span class="line"><span class="javascript">              &#125;).then(<span class="function"><span class="params">response</span>=&gt;</span>&#123;</span></span><br><span class="line"><span class="javascript">              <span class="built_in">console</span>.log(response.data)</span></span><br><span class="line"><span class="javascript">              &#125;).catch(<span class="function"><span class="params">error</span>=&gt;</span>&#123;</span></span><br><span class="line"><span class="javascript">                <span class="built_in">console</span>.log(error);</span></span><br><span class="line">              &#125;)</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">    &#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="2-3-7-前端保存jwt"><a href="#2-3-7-前端保存jwt" class="headerlink" title="2.3.7 前端保存jwt"></a>2.3.7 前端保存jwt</h3><p>我们可以将JWT保存在cookie中，也可以保存在浏览器的本地存储里，我们保存在浏览器本地存储中</p><p>浏览器的本地存储提供了sessionStorage 和 localStorage 两种：</p><ul><li><strong>sessionStorage</strong> 浏览器关闭即失效</li><li><strong>localStorage</strong> 长期有效</li></ul><p>使用方法</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">sessionStorage.变量名 = 变量值   // 保存数据</span><br><span class="line">sessionStorage.变量名  // 读取数据</span><br><span class="line">sessionStorage.clear()  // 清除所有sessionStorage保存的数据</span><br><span class="line"></span><br><span class="line">localStorage.变量名 = 变量值   // 保存数据</span><br><span class="line">localStorage.变量名  // 读取数据</span><br><span class="line">localStorage.clear()  // 清除所有localStorage保存的数据</span><br></pre></td></tr></table></figure><p>登陆组件代码Login.vue</p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">methods:&#123;</span><br><span class="line">          <span class="comment">// 登录</span></span><br><span class="line">          loginhander()&#123;</span><br><span class="line">            <span class="keyword">this</span>.$axios.post(<span class="keyword">this</span>.$settings.Host+<span class="string">"/users/login/"</span>,</span><br><span class="line">              &#123;</span><br><span class="line">                <span class="string">"username"</span>:<span class="keyword">this</span>.username,</span><br><span class="line">                <span class="string">"password"</span>:<span class="keyword">this</span>.password</span><br><span class="line">              &#125;).then(<span class="function"><span class="params">response</span>=&gt;</span>&#123;</span><br><span class="line">                  <span class="comment">// 使用浏览器本地存储保存token</span></span><br><span class="line">                  <span class="keyword">if</span> (<span class="keyword">this</span>.remember_me) &#123;</span><br><span class="line">                    <span class="comment">// 记住登录</span></span><br><span class="line">                    sessionStorage.clear();</span><br><span class="line">                    localStorage.user_token = response.data.token;</span><br><span class="line">                  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    <span class="comment">// 未记住登录</span></span><br><span class="line">                    localStorage.clear();</span><br><span class="line">                    sessionStorage.user_token = response.data.token;</span><br><span class="line">                  &#125;</span><br><span class="line"></span><br><span class="line">                  <span class="keyword">this</span>.$confirm(<span class="string">'登录成功, 欢迎回来！'</span>, <span class="string">'提示'</span>, &#123;</span><br><span class="line">                    confirmButtonText: <span class="string">'返回首页'</span>,</span><br><span class="line">                    cancelButtonText: <span class="string">'返回上一页'</span>,</span><br><span class="line">                    type: <span class="string">'success'</span></span><br><span class="line">                  &#125;).then(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">                    <span class="keyword">this</span>.$router.push(<span class="string">"/"</span>);</span><br><span class="line">                  &#125;).catch(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">                    <span class="keyword">this</span>.$router.go(<span class="number">-1</span>);</span><br><span class="line">                  &#125;);</span><br><span class="line"></span><br><span class="line">              &#125;).catch(<span class="function"><span class="params">error</span>=&gt;</span>&#123;</span><br><span class="line">                <span class="built_in">console</span>.log(error);</span><br><span class="line">              &#125;)</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;,</span><br></pre></td></tr></table></figure><p>默认的返回值仅有token，我们还需在返回值中增加username和id，方便在客户端页面中显示当前登陆用户</p><p>通过修改该视图的返回值可以完成我们的需求。</p><p>在users/utils.py 中，创建</p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">def jwt_response_payload_handler(token, user=None, request=None):</span><br><span class="line">    <span class="string">""</span><span class="string">"</span></span><br><span class="line"><span class="string">    自定义jwt认证成功返回数据</span></span><br><span class="line"><span class="string">    "</span><span class="string">""</span></span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">        <span class="string">'token'</span>: token,</span><br><span class="line">        <span class="string">'id'</span>: user.id,</span><br><span class="line">        <span class="string">'username'</span>: user.username,</span><br><span class="line">        <span class="string">'avatar'</span>: user.avatar.url,</span><br><span class="line">        <span class="string">'nickname'</span>: user.nickname,</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p>修改settings/dev.py配置文件</p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"># JWT</span><br><span class="line">JWT_AUTH = &#123;</span><br><span class="line">    <span class="string">'JWT_EXPIRATION_DELTA'</span>: datetime.timedelta(days=<span class="number">1</span>),</span><br><span class="line">    <span class="string">'JWT_RESPONSE_PAYLOAD_HANDLER'</span>: <span class="string">'users.utils.jwt_response_payload_handler'</span>,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>登陆组件代码Login.vue</p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line">methods:&#123;</span><br><span class="line">          <span class="comment">// 登录</span></span><br><span class="line">          loginhander()&#123;</span><br><span class="line">            <span class="keyword">this</span>.$axios.post(<span class="keyword">this</span>.$settings.Host+<span class="string">"/users/login/"</span>,</span><br><span class="line">              &#123;</span><br><span class="line">                <span class="string">"username"</span>:<span class="keyword">this</span>.username,</span><br><span class="line">                <span class="string">"password"</span>:<span class="keyword">this</span>.password</span><br><span class="line">              &#125;).then(<span class="function"><span class="params">response</span>=&gt;</span>&#123;</span><br><span class="line">                  <span class="comment">// 使用浏览器本地存储保存token</span></span><br><span class="line">                  <span class="keyword">if</span> (<span class="keyword">this</span>.remember_me) &#123;</span><br><span class="line">                    <span class="comment">// 记住登录</span></span><br><span class="line">                    sessionStorage.removeItem(<span class="string">"user_token"</span>);</span><br><span class="line">                    sessionStorage.removeItem(<span class="string">"user_id"</span>);</span><br><span class="line">                    sessionStorage.removeItem(<span class="string">"user_name"</span>);</span><br><span class="line">                    sessionStorage.removeItem(<span class="string">"user_avatar"</span>);</span><br><span class="line">                    sessionStorage.removeItem(<span class="string">"user_nickname"</span>);</span><br><span class="line">                    localStorage.user_token = response.data.token;</span><br><span class="line">                    localStorage.user_id = response.data.id;</span><br><span class="line">                    localStorage.user_name = response.data.username;</span><br><span class="line">                    localStorage.user_avatar = response.data.avatar;</span><br><span class="line">                    localStorage.user_nickname = response.data.nickname;</span><br><span class="line">                  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    <span class="comment">// 未记住登录</span></span><br><span class="line">                    localStorage.removeItem(<span class="string">"user_token"</span>);</span><br><span class="line">                    localStorage.removeItem(<span class="string">"user_id"</span>);</span><br><span class="line">                    localStorage.removeItem(<span class="string">"user_name"</span>);</span><br><span class="line">                    localStorage.removeItem(<span class="string">"user_avatar"</span>);</span><br><span class="line">                    localStorage.removeItem(<span class="string">"user_nickname"</span>);</span><br><span class="line">                    sessionStorage.user_token = response.data.token;</span><br><span class="line">                    sessionStorage.user_id = response.data.id;</span><br><span class="line">                    sessionStorage.user_name = response.data.username;</span><br><span class="line">                    sessionStorage.user_avatar = response.data.avatar;</span><br><span class="line">                    sessionStorage.user_nickname = response.data.nickname;</span><br><span class="line">                  &#125;</span><br><span class="line">                  <span class="keyword">this</span>.$confirm(<span class="string">'登录成功, 欢迎回来！'</span>, <span class="string">'提示'</span>, &#123;</span><br><span class="line">                    confirmButtonText: <span class="string">'返回首页'</span>,</span><br><span class="line">                    cancelButtonText: <span class="string">'返回上一页'</span>,</span><br><span class="line">                    type: <span class="string">'success'</span></span><br><span class="line">                  &#125;).then(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">                    <span class="keyword">this</span>.$router.push(<span class="string">"/"</span>);</span><br><span class="line">                  &#125;).catch(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">                    <span class="keyword">this</span>.$router.go(<span class="number">-1</span>);</span><br><span class="line">                  &#125;);</span><br><span class="line"></span><br><span class="line">              &#125;).catch(<span class="function"><span class="params">error</span>=&gt;</span>&#123;</span><br><span class="line">                  <span class="keyword">this</span>.$message.error(<span class="string">"登录失败！账号或密码错误！"</span>);</span><br><span class="line">                  <span class="keyword">this</span>.username = <span class="string">""</span>;</span><br><span class="line">                  <span class="keyword">this</span>.password = <span class="string">""</span>;</span><br><span class="line">              &#125;)</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;,</span><br></pre></td></tr></table></figure><h3 id="2-3-9-多条件登录"><a href="#2-3-9-多条件登录" class="headerlink" title="2.3.9 多条件登录"></a>2.3.9 多条件登录</h3><p>JWT扩展的登录视图，在收到用户名与密码时，也是调用Django的认证系统中提供的<strong>authenticate()</strong>来检查用户名与密码是否正确。</p><p>我们可以通过修改Django认证系统的认证后端（主要是authenticate方法）来支持登录账号既可以是用户名也可以是手机号。</p><p><strong>修改Django认证系统的认证后端需要继承django.contrib.auth.backends.ModelBackend，并重写authenticate方法。</strong></p><p><code>authenticate(self, request, username=None, password=None, **kwargs)</code>方法的参数说明：</p><ul><li>request 本次认证的请求对象</li><li>username 本次认证提供的用户账号</li><li>password 本次认证提供的密码</li></ul><p><strong>我们想要让用户既可以以用户名登录，也可以以手机号登录，那么对于authenticate方法而言，username参数即表示用户名或者手机号。</strong></p><p>重写authenticate方法的思路：</p><ol><li>根据username参数查找用户User对象，username参数可能是用户名，也可能是手机号</li><li>若查找到User对象，调用User对象的 check_password 方法检查密码是否正确</li></ol><p>在users/utils.py中编写：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> django.contrib.auth.backends <span class="keyword">import</span> ModelBackend</span><br><span class="line"><span class="keyword">from</span> .models <span class="keyword">import</span> User</span><br><span class="line"><span class="keyword">from</span> django.db.models <span class="keyword">import</span> Q</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_user_by_account</span><span class="params">(account)</span>:</span></span><br><span class="line">    <span class="string">"""根据账号信息获取用户模型"""</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        user = User.objects.get(Q(mobile=account) | Q(email=account)| Q(username=account))</span><br><span class="line">    <span class="keyword">except</span> User.DoesNotExist:</span><br><span class="line">        user = <span class="literal">None</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> user</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">UsernameMobileAuthBackend</span><span class="params">(ModelBackend)</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">authenticate</span><span class="params">(self, request, username=None, password=None, **kwargs)</span>:</span></span><br><span class="line">        <span class="comment"># 进行登录判断</span></span><br><span class="line">        user = get_user_by_account(username)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 账号通过了还要进行密码的验证,以及判断当前站好是否是激活状态</span></span><br><span class="line">        <span class="keyword">if</span> isinstance(user,User) <span class="keyword">and</span> user.check_password(password) <span class="keyword">and</span> self.user_can_authenticate(user):</span><br><span class="line">            <span class="keyword">return</span> user</span><br></pre></td></tr></table></figure><p>在配置文件settings/dev.py中告知Django使用我们自定义的认证后端</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">AUTHENTICATION_BACKENDS = [</span><br><span class="line">    <span class="string">'users.utils.UsernameMobileAuthBackend'</span>,</span><br><span class="line">]</span><br></pre></td></tr></table></figure><h2 id="在登录认证中接入腾讯防水墙验证码"><a href="#在登录认证中接入腾讯防水墙验证码" class="headerlink" title="在登录认证中接入腾讯防水墙验证码"></a>在登录认证中接入腾讯防水墙验证码</h2><p>官网： <a href="https://007.qq.com/" target="_blank" rel="noopener">https://007.qq.com</a></p><p>使用微信扫码登录腾讯云控制台，然后根据官方文档，把验证码集成到项目中</p><p>快速接入：<a href="https://007.qq.com/python-access.html?ADTAG=acces.start" target="_blank" rel="noopener">https://007.qq.com/python-access.html?ADTAG=acces.start</a></p><ol><li><p>访问地址: <a href="https://cloud.tencent.com/document/product/1110/36839" target="_blank" rel="noopener">https://cloud.tencent.com/document/product/1110/36839</a></p></li><li><p>访问云API秘钥</p></li><li><p>访问验证码控制台: <a href="https://console.cloud.tencent.com/captcha" target="_blank" rel="noopener">https://console.cloud.tencent.com/captcha</a></p></li><li><p>新建验证[ 新用户可以领取一个免费的验证码套餐 ]</p><p><img src="/images/1578277301522.png" alt="1578277301522.png"></p></li></ol><p><img src="/images/1578277415727.png" alt="1578277415727.png"></p><p>点击详情:</p><p><img src="/images/1578277442350.png" alt="1578277442350.png"></p><p>获取当前验证码应用的应用ID和应用秘钥.</p><p><img src="/images/1578277500168.png" alt="1578277500168.png"></p><p>把秘钥和ID保存到settings/dev.py配置文件中.</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"># 腾讯防水墙配置</span><br><span class="line">TENCENT_CAPTCHA = &#123;</span><br><span class="line">    "GATEWAY": "https://ssl.captcha.qq.com/ticket/verify",</span><br><span class="line">    "APPID": "2086888489",</span><br><span class="line">    "App_Secret_Key": "0TGMvQXvBZ54r9bOWrNYEhA**",</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="前端获取显示并校验验证码"><a href="#前端获取显示并校验验证码" class="headerlink" title="前端获取显示并校验验证码"></a>前端获取显示并校验验证码</h3><p>把防水墙的前端核心js文件通过index.html引入。</p><p>下载地址：<a href="https://ssl.captcha.qq.com/TCaptcha.js" target="_blank" rel="noopener">https://ssl.captcha.qq.com/TCaptcha.js</a></p><p>在settings.js中添加配置：</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">export default &#123;</span><br><span class="line">  Host:"http://api.renran.cn:8000",</span><br><span class="line">  TC_captcha:&#123;</span><br><span class="line">    app_id: "2086888489",</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>Login.vue代码</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br><span class="line">476</span><br><span class="line">477</span><br><span class="line">478</span><br><span class="line">479</span><br><span class="line">480</span><br><span class="line">481</span><br><span class="line">482</span><br><span class="line">483</span><br><span class="line">484</span><br><span class="line">485</span><br><span class="line">486</span><br><span class="line">487</span><br><span class="line">488</span><br><span class="line">489</span><br><span class="line">490</span><br><span class="line">491</span><br><span class="line">492</span><br><span class="line">493</span><br><span class="line">494</span><br><span class="line">495</span><br><span class="line">496</span><br><span class="line">497</span><br><span class="line">498</span><br><span class="line">499</span><br><span class="line">500</span><br><span class="line">501</span><br><span class="line">502</span><br><span class="line">503</span><br><span class="line">504</span><br><span class="line">505</span><br><span class="line">506</span><br><span class="line">507</span><br><span class="line">508</span><br><span class="line">509</span><br><span class="line">510</span><br><span class="line">511</span><br><span class="line">512</span><br><span class="line">513</span><br><span class="line">514</span><br><span class="line">515</span><br><span class="line">516</span><br><span class="line">517</span><br><span class="line">518</span><br><span class="line">519</span><br><span class="line">520</span><br><span class="line">521</span><br><span class="line">522</span><br><span class="line">523</span><br><span class="line">524</span><br><span class="line">525</span><br><span class="line">526</span><br><span class="line">527</span><br><span class="line">528</span><br><span class="line">529</span><br><span class="line">530</span><br><span class="line">531</span><br><span class="line">532</span><br><span class="line">533</span><br><span class="line">534</span><br><span class="line">535</span><br><span class="line">536</span><br><span class="line">537</span><br><span class="line">538</span><br><span class="line">539</span><br><span class="line">540</span><br><span class="line">541</span><br><span class="line">542</span><br><span class="line">543</span><br><span class="line">544</span><br><span class="line">545</span><br><span class="line">546</span><br><span class="line">547</span><br><span class="line">548</span><br><span class="line">549</span><br><span class="line">550</span><br><span class="line">551</span><br><span class="line">552</span><br><span class="line">553</span><br><span class="line">554</span><br><span class="line">555</span><br><span class="line">556</span><br><span class="line">557</span><br><span class="line">558</span><br><span class="line">559</span><br><span class="line">560</span><br><span class="line">561</span><br><span class="line">562</span><br><span class="line">563</span><br><span class="line">564</span><br><span class="line">565</span><br><span class="line">566</span><br><span class="line">567</span><br><span class="line">568</span><br><span class="line">569</span><br><span class="line">570</span><br><span class="line">571</span><br><span class="line">572</span><br><span class="line">573</span><br><span class="line">574</span><br><span class="line">575</span><br><span class="line">576</span><br><span class="line">577</span><br><span class="line">578</span><br><span class="line">579</span><br><span class="line">580</span><br><span class="line">581</span><br><span class="line">582</span><br><span class="line">583</span><br><span class="line">584</span><br><span class="line">585</span><br><span class="line">586</span><br><span class="line">587</span><br><span class="line">588</span><br><span class="line">589</span><br><span class="line">590</span><br><span class="line">591</span><br><span class="line">592</span><br><span class="line">593</span><br><span class="line">594</span><br><span class="line">595</span><br><span class="line">596</span><br><span class="line">597</span><br><span class="line">598</span><br><span class="line">599</span><br><span class="line">600</span><br><span class="line">601</span><br><span class="line">602</span><br><span class="line">603</span><br><span class="line">604</span><br><span class="line">605</span><br><span class="line">606</span><br><span class="line">607</span><br><span class="line">608</span><br><span class="line">609</span><br><span class="line">610</span><br><span class="line">611</span><br><span class="line">612</span><br><span class="line">613</span><br><span class="line">614</span><br><span class="line">615</span><br><span class="line">616</span><br><span class="line">617</span><br><span class="line">618</span><br><span class="line">619</span><br><span class="line">620</span><br><span class="line">621</span><br><span class="line">622</span><br><span class="line">623</span><br><span class="line">624</span><br><span class="line">625</span><br><span class="line">626</span><br><span class="line">627</span><br><span class="line">628</span><br><span class="line">629</span><br><span class="line">630</span><br><span class="line">631</span><br><span class="line">632</span><br><span class="line">633</span><br><span class="line">634</span><br><span class="line">635</span><br><span class="line">636</span><br><span class="line">637</span><br><span class="line">638</span><br><span class="line">639</span><br><span class="line">640</span><br><span class="line">641</span><br><span class="line">642</span><br><span class="line">643</span><br><span class="line">644</span><br><span class="line">645</span><br><span class="line">646</span><br><span class="line">647</span><br><span class="line">648</span><br><span class="line">649</span><br><span class="line">650</span><br><span class="line">651</span><br><span class="line">652</span><br><span class="line">653</span><br><span class="line">654</span><br><span class="line">655</span><br><span class="line">656</span><br><span class="line">657</span><br><span class="line">658</span><br><span class="line">659</span><br><span class="line">660</span><br><span class="line">661</span><br><span class="line">662</span><br><span class="line">663</span><br><span class="line">664</span><br><span class="line">665</span><br><span class="line">666</span><br><span class="line">667</span><br><span class="line">668</span><br><span class="line">669</span><br><span class="line">670</span><br><span class="line">671</span><br><span class="line">672</span><br><span class="line">673</span><br><span class="line">674</span><br><span class="line">675</span><br><span class="line">676</span><br><span class="line">677</span><br><span class="line">678</span><br><span class="line">679</span><br><span class="line">680</span><br><span class="line">681</span><br><span class="line">682</span><br><span class="line">683</span><br><span class="line">684</span><br><span class="line">685</span><br><span class="line">686</span><br><span class="line">687</span><br><span class="line">688</span><br><span class="line">689</span><br><span class="line">690</span><br><span class="line">691</span><br><span class="line">692</span><br><span class="line">693</span><br><span class="line">694</span><br><span class="line">695</span><br><span class="line">696</span><br><span class="line">697</span><br><span class="line">698</span><br><span class="line">699</span><br><span class="line">700</span><br><span class="line">701</span><br><span class="line">702</span><br><span class="line">703</span><br><span class="line">704</span><br><span class="line">705</span><br><span class="line">706</span><br><span class="line">707</span><br><span class="line">708</span><br><span class="line">709</span><br><span class="line">710</span><br><span class="line">711</span><br><span class="line">712</span><br><span class="line">713</span><br><span class="line">714</span><br><span class="line">715</span><br><span class="line">716</span><br><span class="line">717</span><br><span class="line">718</span><br><span class="line">719</span><br><span class="line">720</span><br><span class="line">721</span><br><span class="line">722</span><br><span class="line">723</span><br><span class="line">724</span><br><span class="line">725</span><br><span class="line">726</span><br><span class="line">727</span><br><span class="line">728</span><br><span class="line">729</span><br><span class="line">730</span><br><span class="line">731</span><br><span class="line">732</span><br><span class="line">733</span><br><span class="line">734</span><br><span class="line">735</span><br><span class="line">736</span><br><span class="line">737</span><br><span class="line">738</span><br><span class="line">739</span><br><span class="line">740</span><br><span class="line">741</span><br><span class="line">742</span><br><span class="line">743</span><br><span class="line">744</span><br><span class="line">745</span><br><span class="line">746</span><br><span class="line">747</span><br><span class="line">748</span><br><span class="line">749</span><br><span class="line">750</span><br><span class="line">751</span><br><span class="line">752</span><br><span class="line">753</span><br><span class="line">754</span><br><span class="line">755</span><br><span class="line">756</span><br><span class="line">757</span><br><span class="line">758</span><br><span class="line">759</span><br><span class="line">760</span><br><span class="line">761</span><br><span class="line">762</span><br><span class="line">763</span><br><span class="line">764</span><br><span class="line">765</span><br><span class="line">766</span><br><span class="line">767</span><br><span class="line">768</span><br><span class="line">769</span><br><span class="line">770</span><br><span class="line">771</span><br><span class="line">772</span><br><span class="line">773</span><br><span class="line">774</span><br><span class="line">775</span><br><span class="line">776</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"sign"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"logo"</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"/"</span>&gt;</span><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">"/static/image/nav-logo.png"</span> <span class="attr">alt</span>=<span class="string">"Logo"</span>&gt;</span><span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"main"</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">h4</span> <span class="attr">class</span>=<span class="string">"title"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"normal-title"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">router-link</span> <span class="attr">class</span>=<span class="string">"active"</span> <span class="attr">to</span>=<span class="string">"/user/login"</span>&gt;</span>登录<span class="tag">&lt;/<span class="name">router-link</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">b</span>&gt;</span>·<span class="tag">&lt;/<span class="name">b</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">a</span> <span class="attr">id</span>=<span class="string">"js-sign-up-btn"</span> <span class="attr">class</span>=<span class="string">""</span> <span class="attr">href</span>=<span class="string">"/register"</span>&gt;</span>注册<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">h4</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"js-sign-in-container"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">form</span> <span class="attr">id</span>=<span class="string">"new_session"</span> <span class="attr">action</span>=<span class="string">""</span> <span class="attr">method</span>=<span class="string">"post"</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"input-prepend restyle js-normal"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">placeholder</span>=<span class="string">"登录账号或手机号或邮箱"</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">v-model</span>=<span class="string">"username"</span> <span class="attr">id</span>=<span class="string">"session_email_or_mobile_number"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">i</span> <span class="attr">class</span>=<span class="string">"iconfont ic-user"</span>&gt;</span><span class="tag">&lt;/<span class="name">i</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="comment">&lt;!-- 海外登录登录名输入框 --&gt;</span></span><br><span class="line"></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"input-prepend"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">placeholder</span>=<span class="string">"密码"</span> <span class="attr">type</span>=<span class="string">"password"</span> <span class="attr">v-model</span>=<span class="string">"password"</span> <span class="attr">id</span>=<span class="string">"session_password"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">i</span> <span class="attr">class</span>=<span class="string">"iconfont ic-password"</span>&gt;</span><span class="tag">&lt;/<span class="name">i</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"remember-btn"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"checkbox"</span> <span class="attr">value</span>=<span class="string">"true"</span> <span class="attr">checked</span>=<span class="string">"checked"</span> <span class="attr">v-model</span>=<span class="string">"remember_me"</span> <span class="attr">id</span>=<span class="string">"session_remember_me"</span>&gt;</span><span class="tag">&lt;<span class="name">span</span>&gt;</span>记住我<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"forget-btn"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">a</span> <span class="attr">class</span>=<span class="string">""</span> <span class="attr">href</span>=<span class="string">""</span>&gt;</span>登录遇到问题?<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">button</span> <span class="attr">class</span>=<span class="string">"sign-in-button"</span> <span class="attr">id</span>=<span class="string">"sign-in-form-submit-btn"</span> <span class="attr">type</span>=<span class="string">"button"</span> @<span class="attr">click.prevent</span>=<span class="string">"show_captcha"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">span</span> <span class="attr">id</span>=<span class="string">"sign-in-loading"</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span>登录</span><br><span class="line">      <span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- 更多登录方式 --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"more-sign"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h6</span>&gt;</span>社交帐号登录<span class="tag">&lt;/<span class="name">h6</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">ul</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">li</span> <span class="attr">id</span>=<span class="string">"weibo-link-wrap"</span> <span class="attr">class</span>=<span class="string">""</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">a</span> <span class="attr">class</span>=<span class="string">"weibo"</span> <span class="attr">id</span>=<span class="string">"weibo-link"</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">i</span> <span class="attr">class</span>=<span class="string">"iconfont ic-weibo"</span>&gt;</span><span class="tag">&lt;/<span class="name">i</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">id</span>=<span class="string">"weixin"</span> <span class="attr">class</span>=<span class="string">"weixin"</span> <span class="attr">target</span>=<span class="string">"_blank"</span> <span class="attr">href</span>=<span class="string">""</span>&gt;</span><span class="tag">&lt;<span class="name">i</span> <span class="attr">class</span>=<span class="string">"iconfont ic-wechat"</span>&gt;</span><span class="tag">&lt;/<span class="name">i</span>&gt;</span><span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">id</span>=<span class="string">"qq"</span> <span class="attr">class</span>=<span class="string">"qq"</span> <span class="attr">target</span>=<span class="string">"_blank"</span> <span class="attr">href</span>=<span class="string">""</span>&gt;</span><span class="tag">&lt;<span class="name">i</span> <span class="attr">class</span>=<span class="string">"iconfont ic-qq_connect"</span>&gt;</span><span class="tag">&lt;/<span class="name">i</span>&gt;</span><span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="actionscript">    <span class="meta"><span class="meta-keyword">import</span> "../../static/js/TCaptcha";</span></span></span><br><span class="line"><span class="javascript">    <span class="keyword">export</span> <span class="keyword">default</span> &#123;</span></span><br><span class="line"><span class="actionscript">        name: <span class="string">"Login"</span>,</span></span><br><span class="line">        data()&#123;</span><br><span class="line"><span class="actionscript">          <span class="keyword">return</span> &#123;</span></span><br><span class="line"><span class="actionscript">             username:<span class="string">""</span>,</span></span><br><span class="line"><span class="actionscript">             password:<span class="string">""</span>,</span></span><br><span class="line"><span class="actionscript">             remember_me: <span class="literal">false</span>,</span></span><br><span class="line">          &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        methods:&#123;</span><br><span class="line"><span class="actionscript">          <span class="comment">// 登录</span></span></span><br><span class="line">          loginhander()&#123;</span><br><span class="line"><span class="actionscript">            <span class="keyword">this</span>.$axios.post(<span class="keyword">this</span>.$settings.Host+<span class="string">"/users/login/"</span>,</span></span><br><span class="line">              &#123;</span><br><span class="line"><span class="actionscript">                <span class="string">"username"</span>:<span class="keyword">this</span>.username,</span></span><br><span class="line"><span class="actionscript">                <span class="string">"password"</span>:<span class="keyword">this</span>.password</span></span><br><span class="line"><span class="javascript">              &#125;).then(<span class="function"><span class="params">response</span>=&gt;</span>&#123;</span></span><br><span class="line"><span class="actionscript">                  <span class="comment">// 使用浏览器本地存储保存token</span></span></span><br><span class="line"><span class="actionscript">                  <span class="keyword">if</span> (<span class="keyword">this</span>.remember_me) &#123;</span></span><br><span class="line"><span class="actionscript">                    <span class="comment">// 记住登录</span></span></span><br><span class="line"><span class="actionscript">                    sessionStorage.removeItem(<span class="string">"user_token"</span>);</span></span><br><span class="line"><span class="actionscript">                    sessionStorage.removeItem(<span class="string">"user_id"</span>);</span></span><br><span class="line"><span class="actionscript">                    sessionStorage.removeItem(<span class="string">"user_name"</span>);</span></span><br><span class="line"><span class="actionscript">                    sessionStorage.removeItem(<span class="string">"user_avatar"</span>);</span></span><br><span class="line">                    localStorage.user_token = response.data.token;</span><br><span class="line">                    localStorage.user_id = response.data.id;</span><br><span class="line">                    localStorage.user_name = response.data.username;</span><br><span class="line">                    localStorage.user_avatar = response.data.avatar;</span><br><span class="line"><span class="actionscript">                  &#125; <span class="keyword">else</span> &#123;</span></span><br><span class="line"><span class="actionscript">                    <span class="comment">// 未记住登录</span></span></span><br><span class="line"><span class="actionscript">                    localStorage.removeItem(<span class="string">"user_token"</span>);</span></span><br><span class="line"><span class="actionscript">                    localStorage.removeItem(<span class="string">"user_id"</span>);</span></span><br><span class="line"><span class="actionscript">                    localStorage.removeItem(<span class="string">"user_name"</span>);</span></span><br><span class="line"><span class="actionscript">                    localStorage.removeItem(<span class="string">"user_avatar"</span>);</span></span><br><span class="line">                    sessionStorage.user_token = response.data.token;</span><br><span class="line">                    sessionStorage.user_id = response.data.id;</span><br><span class="line">                    sessionStorage.user_name = response.data.username;</span><br><span class="line">                    sessionStorage.user_avatar = response.data.avatar;</span><br><span class="line">                  &#125;</span><br><span class="line"></span><br><span class="line"><span class="actionscript">                  <span class="keyword">this</span>.$confirm(<span class="string">'登录成功, 欢迎回来！'</span>, <span class="string">'提示'</span>, &#123;</span></span><br><span class="line"><span class="actionscript">                    confirmButtonText: <span class="string">'返回首页'</span>,</span></span><br><span class="line"><span class="actionscript">                    cancelButtonText: <span class="string">'返回上一页'</span>,</span></span><br><span class="line"><span class="actionscript">                    type: <span class="string">'success'</span></span></span><br><span class="line"><span class="javascript">                  &#125;).then(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span></span><br><span class="line"><span class="actionscript">                    <span class="keyword">this</span>.$router.push(<span class="string">"/"</span>);</span></span><br><span class="line"><span class="javascript">                  &#125;).catch(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span></span><br><span class="line"><span class="actionscript">                    <span class="keyword">this</span>.$router.go(<span class="number">-1</span>);</span></span><br><span class="line">                  &#125;);</span><br><span class="line"></span><br><span class="line"><span class="javascript">              &#125;).catch(<span class="function"><span class="params">error</span>=&gt;</span>&#123;</span></span><br><span class="line"><span class="actionscript">                  <span class="keyword">this</span>.$message.error(<span class="string">"登录失败！账号或密码错误！"</span>);</span></span><br><span class="line"><span class="actionscript">                  <span class="keyword">this</span>.username = <span class="string">""</span>;</span></span><br><span class="line"><span class="actionscript">                  <span class="keyword">this</span>.password = <span class="string">""</span>;</span></span><br><span class="line">              &#125;)</span><br><span class="line">          &#125;,</span><br><span class="line">          show_captcha()&#123;</span><br><span class="line"></span><br><span class="line"><span class="actionscript">            <span class="comment">// 判断手机号或者密码是否为空！</span></span></span><br><span class="line"><span class="actionscript">            <span class="keyword">if</span>(<span class="keyword">this</span>.username.length&lt;<span class="number">1</span> || <span class="keyword">this</span>.password.length&lt;<span class="number">1</span>)&#123;</span></span><br><span class="line"><span class="actionscript">              <span class="keyword">return</span> <span class="literal">false</span>; <span class="comment">// 阻止代码继续往下执行</span></span></span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line"><span class="actionscript">            <span class="comment">// 验证码</span></span></span><br><span class="line"><span class="javascript">            <span class="keyword">let</span> self = <span class="keyword">this</span>;</span></span><br><span class="line"><span class="actionscript">            <span class="comment">// 生成一个验证码对象</span></span></span><br><span class="line"><span class="actionscript">            <span class="keyword">var</span> captcha1 = <span class="keyword">new</span> TencentCaptcha(<span class="keyword">this</span>.$settings.TC_captcha.app_id, <span class="function"><span class="keyword">function</span><span class="params">(res)</span> </span>&#123;</span></span><br><span class="line"><span class="javascript">              <span class="built_in">console</span>.log(res);</span></span><br><span class="line"><span class="actionscript">              <span class="comment">// res（未通过验证）= &#123;ret: 1, ticket: null&#125;</span></span></span><br><span class="line"></span><br><span class="line"><span class="actionscript">              <span class="comment">// ticket 验证成功的票据，当且仅当ret=0时ticket有值</span></span></span><br><span class="line"><span class="actionscript">              <span class="comment">// res（验证成功） = &#123;ret: 0, ticket: "String", randstr: "String"&#125;</span></span></span><br><span class="line">              if (res.ret === 0) &#123;</span><br><span class="line"><span class="actionscript">                <span class="comment">// 随机码</span></span></span><br><span class="line"><span class="actionscript">                <span class="comment">// api服务端校验验证码的结果</span></span></span><br><span class="line"><span class="javascript">                self.$axios.get(<span class="string">`<span class="subst">$&#123;self.$settings.Host&#125;</span>/users/captcha/`</span>,&#123;</span></span><br><span class="line">                  params:&#123;</span><br><span class="line">                    ticket: res.ticket,</span><br><span class="line">                    randstr: res.randstr,</span><br><span class="line">                  &#125;</span><br><span class="line"><span class="javascript">                &#125;).then(<span class="function"><span class="params">response</span>=&gt;</span>&#123;</span></span><br><span class="line"><span class="actionscript">                  <span class="comment">// 进行登录处理</span></span></span><br><span class="line">                  self.loginhander();</span><br><span class="line"><span class="javascript">                &#125;).catch(<span class="function"><span class="params">error</span>=&gt;</span>&#123;</span></span><br><span class="line"><span class="actionscript">                  self.$message.error(<span class="string">"验证码校验错误！"</span>);</span></span><br><span class="line">                &#125;)</span><br><span class="line">              &#125;</span><br><span class="line">            &#125;);</span><br><span class="line"></span><br><span class="line"><span class="actionscript">            <span class="comment">// 显示验证码</span></span></span><br><span class="line">            captcha1.show();</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">    &#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span> <span class="attr">scoped</span>&gt;</span></span><br><span class="line">input&#123;</span><br><span class="line">  outline: none;</span><br><span class="line">&#125;</span><br><span class="line"><span class="css">*, <span class="selector-pseudo">:after</span>, <span class="selector-pseudo">:before</span> &#123;</span></span><br><span class="line">    box-sizing: border-box;</span><br><span class="line">&#125;</span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> &#123;</span></span><br><span class="line">    height: 100%;</span><br><span class="line">    min-height: 750px;</span><br><span class="line">    text-align: center;</span><br><span class="line">    font-size: 14px;</span><br><span class="line"><span class="css">    <span class="selector-tag">background-color</span>: <span class="selector-id">#f1f1f1</span></span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span><span class="selector-pseudo">:before</span> &#123;</span></span><br><span class="line">    content: "";</span><br><span class="line">    display: inline-block;</span><br><span class="line">    height: 85%;</span><br><span class="line">    vertical-align: middle</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.disable</span>,<span class="selector-class">.sign</span> <span class="selector-class">.disable-gray</span> &#123;</span></span><br><span class="line"><span class="css">    <span class="selector-tag">opacity</span>: <span class="selector-class">.5</span>;</span></span><br><span class="line">    pointer-events: none</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.disable-gray</span> &#123;</span></span><br><span class="line"><span class="css">    <span class="selector-tag">background-color</span>: <span class="selector-id">#969696</span></span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.tooltip-error</span> &#123;</span></span><br><span class="line">    font-size: 14px;</span><br><span class="line">    line-height: 25px;</span><br><span class="line">    white-space: nowrap;</span><br><span class="line">    background: none</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.tooltip-error</span> <span class="selector-class">.tooltip-inner</span> &#123;</span></span><br><span class="line">    max-width: 280px;</span><br><span class="line"><span class="css">    <span class="selector-tag">color</span>: <span class="selector-id">#333</span>;</span></span><br><span class="line"><span class="css">    <span class="selector-tag">border</span>: 1<span class="selector-tag">px</span> <span class="selector-tag">solid</span> <span class="selector-id">#ea6f5a</span>;</span></span><br><span class="line"><span class="css">    <span class="selector-tag">background-color</span>: <span class="selector-id">#fff</span></span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.tooltip-error</span> <span class="selector-class">.tooltip-inner</span> <span class="selector-tag">i</span> &#123;</span></span><br><span class="line">    position: static;</span><br><span class="line">    margin-right: 5px;</span><br><span class="line">    font-size: 20px;</span><br><span class="line"><span class="css">    <span class="selector-tag">color</span>: <span class="selector-id">#ea6f5a</span>;</span></span><br><span class="line">    vertical-align: middle</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.tooltip-error</span> <span class="selector-class">.tooltip-inner</span> <span class="selector-tag">span</span> &#123;</span></span><br><span class="line">    vertical-align: middle;</span><br><span class="line">    display: inline-block;</span><br><span class="line">    white-space: normal;</span><br><span class="line">    max-width: 230px</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.tooltip-error</span><span class="selector-class">.right</span> <span class="selector-class">.tooltip-arrow-border</span> &#123;</span></span><br><span class="line"><span class="css">    <span class="selector-tag">border-right-color</span>: <span class="selector-id">#ea6f5a</span></span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.tooltip-error</span><span class="selector-class">.right</span> <span class="selector-class">.tooltip-arrow-bg</span> &#123;</span></span><br><span class="line">    left: 2px;</span><br><span class="line"><span class="css">    <span class="selector-tag">border-right-color</span>: <span class="selector-id">#fff</span></span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.slide-error</span> &#123;</span></span><br><span class="line">    position: relative;</span><br><span class="line">    padding: 10px 0;</span><br><span class="line"><span class="css">    <span class="selector-tag">border</span>: 1<span class="selector-tag">px</span> <span class="selector-tag">solid</span> <span class="selector-id">#c8c8c8</span>;</span></span><br><span class="line">    border-radius: 4px</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.slide-error</span> <span class="selector-tag">i</span> &#123;</span></span><br><span class="line">    position: static!important;</span><br><span class="line">    margin-right: 10px;</span><br><span class="line"><span class="css">    <span class="selector-tag">color</span>: <span class="selector-id">#ea6f5a</span>!<span class="selector-tag">important</span>;</span></span><br><span class="line">    vertical-align: middle</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.slide-error</span> <span class="selector-tag">span</span> &#123;</span></span><br><span class="line">    font-size: 15px;</span><br><span class="line">    vertical-align: middle</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.slide-error</span> <span class="selector-tag">div</span> &#123;</span></span><br><span class="line">    margin-top: 10px;</span><br><span class="line">    font-size: 13px</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.slide-error</span> <span class="selector-tag">a</span> &#123;</span></span><br><span class="line"><span class="css">    <span class="selector-tag">color</span>: <span class="selector-id">#3194d0</span></span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.js-sign-up-forbidden</span> &#123;</span></span><br><span class="line"><span class="css">    <span class="selector-tag">color</span>: <span class="selector-id">#999</span>;</span></span><br><span class="line">    padding: 80px 0 100px</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.js-sign-up-container</span> <span class="selector-class">.slide-error</span> &#123;</span></span><br><span class="line">    border-bottom: none;</span><br><span class="line">    border-radius: 0</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.logo</span> &#123;</span></span><br><span class="line">    position: absolute;</span><br><span class="line">    top: 56px;</span><br><span class="line">    margin-left: 50px</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.logo</span> <span class="selector-tag">img</span> &#123;</span></span><br><span class="line">    width: 100px</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.main</span> &#123;</span></span><br><span class="line">    width: 400px;</span><br><span class="line">    margin: 60px auto 0;</span><br><span class="line">    padding: 50px 50px 30px;</span><br><span class="line"><span class="css">    <span class="selector-tag">background-color</span>: <span class="selector-id">#fff</span>;</span></span><br><span class="line">    border-radius: 4px;</span><br><span class="line"><span class="css">    <span class="selector-tag">box-shadow</span>: 0 0 8<span class="selector-tag">px</span> <span class="selector-tag">rgba</span>(0,0,0,<span class="selector-class">.1</span>);</span></span><br><span class="line">    vertical-align: middle;</span><br><span class="line">    display: inline-block</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.reset-title</span>,<span class="selector-class">.sign</span> <span class="selector-class">.title</span> &#123;</span></span><br><span class="line">    margin: 0 auto 50px;</span><br><span class="line">    padding: 10px;</span><br><span class="line">    font-weight: 400;</span><br><span class="line"><span class="css">    <span class="selector-tag">color</span>: <span class="selector-id">#969696</span></span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.reset-title</span> <span class="selector-tag">a</span>,<span class="selector-class">.sign</span> <span class="selector-class">.title</span> <span class="selector-tag">a</span> &#123;</span></span><br><span class="line">    padding: 10px;</span><br><span class="line"><span class="css">    <span class="selector-tag">color</span>: <span class="selector-id">#969696</span></span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.reset-title</span> <span class="selector-tag">a</span><span class="selector-pseudo">:hover</span>,<span class="selector-class">.sign</span> <span class="selector-class">.title</span> <span class="selector-tag">a</span><span class="selector-pseudo">:hover</span> &#123;</span></span><br><span class="line"><span class="css">    <span class="selector-tag">border-bottom</span>: 2<span class="selector-tag">px</span> <span class="selector-tag">solid</span> <span class="selector-id">#ea6f5a</span></span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.reset-title</span> <span class="selector-class">.active</span>,<span class="selector-class">.sign</span> <span class="selector-class">.title</span> <span class="selector-class">.active</span> &#123;</span></span><br><span class="line">    font-weight: 700;</span><br><span class="line"><span class="css">    <span class="selector-tag">color</span>: <span class="selector-id">#ea6f5a</span>;</span></span><br><span class="line"><span class="css">    <span class="selector-tag">border-bottom</span>: 2<span class="selector-tag">px</span> <span class="selector-tag">solid</span> <span class="selector-id">#ea6f5a</span></span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.reset-title</span> <span class="selector-tag">b</span>,<span class="selector-class">.sign</span> <span class="selector-class">.title</span> <span class="selector-tag">b</span> &#123;</span></span><br><span class="line">    padding: 10px</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.reset-title</span> &#123;</span></span><br><span class="line"><span class="css">    <span class="selector-tag">color</span>: <span class="selector-id">#333</span>;</span></span><br><span class="line">    font-weight: 700</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-tag">form</span> &#123;</span></span><br><span class="line">    margin-bottom: 30px</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-tag">form</span> <span class="selector-class">.input-prepend</span> &#123;</span></span><br><span class="line">    position: relative;</span><br><span class="line">    width: 100%</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-tag">form</span> <span class="selector-class">.input-prepend</span> <span class="selector-tag">input</span> &#123;</span></span><br><span class="line">    width: 100%;</span><br><span class="line">    height: 50px;</span><br><span class="line">    margin-bottom: 0;</span><br><span class="line">    padding: 4px 12px 4px 35px;</span><br><span class="line"><span class="css">    <span class="selector-tag">border</span>: 1<span class="selector-tag">px</span> <span class="selector-tag">solid</span> <span class="selector-id">#c8c8c8</span>;</span></span><br><span class="line">    border-radius: 0 0 4px 4px;</span><br><span class="line"><span class="css">    <span class="selector-tag">background-color</span>: <span class="selector-tag">hsla</span>(0,0%,71%,<span class="selector-class">.1</span>);</span></span><br><span class="line">    vertical-align: middle</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-tag">form</span> <span class="selector-class">.input-prepend</span> <span class="selector-tag">i</span> &#123;</span></span><br><span class="line">    position: absolute;</span><br><span class="line">    top: 14px;</span><br><span class="line">    left: 10px;</span><br><span class="line">    font-size: 18px;</span><br><span class="line"><span class="css">    <span class="selector-tag">color</span>: <span class="selector-id">#969696</span></span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-tag">form</span> <span class="selector-class">.input-prepend</span> <span class="selector-tag">span</span> &#123;</span></span><br><span class="line"><span class="css">    <span class="selector-tag">color</span>: <span class="selector-id">#333</span></span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-tag">form</span> <span class="selector-class">.input-prepend</span> <span class="selector-class">.ic-show</span> &#123;</span></span><br><span class="line">    top: 18px;</span><br><span class="line">    left: auto;</span><br><span class="line">    right: 8px;</span><br><span class="line">    font-size: 12px</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-tag">form</span> <span class="selector-class">.geetest-placeholder</span> &#123;</span></span><br><span class="line">    height: 44px;</span><br><span class="line">    border-radius: 4px;</span><br><span class="line"><span class="css">    <span class="selector-tag">background-color</span>: <span class="selector-tag">hsla</span>(0,0%,71%,<span class="selector-class">.1</span>);</span></span><br><span class="line">    text-align: center;</span><br><span class="line">    line-height: 44px;</span><br><span class="line">    font-size: 14px;</span><br><span class="line"><span class="css">    <span class="selector-tag">color</span>: <span class="selector-id">#999</span></span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-tag">form</span> <span class="selector-class">.restyle</span> &#123;</span></span><br><span class="line">    margin-bottom: 0</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-tag">form</span> <span class="selector-class">.restyle</span> <span class="selector-tag">input</span> &#123;</span></span><br><span class="line">    border-bottom: none;</span><br><span class="line">    border-radius: 4px 4px 0 0</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-tag">form</span> <span class="selector-class">.no-radius</span> <span class="selector-tag">input</span> &#123;</span></span><br><span class="line">    border-radius: 0</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-tag">form</span> <span class="selector-class">.slide-security-placeholder</span> &#123;</span></span><br><span class="line">    height: 32px;</span><br><span class="line"><span class="css">    <span class="selector-tag">background-color</span>: <span class="selector-tag">hsla</span>(0,0%,71%,<span class="selector-class">.1</span>);</span></span><br><span class="line">    border-radius: 4px</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-tag">form</span> <span class="selector-class">.slide-security-placeholder</span> <span class="selector-tag">p</span> &#123;</span></span><br><span class="line">    padding-top: 7px;</span><br><span class="line"><span class="css">    <span class="selector-tag">color</span>: <span class="selector-id">#999</span>;</span></span><br><span class="line">    margin-right: -7px</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.overseas-btn</span> &#123;</span></span><br><span class="line">    font-size: 14px;</span><br><span class="line"><span class="css">    <span class="selector-tag">color</span>: <span class="selector-id">#999</span></span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.overseas-btn</span><span class="selector-pseudo">:hover</span> &#123;</span></span><br><span class="line"><span class="css">    <span class="selector-tag">color</span>: <span class="selector-id">#2f2f2f</span></span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.remember-btn</span> &#123;</span></span><br><span class="line">    float: left;</span><br><span class="line">    margin: 15px 0</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.remember-btn</span> <span class="selector-tag">span</span> &#123;</span></span><br><span class="line">    margin-left: 5px;</span><br><span class="line">    font-size: 15px;</span><br><span class="line"><span class="css">    <span class="selector-tag">color</span>: <span class="selector-id">#969696</span>;</span></span><br><span class="line">    vertical-align: middle</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.forget-btn</span> &#123;</span></span><br><span class="line">    float: right;</span><br><span class="line">    position: relative;</span><br><span class="line">    margin: 15px 0;</span><br><span class="line">    font-size: 14px</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.forget-btn</span> <span class="selector-tag">a</span> &#123;</span></span><br><span class="line"><span class="css">    <span class="selector-tag">color</span>: <span class="selector-id">#999</span></span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.forget-btn</span> <span class="selector-tag">a</span><span class="selector-pseudo">:hover</span> &#123;</span></span><br><span class="line"><span class="css">    <span class="selector-tag">color</span>: <span class="selector-id">#333</span></span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.forget-btn</span> <span class="selector-class">.dropdown-menu</span> &#123;</span></span><br><span class="line">    top: 20px;</span><br><span class="line">    left: auto;</span><br><span class="line">    right: 0;</span><br><span class="line">    border-radius: 4px</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.forget-btn</span> <span class="selector-class">.dropdown-menu</span> <span class="selector-tag">a</span> &#123;</span></span><br><span class="line">    padding: 10px 20px;</span><br><span class="line"><span class="css">    <span class="selector-tag">color</span>: <span class="selector-id">#333</span></span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-id">#sign-in-loading</span> &#123;</span></span><br><span class="line">    position: relative;</span><br><span class="line">    width: 20px;</span><br><span class="line">    height: 20px;</span><br><span class="line">    vertical-align: middle;</span><br><span class="line">    margin-top: -4px;</span><br><span class="line">    margin-right: 2px;</span><br><span class="line">    display: none</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-id">#sign-in-loading</span><span class="selector-pseudo">:after</span> &#123;</span></span><br><span class="line">    content: "";</span><br><span class="line">    position: absolute;</span><br><span class="line">    left: 0;</span><br><span class="line">    top: 0;</span><br><span class="line">    width: 100%;</span><br><span class="line">    height: 100%;</span><br><span class="line">    background-color: transparent</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-id">#sign-in-loading</span><span class="selector-pseudo">:before</span> &#123;</span></span><br><span class="line">    content: "";</span><br><span class="line">    position: absolute;</span><br><span class="line">    top: 50%;</span><br><span class="line">    left: 50%;</span><br><span class="line">    width: 20px;</span><br><span class="line">    height: 20px;</span><br><span class="line">    margin: -10px 0 0 -10px;</span><br><span class="line">    border-radius: 10px;</span><br><span class="line"><span class="css">    <span class="selector-tag">border</span>: 2<span class="selector-tag">px</span> <span class="selector-tag">solid</span> <span class="selector-id">#fff</span>;</span></span><br><span class="line">    border-bottom-color: transparent;</span><br><span class="line">    vertical-align: middle;</span><br><span class="line"><span class="css">    <span class="selector-tag">-webkit-animation</span>: <span class="selector-tag">rolling</span> <span class="selector-class">.8s</span> <span class="selector-tag">infinite</span> <span class="selector-tag">linear</span>;</span></span><br><span class="line"><span class="css">    <span class="selector-tag">animation</span>: <span class="selector-tag">rolling</span> <span class="selector-class">.8s</span> <span class="selector-tag">infinite</span> <span class="selector-tag">linear</span>;</span></span><br><span class="line">    z-index: 1</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.sign-in-button</span>,<span class="selector-class">.sign</span> <span class="selector-class">.sign-up-button</span> &#123;</span></span><br><span class="line">    margin-top: 20px;</span><br><span class="line">    width: 100%;</span><br><span class="line">    padding: 9px 18px;</span><br><span class="line">    font-size: 18px;</span><br><span class="line">    border: none;</span><br><span class="line">    border-radius: 25px;</span><br><span class="line"><span class="css">    <span class="selector-tag">color</span>: <span class="selector-id">#fff</span>;</span></span><br><span class="line"><span class="css">    <span class="selector-tag">background</span>: <span class="selector-id">#42c02e</span>;</span></span><br><span class="line">    cursor: pointer;</span><br><span class="line">    outline: none;</span><br><span class="line">    display: block;</span><br><span class="line">    clear: both</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.sign-in-button</span><span class="selector-pseudo">:hover</span>,<span class="selector-class">.sign</span> <span class="selector-class">.sign-up-button</span><span class="selector-pseudo">:hover</span> &#123;</span></span><br><span class="line"><span class="css">    <span class="selector-tag">background</span>: <span class="selector-id">#3db922</span></span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.sign-in-button</span> &#123;</span></span><br><span class="line"><span class="css">    <span class="selector-tag">background</span>: <span class="selector-id">#3194d0</span></span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.sign-in-button</span><span class="selector-pseudo">:hover</span> &#123;</span></span><br><span class="line"><span class="css">    <span class="selector-tag">background</span>: <span class="selector-id">#187cb7</span></span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.btn-in-resend</span>,<span class="selector-class">.sign</span> <span class="selector-class">.btn-up-resend</span> &#123;</span></span><br><span class="line">    position: absolute;</span><br><span class="line">    top: 7px;</span><br><span class="line">    right: 7px;</span><br><span class="line">    width: 100px;</span><br><span class="line">    height: 36px;</span><br><span class="line">    font-size: 13px;</span><br><span class="line"><span class="css">    <span class="selector-tag">color</span>: <span class="selector-id">#fff</span>;</span></span><br><span class="line"><span class="css">    <span class="selector-tag">background-color</span>: <span class="selector-id">#42c02e</span>;</span></span><br><span class="line">    border-radius: 20px;</span><br><span class="line">    line-height: 36px</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.btn-in-resend</span> &#123;</span></span><br><span class="line"><span class="css">    <span class="selector-tag">background-color</span>: <span class="selector-id">#3194d0</span></span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.sign-up-msg</span> &#123;</span></span><br><span class="line">    margin: 10px 0;</span><br><span class="line">    padding: 0;</span><br><span class="line">    text-align: center;</span><br><span class="line">    font-size: 12px;</span><br><span class="line">    line-height: 20px;</span><br><span class="line"><span class="css">    <span class="selector-tag">color</span>: <span class="selector-id">#969696</span></span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.sign-up-msg</span> <span class="selector-tag">a</span>,<span class="selector-class">.sign</span> <span class="selector-class">.sign-up-msg</span> <span class="selector-tag">a</span><span class="selector-pseudo">:hover</span> &#123;</span></span><br><span class="line"><span class="css">    <span class="selector-tag">color</span>: <span class="selector-id">#3194d0</span></span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.overseas</span> <span class="selector-tag">input</span> &#123;</span></span><br><span class="line">    padding-left: 110px!important</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.overseas</span> <span class="selector-class">.overseas-number</span> &#123;</span></span><br><span class="line">    position: absolute;</span><br><span class="line">    top: 0;</span><br><span class="line">    left: 0;</span><br><span class="line">    width: 100px;</span><br><span class="line">    height: 50px;</span><br><span class="line">    font-size: 18px;</span><br><span class="line"><span class="css">    <span class="selector-tag">color</span>: <span class="selector-id">#969696</span>;</span></span><br><span class="line"><span class="css">    <span class="selector-tag">border-right</span>: 1<span class="selector-tag">px</span> <span class="selector-tag">solid</span> <span class="selector-id">#c8c8c8</span></span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.overseas</span> <span class="selector-class">.overseas-number</span> <span class="selector-tag">span</span> &#123;</span></span><br><span class="line">    margin-top: 17px;</span><br><span class="line">    padding-left: 35px;</span><br><span class="line">    text-align: left;</span><br><span class="line">    font-size: 14px;</span><br><span class="line">    display: block</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.overseas</span> <span class="selector-class">.dropdown-menu</span> &#123;</span></span><br><span class="line">    width: 100%;</span><br><span class="line">    max-height: 285px;</span><br><span class="line">    font-size: 14px;</span><br><span class="line">    border-radius: 0 0 4px 4px;</span><br><span class="line">    overflow-y: auto</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.overseas</span> <span class="selector-class">.dropdown-menu</span> <span class="selector-tag">li</span> <span class="selector-class">.nation-code</span> &#123;</span></span><br><span class="line">    width: 65px;</span><br><span class="line">    display: inline-block</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.overseas</span> <span class="selector-class">.dropdown-menu</span> <span class="selector-tag">li</span> <span class="selector-tag">a</span> &#123;</span></span><br><span class="line">    padding: 6px 20px;</span><br><span class="line">    font-size: 14px;</span><br><span class="line">    line-height: 20px</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.overseas</span> <span class="selector-class">.dropdown-menu</span> <span class="selector-tag">li</span> <span class="selector-tag">a</span><span class="selector-pseudo">::hover</span> &#123;</span></span><br><span class="line"><span class="css">    <span class="selector-tag">color</span>: <span class="selector-id">#fff</span>;</span></span><br><span class="line"><span class="css">    <span class="selector-tag">background-color</span>: <span class="selector-id">#f5f5f5</span></span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.more-sign</span> &#123;</span></span><br><span class="line">    margin-top: 50px</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.more-sign</span> <span class="selector-tag">h6</span> &#123;</span></span><br><span class="line">    position: relative;</span><br><span class="line">    margin: 0 0 10px;</span><br><span class="line">    font-size: 12px;</span><br><span class="line"><span class="css">    <span class="selector-tag">color</span>: <span class="selector-id">#b5b5b5</span></span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.more-sign</span> <span class="selector-tag">h6</span><span class="selector-pseudo">:before</span> &#123;</span></span><br><span class="line">    left: 30px</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.more-sign</span> <span class="selector-tag">h6</span><span class="selector-pseudo">:after</span>,<span class="selector-class">.sign</span> <span class="selector-class">.more-sign</span> <span class="selector-tag">h6</span><span class="selector-pseudo">:before</span> &#123;</span></span><br><span class="line">    content: "";</span><br><span class="line"><span class="css">    <span class="selector-tag">border-top</span>: 1<span class="selector-tag">px</span> <span class="selector-tag">solid</span> <span class="selector-id">#b5b5b5</span>;</span></span><br><span class="line">    display: block;</span><br><span class="line">    position: absolute;</span><br><span class="line">    width: 60px;</span><br><span class="line">    top: 5px</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.more-sign</span> <span class="selector-tag">h6</span><span class="selector-pseudo">:after</span> &#123;</span></span><br><span class="line">    right: 30px</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.more-sign</span> <span class="selector-tag">ul</span> &#123;</span></span><br><span class="line">    margin-bottom: 10px;</span><br><span class="line">    list-style: none</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.more-sign</span> <span class="selector-tag">ul</span> <span class="selector-tag">li</span> &#123;</span></span><br><span class="line">    margin: 0 5px;</span><br><span class="line">    display: inline-block</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.more-sign</span> <span class="selector-tag">ul</span> <span class="selector-tag">a</span> &#123;</span></span><br><span class="line">    width: 50px;</span><br><span class="line">    height: 50px;</span><br><span class="line">    line-height: 50px;</span><br><span class="line">    display: block</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.more-sign</span> <span class="selector-tag">ul</span> <span class="selector-tag">i</span> &#123;</span></span><br><span class="line">    font-size: 28px</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.more-sign</span> <span class="selector-class">.ic-weibo</span> &#123;</span></span><br><span class="line"><span class="css">    <span class="selector-tag">color</span>: <span class="selector-id">#e05244</span></span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.more-sign</span> <span class="selector-class">.ic-wechat</span> &#123;</span></span><br><span class="line"><span class="css">    <span class="selector-tag">color</span>: <span class="selector-id">#00bb29</span></span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.more-sign</span> <span class="selector-class">.ic-qq_connect</span> &#123;</span></span><br><span class="line"><span class="css">    <span class="selector-tag">color</span>: <span class="selector-id">#498ad5</span></span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.more-sign</span> <span class="selector-class">.ic-douban</span> &#123;</span></span><br><span class="line"><span class="css">    <span class="selector-tag">color</span>: <span class="selector-id">#00820f</span></span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.more-sign</span> <span class="selector-class">.ic-more</span> &#123;</span></span><br><span class="line"><span class="css">    <span class="selector-tag">color</span>: <span class="selector-id">#999</span></span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.more-sign</span> <span class="selector-class">.weibo-loading</span> &#123;</span></span><br><span class="line">    pointer-events: none;</span><br><span class="line">    cursor: pointer;</span><br><span class="line">    position: relative</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.more-sign</span> <span class="selector-class">.weibo-loading</span><span class="selector-pseudo">:after</span> &#123;</span></span><br><span class="line">    content: "";</span><br><span class="line">    position: absolute;</span><br><span class="line">    left: 0;</span><br><span class="line">    top: 0;</span><br><span class="line">    width: 100%;</span><br><span class="line">    height: 100%;</span><br><span class="line"><span class="css">    <span class="selector-tag">background-color</span>: <span class="selector-id">#fff</span></span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-tag">body</span><span class="selector-class">.reader-night-mode</span> <span class="selector-class">.sign</span> <span class="selector-class">.more-sign</span> <span class="selector-class">.weibo-loading</span><span class="selector-pseudo">:after</span> &#123;</span></span><br><span class="line"><span class="css">    <span class="selector-tag">background-color</span>: <span class="selector-id">#3f3f3f</span></span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.more-sign</span> <span class="selector-class">.weibo-loading</span><span class="selector-pseudo">:before</span> &#123;</span></span><br><span class="line">    content: "";</span><br><span class="line">    position: absolute;</span><br><span class="line">    top: 50%;</span><br><span class="line">    left: 50%;</span><br><span class="line">    width: 20px;</span><br><span class="line">    height: 20px;</span><br><span class="line">    margin: -10px 0 0 -10px;</span><br><span class="line">    border-radius: 10px;</span><br><span class="line"><span class="css">    <span class="selector-tag">border</span>: 2<span class="selector-tag">px</span> <span class="selector-tag">solid</span> <span class="selector-id">#e05244</span>;</span></span><br><span class="line">    border-bottom-color: transparent;</span><br><span class="line">    vertical-align: middle;</span><br><span class="line"><span class="css">    <span class="selector-tag">-webkit-animation</span>: <span class="selector-tag">rolling</span> <span class="selector-class">.8s</span> <span class="selector-tag">infinite</span> <span class="selector-tag">linear</span>;</span></span><br><span class="line"><span class="css">    <span class="selector-tag">animation</span>: <span class="selector-tag">rolling</span> <span class="selector-class">.8s</span> <span class="selector-tag">infinite</span> <span class="selector-tag">linear</span>;</span></span><br><span class="line">    z-index: 1</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="keyword">@keyframes</span> rolling &#123;</span></span><br><span class="line">    0% &#123;</span><br><span class="line">        -webkit-transform: rotate(0deg);</span><br><span class="line">        transform: rotate(0deg)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    to &#123;</span><br><span class="line">        -webkit-transform: rotate(1turn);</span><br><span class="line">        transform: rotate(1turn)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="keyword">@-webkit-keyframes</span> rolling &#123;</span></span><br><span class="line">    0% &#123;</span><br><span class="line">        -webkit-transform: rotate(0deg)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    to &#123;</span><br><span class="line">        -webkit-transform: rotate(1turn)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.reset-password-input</span> &#123;</span></span><br><span class="line">    border-radius: 4px!important</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.return</span> &#123;</span></span><br><span class="line">    margin-left: -8px;</span><br><span class="line"><span class="css">    <span class="selector-tag">color</span>: <span class="selector-id">#969696</span></span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.return</span><span class="selector-pseudo">:hover</span> &#123;</span></span><br><span class="line"><span class="css">    <span class="selector-tag">color</span>: <span class="selector-id">#333</span></span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.return</span> <span class="selector-tag">i</span> &#123;</span></span><br><span class="line">    margin-right: 5px</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.icheckbox_square-green</span> &#123;</span></span><br><span class="line">    display: inline-block;</span><br><span class="line">    *display: inline;</span><br><span class="line">    vertical-align: middle;</span><br><span class="line">    margin: 0;</span><br><span class="line">    padding: 0;</span><br><span class="line">    width: 18px;</span><br><span class="line">    height: 18px;</span><br><span class="line">    background: url(/static/image/green.png) no-repeat;</span><br><span class="line">    border: none;</span><br><span class="line">    cursor: pointer;</span><br><span class="line">    background-position: 0 0</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.icheckbox_square-green</span><span class="selector-class">.hover</span> &#123;</span></span><br><span class="line">    background-position: -20px 0</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.icheckbox_square-green</span><span class="selector-class">.checked</span> &#123;</span></span><br><span class="line">    background-position: -40px 0</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.icheckbox_square-green</span><span class="selector-class">.disabled</span> &#123;</span></span><br><span class="line">    background-position: -60px 0;</span><br><span class="line">    cursor: default</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.icheckbox_square-green</span><span class="selector-class">.checked</span><span class="selector-class">.disabled</span> &#123;</span></span><br><span class="line">    background-position: -80px 0</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.geetest_panel_box</span>&gt;* &#123;</span></span><br><span class="line">    box-sizing: content-box</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="keyword">@media</span> (<span class="attribute">max-width:</span><span class="number">768px</span>) &#123;</span></span><br><span class="line">    body &#123;</span><br><span class="line">        min-width: 0</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="css">    <span class="selector-class">.sign</span> &#123;</span></span><br><span class="line">        height: auto;</span><br><span class="line">        min-height: 0;</span><br><span class="line">        background-color: transparent</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="css">    <span class="selector-class">.sign</span> <span class="selector-class">.logo</span> &#123;</span></span><br><span class="line">        display: none</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="css">    <span class="selector-class">.sign</span> <span class="selector-class">.main</span> &#123;</span></span><br><span class="line">        position: absolute;</span><br><span class="line">        left: 50%;</span><br><span class="line">        margin: 0 0 0 -200px;</span><br><span class="line">        box-shadow: none</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br></pre></td></tr></table></figure><p>api服务端接入验证码的文档说明: <a href="https://007.qq.com/python-access.html?ADTAG=acces.start" target="_blank" rel="noopener">https://007.qq.com/python-access.html?ADTAG=acces.start</a></p><p>服务端接受验证结果并返回，代码：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Create your views here.</span></span><br><span class="line"><span class="keyword">from</span> rest_framework.views <span class="keyword">import</span> APIView</span><br><span class="line"><span class="keyword">from</span> django.conf <span class="keyword">import</span> settings</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"><span class="keyword">from</span> urllib.parse <span class="keyword">import</span> urlencode</span><br><span class="line"><span class="keyword">from</span> urllib.request <span class="keyword">import</span> urlopen</span><br><span class="line"><span class="keyword">from</span> rest_framework.response <span class="keyword">import</span> Response</span><br><span class="line"><span class="keyword">from</span> rest_framework <span class="keyword">import</span> status</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">CaptchaAPIView</span><span class="params">(APIView)</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get</span><span class="params">(self,request)</span>:</span></span><br><span class="line">        <span class="string">"""验证码的验证结果校验"""</span></span><br><span class="line">        AppSecretKey = settings.TENCENT_CAPTCHA[<span class="string">"App_Secret_Key"</span>]</span><br><span class="line">        appid = settings.TENCENT_CAPTCHA[<span class="string">"APPID"</span>]</span><br><span class="line">        Ticket = request.query_params.get(<span class="string">"ticket"</span>)</span><br><span class="line">        Randstr = request.query_params.get(<span class="string">"randstr"</span>)</span><br><span class="line">        UserIP = request._request.META.get(<span class="string">"REMOTE_ADDR"</span>)</span><br><span class="line">        print(<span class="string">"用户ID地址：%s"</span> % UserIP)</span><br><span class="line">        params = &#123;</span><br><span class="line">            <span class="string">"aid"</span>: appid,</span><br><span class="line">            <span class="string">"AppSecretKey"</span>: AppSecretKey,</span><br><span class="line">            <span class="string">"Ticket"</span>: Ticket,</span><br><span class="line">            <span class="string">"Randstr"</span>: Randstr,</span><br><span class="line">            <span class="string">"UserIP"</span>: UserIP</span><br><span class="line">        &#125;</span><br><span class="line">        params = urlencode(params)</span><br><span class="line"></span><br><span class="line">        f = urlopen(<span class="string">"%s?%s"</span> % (settings.TENCENT_CAPTCHA[<span class="string">"GATEWAY"</span>], params))</span><br><span class="line">        content = f.read()</span><br><span class="line">        res = json.loads(content)</span><br><span class="line">        print(res)</span><br><span class="line">        <span class="keyword">if</span> res:</span><br><span class="line">            error_code = res[<span class="string">"response"</span>]</span><br><span class="line">            <span class="keyword">if</span> int(error_code) == <span class="number">1</span>:</span><br><span class="line">                <span class="keyword">return</span> Response(<span class="string">"验证通过！"</span>)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="keyword">return</span> Response(<span class="string">"验证失败！%s"</span> % res[<span class="string">"err_msg"</span>], status=status.HTTP_400_BAD_REQUEST)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">return</span> Response(<span class="string">"验证失败！"</span>, status=status.HTTP_400_BAD_REQUEST)</span><br></pre></td></tr></table></figure><p>路由，代码：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 子应用路由：</span></span><br><span class="line"><span class="keyword">from</span> django.urls <span class="keyword">import</span> path</span><br><span class="line"><span class="keyword">from</span> . <span class="keyword">import</span> views</span><br><span class="line">urlpatterns = [</span><br><span class="line">    path(<span class="string">"captcha/"</span>, views.CaptchaAPIView.as_view()),</span><br><span class="line">]</span><br></pre></td></tr></table></figure><h1 id="用户的注册认证"><a href="#用户的注册认证" class="headerlink" title="用户的注册认证"></a>用户的注册认证</h1><p>前端显示注册页面并调整首页头部和登陆页面的注册按钮的链接。</p><p>注册页面Register.vue,主要是通过登录页面进行改成而成</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br><span class="line">476</span><br><span class="line">477</span><br><span class="line">478</span><br><span class="line">479</span><br><span class="line">480</span><br><span class="line">481</span><br><span class="line">482</span><br><span class="line">483</span><br><span class="line">484</span><br><span class="line">485</span><br><span class="line">486</span><br><span class="line">487</span><br><span class="line">488</span><br><span class="line">489</span><br><span class="line">490</span><br><span class="line">491</span><br><span class="line">492</span><br><span class="line">493</span><br><span class="line">494</span><br><span class="line">495</span><br><span class="line">496</span><br><span class="line">497</span><br><span class="line">498</span><br><span class="line">499</span><br><span class="line">500</span><br><span class="line">501</span><br><span class="line">502</span><br><span class="line">503</span><br><span class="line">504</span><br><span class="line">505</span><br><span class="line">506</span><br><span class="line">507</span><br><span class="line">508</span><br><span class="line">509</span><br><span class="line">510</span><br><span class="line">511</span><br><span class="line">512</span><br><span class="line">513</span><br><span class="line">514</span><br><span class="line">515</span><br><span class="line">516</span><br><span class="line">517</span><br><span class="line">518</span><br><span class="line">519</span><br><span class="line">520</span><br><span class="line">521</span><br><span class="line">522</span><br><span class="line">523</span><br><span class="line">524</span><br><span class="line">525</span><br><span class="line">526</span><br><span class="line">527</span><br><span class="line">528</span><br><span class="line">529</span><br><span class="line">530</span><br><span class="line">531</span><br><span class="line">532</span><br><span class="line">533</span><br><span class="line">534</span><br><span class="line">535</span><br><span class="line">536</span><br><span class="line">537</span><br><span class="line">538</span><br><span class="line">539</span><br><span class="line">540</span><br><span class="line">541</span><br><span class="line">542</span><br><span class="line">543</span><br><span class="line">544</span><br><span class="line">545</span><br><span class="line">546</span><br><span class="line">547</span><br><span class="line">548</span><br><span class="line">549</span><br><span class="line">550</span><br><span class="line">551</span><br><span class="line">552</span><br><span class="line">553</span><br><span class="line">554</span><br><span class="line">555</span><br><span class="line">556</span><br><span class="line">557</span><br><span class="line">558</span><br><span class="line">559</span><br><span class="line">560</span><br><span class="line">561</span><br><span class="line">562</span><br><span class="line">563</span><br><span class="line">564</span><br><span class="line">565</span><br><span class="line">566</span><br><span class="line">567</span><br><span class="line">568</span><br><span class="line">569</span><br><span class="line">570</span><br><span class="line">571</span><br><span class="line">572</span><br><span class="line">573</span><br><span class="line">574</span><br><span class="line">575</span><br><span class="line">576</span><br><span class="line">577</span><br><span class="line">578</span><br><span class="line">579</span><br><span class="line">580</span><br><span class="line">581</span><br><span class="line">582</span><br><span class="line">583</span><br><span class="line">584</span><br><span class="line">585</span><br><span class="line">586</span><br><span class="line">587</span><br><span class="line">588</span><br><span class="line">589</span><br><span class="line">590</span><br><span class="line">591</span><br><span class="line">592</span><br><span class="line">593</span><br><span class="line">594</span><br><span class="line">595</span><br><span class="line">596</span><br><span class="line">597</span><br><span class="line">598</span><br><span class="line">599</span><br><span class="line">600</span><br><span class="line">601</span><br><span class="line">602</span><br><span class="line">603</span><br><span class="line">604</span><br><span class="line">605</span><br><span class="line">606</span><br><span class="line">607</span><br><span class="line">608</span><br><span class="line">609</span><br><span class="line">610</span><br><span class="line">611</span><br><span class="line">612</span><br><span class="line">613</span><br><span class="line">614</span><br><span class="line">615</span><br><span class="line">616</span><br><span class="line">617</span><br><span class="line">618</span><br><span class="line">619</span><br><span class="line">620</span><br><span class="line">621</span><br><span class="line">622</span><br><span class="line">623</span><br><span class="line">624</span><br><span class="line">625</span><br><span class="line">626</span><br><span class="line">627</span><br><span class="line">628</span><br><span class="line">629</span><br><span class="line">630</span><br><span class="line">631</span><br><span class="line">632</span><br><span class="line">633</span><br><span class="line">634</span><br><span class="line">635</span><br><span class="line">636</span><br><span class="line">637</span><br><span class="line">638</span><br><span class="line">639</span><br><span class="line">640</span><br><span class="line">641</span><br><span class="line">642</span><br><span class="line">643</span><br><span class="line">644</span><br><span class="line">645</span><br><span class="line">646</span><br><span class="line">647</span><br><span class="line">648</span><br><span class="line">649</span><br><span class="line">650</span><br><span class="line">651</span><br><span class="line">652</span><br><span class="line">653</span><br><span class="line">654</span><br><span class="line">655</span><br><span class="line">656</span><br><span class="line">657</span><br><span class="line">658</span><br><span class="line">659</span><br><span class="line">660</span><br><span class="line">661</span><br><span class="line">662</span><br><span class="line">663</span><br><span class="line">664</span><br><span class="line">665</span><br><span class="line">666</span><br><span class="line">667</span><br><span class="line">668</span><br><span class="line">669</span><br><span class="line">670</span><br><span class="line">671</span><br><span class="line">672</span><br><span class="line">673</span><br><span class="line">674</span><br><span class="line">675</span><br><span class="line">676</span><br><span class="line">677</span><br><span class="line">678</span><br><span class="line">679</span><br><span class="line">680</span><br><span class="line">681</span><br><span class="line">682</span><br><span class="line">683</span><br><span class="line">684</span><br><span class="line">685</span><br><span class="line">686</span><br><span class="line">687</span><br><span class="line">688</span><br><span class="line">689</span><br><span class="line">690</span><br><span class="line">691</span><br><span class="line">692</span><br><span class="line">693</span><br><span class="line">694</span><br><span class="line">695</span><br><span class="line">696</span><br><span class="line">697</span><br><span class="line">698</span><br><span class="line">699</span><br><span class="line">700</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"sign"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"logo"</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"/"</span>&gt;</span><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">"/static/image/nav-logo.png"</span> <span class="attr">alt</span>=<span class="string">"Logo"</span>&gt;</span><span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"main"</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">h4</span> <span class="attr">class</span>=<span class="string">"title"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"normal-title"</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">router-link</span> <span class="attr">to</span>=<span class="string">"/user/login"</span>&gt;</span>登录<span class="tag">&lt;/<span class="name">router-link</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">b</span>&gt;</span>·<span class="tag">&lt;/<span class="name">b</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">router-link</span> <span class="attr">id</span>=<span class="string">"js-sign-up-btn"</span> <span class="attr">class</span>=<span class="string">"active"</span> <span class="attr">to</span>=<span class="string">"/user/register"</span>&gt;</span>注册<span class="tag">&lt;/<span class="name">router-link</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">h4</span>&gt;</span></span><br><span class="line"></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"js-sign-up-container"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">form</span> <span class="attr">class</span>=<span class="string">"new_user"</span> <span class="attr">id</span>=<span class="string">"new_user"</span> <span class="attr">action</span>=<span class="string">""</span> <span class="attr">accept-charset</span>=<span class="string">"UTF-8"</span> <span class="attr">method</span>=<span class="string">"post"</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"input-prepend restyle"</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">input</span> <span class="attr">placeholder</span>=<span class="string">"你的昵称"</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">value</span>=<span class="string">""</span> <span class="attr">v-model</span>=<span class="string">"nickname"</span> <span class="attr">id</span>=<span class="string">"user_nickname"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">i</span> <span class="attr">class</span>=<span class="string">"iconfont ic-user"</span>&gt;</span><span class="tag">&lt;/<span class="name">i</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"input-prepend restyle no-radius js-normal"</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">input</span> <span class="attr">placeholder</span>=<span class="string">"手机号"</span> <span class="attr">type</span>=<span class="string">"tel"</span> <span class="attr">v-model</span>=<span class="string">"mobile"</span> <span class="attr">id</span>=<span class="string">"user_mobile_number"</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">i</span> <span class="attr">class</span>=<span class="string">"iconfont ic-phonenumber"</span>&gt;</span><span class="tag">&lt;/<span class="name">i</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"input-prepend restyle no-radius security-up-code js-security-number"</span> <span class="attr">v-if</span>=<span class="string">"is_show_sms_code"</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">v-model</span>=<span class="string">"sms_code"</span> <span class="attr">id</span>=<span class="string">"sms_code"</span> <span class="attr">placeholder</span>=<span class="string">"手机验证码"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">i</span> <span class="attr">class</span>=<span class="string">"iconfont ic-verify"</span>&gt;</span><span class="tag">&lt;/<span class="name">i</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">a</span> <span class="attr">tabindex</span>=<span class="string">"-1"</span> <span class="attr">class</span>=<span class="string">"btn-up-resend js-send-code-button disable"</span> <span class="attr">href</span>=<span class="string">"javascript:void(0);"</span> <span class="attr">id</span>=<span class="string">"send_code"</span>&gt;</span>&#123;&#123;sms_code_text&#125;&#125;<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"hidden"</span> <span class="attr">name</span>=<span class="string">"security_number"</span> <span class="attr">id</span>=<span class="string">"security_number"</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"input-prepend"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">input</span> <span class="attr">placeholder</span>=<span class="string">"设置密码"</span> <span class="attr">type</span>=<span class="string">"password"</span> <span class="attr">v-model</span>=<span class="string">"password"</span> <span class="attr">id</span>=<span class="string">"user_password"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">i</span> <span class="attr">class</span>=<span class="string">"iconfont ic-password"</span>&gt;</span><span class="tag">&lt;/<span class="name">i</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"submit"</span> <span class="attr">name</span>=<span class="string">"commit"</span> <span class="attr">value</span>=<span class="string">"注册"</span> <span class="attr">class</span>=<span class="string">"sign-up-button"</span> <span class="attr">id</span>=<span class="string">"sign_up_btn"</span> <span class="attr">data-disable-with</span>=<span class="string">"注册"</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">p</span> <span class="attr">class</span>=<span class="string">"sign-up-msg"</span>&gt;</span>点击 “注册” 即表示您同意并愿意遵守荏苒<span class="tag">&lt;<span class="name">br</span>&gt;</span> <span class="tag">&lt;<span class="name">a</span> <span class="attr">target</span>=<span class="string">"_blank"</span> <span class="attr">href</span>=<span class="string">""</span>&gt;</span>用户协议<span class="tag">&lt;/<span class="name">a</span>&gt;</span> 和 <span class="tag">&lt;<span class="name">a</span> <span class="attr">target</span>=<span class="string">"_blank"</span> <span class="attr">href</span>=<span class="string">""</span>&gt;</span>隐私政策<span class="tag">&lt;/<span class="name">a</span>&gt;</span> 。<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- 更多注册方式 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"more-sign"</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">h6</span>&gt;</span>社交帐号直接注册<span class="tag">&lt;/<span class="name">h6</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">ul</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">id</span>=<span class="string">"weixin"</span> <span class="attr">class</span>=<span class="string">"weixin"</span> <span class="attr">target</span>=<span class="string">"_blank"</span> <span class="attr">href</span>=<span class="string">""</span>&gt;</span><span class="tag">&lt;<span class="name">i</span> <span class="attr">class</span>=<span class="string">"iconfont ic-wechat"</span>&gt;</span><span class="tag">&lt;/<span class="name">i</span>&gt;</span><span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">id</span>=<span class="string">"qq"</span> <span class="attr">class</span>=<span class="string">"qq"</span> <span class="attr">target</span>=<span class="string">"_blank"</span> <span class="attr">href</span>=<span class="string">""</span>&gt;</span><span class="tag">&lt;<span class="name">i</span> <span class="attr">class</span>=<span class="string">"iconfont ic-qq_connect"</span>&gt;</span><span class="tag">&lt;/<span class="name">i</span>&gt;</span><span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript">    <span class="keyword">export</span> <span class="keyword">default</span> &#123;</span></span><br><span class="line"><span class="actionscript">        name: <span class="string">"Register"</span>,</span></span><br><span class="line">        data()&#123;</span><br><span class="line"><span class="actionscript">          <span class="keyword">return</span> &#123;</span></span><br><span class="line"><span class="actionscript">            nickname:<span class="string">""</span>,</span></span><br><span class="line"><span class="actionscript">            mobile:<span class="string">""</span>,</span></span><br><span class="line"><span class="actionscript">            sms_code:<span class="string">""</span>,</span></span><br><span class="line"><span class="actionscript">            password:<span class="string">""</span>,</span></span><br><span class="line"><span class="actionscript">            sms_code_text:<span class="string">"发送验证码"</span>,</span></span><br><span class="line"><span class="actionscript">            is_show_sms_code:<span class="literal">false</span>,</span></span><br><span class="line">          &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        watch:&#123;</span><br><span class="line">          mobile()&#123;</span><br><span class="line"><span class="javascript">            <span class="keyword">if</span>(<span class="regexp">/^1[3-9]\d&#123;9&#125;$/</span>.test(<span class="keyword">this</span>.mobile))&#123;</span></span><br><span class="line"><span class="actionscript">              <span class="keyword">this</span>.is_show_sms_code = <span class="literal">true</span>;</span></span><br><span class="line"><span class="actionscript">            &#125;<span class="keyword">else</span>&#123;</span></span><br><span class="line"><span class="actionscript">              <span class="keyword">this</span>.is_show_sms_code = <span class="literal">false</span>;</span></span><br><span class="line">            &#125;</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span> <span class="attr">scoped</span>&gt;</span></span><br><span class="line">input&#123;</span><br><span class="line">  outline: none;</span><br><span class="line">&#125;</span><br><span class="line"><span class="css">*, <span class="selector-pseudo">:after</span>, <span class="selector-pseudo">:before</span> &#123;</span></span><br><span class="line">    box-sizing: border-box;</span><br><span class="line">&#125;</span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> &#123;</span></span><br><span class="line">height: 100%;</span><br><span class="line">min-height: 750px;</span><br><span class="line">text-align: center;</span><br><span class="line">font-size: 14px;</span><br><span class="line"><span class="css"><span class="selector-tag">background-color</span>: <span class="selector-id">#f1f1f1</span></span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span><span class="selector-pseudo">:before</span> &#123;</span></span><br><span class="line">content: "";</span><br><span class="line">display: inline-block;</span><br><span class="line">height: 85%;</span><br><span class="line">vertical-align: middle</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.disable</span>,<span class="selector-class">.sign</span> <span class="selector-class">.disable-gray</span> &#123;</span></span><br><span class="line"><span class="css"><span class="selector-tag">opacity</span>: <span class="selector-class">.5</span>;</span></span><br><span class="line">pointer-events: none</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.disable-gray</span> &#123;</span></span><br><span class="line"><span class="css"><span class="selector-tag">background-color</span>: <span class="selector-id">#969696</span></span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.tooltip-error</span> &#123;</span></span><br><span class="line">font-size: 14px;</span><br><span class="line">line-height: 25px;</span><br><span class="line">white-space: nowrap;</span><br><span class="line">background: none</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.tooltip-error</span> <span class="selector-class">.tooltip-inner</span> &#123;</span></span><br><span class="line">max-width: 280px;</span><br><span class="line"><span class="css"><span class="selector-tag">color</span>: <span class="selector-id">#333</span>;</span></span><br><span class="line"><span class="css"><span class="selector-tag">border</span>: 1<span class="selector-tag">px</span> <span class="selector-tag">solid</span> <span class="selector-id">#ea6f5a</span>;</span></span><br><span class="line"><span class="css"><span class="selector-tag">background-color</span>: <span class="selector-id">#fff</span></span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.tooltip-error</span> <span class="selector-class">.tooltip-inner</span> <span class="selector-tag">i</span> &#123;</span></span><br><span class="line">position: static;</span><br><span class="line">margin-right: 5px;</span><br><span class="line">font-size: 20px;</span><br><span class="line"><span class="css"><span class="selector-tag">color</span>: <span class="selector-id">#ea6f5a</span>;</span></span><br><span class="line">vertical-align: middle</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.tooltip-error</span> <span class="selector-class">.tooltip-inner</span> <span class="selector-tag">span</span> &#123;</span></span><br><span class="line">vertical-align: middle;</span><br><span class="line">display: inline-block;</span><br><span class="line">white-space: normal;</span><br><span class="line">max-width: 230px</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.tooltip-error</span><span class="selector-class">.right</span> <span class="selector-class">.tooltip-arrow-border</span> &#123;</span></span><br><span class="line"><span class="css"><span class="selector-tag">border-right-color</span>: <span class="selector-id">#ea6f5a</span></span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.tooltip-error</span><span class="selector-class">.right</span> <span class="selector-class">.tooltip-arrow-bg</span> &#123;</span></span><br><span class="line">left: 2px;</span><br><span class="line"><span class="css"><span class="selector-tag">border-right-color</span>: <span class="selector-id">#fff</span></span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.slide-error</span> &#123;</span></span><br><span class="line">position: relative;</span><br><span class="line">padding: 10px 0;</span><br><span class="line"><span class="css"><span class="selector-tag">border</span>: 1<span class="selector-tag">px</span> <span class="selector-tag">solid</span> <span class="selector-id">#c8c8c8</span>;</span></span><br><span class="line">border-radius: 4px</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.slide-error</span> <span class="selector-tag">i</span> &#123;</span></span><br><span class="line">position: static!important;</span><br><span class="line">margin-right: 10px;</span><br><span class="line"><span class="css"><span class="selector-tag">color</span>: <span class="selector-id">#ea6f5a</span>!<span class="selector-tag">important</span>;</span></span><br><span class="line">vertical-align: middle</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.slide-error</span> <span class="selector-tag">span</span> &#123;</span></span><br><span class="line">font-size: 15px;</span><br><span class="line">vertical-align: middle</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.slide-error</span> <span class="selector-tag">div</span> &#123;</span></span><br><span class="line">margin-top: 10px;</span><br><span class="line">font-size: 13px</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.slide-error</span> <span class="selector-tag">a</span> &#123;</span></span><br><span class="line"><span class="css"><span class="selector-tag">color</span>: <span class="selector-id">#3194d0</span></span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.js-sign-up-forbidden</span> &#123;</span></span><br><span class="line"><span class="css"><span class="selector-tag">color</span>: <span class="selector-id">#999</span>;</span></span><br><span class="line">padding: 80px 0 100px</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.js-sign-up-container</span> <span class="selector-class">.slide-error</span> &#123;</span></span><br><span class="line">border-bottom: none;</span><br><span class="line">border-radius: 0</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.logo</span> &#123;</span></span><br><span class="line">position: absolute;</span><br><span class="line">top: 56px;</span><br><span class="line">margin-left: 50px</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.logo</span> <span class="selector-tag">img</span> &#123;</span></span><br><span class="line">width: 100px</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.main</span> &#123;</span></span><br><span class="line">width: 400px;</span><br><span class="line">margin: 60px auto 0;</span><br><span class="line">padding: 50px 50px 30px;</span><br><span class="line"><span class="css"><span class="selector-tag">background-color</span>: <span class="selector-id">#fff</span>;</span></span><br><span class="line">border-radius: 4px;</span><br><span class="line"><span class="css"><span class="selector-tag">box-shadow</span>: 0 0 8<span class="selector-tag">px</span> <span class="selector-tag">rgba</span>(0,0,0,<span class="selector-class">.1</span>);</span></span><br><span class="line">vertical-align: middle;</span><br><span class="line">display: inline-block</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.reset-title</span>,<span class="selector-class">.sign</span> <span class="selector-class">.title</span> &#123;</span></span><br><span class="line">margin: 0 auto 50px;</span><br><span class="line">padding: 10px;</span><br><span class="line">font-weight: 400;</span><br><span class="line"><span class="css"><span class="selector-tag">color</span>: <span class="selector-id">#969696</span></span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.reset-title</span> <span class="selector-tag">a</span>,<span class="selector-class">.sign</span> <span class="selector-class">.title</span> <span class="selector-tag">a</span> &#123;</span></span><br><span class="line">padding: 10px;</span><br><span class="line"><span class="css"><span class="selector-tag">color</span>: <span class="selector-id">#969696</span></span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.reset-title</span> <span class="selector-tag">a</span><span class="selector-pseudo">:hover</span>,<span class="selector-class">.sign</span> <span class="selector-class">.title</span> <span class="selector-tag">a</span><span class="selector-pseudo">:hover</span> &#123;</span></span><br><span class="line"><span class="css"><span class="selector-tag">border-bottom</span>: 2<span class="selector-tag">px</span> <span class="selector-tag">solid</span> <span class="selector-id">#ea6f5a</span></span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.reset-title</span> <span class="selector-class">.active</span>,<span class="selector-class">.sign</span> <span class="selector-class">.title</span> <span class="selector-class">.active</span> &#123;</span></span><br><span class="line">font-weight: 700;</span><br><span class="line"><span class="css"><span class="selector-tag">color</span>: <span class="selector-id">#ea6f5a</span>;</span></span><br><span class="line"><span class="css"><span class="selector-tag">border-bottom</span>: 2<span class="selector-tag">px</span> <span class="selector-tag">solid</span> <span class="selector-id">#ea6f5a</span></span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.reset-title</span> <span class="selector-tag">b</span>,<span class="selector-class">.sign</span> <span class="selector-class">.title</span> <span class="selector-tag">b</span> &#123;</span></span><br><span class="line">padding: 10px</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.reset-title</span> &#123;</span></span><br><span class="line"><span class="css"><span class="selector-tag">color</span>: <span class="selector-id">#333</span>;</span></span><br><span class="line">font-weight: 700</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-tag">form</span> &#123;</span></span><br><span class="line">margin-bottom: 30px</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-tag">form</span> <span class="selector-class">.input-prepend</span> &#123;</span></span><br><span class="line">position: relative;</span><br><span class="line">width: 100%</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-tag">form</span> <span class="selector-class">.input-prepend</span> <span class="selector-tag">input</span> &#123;</span></span><br><span class="line">width: 100%;</span><br><span class="line">height: 50px;</span><br><span class="line">margin-bottom: 0;</span><br><span class="line">padding: 4px 12px 4px 35px;</span><br><span class="line"><span class="css"><span class="selector-tag">border</span>: 1<span class="selector-tag">px</span> <span class="selector-tag">solid</span> <span class="selector-id">#c8c8c8</span>;</span></span><br><span class="line">border-radius: 0 0 4px 4px;</span><br><span class="line"><span class="css"><span class="selector-tag">background-color</span>: <span class="selector-tag">hsla</span>(0,0%,71%,<span class="selector-class">.1</span>);</span></span><br><span class="line">vertical-align: middle</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-tag">form</span> <span class="selector-class">.input-prepend</span> <span class="selector-tag">i</span> &#123;</span></span><br><span class="line">position: absolute;</span><br><span class="line">top: 14px;</span><br><span class="line">left: 10px;</span><br><span class="line">font-size: 18px;</span><br><span class="line"><span class="css"><span class="selector-tag">color</span>: <span class="selector-id">#969696</span></span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-tag">form</span> <span class="selector-class">.input-prepend</span> <span class="selector-tag">span</span> &#123;</span></span><br><span class="line"><span class="css"><span class="selector-tag">color</span>: <span class="selector-id">#333</span></span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-tag">form</span> <span class="selector-class">.input-prepend</span> <span class="selector-class">.ic-show</span> &#123;</span></span><br><span class="line">top: 18px;</span><br><span class="line">left: auto;</span><br><span class="line">right: 8px;</span><br><span class="line">font-size: 12px</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-tag">form</span> <span class="selector-class">.geetest-placeholder</span> &#123;</span></span><br><span class="line">height: 44px;</span><br><span class="line">border-radius: 4px;</span><br><span class="line"><span class="css"><span class="selector-tag">background-color</span>: <span class="selector-tag">hsla</span>(0,0%,71%,<span class="selector-class">.1</span>);</span></span><br><span class="line">text-align: center;</span><br><span class="line">line-height: 44px;</span><br><span class="line">font-size: 14px;</span><br><span class="line"><span class="css"><span class="selector-tag">color</span>: <span class="selector-id">#999</span></span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-tag">form</span> <span class="selector-class">.restyle</span> &#123;</span></span><br><span class="line">margin-bottom: 0</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-tag">form</span> <span class="selector-class">.restyle</span> <span class="selector-tag">input</span> &#123;</span></span><br><span class="line">border-bottom: none;</span><br><span class="line">border-radius: 4px 4px 0 0</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-tag">form</span> <span class="selector-class">.no-radius</span> <span class="selector-tag">input</span> &#123;</span></span><br><span class="line">border-radius: 0</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-tag">form</span> <span class="selector-class">.slide-security-placeholder</span> &#123;</span></span><br><span class="line">height: 32px;</span><br><span class="line"><span class="css"><span class="selector-tag">background-color</span>: <span class="selector-tag">hsla</span>(0,0%,71%,<span class="selector-class">.1</span>);</span></span><br><span class="line">border-radius: 4px</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-tag">form</span> <span class="selector-class">.slide-security-placeholder</span> <span class="selector-tag">p</span> &#123;</span></span><br><span class="line">padding-top: 7px;</span><br><span class="line"><span class="css"><span class="selector-tag">color</span>: <span class="selector-id">#999</span>;</span></span><br><span class="line">margin-right: -7px</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.overseas-btn</span> &#123;</span></span><br><span class="line">font-size: 14px;</span><br><span class="line"><span class="css"><span class="selector-tag">color</span>: <span class="selector-id">#999</span></span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.overseas-btn</span><span class="selector-pseudo">:hover</span> &#123;</span></span><br><span class="line"><span class="css"><span class="selector-tag">color</span>: <span class="selector-id">#2f2f2f</span></span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.remember-btn</span> &#123;</span></span><br><span class="line">float: left;</span><br><span class="line">margin: 15px 0</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.remember-btn</span> <span class="selector-tag">span</span> &#123;</span></span><br><span class="line">margin-left: 5px;</span><br><span class="line">font-size: 15px;</span><br><span class="line"><span class="css"><span class="selector-tag">color</span>: <span class="selector-id">#969696</span>;</span></span><br><span class="line">vertical-align: middle</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.forget-btn</span> &#123;</span></span><br><span class="line">float: right;</span><br><span class="line">position: relative;</span><br><span class="line">margin: 15px 0;</span><br><span class="line">font-size: 14px</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.forget-btn</span> <span class="selector-tag">a</span> &#123;</span></span><br><span class="line"><span class="css"><span class="selector-tag">color</span>: <span class="selector-id">#999</span></span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.forget-btn</span> <span class="selector-tag">a</span><span class="selector-pseudo">:hover</span> &#123;</span></span><br><span class="line"><span class="css"><span class="selector-tag">color</span>: <span class="selector-id">#333</span></span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.forget-btn</span> <span class="selector-class">.dropdown-menu</span> &#123;</span></span><br><span class="line">top: 20px;</span><br><span class="line">left: auto;</span><br><span class="line">right: 0;</span><br><span class="line">border-radius: 4px</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.forget-btn</span> <span class="selector-class">.dropdown-menu</span> <span class="selector-tag">a</span> &#123;</span></span><br><span class="line">padding: 10px 20px;</span><br><span class="line"><span class="css"><span class="selector-tag">color</span>: <span class="selector-id">#333</span></span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-id">#sign-in-loading</span> &#123;</span></span><br><span class="line">position: relative;</span><br><span class="line">width: 20px;</span><br><span class="line">height: 20px;</span><br><span class="line">vertical-align: middle;</span><br><span class="line">margin-top: -4px;</span><br><span class="line">margin-right: 2px;</span><br><span class="line">display: none</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-id">#sign-in-loading</span><span class="selector-pseudo">:after</span> &#123;</span></span><br><span class="line">content: "";</span><br><span class="line">position: absolute;</span><br><span class="line">left: 0;</span><br><span class="line">top: 0;</span><br><span class="line">width: 100%;</span><br><span class="line">height: 100%;</span><br><span class="line">background-color: transparent</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-id">#sign-in-loading</span><span class="selector-pseudo">:before</span> &#123;</span></span><br><span class="line">content: "";</span><br><span class="line">position: absolute;</span><br><span class="line">top: 50%;</span><br><span class="line">left: 50%;</span><br><span class="line">width: 20px;</span><br><span class="line">height: 20px;</span><br><span class="line">margin: -10px 0 0 -10px;</span><br><span class="line">border-radius: 10px;</span><br><span class="line"><span class="css"><span class="selector-tag">border</span>: 2<span class="selector-tag">px</span> <span class="selector-tag">solid</span> <span class="selector-id">#fff</span>;</span></span><br><span class="line">border-bottom-color: transparent;</span><br><span class="line">vertical-align: middle;</span><br><span class="line"><span class="css"><span class="selector-tag">-webkit-animation</span>: <span class="selector-tag">rolling</span> <span class="selector-class">.8s</span> <span class="selector-tag">infinite</span> <span class="selector-tag">linear</span>;</span></span><br><span class="line"><span class="css"><span class="selector-tag">animation</span>: <span class="selector-tag">rolling</span> <span class="selector-class">.8s</span> <span class="selector-tag">infinite</span> <span class="selector-tag">linear</span>;</span></span><br><span class="line">z-index: 1</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.sign-in-button</span>,<span class="selector-class">.sign</span> <span class="selector-class">.sign-up-button</span> &#123;</span></span><br><span class="line">margin-top: 20px;</span><br><span class="line">width: 100%;</span><br><span class="line">padding: 9px 18px;</span><br><span class="line">font-size: 18px;</span><br><span class="line">border: none;</span><br><span class="line">border-radius: 25px;</span><br><span class="line"><span class="css"><span class="selector-tag">color</span>: <span class="selector-id">#fff</span>;</span></span><br><span class="line"><span class="css"><span class="selector-tag">background</span>: <span class="selector-id">#42c02e</span>;</span></span><br><span class="line">cursor: pointer;</span><br><span class="line">outline: none;</span><br><span class="line">display: block;</span><br><span class="line">clear: both</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.sign-in-button</span><span class="selector-pseudo">:hover</span>,<span class="selector-class">.sign</span> <span class="selector-class">.sign-up-button</span><span class="selector-pseudo">:hover</span> &#123;</span></span><br><span class="line"><span class="css"><span class="selector-tag">background</span>: <span class="selector-id">#3db922</span></span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.sign-in-button</span> &#123;</span></span><br><span class="line"><span class="css"><span class="selector-tag">background</span>: <span class="selector-id">#3194d0</span></span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.sign-in-button</span><span class="selector-pseudo">:hover</span> &#123;</span></span><br><span class="line"><span class="css"><span class="selector-tag">background</span>: <span class="selector-id">#187cb7</span></span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.btn-in-resend</span>,<span class="selector-class">.sign</span> <span class="selector-class">.btn-up-resend</span> &#123;</span></span><br><span class="line">position: absolute;</span><br><span class="line">top: 7px;</span><br><span class="line">right: 7px;</span><br><span class="line">width: 100px;</span><br><span class="line">height: 36px;</span><br><span class="line">font-size: 13px;</span><br><span class="line"><span class="css"><span class="selector-tag">color</span>: <span class="selector-id">#fff</span>;</span></span><br><span class="line"><span class="css"><span class="selector-tag">background-color</span>: <span class="selector-id">#42c02e</span>;</span></span><br><span class="line">border-radius: 20px;</span><br><span class="line">line-height: 36px</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.btn-in-resend</span> &#123;</span></span><br><span class="line"><span class="css"><span class="selector-tag">background-color</span>: <span class="selector-id">#3194d0</span></span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.sign-up-msg</span> &#123;</span></span><br><span class="line">margin: 10px 0;</span><br><span class="line">padding: 0;</span><br><span class="line">text-align: center;</span><br><span class="line">font-size: 12px;</span><br><span class="line">line-height: 20px;</span><br><span class="line"><span class="css"><span class="selector-tag">color</span>: <span class="selector-id">#969696</span></span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.sign-up-msg</span> <span class="selector-tag">a</span>,<span class="selector-class">.sign</span> <span class="selector-class">.sign-up-msg</span> <span class="selector-tag">a</span><span class="selector-pseudo">:hover</span> &#123;</span></span><br><span class="line"><span class="css"><span class="selector-tag">color</span>: <span class="selector-id">#3194d0</span></span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.overseas</span> <span class="selector-tag">input</span> &#123;</span></span><br><span class="line">padding-left: 110px!important</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.overseas</span> <span class="selector-class">.overseas-number</span> &#123;</span></span><br><span class="line">position: absolute;</span><br><span class="line">top: 0;</span><br><span class="line">left: 0;</span><br><span class="line">width: 100px;</span><br><span class="line">height: 50px;</span><br><span class="line">font-size: 18px;</span><br><span class="line"><span class="css"><span class="selector-tag">color</span>: <span class="selector-id">#969696</span>;</span></span><br><span class="line"><span class="css"><span class="selector-tag">border-right</span>: 1<span class="selector-tag">px</span> <span class="selector-tag">solid</span> <span class="selector-id">#c8c8c8</span></span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.overseas</span> <span class="selector-class">.overseas-number</span> <span class="selector-tag">span</span> &#123;</span></span><br><span class="line">margin-top: 17px;</span><br><span class="line">padding-left: 35px;</span><br><span class="line">text-align: left;</span><br><span class="line">font-size: 14px;</span><br><span class="line">display: block</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.overseas</span> <span class="selector-class">.dropdown-menu</span> &#123;</span></span><br><span class="line">width: 100%;</span><br><span class="line">max-height: 285px;</span><br><span class="line">font-size: 14px;</span><br><span class="line">border-radius: 0 0 4px 4px;</span><br><span class="line">overflow-y: auto</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.overseas</span> <span class="selector-class">.dropdown-menu</span> <span class="selector-tag">li</span> <span class="selector-class">.nation-code</span> &#123;</span></span><br><span class="line">width: 65px;</span><br><span class="line">display: inline-block</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.overseas</span> <span class="selector-class">.dropdown-menu</span> <span class="selector-tag">li</span> <span class="selector-tag">a</span> &#123;</span></span><br><span class="line">padding: 6px 20px;</span><br><span class="line">font-size: 14px;</span><br><span class="line">line-height: 20px</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.overseas</span> <span class="selector-class">.dropdown-menu</span> <span class="selector-tag">li</span> <span class="selector-tag">a</span><span class="selector-pseudo">::hover</span> &#123;</span></span><br><span class="line"><span class="css"><span class="selector-tag">color</span>: <span class="selector-id">#fff</span>;</span></span><br><span class="line"><span class="css"><span class="selector-tag">background-color</span>: <span class="selector-id">#f5f5f5</span></span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.more-sign</span> &#123;</span></span><br><span class="line">margin-top: 50px</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.more-sign</span> <span class="selector-tag">h6</span> &#123;</span></span><br><span class="line">position: relative;</span><br><span class="line">margin: 0 0 10px;</span><br><span class="line">font-size: 12px;</span><br><span class="line"><span class="css"><span class="selector-tag">color</span>: <span class="selector-id">#b5b5b5</span></span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.more-sign</span> <span class="selector-tag">h6</span><span class="selector-pseudo">:before</span> &#123;</span></span><br><span class="line">left: 30px</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.more-sign</span> <span class="selector-tag">h6</span><span class="selector-pseudo">:after</span>,<span class="selector-class">.sign</span> <span class="selector-class">.more-sign</span> <span class="selector-tag">h6</span><span class="selector-pseudo">:before</span> &#123;</span></span><br><span class="line">content: "";</span><br><span class="line"><span class="css"><span class="selector-tag">border-top</span>: 1<span class="selector-tag">px</span> <span class="selector-tag">solid</span> <span class="selector-id">#b5b5b5</span>;</span></span><br><span class="line">display: block;</span><br><span class="line">position: absolute;</span><br><span class="line">width: 60px;</span><br><span class="line">top: 5px</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.more-sign</span> <span class="selector-tag">h6</span><span class="selector-pseudo">:after</span> &#123;</span></span><br><span class="line">right: 30px</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.more-sign</span> <span class="selector-tag">ul</span> &#123;</span></span><br><span class="line">margin-bottom: 10px;</span><br><span class="line">list-style: none</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.more-sign</span> <span class="selector-tag">ul</span> <span class="selector-tag">li</span> &#123;</span></span><br><span class="line">margin: 0 5px;</span><br><span class="line">display: inline-block</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.more-sign</span> <span class="selector-tag">ul</span> <span class="selector-tag">a</span> &#123;</span></span><br><span class="line">width: 50px;</span><br><span class="line">height: 50px;</span><br><span class="line">line-height: 50px;</span><br><span class="line">display: block</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.more-sign</span> <span class="selector-tag">ul</span> <span class="selector-tag">i</span> &#123;</span></span><br><span class="line">font-size: 28px</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.more-sign</span> <span class="selector-class">.ic-weibo</span> &#123;</span></span><br><span class="line"><span class="css"><span class="selector-tag">color</span>: <span class="selector-id">#e05244</span></span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.more-sign</span> <span class="selector-class">.ic-wechat</span> &#123;</span></span><br><span class="line"><span class="css"><span class="selector-tag">color</span>: <span class="selector-id">#00bb29</span></span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.more-sign</span> <span class="selector-class">.ic-qq_connect</span> &#123;</span></span><br><span class="line"><span class="css"><span class="selector-tag">color</span>: <span class="selector-id">#498ad5</span></span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.more-sign</span> <span class="selector-class">.ic-douban</span> &#123;</span></span><br><span class="line"><span class="css"><span class="selector-tag">color</span>: <span class="selector-id">#00820f</span></span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.more-sign</span> <span class="selector-class">.ic-more</span> &#123;</span></span><br><span class="line"><span class="css"><span class="selector-tag">color</span>: <span class="selector-id">#999</span></span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.more-sign</span> <span class="selector-class">.weibo-loading</span> &#123;</span></span><br><span class="line">pointer-events: none;</span><br><span class="line">cursor: pointer;</span><br><span class="line">position: relative</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.more-sign</span> <span class="selector-class">.weibo-loading</span><span class="selector-pseudo">:after</span> &#123;</span></span><br><span class="line">content: "";</span><br><span class="line">position: absolute;</span><br><span class="line">left: 0;</span><br><span class="line">top: 0;</span><br><span class="line">width: 100%;</span><br><span class="line">height: 100%;</span><br><span class="line"><span class="css"><span class="selector-tag">background-color</span>: <span class="selector-id">#fff</span></span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-tag">body</span><span class="selector-class">.reader-night-mode</span> <span class="selector-class">.sign</span> <span class="selector-class">.more-sign</span> <span class="selector-class">.weibo-loading</span><span class="selector-pseudo">:after</span> &#123;</span></span><br><span class="line"><span class="css"><span class="selector-tag">background-color</span>: <span class="selector-id">#3f3f3f</span></span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.more-sign</span> <span class="selector-class">.weibo-loading</span><span class="selector-pseudo">:before</span> &#123;</span></span><br><span class="line">content: "";</span><br><span class="line">position: absolute;</span><br><span class="line">top: 50%;</span><br><span class="line">left: 50%;</span><br><span class="line">width: 20px;</span><br><span class="line">height: 20px;</span><br><span class="line">margin: -10px 0 0 -10px;</span><br><span class="line">border-radius: 10px;</span><br><span class="line"><span class="css"><span class="selector-tag">border</span>: 2<span class="selector-tag">px</span> <span class="selector-tag">solid</span> <span class="selector-id">#e05244</span>;</span></span><br><span class="line">border-bottom-color: transparent;</span><br><span class="line">vertical-align: middle;</span><br><span class="line"><span class="css"><span class="selector-tag">-webkit-animation</span>: <span class="selector-tag">rolling</span> <span class="selector-class">.8s</span> <span class="selector-tag">infinite</span> <span class="selector-tag">linear</span>;</span></span><br><span class="line"><span class="css"><span class="selector-tag">animation</span>: <span class="selector-tag">rolling</span> <span class="selector-class">.8s</span> <span class="selector-tag">infinite</span> <span class="selector-tag">linear</span>;</span></span><br><span class="line">z-index: 1</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="keyword">@keyframes</span> rolling &#123;</span></span><br><span class="line">0% &#123;</span><br><span class="line">-webkit-transform: rotate(0deg);</span><br><span class="line">transform: rotate(0deg)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">to &#123;</span><br><span class="line">-webkit-transform: rotate(1turn);</span><br><span class="line">transform: rotate(1turn)</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="keyword">@-webkit-keyframes</span> rolling &#123;</span></span><br><span class="line">0% &#123;</span><br><span class="line">-webkit-transform: rotate(0deg)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">to &#123;</span><br><span class="line">-webkit-transform: rotate(1turn)</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.reset-password-input</span> &#123;</span></span><br><span class="line">border-radius: 4px!important</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.return</span> &#123;</span></span><br><span class="line">margin-left: -8px;</span><br><span class="line"><span class="css"><span class="selector-tag">color</span>: <span class="selector-id">#969696</span></span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.return</span><span class="selector-pseudo">:hover</span> &#123;</span></span><br><span class="line"><span class="css"><span class="selector-tag">color</span>: <span class="selector-id">#333</span></span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.return</span> <span class="selector-tag">i</span> &#123;</span></span><br><span class="line">margin-right: 5px</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.icheckbox_square-green</span> &#123;</span></span><br><span class="line">display: inline-block;</span><br><span class="line">*display: inline;</span><br><span class="line">vertical-align: middle;</span><br><span class="line">margin: 0;</span><br><span class="line">padding: 0;</span><br><span class="line">width: 18px;</span><br><span class="line">height: 18px;</span><br><span class="line">background: url(/static/image/green.png) no-repeat;</span><br><span class="line">border: none;</span><br><span class="line">cursor: pointer;</span><br><span class="line">background-position: 0 0</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.icheckbox_square-green</span><span class="selector-class">.hover</span> &#123;</span></span><br><span class="line">background-position: -20px 0</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.icheckbox_square-green</span><span class="selector-class">.checked</span> &#123;</span></span><br><span class="line">background-position: -40px 0</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.icheckbox_square-green</span><span class="selector-class">.disabled</span> &#123;</span></span><br><span class="line">background-position: -60px 0;</span><br><span class="line">cursor: default</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.icheckbox_square-green</span><span class="selector-class">.checked</span><span class="selector-class">.disabled</span> &#123;</span></span><br><span class="line">background-position: -80px 0</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.geetest_panel_box</span>&gt;* &#123;</span></span><br><span class="line">box-sizing: content-box</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="keyword">@media</span> (<span class="attribute">max-width:</span><span class="number">768px</span>) &#123;</span></span><br><span class="line">body &#123;</span><br><span class="line">min-width: 0</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> &#123;</span></span><br><span class="line">height: auto;</span><br><span class="line">min-height: 0;</span><br><span class="line">background-color: transparent</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.logo</span> &#123;</span></span><br><span class="line">display: none</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.main</span> &#123;</span></span><br><span class="line">position: absolute;</span><br><span class="line">left: 50%;</span><br><span class="line">margin: 0 0 0 -200px;</span><br><span class="line">box-shadow: none</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br></pre></td></tr></table></figure><p>前端注册路由:</p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> Register <span class="keyword">from</span> <span class="string">"../components/Register"</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 配置路由列表</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">new</span> Router(&#123;</span><br><span class="line">  mode:<span class="string">"history"</span>,</span><br><span class="line">  routes:[</span><br><span class="line">    <span class="comment">// 路由列表</span></span><br><span class="line">...</span><br><span class="line">    &#123;</span><br><span class="line">      name:<span class="string">"Register"</span>,</span><br><span class="line">      path: <span class="string">"/register"</span>,</span><br><span class="line">      component:Register,</span><br><span class="line">    &#125;</span><br><span class="line">  ]</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p>修改首页头部的连接:</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"># Header.vue</span><br><span class="line"><span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"header-register"</span>&gt;</span><span class="tag">&lt;<span class="name">router-link</span> <span class="attr">to</span>=<span class="string">"/register"</span>&gt;</span>注册<span class="tag">&lt;/<span class="name">router-link</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">#Login.vue</span><br><span class="line"><span class="tag">&lt;<span class="name">p</span> <span class="attr">class</span>=<span class="string">"go_login"</span> &gt;</span>没有账号 <span class="tag">&lt;<span class="name">router-link</span> <span class="attr">to</span>=<span class="string">"/register"</span>&gt;</span>立即注册<span class="tag">&lt;/<span class="name">router-link</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="注册功能的实现"><a href="#注册功能的实现" class="headerlink" title="注册功能的实现"></a>注册功能的实现</h2><h3 id="实现基本的账号信息注册"><a href="#实现基本的账号信息注册" class="headerlink" title="实现基本的账号信息注册"></a>实现基本的账号信息注册</h3><p>视图代码:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> rest_framework.generics <span class="keyword">import</span> CreateAPIView</span><br><span class="line"><span class="keyword">from</span> .models <span class="keyword">import</span> User</span><br><span class="line"><span class="keyword">from</span> .serializers <span class="keyword">import</span> UserModelSerializer</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">UserCreateAPIView</span><span class="params">(CreateAPIView)</span>:</span></span><br><span class="line">    queryset = User.objects.all()</span><br><span class="line">    serializer_class = UserModelSerializer</span><br></pre></td></tr></table></figure><p>序列化器中,验证和保存数据,并返回jwt登录认证</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> rest_framework <span class="keyword">import</span> serializers</span><br><span class="line"><span class="keyword">from</span> .models <span class="keyword">import</span> User</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">UserModelSerializer</span><span class="params">(serializers.ModelSerializer)</span>:</span></span><br><span class="line">    <span class="string">"""用户信息序列化器"""</span></span><br><span class="line">    sms_code = serializers.CharField(required=<span class="literal">True</span>, write_only=<span class="literal">True</span>, max_length=<span class="number">5</span>, help_text=<span class="string">"短信验证码"</span>)</span><br><span class="line">    token = serializers.CharField(read_only=<span class="literal">True</span>, help_text=<span class="string">"jwt登录认证"</span>)</span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">Meta</span>:</span></span><br><span class="line">        model = User</span><br><span class="line">        fields = [<span class="string">"id"</span>,<span class="string">"username"</span>,<span class="string">"mobile"</span>,<span class="string">"password"</span>,<span class="string">"nickname"</span>,<span class="string">"sms_code"</span>,<span class="string">"token"</span>]</span><br><span class="line">        extra_kwargs = &#123;</span><br><span class="line">            <span class="string">"id"</span>:&#123;<span class="string">"read_only"</span>:<span class="literal">True</span>, &#125;,</span><br><span class="line">            <span class="string">"username"</span>:&#123;<span class="string">"read_only"</span>:<span class="literal">True</span>, &#125;,</span><br><span class="line">            <span class="string">"mobile"</span>:&#123;<span class="string">"required"</span>:<span class="literal">True</span>, <span class="string">"write_only"</span>:<span class="literal">True</span>, &#125;,</span><br><span class="line">            <span class="string">"password"</span>:&#123;<span class="string">"required"</span>:<span class="literal">True</span>, <span class="string">"write_only"</span>:<span class="literal">True</span>, <span class="string">"max_length"</span>: <span class="number">16</span>, <span class="string">"min_length"</span>: <span class="number">6</span>&#125;,</span><br><span class="line">            <span class="string">"nickname"</span>:&#123;<span class="string">"required"</span>:<span class="literal">True</span> &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">validate</span><span class="params">(self, attrs)</span>:</span></span><br><span class="line">        <span class="comment"># 1. 验证手机号码是否格式正确</span></span><br><span class="line">        mobile = attrs.get(<span class="string">"mobile"</span>)</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> re.match(<span class="string">"^1[3-9]\d&#123;9&#125;$"</span>, mobile):</span><br><span class="line">            <span class="keyword">raise</span> serializers.ValidationError(<span class="string">"手机号码格式错误！"</span>)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 2. 验证手机号是否注册了</span></span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            User.objects.get(mobile=mobile)</span><br><span class="line">            <span class="keyword">raise</span> serializers.ValidationError(<span class="string">"手机号码被占用！"</span>)</span><br><span class="line">        <span class="keyword">except</span> User.DoesNotExist:</span><br><span class="line">            <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"># 3. 昵称是否被注册了</span></span><br><span class="line">        nickname = attrs.get(<span class="string">"nickname"</span>)</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            User.objects.get(nickname=nickname)</span><br><span class="line">            <span class="keyword">raise</span> serializers.ValidationError(<span class="string">"用户昵称被占用！"</span>)</span><br><span class="line">        <span class="keyword">except</span> User.DoesNotExist:</span><br><span class="line">            <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"># todo 4. 验证手机短信是否正确</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> attrs</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">create</span><span class="params">(self, validated_data)</span>:</span></span><br><span class="line">        <span class="string">"""保存用户注册信息"""</span></span><br><span class="line">        mobile = validated_data.get(<span class="string">"mobile"</span>)</span><br><span class="line">        nickname = validated_data.get(<span class="string">"nickname"</span>)</span><br><span class="line">        password = validated_data.get(<span class="string">"password"</span>)</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            user = User.objects.create_user(mobile=mobile, nickname=nickname, password=password)</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            <span class="keyword">raise</span> serializers.ValidationError(<span class="string">"用户信息注册失败！"</span>)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 返回jwt登录token</span></span><br><span class="line">        <span class="keyword">from</span> rest_framework_jwt.settings <span class="keyword">import</span> api_settings</span><br><span class="line"></span><br><span class="line">        jwt_payload_handler = api_settings.JWT_PAYLOAD_HANDLER</span><br><span class="line">        jwt_encode_handler = api_settings.JWT_ENCODE_HANDLER</span><br><span class="line"></span><br><span class="line">        payload = jwt_payload_handler(user)</span><br><span class="line">        user.token = jwt_encode_handler(payload)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> user</span><br></pre></td></tr></table></figure><p>路由,代码:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">path(<span class="string">""</span>, views.UserCreateAPIView.as_view()),</span><br></pre></td></tr></table></figure><h3 id="客户端提交注册信息"><a href="#客户端提交注册信息" class="headerlink" title="客户端提交注册信息"></a>客户端提交注册信息</h3><p>register.vue,代码:</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br><span class="line">476</span><br><span class="line">477</span><br><span class="line">478</span><br><span class="line">479</span><br><span class="line">480</span><br><span class="line">481</span><br><span class="line">482</span><br><span class="line">483</span><br><span class="line">484</span><br><span class="line">485</span><br><span class="line">486</span><br><span class="line">487</span><br><span class="line">488</span><br><span class="line">489</span><br><span class="line">490</span><br><span class="line">491</span><br><span class="line">492</span><br><span class="line">493</span><br><span class="line">494</span><br><span class="line">495</span><br><span class="line">496</span><br><span class="line">497</span><br><span class="line">498</span><br><span class="line">499</span><br><span class="line">500</span><br><span class="line">501</span><br><span class="line">502</span><br><span class="line">503</span><br><span class="line">504</span><br><span class="line">505</span><br><span class="line">506</span><br><span class="line">507</span><br><span class="line">508</span><br><span class="line">509</span><br><span class="line">510</span><br><span class="line">511</span><br><span class="line">512</span><br><span class="line">513</span><br><span class="line">514</span><br><span class="line">515</span><br><span class="line">516</span><br><span class="line">517</span><br><span class="line">518</span><br><span class="line">519</span><br><span class="line">520</span><br><span class="line">521</span><br><span class="line">522</span><br><span class="line">523</span><br><span class="line">524</span><br><span class="line">525</span><br><span class="line">526</span><br><span class="line">527</span><br><span class="line">528</span><br><span class="line">529</span><br><span class="line">530</span><br><span class="line">531</span><br><span class="line">532</span><br><span class="line">533</span><br><span class="line">534</span><br><span class="line">535</span><br><span class="line">536</span><br><span class="line">537</span><br><span class="line">538</span><br><span class="line">539</span><br><span class="line">540</span><br><span class="line">541</span><br><span class="line">542</span><br><span class="line">543</span><br><span class="line">544</span><br><span class="line">545</span><br><span class="line">546</span><br><span class="line">547</span><br><span class="line">548</span><br><span class="line">549</span><br><span class="line">550</span><br><span class="line">551</span><br><span class="line">552</span><br><span class="line">553</span><br><span class="line">554</span><br><span class="line">555</span><br><span class="line">556</span><br><span class="line">557</span><br><span class="line">558</span><br><span class="line">559</span><br><span class="line">560</span><br><span class="line">561</span><br><span class="line">562</span><br><span class="line">563</span><br><span class="line">564</span><br><span class="line">565</span><br><span class="line">566</span><br><span class="line">567</span><br><span class="line">568</span><br><span class="line">569</span><br><span class="line">570</span><br><span class="line">571</span><br><span class="line">572</span><br><span class="line">573</span><br><span class="line">574</span><br><span class="line">575</span><br><span class="line">576</span><br><span class="line">577</span><br><span class="line">578</span><br><span class="line">579</span><br><span class="line">580</span><br><span class="line">581</span><br><span class="line">582</span><br><span class="line">583</span><br><span class="line">584</span><br><span class="line">585</span><br><span class="line">586</span><br><span class="line">587</span><br><span class="line">588</span><br><span class="line">589</span><br><span class="line">590</span><br><span class="line">591</span><br><span class="line">592</span><br><span class="line">593</span><br><span class="line">594</span><br><span class="line">595</span><br><span class="line">596</span><br><span class="line">597</span><br><span class="line">598</span><br><span class="line">599</span><br><span class="line">600</span><br><span class="line">601</span><br><span class="line">602</span><br><span class="line">603</span><br><span class="line">604</span><br><span class="line">605</span><br><span class="line">606</span><br><span class="line">607</span><br><span class="line">608</span><br><span class="line">609</span><br><span class="line">610</span><br><span class="line">611</span><br><span class="line">612</span><br><span class="line">613</span><br><span class="line">614</span><br><span class="line">615</span><br><span class="line">616</span><br><span class="line">617</span><br><span class="line">618</span><br><span class="line">619</span><br><span class="line">620</span><br><span class="line">621</span><br><span class="line">622</span><br><span class="line">623</span><br><span class="line">624</span><br><span class="line">625</span><br><span class="line">626</span><br><span class="line">627</span><br><span class="line">628</span><br><span class="line">629</span><br><span class="line">630</span><br><span class="line">631</span><br><span class="line">632</span><br><span class="line">633</span><br><span class="line">634</span><br><span class="line">635</span><br><span class="line">636</span><br><span class="line">637</span><br><span class="line">638</span><br><span class="line">639</span><br><span class="line">640</span><br><span class="line">641</span><br><span class="line">642</span><br><span class="line">643</span><br><span class="line">644</span><br><span class="line">645</span><br><span class="line">646</span><br><span class="line">647</span><br><span class="line">648</span><br><span class="line">649</span><br><span class="line">650</span><br><span class="line">651</span><br><span class="line">652</span><br><span class="line">653</span><br><span class="line">654</span><br><span class="line">655</span><br><span class="line">656</span><br><span class="line">657</span><br><span class="line">658</span><br><span class="line">659</span><br><span class="line">660</span><br><span class="line">661</span><br><span class="line">662</span><br><span class="line">663</span><br><span class="line">664</span><br><span class="line">665</span><br><span class="line">666</span><br><span class="line">667</span><br><span class="line">668</span><br><span class="line">669</span><br><span class="line">670</span><br><span class="line">671</span><br><span class="line">672</span><br><span class="line">673</span><br><span class="line">674</span><br><span class="line">675</span><br><span class="line">676</span><br><span class="line">677</span><br><span class="line">678</span><br><span class="line">679</span><br><span class="line">680</span><br><span class="line">681</span><br><span class="line">682</span><br><span class="line">683</span><br><span class="line">684</span><br><span class="line">685</span><br><span class="line">686</span><br><span class="line">687</span><br><span class="line">688</span><br><span class="line">689</span><br><span class="line">690</span><br><span class="line">691</span><br><span class="line">692</span><br><span class="line">693</span><br><span class="line">694</span><br><span class="line">695</span><br><span class="line">696</span><br><span class="line">697</span><br><span class="line">698</span><br><span class="line">699</span><br><span class="line">700</span><br><span class="line">701</span><br><span class="line">702</span><br><span class="line">703</span><br><span class="line">704</span><br><span class="line">705</span><br><span class="line">706</span><br><span class="line">707</span><br><span class="line">708</span><br><span class="line">709</span><br><span class="line">710</span><br><span class="line">711</span><br><span class="line">712</span><br><span class="line">713</span><br><span class="line">714</span><br><span class="line">715</span><br><span class="line">716</span><br><span class="line">717</span><br><span class="line">718</span><br><span class="line">719</span><br><span class="line">720</span><br><span class="line">721</span><br><span class="line">722</span><br><span class="line">723</span><br><span class="line">724</span><br><span class="line">725</span><br><span class="line">726</span><br><span class="line">727</span><br><span class="line">728</span><br><span class="line">729</span><br><span class="line">730</span><br><span class="line">731</span><br><span class="line">732</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"sign"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"logo"</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"/"</span>&gt;</span><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">"/static/image/nav-logo.png"</span> <span class="attr">alt</span>=<span class="string">"Logo"</span>&gt;</span><span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"main"</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">h4</span> <span class="attr">class</span>=<span class="string">"title"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"normal-title"</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">router-link</span> <span class="attr">to</span>=<span class="string">"/user/login"</span>&gt;</span>登录<span class="tag">&lt;/<span class="name">router-link</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">b</span>&gt;</span>·<span class="tag">&lt;/<span class="name">b</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">router-link</span> <span class="attr">id</span>=<span class="string">"js-sign-up-btn"</span> <span class="attr">class</span>=<span class="string">"active"</span> <span class="attr">to</span>=<span class="string">"/user/register"</span>&gt;</span>注册<span class="tag">&lt;/<span class="name">router-link</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">h4</span>&gt;</span></span><br><span class="line"></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"js-sign-up-container"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">form</span> <span class="attr">class</span>=<span class="string">"new_user"</span> <span class="attr">id</span>=<span class="string">"new_user"</span> <span class="attr">action</span>=<span class="string">""</span> <span class="attr">accept-charset</span>=<span class="string">"UTF-8"</span> <span class="attr">method</span>=<span class="string">"post"</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"input-prepend restyle"</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">input</span> <span class="attr">placeholder</span>=<span class="string">"你的昵称"</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">value</span>=<span class="string">""</span> <span class="attr">v-model</span>=<span class="string">"nickname"</span> <span class="attr">id</span>=<span class="string">"user_nickname"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">i</span> <span class="attr">class</span>=<span class="string">"iconfont ic-user"</span>&gt;</span><span class="tag">&lt;/<span class="name">i</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"input-prepend restyle no-radius js-normal"</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">input</span> <span class="attr">placeholder</span>=<span class="string">"手机号"</span> <span class="attr">type</span>=<span class="string">"tel"</span> <span class="attr">v-model</span>=<span class="string">"mobile"</span> <span class="attr">id</span>=<span class="string">"user_mobile_number"</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">i</span> <span class="attr">class</span>=<span class="string">"iconfont ic-phonenumber"</span>&gt;</span><span class="tag">&lt;/<span class="name">i</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"input-prepend restyle no-radius security-up-code js-security-number"</span> <span class="attr">v-if</span>=<span class="string">"is_show_sms_code"</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">v-model</span>=<span class="string">"sms_code"</span> <span class="attr">id</span>=<span class="string">"sms_code"</span> <span class="attr">placeholder</span>=<span class="string">"手机验证码"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">i</span> <span class="attr">class</span>=<span class="string">"iconfont ic-verify"</span>&gt;</span><span class="tag">&lt;/<span class="name">i</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">a</span> <span class="attr">tabindex</span>=<span class="string">"-1"</span> <span class="attr">class</span>=<span class="string">"btn-up-resend js-send-code-button disable"</span> <span class="attr">href</span>=<span class="string">"javascript:void(0);"</span> <span class="attr">id</span>=<span class="string">"send_code"</span>&gt;</span>&#123;&#123;sms_code_text&#125;&#125;<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"hidden"</span> <span class="attr">name</span>=<span class="string">"security_number"</span> <span class="attr">id</span>=<span class="string">"security_number"</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"input-prepend"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">input</span> <span class="attr">placeholder</span>=<span class="string">"设置密码"</span> <span class="attr">type</span>=<span class="string">"password"</span> <span class="attr">v-model</span>=<span class="string">"password"</span> <span class="attr">id</span>=<span class="string">"user_password"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">i</span> <span class="attr">class</span>=<span class="string">"iconfont ic-password"</span>&gt;</span><span class="tag">&lt;/<span class="name">i</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"submit"</span> <span class="attr">name</span>=<span class="string">"commit"</span> <span class="attr">value</span>=<span class="string">"注册"</span> <span class="attr">class</span>=<span class="string">"sign-up-button"</span> <span class="attr">id</span>=<span class="string">"sign_up_btn"</span> @<span class="attr">click.prevent</span>=<span class="string">"registerHandler"</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">p</span> <span class="attr">class</span>=<span class="string">"sign-up-msg"</span>&gt;</span>点击 “注册” 即表示您同意并愿意遵守荏苒<span class="tag">&lt;<span class="name">br</span>&gt;</span> <span class="tag">&lt;<span class="name">a</span> <span class="attr">target</span>=<span class="string">"_blank"</span> <span class="attr">href</span>=<span class="string">""</span>&gt;</span>用户协议<span class="tag">&lt;/<span class="name">a</span>&gt;</span> 和 <span class="tag">&lt;<span class="name">a</span> <span class="attr">target</span>=<span class="string">"_blank"</span> <span class="attr">href</span>=<span class="string">""</span>&gt;</span>隐私政策<span class="tag">&lt;/<span class="name">a</span>&gt;</span> 。<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- 更多注册方式 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"more-sign"</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">h6</span>&gt;</span>社交帐号直接注册<span class="tag">&lt;/<span class="name">h6</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">ul</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">id</span>=<span class="string">"weixin"</span> <span class="attr">class</span>=<span class="string">"weixin"</span> <span class="attr">target</span>=<span class="string">"_blank"</span> <span class="attr">href</span>=<span class="string">""</span>&gt;</span><span class="tag">&lt;<span class="name">i</span> <span class="attr">class</span>=<span class="string">"iconfont ic-wechat"</span>&gt;</span><span class="tag">&lt;/<span class="name">i</span>&gt;</span><span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">id</span>=<span class="string">"qq"</span> <span class="attr">class</span>=<span class="string">"qq"</span> <span class="attr">target</span>=<span class="string">"_blank"</span> <span class="attr">href</span>=<span class="string">""</span>&gt;</span><span class="tag">&lt;<span class="name">i</span> <span class="attr">class</span>=<span class="string">"iconfont ic-qq_connect"</span>&gt;</span><span class="tag">&lt;/<span class="name">i</span>&gt;</span><span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript">    <span class="keyword">export</span> <span class="keyword">default</span> &#123;</span></span><br><span class="line"><span class="actionscript">        name: <span class="string">"Register"</span>,</span></span><br><span class="line">        data()&#123;</span><br><span class="line"><span class="actionscript">          <span class="keyword">return</span> &#123;</span></span><br><span class="line"><span class="actionscript">            nickname:<span class="string">""</span>,</span></span><br><span class="line"><span class="actionscript">            mobile:<span class="string">""</span>,</span></span><br><span class="line"><span class="actionscript">            sms_code:<span class="string">""</span>,</span></span><br><span class="line"><span class="actionscript">            password:<span class="string">""</span>,</span></span><br><span class="line"><span class="actionscript">            sms_code_text:<span class="string">"发送验证码"</span>,</span></span><br><span class="line"><span class="actionscript">            is_show_sms_code:<span class="literal">false</span>,</span></span><br><span class="line">          &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        watch: &#123;</span><br><span class="line">          mobile() &#123;</span><br><span class="line"><span class="javascript">            <span class="keyword">if</span> (<span class="regexp">/^1[3-9]\d&#123;9&#125;$/</span>.test(<span class="keyword">this</span>.mobile)) &#123;</span></span><br><span class="line"><span class="actionscript">              <span class="keyword">this</span>.is_show_sms_code = <span class="literal">true</span>;</span></span><br><span class="line"><span class="actionscript">            &#125; <span class="keyword">else</span> &#123;</span></span><br><span class="line"><span class="actionscript">              <span class="keyword">this</span>.is_show_sms_code = <span class="literal">false</span>;</span></span><br><span class="line">            &#125;</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        methods:&#123;</span><br><span class="line">          registerHandler()&#123;</span><br><span class="line"><span class="actionscript">            <span class="comment">// todo 数据验证</span></span></span><br><span class="line"></span><br><span class="line"><span class="actionscript">            <span class="comment">// 注册处理</span></span></span><br><span class="line"><span class="javascript">            <span class="keyword">this</span>.$axios.post(<span class="string">`<span class="subst">$&#123;<span class="keyword">this</span>.$settings.Host&#125;</span>/users/`</span>,&#123;</span></span><br><span class="line"><span class="actionscript">                mobile: <span class="keyword">this</span>.mobile,</span></span><br><span class="line"><span class="actionscript">                nickname: <span class="keyword">this</span>.nickname,</span></span><br><span class="line"><span class="actionscript">                password: <span class="keyword">this</span>.password,</span></span><br><span class="line"><span class="actionscript">                sms_code: <span class="keyword">this</span>.sms_code,</span></span><br><span class="line"><span class="javascript">            &#125;).then(<span class="function"><span class="params">response</span>=&gt;</span> &#123;</span></span><br><span class="line">              sessionStorage.user_token = response.data.token;</span><br><span class="line">              sessionStorage.user_id = response.data.id;</span><br><span class="line">              sessionStorage.user_name = response.data.username;</span><br><span class="line">              sessionStorage.user_avatar = response.data.avatar;</span><br><span class="line">              sessionStorage.user_nickname = response.data.nickname;</span><br><span class="line"></span><br><span class="line"><span class="actionscript">              <span class="keyword">this</span>.$confirm(<span class="string">'注册成功, 欢迎加入荏苒！'</span>, <span class="string">'提示'</span>, &#123;</span></span><br><span class="line"><span class="actionscript">                confirmButtonText: <span class="string">'跳转到首页'</span>,</span></span><br><span class="line"><span class="actionscript">                cancelButtonText: <span class="string">'跳转上一页'</span>,</span></span><br><span class="line"><span class="actionscript">                type: <span class="string">'success'</span></span></span><br><span class="line"><span class="javascript">              &#125;).then(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span></span><br><span class="line"><span class="actionscript">                <span class="keyword">this</span>.$router.push(<span class="string">"/"</span>);</span></span><br><span class="line"><span class="javascript">              &#125;).catch(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span></span><br><span class="line"><span class="actionscript">                <span class="keyword">this</span>.$router.go(<span class="number">-1</span>);</span></span><br><span class="line">              &#125;);</span><br><span class="line"></span><br><span class="line"><span class="javascript">            &#125;).catch(<span class="function"><span class="params">error</span>=&gt;</span>&#123;</span></span><br><span class="line"><span class="actionscript">                <span class="keyword">this</span>.$message.error(<span class="string">"用户注册失败！"</span>);</span></span><br><span class="line">            &#125;)</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span> <span class="attr">scoped</span>&gt;</span></span><br><span class="line">input&#123;</span><br><span class="line">  outline: none;</span><br><span class="line">&#125;</span><br><span class="line"><span class="css">*, <span class="selector-pseudo">:after</span>, <span class="selector-pseudo">:before</span> &#123;</span></span><br><span class="line">    box-sizing: border-box;</span><br><span class="line">&#125;</span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> &#123;</span></span><br><span class="line">    height: 100%;</span><br><span class="line">    min-height: 750px;</span><br><span class="line">    text-align: center;</span><br><span class="line">    font-size: 14px;</span><br><span class="line"><span class="css">    <span class="selector-tag">background-color</span>: <span class="selector-id">#f1f1f1</span></span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span><span class="selector-pseudo">:before</span> &#123;</span></span><br><span class="line">    content: "";</span><br><span class="line">    display: inline-block;</span><br><span class="line">    height: 85%;</span><br><span class="line">    vertical-align: middle</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.disable</span>,<span class="selector-class">.sign</span> <span class="selector-class">.disable-gray</span> &#123;</span></span><br><span class="line"><span class="css">    <span class="selector-tag">opacity</span>: <span class="selector-class">.5</span>;</span></span><br><span class="line">    pointer-events: none</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.disable-gray</span> &#123;</span></span><br><span class="line"><span class="css">    <span class="selector-tag">background-color</span>: <span class="selector-id">#969696</span></span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.tooltip-error</span> &#123;</span></span><br><span class="line">    font-size: 14px;</span><br><span class="line">    line-height: 25px;</span><br><span class="line">    white-space: nowrap;</span><br><span class="line">    background: none</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.tooltip-error</span> <span class="selector-class">.tooltip-inner</span> &#123;</span></span><br><span class="line">    max-width: 280px;</span><br><span class="line"><span class="css">    <span class="selector-tag">color</span>: <span class="selector-id">#333</span>;</span></span><br><span class="line"><span class="css">    <span class="selector-tag">border</span>: 1<span class="selector-tag">px</span> <span class="selector-tag">solid</span> <span class="selector-id">#ea6f5a</span>;</span></span><br><span class="line"><span class="css">    <span class="selector-tag">background-color</span>: <span class="selector-id">#fff</span></span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.tooltip-error</span> <span class="selector-class">.tooltip-inner</span> <span class="selector-tag">i</span> &#123;</span></span><br><span class="line">    position: static;</span><br><span class="line">    margin-right: 5px;</span><br><span class="line">    font-size: 20px;</span><br><span class="line"><span class="css">    <span class="selector-tag">color</span>: <span class="selector-id">#ea6f5a</span>;</span></span><br><span class="line">    vertical-align: middle</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.tooltip-error</span> <span class="selector-class">.tooltip-inner</span> <span class="selector-tag">span</span> &#123;</span></span><br><span class="line">    vertical-align: middle;</span><br><span class="line">    display: inline-block;</span><br><span class="line">    white-space: normal;</span><br><span class="line">    max-width: 230px</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.tooltip-error</span><span class="selector-class">.right</span> <span class="selector-class">.tooltip-arrow-border</span> &#123;</span></span><br><span class="line"><span class="css">    <span class="selector-tag">border-right-color</span>: <span class="selector-id">#ea6f5a</span></span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.tooltip-error</span><span class="selector-class">.right</span> <span class="selector-class">.tooltip-arrow-bg</span> &#123;</span></span><br><span class="line">    left: 2px;</span><br><span class="line"><span class="css">    <span class="selector-tag">border-right-color</span>: <span class="selector-id">#fff</span></span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.slide-error</span> &#123;</span></span><br><span class="line">    position: relative;</span><br><span class="line">    padding: 10px 0;</span><br><span class="line"><span class="css">    <span class="selector-tag">border</span>: 1<span class="selector-tag">px</span> <span class="selector-tag">solid</span> <span class="selector-id">#c8c8c8</span>;</span></span><br><span class="line">    border-radius: 4px</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.slide-error</span> <span class="selector-tag">i</span> &#123;</span></span><br><span class="line">    position: static!important;</span><br><span class="line">    margin-right: 10px;</span><br><span class="line"><span class="css">    <span class="selector-tag">color</span>: <span class="selector-id">#ea6f5a</span>!<span class="selector-tag">important</span>;</span></span><br><span class="line">    vertical-align: middle</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.slide-error</span> <span class="selector-tag">span</span> &#123;</span></span><br><span class="line">    font-size: 15px;</span><br><span class="line">    vertical-align: middle</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.slide-error</span> <span class="selector-tag">div</span> &#123;</span></span><br><span class="line">    margin-top: 10px;</span><br><span class="line">    font-size: 13px</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.slide-error</span> <span class="selector-tag">a</span> &#123;</span></span><br><span class="line"><span class="css">    <span class="selector-tag">color</span>: <span class="selector-id">#3194d0</span></span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.js-sign-up-forbidden</span> &#123;</span></span><br><span class="line"><span class="css">    <span class="selector-tag">color</span>: <span class="selector-id">#999</span>;</span></span><br><span class="line">    padding: 80px 0 100px</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.js-sign-up-container</span> <span class="selector-class">.slide-error</span> &#123;</span></span><br><span class="line">    border-bottom: none;</span><br><span class="line">    border-radius: 0</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.logo</span> &#123;</span></span><br><span class="line">    position: absolute;</span><br><span class="line">    top: 56px;</span><br><span class="line">    margin-left: 50px</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.logo</span> <span class="selector-tag">img</span> &#123;</span></span><br><span class="line">    width: 100px</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.main</span> &#123;</span></span><br><span class="line">    width: 400px;</span><br><span class="line">    margin: 60px auto 0;</span><br><span class="line">    padding: 50px 50px 30px;</span><br><span class="line"><span class="css">    <span class="selector-tag">background-color</span>: <span class="selector-id">#fff</span>;</span></span><br><span class="line">    border-radius: 4px;</span><br><span class="line"><span class="css">    <span class="selector-tag">box-shadow</span>: 0 0 8<span class="selector-tag">px</span> <span class="selector-tag">rgba</span>(0,0,0,<span class="selector-class">.1</span>);</span></span><br><span class="line">    vertical-align: middle;</span><br><span class="line">    display: inline-block</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.reset-title</span>,<span class="selector-class">.sign</span> <span class="selector-class">.title</span> &#123;</span></span><br><span class="line">    margin: 0 auto 50px;</span><br><span class="line">    padding: 10px;</span><br><span class="line">    font-weight: 400;</span><br><span class="line"><span class="css">    <span class="selector-tag">color</span>: <span class="selector-id">#969696</span></span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.reset-title</span> <span class="selector-tag">a</span>,<span class="selector-class">.sign</span> <span class="selector-class">.title</span> <span class="selector-tag">a</span> &#123;</span></span><br><span class="line">    padding: 10px;</span><br><span class="line"><span class="css">    <span class="selector-tag">color</span>: <span class="selector-id">#969696</span></span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.reset-title</span> <span class="selector-tag">a</span><span class="selector-pseudo">:hover</span>,<span class="selector-class">.sign</span> <span class="selector-class">.title</span> <span class="selector-tag">a</span><span class="selector-pseudo">:hover</span> &#123;</span></span><br><span class="line"><span class="css">    <span class="selector-tag">border-bottom</span>: 2<span class="selector-tag">px</span> <span class="selector-tag">solid</span> <span class="selector-id">#ea6f5a</span></span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.reset-title</span> <span class="selector-class">.active</span>,<span class="selector-class">.sign</span> <span class="selector-class">.title</span> <span class="selector-class">.active</span> &#123;</span></span><br><span class="line">    font-weight: 700;</span><br><span class="line"><span class="css">    <span class="selector-tag">color</span>: <span class="selector-id">#ea6f5a</span>;</span></span><br><span class="line"><span class="css">    <span class="selector-tag">border-bottom</span>: 2<span class="selector-tag">px</span> <span class="selector-tag">solid</span> <span class="selector-id">#ea6f5a</span></span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.reset-title</span> <span class="selector-tag">b</span>,<span class="selector-class">.sign</span> <span class="selector-class">.title</span> <span class="selector-tag">b</span> &#123;</span></span><br><span class="line">    padding: 10px</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.reset-title</span> &#123;</span></span><br><span class="line"><span class="css">    <span class="selector-tag">color</span>: <span class="selector-id">#333</span>;</span></span><br><span class="line">    font-weight: 700</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-tag">form</span> &#123;</span></span><br><span class="line">    margin-bottom: 30px</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-tag">form</span> <span class="selector-class">.input-prepend</span> &#123;</span></span><br><span class="line">    position: relative;</span><br><span class="line">    width: 100%</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-tag">form</span> <span class="selector-class">.input-prepend</span> <span class="selector-tag">input</span> &#123;</span></span><br><span class="line">    width: 100%;</span><br><span class="line">    height: 50px;</span><br><span class="line">    margin-bottom: 0;</span><br><span class="line">    padding: 4px 12px 4px 35px;</span><br><span class="line"><span class="css">    <span class="selector-tag">border</span>: 1<span class="selector-tag">px</span> <span class="selector-tag">solid</span> <span class="selector-id">#c8c8c8</span>;</span></span><br><span class="line">    border-radius: 0 0 4px 4px;</span><br><span class="line"><span class="css">    <span class="selector-tag">background-color</span>: <span class="selector-tag">hsla</span>(0,0%,71%,<span class="selector-class">.1</span>);</span></span><br><span class="line">    vertical-align: middle</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-tag">form</span> <span class="selector-class">.input-prepend</span> <span class="selector-tag">i</span> &#123;</span></span><br><span class="line">    position: absolute;</span><br><span class="line">    top: 14px;</span><br><span class="line">    left: 10px;</span><br><span class="line">    font-size: 18px;</span><br><span class="line"><span class="css">    <span class="selector-tag">color</span>: <span class="selector-id">#969696</span></span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-tag">form</span> <span class="selector-class">.input-prepend</span> <span class="selector-tag">span</span> &#123;</span></span><br><span class="line"><span class="css">    <span class="selector-tag">color</span>: <span class="selector-id">#333</span></span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-tag">form</span> <span class="selector-class">.input-prepend</span> <span class="selector-class">.ic-show</span> &#123;</span></span><br><span class="line">    top: 18px;</span><br><span class="line">    left: auto;</span><br><span class="line">    right: 8px;</span><br><span class="line">    font-size: 12px</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-tag">form</span> <span class="selector-class">.geetest-placeholder</span> &#123;</span></span><br><span class="line">    height: 44px;</span><br><span class="line">    border-radius: 4px;</span><br><span class="line"><span class="css">    <span class="selector-tag">background-color</span>: <span class="selector-tag">hsla</span>(0,0%,71%,<span class="selector-class">.1</span>);</span></span><br><span class="line">    text-align: center;</span><br><span class="line">    line-height: 44px;</span><br><span class="line">    font-size: 14px;</span><br><span class="line"><span class="css">    <span class="selector-tag">color</span>: <span class="selector-id">#999</span></span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-tag">form</span> <span class="selector-class">.restyle</span> &#123;</span></span><br><span class="line">    margin-bottom: 0</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-tag">form</span> <span class="selector-class">.restyle</span> <span class="selector-tag">input</span> &#123;</span></span><br><span class="line">    border-bottom: none;</span><br><span class="line">    border-radius: 4px 4px 0 0</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-tag">form</span> <span class="selector-class">.no-radius</span> <span class="selector-tag">input</span> &#123;</span></span><br><span class="line">    border-radius: 0</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-tag">form</span> <span class="selector-class">.slide-security-placeholder</span> &#123;</span></span><br><span class="line">    height: 32px;</span><br><span class="line"><span class="css">    <span class="selector-tag">background-color</span>: <span class="selector-tag">hsla</span>(0,0%,71%,<span class="selector-class">.1</span>);</span></span><br><span class="line">    border-radius: 4px</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-tag">form</span> <span class="selector-class">.slide-security-placeholder</span> <span class="selector-tag">p</span> &#123;</span></span><br><span class="line">    padding-top: 7px;</span><br><span class="line"><span class="css">    <span class="selector-tag">color</span>: <span class="selector-id">#999</span>;</span></span><br><span class="line">    margin-right: -7px</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.overseas-btn</span> &#123;</span></span><br><span class="line">    font-size: 14px;</span><br><span class="line"><span class="css">    <span class="selector-tag">color</span>: <span class="selector-id">#999</span></span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.overseas-btn</span><span class="selector-pseudo">:hover</span> &#123;</span></span><br><span class="line"><span class="css">    <span class="selector-tag">color</span>: <span class="selector-id">#2f2f2f</span></span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.remember-btn</span> &#123;</span></span><br><span class="line">    float: left;</span><br><span class="line">    margin: 15px 0</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.remember-btn</span> <span class="selector-tag">span</span> &#123;</span></span><br><span class="line">    margin-left: 5px;</span><br><span class="line">    font-size: 15px;</span><br><span class="line"><span class="css">    <span class="selector-tag">color</span>: <span class="selector-id">#969696</span>;</span></span><br><span class="line">    vertical-align: middle</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.forget-btn</span> &#123;</span></span><br><span class="line">    float: right;</span><br><span class="line">    position: relative;</span><br><span class="line">    margin: 15px 0;</span><br><span class="line">    font-size: 14px</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.forget-btn</span> <span class="selector-tag">a</span> &#123;</span></span><br><span class="line"><span class="css">    <span class="selector-tag">color</span>: <span class="selector-id">#999</span></span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.forget-btn</span> <span class="selector-tag">a</span><span class="selector-pseudo">:hover</span> &#123;</span></span><br><span class="line"><span class="css">    <span class="selector-tag">color</span>: <span class="selector-id">#333</span></span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.forget-btn</span> <span class="selector-class">.dropdown-menu</span> &#123;</span></span><br><span class="line">    top: 20px;</span><br><span class="line">    left: auto;</span><br><span class="line">    right: 0;</span><br><span class="line">    border-radius: 4px</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.forget-btn</span> <span class="selector-class">.dropdown-menu</span> <span class="selector-tag">a</span> &#123;</span></span><br><span class="line">    padding: 10px 20px;</span><br><span class="line"><span class="css">    <span class="selector-tag">color</span>: <span class="selector-id">#333</span></span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-id">#sign-in-loading</span> &#123;</span></span><br><span class="line">    position: relative;</span><br><span class="line">    width: 20px;</span><br><span class="line">    height: 20px;</span><br><span class="line">    vertical-align: middle;</span><br><span class="line">    margin-top: -4px;</span><br><span class="line">    margin-right: 2px;</span><br><span class="line">    display: none</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-id">#sign-in-loading</span><span class="selector-pseudo">:after</span> &#123;</span></span><br><span class="line">    content: "";</span><br><span class="line">    position: absolute;</span><br><span class="line">    left: 0;</span><br><span class="line">    top: 0;</span><br><span class="line">    width: 100%;</span><br><span class="line">    height: 100%;</span><br><span class="line">    background-color: transparent</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-id">#sign-in-loading</span><span class="selector-pseudo">:before</span> &#123;</span></span><br><span class="line">    content: "";</span><br><span class="line">    position: absolute;</span><br><span class="line">    top: 50%;</span><br><span class="line">    left: 50%;</span><br><span class="line">    width: 20px;</span><br><span class="line">    height: 20px;</span><br><span class="line">    margin: -10px 0 0 -10px;</span><br><span class="line">    border-radius: 10px;</span><br><span class="line"><span class="css">    <span class="selector-tag">border</span>: 2<span class="selector-tag">px</span> <span class="selector-tag">solid</span> <span class="selector-id">#fff</span>;</span></span><br><span class="line">    border-bottom-color: transparent;</span><br><span class="line">    vertical-align: middle;</span><br><span class="line"><span class="css">    <span class="selector-tag">-webkit-animation</span>: <span class="selector-tag">rolling</span> <span class="selector-class">.8s</span> <span class="selector-tag">infinite</span> <span class="selector-tag">linear</span>;</span></span><br><span class="line"><span class="css">    <span class="selector-tag">animation</span>: <span class="selector-tag">rolling</span> <span class="selector-class">.8s</span> <span class="selector-tag">infinite</span> <span class="selector-tag">linear</span>;</span></span><br><span class="line">    z-index: 1</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.sign-in-button</span>,<span class="selector-class">.sign</span> <span class="selector-class">.sign-up-button</span> &#123;</span></span><br><span class="line">    margin-top: 20px;</span><br><span class="line">    width: 100%;</span><br><span class="line">    padding: 9px 18px;</span><br><span class="line">    font-size: 18px;</span><br><span class="line">    border: none;</span><br><span class="line">    border-radius: 25px;</span><br><span class="line"><span class="css">    <span class="selector-tag">color</span>: <span class="selector-id">#fff</span>;</span></span><br><span class="line"><span class="css">    <span class="selector-tag">background</span>: <span class="selector-id">#42c02e</span>;</span></span><br><span class="line">    cursor: pointer;</span><br><span class="line">    outline: none;</span><br><span class="line">    display: block;</span><br><span class="line">    clear: both</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.sign-in-button</span><span class="selector-pseudo">:hover</span>,<span class="selector-class">.sign</span> <span class="selector-class">.sign-up-button</span><span class="selector-pseudo">:hover</span> &#123;</span></span><br><span class="line"><span class="css">    <span class="selector-tag">background</span>: <span class="selector-id">#3db922</span></span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.sign-in-button</span> &#123;</span></span><br><span class="line"><span class="css">    <span class="selector-tag">background</span>: <span class="selector-id">#3194d0</span></span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.sign-in-button</span><span class="selector-pseudo">:hover</span> &#123;</span></span><br><span class="line"><span class="css">    <span class="selector-tag">background</span>: <span class="selector-id">#187cb7</span></span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.btn-in-resend</span>,<span class="selector-class">.sign</span> <span class="selector-class">.btn-up-resend</span> &#123;</span></span><br><span class="line">    position: absolute;</span><br><span class="line">    top: 7px;</span><br><span class="line">    right: 7px;</span><br><span class="line">    width: 100px;</span><br><span class="line">    height: 36px;</span><br><span class="line">    font-size: 13px;</span><br><span class="line"><span class="css">    <span class="selector-tag">color</span>: <span class="selector-id">#fff</span>;</span></span><br><span class="line"><span class="css">    <span class="selector-tag">background-color</span>: <span class="selector-id">#42c02e</span>;</span></span><br><span class="line">    border-radius: 20px;</span><br><span class="line">    line-height: 36px</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.btn-in-resend</span> &#123;</span></span><br><span class="line"><span class="css">    <span class="selector-tag">background-color</span>: <span class="selector-id">#3194d0</span></span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.sign-up-msg</span> &#123;</span></span><br><span class="line">    margin: 10px 0;</span><br><span class="line">    padding: 0;</span><br><span class="line">    text-align: center;</span><br><span class="line">    font-size: 12px;</span><br><span class="line">    line-height: 20px;</span><br><span class="line"><span class="css">    <span class="selector-tag">color</span>: <span class="selector-id">#969696</span></span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.sign-up-msg</span> <span class="selector-tag">a</span>,<span class="selector-class">.sign</span> <span class="selector-class">.sign-up-msg</span> <span class="selector-tag">a</span><span class="selector-pseudo">:hover</span> &#123;</span></span><br><span class="line"><span class="css">    <span class="selector-tag">color</span>: <span class="selector-id">#3194d0</span></span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.overseas</span> <span class="selector-tag">input</span> &#123;</span></span><br><span class="line">    padding-left: 110px!important</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.overseas</span> <span class="selector-class">.overseas-number</span> &#123;</span></span><br><span class="line">    position: absolute;</span><br><span class="line">    top: 0;</span><br><span class="line">    left: 0;</span><br><span class="line">    width: 100px;</span><br><span class="line">    height: 50px;</span><br><span class="line">    font-size: 18px;</span><br><span class="line"><span class="css">    <span class="selector-tag">color</span>: <span class="selector-id">#969696</span>;</span></span><br><span class="line"><span class="css">    <span class="selector-tag">border-right</span>: 1<span class="selector-tag">px</span> <span class="selector-tag">solid</span> <span class="selector-id">#c8c8c8</span></span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.overseas</span> <span class="selector-class">.overseas-number</span> <span class="selector-tag">span</span> &#123;</span></span><br><span class="line">    margin-top: 17px;</span><br><span class="line">    padding-left: 35px;</span><br><span class="line">    text-align: left;</span><br><span class="line">    font-size: 14px;</span><br><span class="line">    display: block</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.overseas</span> <span class="selector-class">.dropdown-menu</span> &#123;</span></span><br><span class="line">    width: 100%;</span><br><span class="line">    max-height: 285px;</span><br><span class="line">    font-size: 14px;</span><br><span class="line">    border-radius: 0 0 4px 4px;</span><br><span class="line">    overflow-y: auto</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.overseas</span> <span class="selector-class">.dropdown-menu</span> <span class="selector-tag">li</span> <span class="selector-class">.nation-code</span> &#123;</span></span><br><span class="line">    width: 65px;</span><br><span class="line">    display: inline-block</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.overseas</span> <span class="selector-class">.dropdown-menu</span> <span class="selector-tag">li</span> <span class="selector-tag">a</span> &#123;</span></span><br><span class="line">    padding: 6px 20px;</span><br><span class="line">    font-size: 14px;</span><br><span class="line">    line-height: 20px</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.overseas</span> <span class="selector-class">.dropdown-menu</span> <span class="selector-tag">li</span> <span class="selector-tag">a</span><span class="selector-pseudo">::hover</span> &#123;</span></span><br><span class="line"><span class="css">    <span class="selector-tag">color</span>: <span class="selector-id">#fff</span>;</span></span><br><span class="line"><span class="css">    <span class="selector-tag">background-color</span>: <span class="selector-id">#f5f5f5</span></span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.more-sign</span> &#123;</span></span><br><span class="line">    margin-top: 50px</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.more-sign</span> <span class="selector-tag">h6</span> &#123;</span></span><br><span class="line">    position: relative;</span><br><span class="line">    margin: 0 0 10px;</span><br><span class="line">    font-size: 12px;</span><br><span class="line"><span class="css">    <span class="selector-tag">color</span>: <span class="selector-id">#b5b5b5</span></span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.more-sign</span> <span class="selector-tag">h6</span><span class="selector-pseudo">:before</span> &#123;</span></span><br><span class="line">    left: 30px</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.more-sign</span> <span class="selector-tag">h6</span><span class="selector-pseudo">:after</span>,<span class="selector-class">.sign</span> <span class="selector-class">.more-sign</span> <span class="selector-tag">h6</span><span class="selector-pseudo">:before</span> &#123;</span></span><br><span class="line">    content: "";</span><br><span class="line"><span class="css">    <span class="selector-tag">border-top</span>: 1<span class="selector-tag">px</span> <span class="selector-tag">solid</span> <span class="selector-id">#b5b5b5</span>;</span></span><br><span class="line">    display: block;</span><br><span class="line">    position: absolute;</span><br><span class="line">    width: 60px;</span><br><span class="line">    top: 5px</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.more-sign</span> <span class="selector-tag">h6</span><span class="selector-pseudo">:after</span> &#123;</span></span><br><span class="line">    right: 30px</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.more-sign</span> <span class="selector-tag">ul</span> &#123;</span></span><br><span class="line">    margin-bottom: 10px;</span><br><span class="line">    list-style: none</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.more-sign</span> <span class="selector-tag">ul</span> <span class="selector-tag">li</span> &#123;</span></span><br><span class="line">    margin: 0 5px;</span><br><span class="line">    display: inline-block</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.more-sign</span> <span class="selector-tag">ul</span> <span class="selector-tag">a</span> &#123;</span></span><br><span class="line">    width: 50px;</span><br><span class="line">    height: 50px;</span><br><span class="line">    line-height: 50px;</span><br><span class="line">    display: block</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.more-sign</span> <span class="selector-tag">ul</span> <span class="selector-tag">i</span> &#123;</span></span><br><span class="line">    font-size: 28px</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.more-sign</span> <span class="selector-class">.ic-weibo</span> &#123;</span></span><br><span class="line"><span class="css">    <span class="selector-tag">color</span>: <span class="selector-id">#e05244</span></span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.more-sign</span> <span class="selector-class">.ic-wechat</span> &#123;</span></span><br><span class="line"><span class="css">    <span class="selector-tag">color</span>: <span class="selector-id">#00bb29</span></span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.more-sign</span> <span class="selector-class">.ic-qq_connect</span> &#123;</span></span><br><span class="line"><span class="css">    <span class="selector-tag">color</span>: <span class="selector-id">#498ad5</span></span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.more-sign</span> <span class="selector-class">.ic-douban</span> &#123;</span></span><br><span class="line"><span class="css">    <span class="selector-tag">color</span>: <span class="selector-id">#00820f</span></span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.more-sign</span> <span class="selector-class">.ic-more</span> &#123;</span></span><br><span class="line"><span class="css">    <span class="selector-tag">color</span>: <span class="selector-id">#999</span></span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.more-sign</span> <span class="selector-class">.weibo-loading</span> &#123;</span></span><br><span class="line">    pointer-events: none;</span><br><span class="line">    cursor: pointer;</span><br><span class="line">    position: relative</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.more-sign</span> <span class="selector-class">.weibo-loading</span><span class="selector-pseudo">:after</span> &#123;</span></span><br><span class="line">    content: "";</span><br><span class="line">    position: absolute;</span><br><span class="line">    left: 0;</span><br><span class="line">    top: 0;</span><br><span class="line">    width: 100%;</span><br><span class="line">    height: 100%;</span><br><span class="line"><span class="css">    <span class="selector-tag">background-color</span>: <span class="selector-id">#fff</span></span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-tag">body</span><span class="selector-class">.reader-night-mode</span> <span class="selector-class">.sign</span> <span class="selector-class">.more-sign</span> <span class="selector-class">.weibo-loading</span><span class="selector-pseudo">:after</span> &#123;</span></span><br><span class="line"><span class="css">    <span class="selector-tag">background-color</span>: <span class="selector-id">#3f3f3f</span></span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.more-sign</span> <span class="selector-class">.weibo-loading</span><span class="selector-pseudo">:before</span> &#123;</span></span><br><span class="line">    content: "";</span><br><span class="line">    position: absolute;</span><br><span class="line">    top: 50%;</span><br><span class="line">    left: 50%;</span><br><span class="line">    width: 20px;</span><br><span class="line">    height: 20px;</span><br><span class="line">    margin: -10px 0 0 -10px;</span><br><span class="line">    border-radius: 10px;</span><br><span class="line"><span class="css">    <span class="selector-tag">border</span>: 2<span class="selector-tag">px</span> <span class="selector-tag">solid</span> <span class="selector-id">#e05244</span>;</span></span><br><span class="line">    border-bottom-color: transparent;</span><br><span class="line">    vertical-align: middle;</span><br><span class="line"><span class="css">    <span class="selector-tag">-webkit-animation</span>: <span class="selector-tag">rolling</span> <span class="selector-class">.8s</span> <span class="selector-tag">infinite</span> <span class="selector-tag">linear</span>;</span></span><br><span class="line"><span class="css">    <span class="selector-tag">animation</span>: <span class="selector-tag">rolling</span> <span class="selector-class">.8s</span> <span class="selector-tag">infinite</span> <span class="selector-tag">linear</span>;</span></span><br><span class="line">    z-index: 1</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="keyword">@keyframes</span> rolling &#123;</span></span><br><span class="line">    0% &#123;</span><br><span class="line">        -webkit-transform: rotate(0deg);</span><br><span class="line">        transform: rotate(0deg)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    to &#123;</span><br><span class="line">        -webkit-transform: rotate(1turn);</span><br><span class="line">        transform: rotate(1turn)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="keyword">@-webkit-keyframes</span> rolling &#123;</span></span><br><span class="line">    0% &#123;</span><br><span class="line">        -webkit-transform: rotate(0deg)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    to &#123;</span><br><span class="line">        -webkit-transform: rotate(1turn)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.reset-password-input</span> &#123;</span></span><br><span class="line">    border-radius: 4px!important</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.return</span> &#123;</span></span><br><span class="line">    margin-left: -8px;</span><br><span class="line"><span class="css">    <span class="selector-tag">color</span>: <span class="selector-id">#969696</span></span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.return</span><span class="selector-pseudo">:hover</span> &#123;</span></span><br><span class="line"><span class="css">    <span class="selector-tag">color</span>: <span class="selector-id">#333</span></span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.return</span> <span class="selector-tag">i</span> &#123;</span></span><br><span class="line">    margin-right: 5px</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.icheckbox_square-green</span> &#123;</span></span><br><span class="line">    display: inline-block;</span><br><span class="line">    *display: inline;</span><br><span class="line">    vertical-align: middle;</span><br><span class="line">    margin: 0;</span><br><span class="line">    padding: 0;</span><br><span class="line">    width: 18px;</span><br><span class="line">    height: 18px;</span><br><span class="line">    background: url(/static/image/green.png) no-repeat;</span><br><span class="line">    border: none;</span><br><span class="line">    cursor: pointer;</span><br><span class="line">    background-position: 0 0</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.icheckbox_square-green</span><span class="selector-class">.hover</span> &#123;</span></span><br><span class="line">    background-position: -20px 0</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.icheckbox_square-green</span><span class="selector-class">.checked</span> &#123;</span></span><br><span class="line">    background-position: -40px 0</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.icheckbox_square-green</span><span class="selector-class">.disabled</span> &#123;</span></span><br><span class="line">    background-position: -60px 0;</span><br><span class="line">    cursor: default</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.icheckbox_square-green</span><span class="selector-class">.checked</span><span class="selector-class">.disabled</span> &#123;</span></span><br><span class="line">    background-position: -80px 0</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.geetest_panel_box</span>&gt;* &#123;</span></span><br><span class="line">    box-sizing: content-box</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="keyword">@media</span> (<span class="attribute">max-width:</span><span class="number">768px</span>) &#123;</span></span><br><span class="line">    body &#123;</span><br><span class="line">        min-width: 0</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="css">    <span class="selector-class">.sign</span> &#123;</span></span><br><span class="line">        height: auto;</span><br><span class="line">        min-height: 0;</span><br><span class="line">        background-color: transparent</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="css">    <span class="selector-class">.sign</span> <span class="selector-class">.logo</span> &#123;</span></span><br><span class="line">        display: none</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="css">    <span class="selector-class">.sign</span> <span class="selector-class">.main</span> &#123;</span></span><br><span class="line">        position: absolute;</span><br><span class="line">        left: 50%;</span><br><span class="line">        margin: 0 0 0 -200px;</span><br><span class="line">        box-shadow: none</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="在注册功能中集成短信验证码功能"><a href="#在注册功能中集成短信验证码功能" class="headerlink" title="在注册功能中集成短信验证码功能"></a>在注册功能中集成短信验证码功能</h2><p>接下来，我们把注册过程中一些注册信息（例如：短信验证码）和session缓存到redis数据库中。</p><p>安装django-redis。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install django-redis</span><br></pre></td></tr></table></figure><p>在settings/dev.py配置中添加一下代码：</p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"># 设置redis缓存</span><br><span class="line">CACHES = &#123;</span><br><span class="line">    # 默认缓存</span><br><span class="line">    <span class="string">"default"</span>: &#123;</span><br><span class="line">        <span class="string">"BACKEND"</span>: <span class="string">"django_redis.cache.RedisCache"</span>,</span><br><span class="line">        # 项目上线时,需要调整这里的路径</span><br><span class="line">        <span class="string">"LOCATION"</span>: <span class="string">"redis://127.0.0.1:6379/0"</span>,</span><br><span class="line"></span><br><span class="line">        <span class="string">"OPTIONS"</span>: &#123;</span><br><span class="line">            <span class="string">"CLIENT_CLASS"</span>: <span class="string">"django_redis.client.DefaultClient"</span>,</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    # 提供给xadmin或者admin的session存储</span><br><span class="line">    <span class="string">"session"</span>: &#123;</span><br><span class="line">        <span class="string">"BACKEND"</span>: <span class="string">"django_redis.cache.RedisCache"</span>,</span><br><span class="line">        <span class="string">"LOCATION"</span>: <span class="string">"redis://127.0.0.1:6379/1"</span>,</span><br><span class="line">        <span class="string">"OPTIONS"</span>: &#123;</span><br><span class="line">            <span class="string">"CLIENT_CLASS"</span>: <span class="string">"django_redis.client.DefaultClient"</span>,</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    # 提供存储短信验证码</span><br><span class="line">    <span class="string">"sms_code"</span>:&#123;</span><br><span class="line">        <span class="string">"BACKEND"</span>: <span class="string">"django_redis.cache.RedisCache"</span>,</span><br><span class="line">        <span class="string">"LOCATION"</span>: <span class="string">"redis://127.0.0.1:6379/2"</span>,</span><br><span class="line">        <span class="string">"OPTIONS"</span>: &#123;</span><br><span class="line">            <span class="string">"CLIENT_CLASS"</span>: <span class="string">"django_redis.client.DefaultClient"</span>,</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"># 设置xadmin用户登录时,登录信息session保存到redis</span><br><span class="line">SESSION_ENGINE = <span class="string">"django.contrib.sessions.backends.cache"</span></span><br><span class="line">SESSION_CACHE_ALIAS = <span class="string">"session"</span></span><br></pre></td></tr></table></figure><p><strong>关于django-redis 的使用，说明文档可见<a href="http://django-redis-chs.readthedocs.io/zh_CN/latest/" target="_blank" rel="noopener">http://django-redis-chs.readthedocs.io/zh_CN/latest/</a></strong></p><p><strong>django-redis提供了get_redis_connection的方法，通过调用get_redis_connection方法传递redis的配置名称可获取到redis的连接对象，通过redis连接对象可以执行redis命令</strong></p><p><a href="https://redis-py.readthedocs.io/en/latest/" target="_blank" rel="noopener">https://redis-py.readthedocs.io/en/latest/</a></p><p>使用范例：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> django_redis <span class="keyword">import</span> get_redis_connection// 链接redis数据库redis_conn = get_redis_connection(<span class="string">"default"</span>)</span><br></pre></td></tr></table></figure><h3 id="使用云通讯发送短信"><a href="#使用云通讯发送短信" class="headerlink" title="使用云通讯发送短信"></a>使用云通讯发送短信</h3><p>在登录后的平台上面获取一下信息:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">ACCOUNT SID：8aaf0708697b6beb01699f4442911776</span><br><span class="line">AUTH TOKEN : b4dea244f43a4e0f90e557f0a99c70fa</span><br><span class="line">AppID(默认)：8aaf0708697b6beb01699f4442e3177c</span><br><span class="line">Rest URL(生产)： app.cloopen.com:8883         [项目上线时使用真实短信发送服务器]</span><br><span class="line">Rest URL(开发)： sandboxapp.cloopen.com:8883  [项目开发时使用沙箱短信发送服务器]</span><br></pre></td></tr></table></figure><p>找到sdkdemo进行下载</p><p><img src="/images/1553677987640.png" alt="1553677987640.png"></p><p>在开发过程中,为了节约发送短信的成本,可以把自己的或者同事的手机加入到测试号码中.</p><p><img src="/images/1553678528811.png" alt="1553678528811.png"></p><h3 id="后端生成短信验证码"><a href="#后端生成短信验证码" class="headerlink" title="后端生成短信验证码"></a>后端生成短信验证码</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> renranapi.libs.yuntongxun.sms <span class="keyword">import</span> CCP</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">from</span> django_redis <span class="keyword">import</span> get_redis_connection</span><br><span class="line"><span class="keyword">from</span> renranapi.settings <span class="keyword">import</span> constants</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">SMSCodeAPIView</span><span class="params">(APIView)</span>:</span></span><br><span class="line">    <span class="string">"""</span></span><br><span class="line"><span class="string">    短信验证码</span></span><br><span class="line"><span class="string">    """</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get</span><span class="params">(self, request, mobile)</span>:</span></span><br><span class="line">        <span class="string">"""</span></span><br><span class="line"><span class="string">        短信验证码</span></span><br><span class="line"><span class="string">        """</span></span><br><span class="line">        <span class="comment"># 生成短信验证码</span></span><br><span class="line">        sms_code = <span class="string">"%06d"</span> % random.randint(<span class="number">0</span>, <span class="number">999999</span>)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 保存短信验证码与发送记录</span></span><br><span class="line">        redis_conn = get_redis_connection(<span class="string">'sms_code'</span>)</span><br><span class="line">        <span class="comment"># 使用redis提供的管道操作可以一次性执行多条redis命令</span></span><br><span class="line">        pl = redis_conn.pipeline()</span><br><span class="line">        pl.multi()</span><br><span class="line">        pl.setex(<span class="string">"sms_%s"</span> % mobile, constants.SMS_CODE_EXPIRE, sms_code)   <span class="comment"># 设置短信有效期为300s</span></span><br><span class="line">        pl.setex(<span class="string">"sms_time_%s"</span> % mobile, constants.SMS_CODE_INTERVAL, <span class="string">"_"</span>)    <span class="comment"># 设置发送短信间隔为60s</span></span><br><span class="line">        pl.execute()</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 发送短信验证码</span></span><br><span class="line">        ccp = CCP()</span><br><span class="line">        ccp.send_template_sms(mobile, [sms_code, ], constants.SMS_CODE_EXPIRE//<span class="number">60</span>, settings.SMS.SMS_TEMPLATE_ID)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> Response(&#123;<span class="string">"message"</span>: <span class="string">"OK"</span>&#125;, status.HTTP_200_OK)</span><br></pre></td></tr></table></figure><p>settings/constants.py代码：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 短信有效使用时间</span></span><br><span class="line">SMS_CODE_EXPIRE = <span class="number">300</span></span><br><span class="line"><span class="comment"># 短信发送冷却时间</span></span><br><span class="line">SMS_CODE_INTERVAL = <span class="number">60</span></span><br></pre></td></tr></table></figure><p>客户端发送注册信息和发送短信</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br><span class="line">476</span><br><span class="line">477</span><br><span class="line">478</span><br><span class="line">479</span><br><span class="line">480</span><br><span class="line">481</span><br><span class="line">482</span><br><span class="line">483</span><br><span class="line">484</span><br><span class="line">485</span><br><span class="line">486</span><br><span class="line">487</span><br><span class="line">488</span><br><span class="line">489</span><br><span class="line">490</span><br><span class="line">491</span><br><span class="line">492</span><br><span class="line">493</span><br><span class="line">494</span><br><span class="line">495</span><br><span class="line">496</span><br><span class="line">497</span><br><span class="line">498</span><br><span class="line">499</span><br><span class="line">500</span><br><span class="line">501</span><br><span class="line">502</span><br><span class="line">503</span><br><span class="line">504</span><br><span class="line">505</span><br><span class="line">506</span><br><span class="line">507</span><br><span class="line">508</span><br><span class="line">509</span><br><span class="line">510</span><br><span class="line">511</span><br><span class="line">512</span><br><span class="line">513</span><br><span class="line">514</span><br><span class="line">515</span><br><span class="line">516</span><br><span class="line">517</span><br><span class="line">518</span><br><span class="line">519</span><br><span class="line">520</span><br><span class="line">521</span><br><span class="line">522</span><br><span class="line">523</span><br><span class="line">524</span><br><span class="line">525</span><br><span class="line">526</span><br><span class="line">527</span><br><span class="line">528</span><br><span class="line">529</span><br><span class="line">530</span><br><span class="line">531</span><br><span class="line">532</span><br><span class="line">533</span><br><span class="line">534</span><br><span class="line">535</span><br><span class="line">536</span><br><span class="line">537</span><br><span class="line">538</span><br><span class="line">539</span><br><span class="line">540</span><br><span class="line">541</span><br><span class="line">542</span><br><span class="line">543</span><br><span class="line">544</span><br><span class="line">545</span><br><span class="line">546</span><br><span class="line">547</span><br><span class="line">548</span><br><span class="line">549</span><br><span class="line">550</span><br><span class="line">551</span><br><span class="line">552</span><br><span class="line">553</span><br><span class="line">554</span><br><span class="line">555</span><br><span class="line">556</span><br><span class="line">557</span><br><span class="line">558</span><br><span class="line">559</span><br><span class="line">560</span><br><span class="line">561</span><br><span class="line">562</span><br><span class="line">563</span><br><span class="line">564</span><br><span class="line">565</span><br><span class="line">566</span><br><span class="line">567</span><br><span class="line">568</span><br><span class="line">569</span><br><span class="line">570</span><br><span class="line">571</span><br><span class="line">572</span><br><span class="line">573</span><br><span class="line">574</span><br><span class="line">575</span><br><span class="line">576</span><br><span class="line">577</span><br><span class="line">578</span><br><span class="line">579</span><br><span class="line">580</span><br><span class="line">581</span><br><span class="line">582</span><br><span class="line">583</span><br><span class="line">584</span><br><span class="line">585</span><br><span class="line">586</span><br><span class="line">587</span><br><span class="line">588</span><br><span class="line">589</span><br><span class="line">590</span><br><span class="line">591</span><br><span class="line">592</span><br><span class="line">593</span><br><span class="line">594</span><br><span class="line">595</span><br><span class="line">596</span><br><span class="line">597</span><br><span class="line">598</span><br><span class="line">599</span><br><span class="line">600</span><br><span class="line">601</span><br><span class="line">602</span><br><span class="line">603</span><br><span class="line">604</span><br><span class="line">605</span><br><span class="line">606</span><br><span class="line">607</span><br><span class="line">608</span><br><span class="line">609</span><br><span class="line">610</span><br><span class="line">611</span><br><span class="line">612</span><br><span class="line">613</span><br><span class="line">614</span><br><span class="line">615</span><br><span class="line">616</span><br><span class="line">617</span><br><span class="line">618</span><br><span class="line">619</span><br><span class="line">620</span><br><span class="line">621</span><br><span class="line">622</span><br><span class="line">623</span><br><span class="line">624</span><br><span class="line">625</span><br><span class="line">626</span><br><span class="line">627</span><br><span class="line">628</span><br><span class="line">629</span><br><span class="line">630</span><br><span class="line">631</span><br><span class="line">632</span><br><span class="line">633</span><br><span class="line">634</span><br><span class="line">635</span><br><span class="line">636</span><br><span class="line">637</span><br><span class="line">638</span><br><span class="line">639</span><br><span class="line">640</span><br><span class="line">641</span><br><span class="line">642</span><br><span class="line">643</span><br><span class="line">644</span><br><span class="line">645</span><br><span class="line">646</span><br><span class="line">647</span><br><span class="line">648</span><br><span class="line">649</span><br><span class="line">650</span><br><span class="line">651</span><br><span class="line">652</span><br><span class="line">653</span><br><span class="line">654</span><br><span class="line">655</span><br><span class="line">656</span><br><span class="line">657</span><br><span class="line">658</span><br><span class="line">659</span><br><span class="line">660</span><br><span class="line">661</span><br><span class="line">662</span><br><span class="line">663</span><br><span class="line">664</span><br><span class="line">665</span><br><span class="line">666</span><br><span class="line">667</span><br><span class="line">668</span><br><span class="line">669</span><br><span class="line">670</span><br><span class="line">671</span><br><span class="line">672</span><br><span class="line">673</span><br><span class="line">674</span><br><span class="line">675</span><br><span class="line">676</span><br><span class="line">677</span><br><span class="line">678</span><br><span class="line">679</span><br><span class="line">680</span><br><span class="line">681</span><br><span class="line">682</span><br><span class="line">683</span><br><span class="line">684</span><br><span class="line">685</span><br><span class="line">686</span><br><span class="line">687</span><br><span class="line">688</span><br><span class="line">689</span><br><span class="line">690</span><br><span class="line">691</span><br><span class="line">692</span><br><span class="line">693</span><br><span class="line">694</span><br><span class="line">695</span><br><span class="line">696</span><br><span class="line">697</span><br><span class="line">698</span><br><span class="line">699</span><br><span class="line">700</span><br><span class="line">701</span><br><span class="line">702</span><br><span class="line">703</span><br><span class="line">704</span><br><span class="line">705</span><br><span class="line">706</span><br><span class="line">707</span><br><span class="line">708</span><br><span class="line">709</span><br><span class="line">710</span><br><span class="line">711</span><br><span class="line">712</span><br><span class="line">713</span><br><span class="line">714</span><br><span class="line">715</span><br><span class="line">716</span><br><span class="line">717</span><br><span class="line">718</span><br><span class="line">719</span><br><span class="line">720</span><br><span class="line">721</span><br><span class="line">722</span><br><span class="line">723</span><br><span class="line">724</span><br><span class="line">725</span><br><span class="line">726</span><br><span class="line">727</span><br><span class="line">728</span><br><span class="line">729</span><br><span class="line">730</span><br><span class="line">731</span><br><span class="line">732</span><br><span class="line">733</span><br><span class="line">734</span><br><span class="line">735</span><br><span class="line">736</span><br><span class="line">737</span><br><span class="line">738</span><br><span class="line">739</span><br><span class="line">740</span><br><span class="line">741</span><br><span class="line">742</span><br><span class="line">743</span><br><span class="line">744</span><br><span class="line">745</span><br><span class="line">746</span><br><span class="line">747</span><br><span class="line">748</span><br><span class="line">749</span><br><span class="line">750</span><br><span class="line">751</span><br><span class="line">752</span><br><span class="line">753</span><br><span class="line">754</span><br><span class="line">755</span><br><span class="line">756</span><br><span class="line">757</span><br><span class="line">758</span><br><span class="line">759</span><br><span class="line">760</span><br><span class="line">761</span><br><span class="line">762</span><br><span class="line">763</span><br><span class="line">764</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"sign"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"logo"</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"/"</span>&gt;</span><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">"/static/image/nav-logo.png"</span> <span class="attr">alt</span>=<span class="string">"Logo"</span>&gt;</span><span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"main"</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">h4</span> <span class="attr">class</span>=<span class="string">"title"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"normal-title"</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">router-link</span> <span class="attr">to</span>=<span class="string">"/user/login"</span>&gt;</span>登录<span class="tag">&lt;/<span class="name">router-link</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">b</span>&gt;</span>·<span class="tag">&lt;/<span class="name">b</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">router-link</span> <span class="attr">id</span>=<span class="string">"js-sign-up-btn"</span> <span class="attr">class</span>=<span class="string">"active"</span> <span class="attr">to</span>=<span class="string">"/user/register"</span>&gt;</span>注册<span class="tag">&lt;/<span class="name">router-link</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">h4</span>&gt;</span></span><br><span class="line"></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"js-sign-up-container"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">form</span> <span class="attr">class</span>=<span class="string">"new_user"</span> <span class="attr">id</span>=<span class="string">"new_user"</span> <span class="attr">action</span>=<span class="string">""</span> <span class="attr">accept-charset</span>=<span class="string">"UTF-8"</span> <span class="attr">method</span>=<span class="string">"post"</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"input-prepend restyle"</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">input</span> <span class="attr">placeholder</span>=<span class="string">"你的昵称"</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">value</span>=<span class="string">""</span> <span class="attr">v-model</span>=<span class="string">"nickname"</span> <span class="attr">id</span>=<span class="string">"user_nickname"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">i</span> <span class="attr">class</span>=<span class="string">"iconfont ic-user"</span>&gt;</span><span class="tag">&lt;/<span class="name">i</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"input-prepend restyle no-radius js-normal"</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">input</span> <span class="attr">placeholder</span>=<span class="string">"手机号"</span> <span class="attr">type</span>=<span class="string">"tel"</span> <span class="attr">v-model</span>=<span class="string">"mobile"</span> <span class="attr">id</span>=<span class="string">"user_mobile_number"</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">i</span> <span class="attr">class</span>=<span class="string">"iconfont ic-phonenumber"</span>&gt;</span><span class="tag">&lt;/<span class="name">i</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"input-prepend restyle no-radius security-up-code js-security-number"</span> <span class="attr">v-if</span>=<span class="string">"is_show_sms_code"</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">v-model</span>=<span class="string">"sms_code"</span> <span class="attr">id</span>=<span class="string">"sms_code"</span> <span class="attr">placeholder</span>=<span class="string">"手机验证码"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">i</span> <span class="attr">class</span>=<span class="string">"iconfont ic-verify"</span>&gt;</span><span class="tag">&lt;/<span class="name">i</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">a</span> <span class="attr">tabindex</span>=<span class="string">"-1"</span> <span class="attr">class</span>=<span class="string">"btn-up-resend js-send-code-button"</span>  <span class="attr">href</span>=<span class="string">"javascript:void(0);"</span> <span class="attr">id</span>=<span class="string">"send_code"</span> @<span class="attr">click.prevent</span>=<span class="string">"send_sms"</span>&gt;</span>&#123;&#123;sms_code_text&#125;&#125;<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"hidden"</span> <span class="attr">name</span>=<span class="string">"security_number"</span> <span class="attr">id</span>=<span class="string">"security_number"</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"input-prepend"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">input</span> <span class="attr">placeholder</span>=<span class="string">"设置密码"</span> <span class="attr">type</span>=<span class="string">"password"</span> <span class="attr">v-model</span>=<span class="string">"password"</span> <span class="attr">id</span>=<span class="string">"user_password"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">i</span> <span class="attr">class</span>=<span class="string">"iconfont ic-password"</span>&gt;</span><span class="tag">&lt;/<span class="name">i</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"submit"</span> <span class="attr">name</span>=<span class="string">"commit"</span> <span class="attr">value</span>=<span class="string">"注册"</span> <span class="attr">class</span>=<span class="string">"sign-up-button"</span> <span class="attr">id</span>=<span class="string">"sign_up_btn"</span> @<span class="attr">click.prevent</span>=<span class="string">"registerHandler"</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">p</span> <span class="attr">class</span>=<span class="string">"sign-up-msg"</span>&gt;</span>点击 “注册” 即表示您同意并愿意遵守荏苒<span class="tag">&lt;<span class="name">br</span>&gt;</span> <span class="tag">&lt;<span class="name">a</span> <span class="attr">target</span>=<span class="string">"_blank"</span> <span class="attr">href</span>=<span class="string">""</span>&gt;</span>用户协议<span class="tag">&lt;/<span class="name">a</span>&gt;</span> 和 <span class="tag">&lt;<span class="name">a</span> <span class="attr">target</span>=<span class="string">"_blank"</span> <span class="attr">href</span>=<span class="string">""</span>&gt;</span>隐私政策<span class="tag">&lt;/<span class="name">a</span>&gt;</span> 。<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- 更多注册方式 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"more-sign"</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">h6</span>&gt;</span>社交帐号直接注册<span class="tag">&lt;/<span class="name">h6</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">ul</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">id</span>=<span class="string">"weixin"</span> <span class="attr">class</span>=<span class="string">"weixin"</span> <span class="attr">target</span>=<span class="string">"_blank"</span> <span class="attr">href</span>=<span class="string">""</span>&gt;</span><span class="tag">&lt;<span class="name">i</span> <span class="attr">class</span>=<span class="string">"iconfont ic-wechat"</span>&gt;</span><span class="tag">&lt;/<span class="name">i</span>&gt;</span><span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">id</span>=<span class="string">"qq"</span> <span class="attr">class</span>=<span class="string">"qq"</span> <span class="attr">target</span>=<span class="string">"_blank"</span> <span class="attr">href</span>=<span class="string">""</span>&gt;</span><span class="tag">&lt;<span class="name">i</span> <span class="attr">class</span>=<span class="string">"iconfont ic-qq_connect"</span>&gt;</span><span class="tag">&lt;/<span class="name">i</span>&gt;</span><span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript">    <span class="keyword">export</span> <span class="keyword">default</span> &#123;</span></span><br><span class="line"><span class="actionscript">        name: <span class="string">"Register"</span>,</span></span><br><span class="line">        data()&#123;</span><br><span class="line"><span class="actionscript">          <span class="keyword">return</span> &#123;</span></span><br><span class="line"><span class="actionscript">            nickname:<span class="string">""</span>,</span></span><br><span class="line"><span class="actionscript">            mobile:<span class="string">""</span>,</span></span><br><span class="line"><span class="actionscript">            sms_code:<span class="string">""</span>,</span></span><br><span class="line"><span class="actionscript">            password:<span class="string">""</span>,</span></span><br><span class="line"><span class="actionscript">            sms_code_text:<span class="string">"发送验证码"</span>,</span></span><br><span class="line"><span class="actionscript">            is_show_sms_code:<span class="literal">false</span>,</span></span><br><span class="line">          &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        watch: &#123;</span><br><span class="line">          mobile() &#123;</span><br><span class="line"><span class="javascript">            <span class="keyword">if</span> (<span class="regexp">/^1[3-9]\d&#123;9&#125;$/</span>.test(<span class="keyword">this</span>.mobile)) &#123;</span></span><br><span class="line"><span class="actionscript">              <span class="keyword">this</span>.is_show_sms_code = <span class="literal">true</span>;</span></span><br><span class="line"><span class="actionscript">            &#125; <span class="keyword">else</span> &#123;</span></span><br><span class="line"><span class="actionscript">              <span class="keyword">this</span>.is_show_sms_code = <span class="literal">false</span>;</span></span><br><span class="line">            &#125;</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        methods:&#123;</span><br><span class="line">          registerHandler()&#123;</span><br><span class="line"><span class="actionscript">            <span class="comment">// todo 数据验证</span></span></span><br><span class="line"></span><br><span class="line"><span class="actionscript">            <span class="comment">// 注册处理</span></span></span><br><span class="line"><span class="javascript">            <span class="keyword">this</span>.$axios.post(<span class="string">`<span class="subst">$&#123;<span class="keyword">this</span>.$settings.Host&#125;</span>/users/`</span>,&#123;</span></span><br><span class="line"><span class="actionscript">                mobile: <span class="keyword">this</span>.mobile,</span></span><br><span class="line"><span class="actionscript">                nickname: <span class="keyword">this</span>.nickname,</span></span><br><span class="line"><span class="actionscript">                password: <span class="keyword">this</span>.password,</span></span><br><span class="line"><span class="actionscript">                sms_code: <span class="keyword">this</span>.sms_code,</span></span><br><span class="line"><span class="javascript">            &#125;).then(<span class="function"><span class="params">response</span>=&gt;</span> &#123;</span></span><br><span class="line">              sessionStorage.user_token = response.data.token;</span><br><span class="line">              sessionStorage.user_id = response.data.id;</span><br><span class="line">              sessionStorage.user_name = response.data.username;</span><br><span class="line">              sessionStorage.user_avatar = response.data.avatar;</span><br><span class="line">              sessionStorage.user_nickname = response.data.nickname;</span><br><span class="line"></span><br><span class="line"><span class="actionscript">              <span class="keyword">this</span>.$confirm(<span class="string">'注册成功, 欢迎加入荏苒！'</span>, <span class="string">'提示'</span>, &#123;</span></span><br><span class="line"><span class="actionscript">                confirmButtonText: <span class="string">'跳转到首页'</span>,</span></span><br><span class="line"><span class="actionscript">                cancelButtonText: <span class="string">'跳转上一页'</span>,</span></span><br><span class="line"><span class="actionscript">                type: <span class="string">'success'</span></span></span><br><span class="line"><span class="javascript">              &#125;).then(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span></span><br><span class="line"><span class="actionscript">                <span class="keyword">this</span>.$router.push(<span class="string">"/"</span>);</span></span><br><span class="line"><span class="javascript">              &#125;).catch(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span></span><br><span class="line"><span class="actionscript">                <span class="keyword">this</span>.$router.go(<span class="number">-1</span>);</span></span><br><span class="line">              &#125;);</span><br><span class="line"></span><br><span class="line"><span class="javascript">            &#125;).catch(<span class="function"><span class="params">error</span>=&gt;</span>&#123;</span></span><br><span class="line"><span class="actionscript">                <span class="keyword">this</span>.$message.error(<span class="string">"用户注册失败！"</span>);</span></span><br><span class="line">            &#125;)</span><br><span class="line">          &#125;,</span><br><span class="line">          send_sms()&#123;</span><br><span class="line"><span class="javascript">                <span class="keyword">if</span>( !<span class="regexp">/1[1-9]&#123;2&#125;\d&#123;8&#125;/</span>.test(<span class="keyword">this</span>.mobile) )&#123;</span></span><br><span class="line"><span class="actionscript">                  <span class="keyword">return</span> <span class="literal">false</span>;</span></span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line"><span class="actionscript">                <span class="comment">// 如果 sms_code_text 不是文本,而是数字,则表示当前手机号码还在60秒的发送短信间隔内</span></span></span><br><span class="line"><span class="actionscript">                <span class="keyword">if</span>(<span class="keyword">this</span>.sms_code_text != <span class="string">"发送验证码"</span>)&#123;</span></span><br><span class="line"><span class="actionscript">                  <span class="keyword">return</span> <span class="literal">false</span>;</span></span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line"><span class="actionscript">                <span class="comment">// 发送短信</span></span></span><br><span class="line"><span class="javascript">                <span class="keyword">let</span> _this = <span class="keyword">this</span>;</span></span><br><span class="line"><span class="javascript">                <span class="keyword">this</span>.$axios.get(<span class="string">`<span class="subst">$&#123;_this.$settings.Host&#125;</span>/users/sms/<span class="subst">$&#123;_this.mobile&#125;</span>/`</span>).then(<span class="function"><span class="params">response</span>=&gt;</span>&#123;</span></span><br><span class="line"><span class="actionscript">                  <span class="comment">// 显示发送短信以后的文本倒计时</span></span></span><br><span class="line"><span class="javascript">                  <span class="keyword">let</span> time = <span class="number">60</span>;</span></span><br><span class="line"><span class="javascript">                  <span class="keyword">let</span> timer = setInterval(<span class="function"><span class="params">()</span>=&gt;</span>&#123;</span></span><br><span class="line">                    --time;</span><br><span class="line">                    if(time &lt;=1)&#123;</span><br><span class="line"><span class="actionscript">                      <span class="comment">// 如果倒计时为0,则关闭当前定时器</span></span></span><br><span class="line"><span class="actionscript">                      _this.sms_code_text = <span class="string">"发送验证码"</span>;</span></span><br><span class="line">                      clearInterval(timer);</span><br><span class="line">                      time = 60;</span><br><span class="line"><span class="actionscript">                    &#125;<span class="keyword">else</span>&#123;</span></span><br><span class="line"><span class="actionscript">                        _this.sms_code_text = time+<span class="string">"秒"</span>;</span></span><br><span class="line">                    &#125;</span><br><span class="line">                  &#125;,1000);</span><br><span class="line"></span><br><span class="line"><span class="javascript">                &#125;).catch(<span class="function"><span class="params">error</span>=&gt;</span>&#123;</span></span><br><span class="line"><span class="javascript">                  <span class="built_in">console</span>.log(error);</span></span><br><span class="line">                &#125;)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span> <span class="attr">scoped</span>&gt;</span></span><br><span class="line">input&#123;</span><br><span class="line">  outline: none;</span><br><span class="line">&#125;</span><br><span class="line"><span class="css">*, <span class="selector-pseudo">:after</span>, <span class="selector-pseudo">:before</span> &#123;</span></span><br><span class="line">    box-sizing: border-box;</span><br><span class="line">&#125;</span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> &#123;</span></span><br><span class="line">height: 100%;</span><br><span class="line">min-height: 750px;</span><br><span class="line">text-align: center;</span><br><span class="line">font-size: 14px;</span><br><span class="line"><span class="css"><span class="selector-tag">background-color</span>: <span class="selector-id">#f1f1f1</span></span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span><span class="selector-pseudo">:before</span> &#123;</span></span><br><span class="line">content: "";</span><br><span class="line">display: inline-block;</span><br><span class="line">height: 85%;</span><br><span class="line">vertical-align: middle</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.disable</span>,<span class="selector-class">.sign</span> <span class="selector-class">.disable-gray</span> &#123;</span></span><br><span class="line"><span class="css"><span class="selector-tag">opacity</span>: <span class="selector-class">.5</span>;</span></span><br><span class="line">pointer-events: none</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.disable-gray</span> &#123;</span></span><br><span class="line"><span class="css"><span class="selector-tag">background-color</span>: <span class="selector-id">#969696</span></span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.tooltip-error</span> &#123;</span></span><br><span class="line">font-size: 14px;</span><br><span class="line">line-height: 25px;</span><br><span class="line">white-space: nowrap;</span><br><span class="line">background: none</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.tooltip-error</span> <span class="selector-class">.tooltip-inner</span> &#123;</span></span><br><span class="line">max-width: 280px;</span><br><span class="line"><span class="css"><span class="selector-tag">color</span>: <span class="selector-id">#333</span>;</span></span><br><span class="line"><span class="css"><span class="selector-tag">border</span>: 1<span class="selector-tag">px</span> <span class="selector-tag">solid</span> <span class="selector-id">#ea6f5a</span>;</span></span><br><span class="line"><span class="css"><span class="selector-tag">background-color</span>: <span class="selector-id">#fff</span></span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.tooltip-error</span> <span class="selector-class">.tooltip-inner</span> <span class="selector-tag">i</span> &#123;</span></span><br><span class="line">position: static;</span><br><span class="line">margin-right: 5px;</span><br><span class="line">font-size: 20px;</span><br><span class="line"><span class="css"><span class="selector-tag">color</span>: <span class="selector-id">#ea6f5a</span>;</span></span><br><span class="line">vertical-align: middle</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.tooltip-error</span> <span class="selector-class">.tooltip-inner</span> <span class="selector-tag">span</span> &#123;</span></span><br><span class="line">vertical-align: middle;</span><br><span class="line">display: inline-block;</span><br><span class="line">white-space: normal;</span><br><span class="line">max-width: 230px</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.tooltip-error</span><span class="selector-class">.right</span> <span class="selector-class">.tooltip-arrow-border</span> &#123;</span></span><br><span class="line"><span class="css"><span class="selector-tag">border-right-color</span>: <span class="selector-id">#ea6f5a</span></span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.tooltip-error</span><span class="selector-class">.right</span> <span class="selector-class">.tooltip-arrow-bg</span> &#123;</span></span><br><span class="line">left: 2px;</span><br><span class="line"><span class="css"><span class="selector-tag">border-right-color</span>: <span class="selector-id">#fff</span></span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.slide-error</span> &#123;</span></span><br><span class="line">position: relative;</span><br><span class="line">padding: 10px 0;</span><br><span class="line"><span class="css"><span class="selector-tag">border</span>: 1<span class="selector-tag">px</span> <span class="selector-tag">solid</span> <span class="selector-id">#c8c8c8</span>;</span></span><br><span class="line">border-radius: 4px</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.slide-error</span> <span class="selector-tag">i</span> &#123;</span></span><br><span class="line">position: static!important;</span><br><span class="line">margin-right: 10px;</span><br><span class="line"><span class="css"><span class="selector-tag">color</span>: <span class="selector-id">#ea6f5a</span>!<span class="selector-tag">important</span>;</span></span><br><span class="line">vertical-align: middle</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.slide-error</span> <span class="selector-tag">span</span> &#123;</span></span><br><span class="line">font-size: 15px;</span><br><span class="line">vertical-align: middle</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.slide-error</span> <span class="selector-tag">div</span> &#123;</span></span><br><span class="line">margin-top: 10px;</span><br><span class="line">font-size: 13px</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.slide-error</span> <span class="selector-tag">a</span> &#123;</span></span><br><span class="line"><span class="css"><span class="selector-tag">color</span>: <span class="selector-id">#3194d0</span></span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.js-sign-up-forbidden</span> &#123;</span></span><br><span class="line"><span class="css"><span class="selector-tag">color</span>: <span class="selector-id">#999</span>;</span></span><br><span class="line">padding: 80px 0 100px</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.js-sign-up-container</span> <span class="selector-class">.slide-error</span> &#123;</span></span><br><span class="line">border-bottom: none;</span><br><span class="line">border-radius: 0</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.logo</span> &#123;</span></span><br><span class="line">position: absolute;</span><br><span class="line">top: 56px;</span><br><span class="line">margin-left: 50px</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.logo</span> <span class="selector-tag">img</span> &#123;</span></span><br><span class="line">width: 100px</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.main</span> &#123;</span></span><br><span class="line">width: 400px;</span><br><span class="line">margin: 60px auto 0;</span><br><span class="line">padding: 50px 50px 30px;</span><br><span class="line"><span class="css"><span class="selector-tag">background-color</span>: <span class="selector-id">#fff</span>;</span></span><br><span class="line">border-radius: 4px;</span><br><span class="line"><span class="css"><span class="selector-tag">box-shadow</span>: 0 0 8<span class="selector-tag">px</span> <span class="selector-tag">rgba</span>(0,0,0,<span class="selector-class">.1</span>);</span></span><br><span class="line">vertical-align: middle;</span><br><span class="line">display: inline-block</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.reset-title</span>,<span class="selector-class">.sign</span> <span class="selector-class">.title</span> &#123;</span></span><br><span class="line">margin: 0 auto 50px;</span><br><span class="line">padding: 10px;</span><br><span class="line">font-weight: 400;</span><br><span class="line"><span class="css"><span class="selector-tag">color</span>: <span class="selector-id">#969696</span></span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.reset-title</span> <span class="selector-tag">a</span>,<span class="selector-class">.sign</span> <span class="selector-class">.title</span> <span class="selector-tag">a</span> &#123;</span></span><br><span class="line">padding: 10px;</span><br><span class="line"><span class="css"><span class="selector-tag">color</span>: <span class="selector-id">#969696</span></span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.reset-title</span> <span class="selector-tag">a</span><span class="selector-pseudo">:hover</span>,<span class="selector-class">.sign</span> <span class="selector-class">.title</span> <span class="selector-tag">a</span><span class="selector-pseudo">:hover</span> &#123;</span></span><br><span class="line"><span class="css"><span class="selector-tag">border-bottom</span>: 2<span class="selector-tag">px</span> <span class="selector-tag">solid</span> <span class="selector-id">#ea6f5a</span></span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.reset-title</span> <span class="selector-class">.active</span>,<span class="selector-class">.sign</span> <span class="selector-class">.title</span> <span class="selector-class">.active</span> &#123;</span></span><br><span class="line">font-weight: 700;</span><br><span class="line"><span class="css"><span class="selector-tag">color</span>: <span class="selector-id">#ea6f5a</span>;</span></span><br><span class="line"><span class="css"><span class="selector-tag">border-bottom</span>: 2<span class="selector-tag">px</span> <span class="selector-tag">solid</span> <span class="selector-id">#ea6f5a</span></span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.reset-title</span> <span class="selector-tag">b</span>,<span class="selector-class">.sign</span> <span class="selector-class">.title</span> <span class="selector-tag">b</span> &#123;</span></span><br><span class="line">padding: 10px</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.reset-title</span> &#123;</span></span><br><span class="line"><span class="css"><span class="selector-tag">color</span>: <span class="selector-id">#333</span>;</span></span><br><span class="line">font-weight: 700</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-tag">form</span> &#123;</span></span><br><span class="line">margin-bottom: 30px</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-tag">form</span> <span class="selector-class">.input-prepend</span> &#123;</span></span><br><span class="line">position: relative;</span><br><span class="line">width: 100%</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-tag">form</span> <span class="selector-class">.input-prepend</span> <span class="selector-tag">input</span> &#123;</span></span><br><span class="line">width: 100%;</span><br><span class="line">height: 50px;</span><br><span class="line">margin-bottom: 0;</span><br><span class="line">padding: 4px 12px 4px 35px;</span><br><span class="line"><span class="css"><span class="selector-tag">border</span>: 1<span class="selector-tag">px</span> <span class="selector-tag">solid</span> <span class="selector-id">#c8c8c8</span>;</span></span><br><span class="line">border-radius: 0 0 4px 4px;</span><br><span class="line"><span class="css"><span class="selector-tag">background-color</span>: <span class="selector-tag">hsla</span>(0,0%,71%,<span class="selector-class">.1</span>);</span></span><br><span class="line">vertical-align: middle</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-tag">form</span> <span class="selector-class">.input-prepend</span> <span class="selector-tag">i</span> &#123;</span></span><br><span class="line">position: absolute;</span><br><span class="line">top: 14px;</span><br><span class="line">left: 10px;</span><br><span class="line">font-size: 18px;</span><br><span class="line"><span class="css"><span class="selector-tag">color</span>: <span class="selector-id">#969696</span></span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-tag">form</span> <span class="selector-class">.input-prepend</span> <span class="selector-tag">span</span> &#123;</span></span><br><span class="line"><span class="css"><span class="selector-tag">color</span>: <span class="selector-id">#333</span></span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-tag">form</span> <span class="selector-class">.input-prepend</span> <span class="selector-class">.ic-show</span> &#123;</span></span><br><span class="line">top: 18px;</span><br><span class="line">left: auto;</span><br><span class="line">right: 8px;</span><br><span class="line">font-size: 12px</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-tag">form</span> <span class="selector-class">.geetest-placeholder</span> &#123;</span></span><br><span class="line">height: 44px;</span><br><span class="line">border-radius: 4px;</span><br><span class="line"><span class="css"><span class="selector-tag">background-color</span>: <span class="selector-tag">hsla</span>(0,0%,71%,<span class="selector-class">.1</span>);</span></span><br><span class="line">text-align: center;</span><br><span class="line">line-height: 44px;</span><br><span class="line">font-size: 14px;</span><br><span class="line"><span class="css"><span class="selector-tag">color</span>: <span class="selector-id">#999</span></span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-tag">form</span> <span class="selector-class">.restyle</span> &#123;</span></span><br><span class="line">margin-bottom: 0</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-tag">form</span> <span class="selector-class">.restyle</span> <span class="selector-tag">input</span> &#123;</span></span><br><span class="line">border-bottom: none;</span><br><span class="line">border-radius: 4px 4px 0 0</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-tag">form</span> <span class="selector-class">.no-radius</span> <span class="selector-tag">input</span> &#123;</span></span><br><span class="line">border-radius: 0</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-tag">form</span> <span class="selector-class">.slide-security-placeholder</span> &#123;</span></span><br><span class="line">height: 32px;</span><br><span class="line"><span class="css"><span class="selector-tag">background-color</span>: <span class="selector-tag">hsla</span>(0,0%,71%,<span class="selector-class">.1</span>);</span></span><br><span class="line">border-radius: 4px</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-tag">form</span> <span class="selector-class">.slide-security-placeholder</span> <span class="selector-tag">p</span> &#123;</span></span><br><span class="line">padding-top: 7px;</span><br><span class="line"><span class="css"><span class="selector-tag">color</span>: <span class="selector-id">#999</span>;</span></span><br><span class="line">margin-right: -7px</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.overseas-btn</span> &#123;</span></span><br><span class="line">font-size: 14px;</span><br><span class="line"><span class="css"><span class="selector-tag">color</span>: <span class="selector-id">#999</span></span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.overseas-btn</span><span class="selector-pseudo">:hover</span> &#123;</span></span><br><span class="line"><span class="css"><span class="selector-tag">color</span>: <span class="selector-id">#2f2f2f</span></span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.remember-btn</span> &#123;</span></span><br><span class="line">float: left;</span><br><span class="line">margin: 15px 0</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.remember-btn</span> <span class="selector-tag">span</span> &#123;</span></span><br><span class="line">margin-left: 5px;</span><br><span class="line">font-size: 15px;</span><br><span class="line"><span class="css"><span class="selector-tag">color</span>: <span class="selector-id">#969696</span>;</span></span><br><span class="line">vertical-align: middle</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.forget-btn</span> &#123;</span></span><br><span class="line">float: right;</span><br><span class="line">position: relative;</span><br><span class="line">margin: 15px 0;</span><br><span class="line">font-size: 14px</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.forget-btn</span> <span class="selector-tag">a</span> &#123;</span></span><br><span class="line"><span class="css"><span class="selector-tag">color</span>: <span class="selector-id">#999</span></span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.forget-btn</span> <span class="selector-tag">a</span><span class="selector-pseudo">:hover</span> &#123;</span></span><br><span class="line"><span class="css"><span class="selector-tag">color</span>: <span class="selector-id">#333</span></span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.forget-btn</span> <span class="selector-class">.dropdown-menu</span> &#123;</span></span><br><span class="line">top: 20px;</span><br><span class="line">left: auto;</span><br><span class="line">right: 0;</span><br><span class="line">border-radius: 4px</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.forget-btn</span> <span class="selector-class">.dropdown-menu</span> <span class="selector-tag">a</span> &#123;</span></span><br><span class="line">padding: 10px 20px;</span><br><span class="line"><span class="css"><span class="selector-tag">color</span>: <span class="selector-id">#333</span></span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-id">#sign-in-loading</span> &#123;</span></span><br><span class="line">position: relative;</span><br><span class="line">width: 20px;</span><br><span class="line">height: 20px;</span><br><span class="line">vertical-align: middle;</span><br><span class="line">margin-top: -4px;</span><br><span class="line">margin-right: 2px;</span><br><span class="line">display: none</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-id">#sign-in-loading</span><span class="selector-pseudo">:after</span> &#123;</span></span><br><span class="line">content: "";</span><br><span class="line">position: absolute;</span><br><span class="line">left: 0;</span><br><span class="line">top: 0;</span><br><span class="line">width: 100%;</span><br><span class="line">height: 100%;</span><br><span class="line">background-color: transparent;              </span><br><span class="line">    </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-id">#sign-in-loading</span><span class="selector-pseudo">:before</span> &#123;</span></span><br><span class="line">content: "";</span><br><span class="line">position: absolute;</span><br><span class="line">top: 50%;</span><br><span class="line">left: 50%;</span><br><span class="line">width: 20px;</span><br><span class="line">height: 20px;</span><br><span class="line">margin: -10px 0 0 -10px;</span><br><span class="line">border-radius: 10px;</span><br><span class="line"><span class="css"><span class="selector-tag">border</span>: 2<span class="selector-tag">px</span> <span class="selector-tag">solid</span> <span class="selector-id">#fff</span>;</span></span><br><span class="line">border-bottom-color: transparent;</span><br><span class="line">vertical-align: middle;</span><br><span class="line"><span class="css"><span class="selector-tag">-webkit-animation</span>: <span class="selector-tag">rolling</span> <span class="selector-class">.8s</span> <span class="selector-tag">infinite</span> <span class="selector-tag">linear</span>;</span></span><br><span class="line"><span class="css"><span class="selector-tag">animation</span>: <span class="selector-tag">rolling</span> <span class="selector-class">.8s</span> <span class="selector-tag">infinite</span> <span class="selector-tag">linear</span>;</span></span><br><span class="line">z-index: 1</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.sign-in-button</span>,<span class="selector-class">.sign</span> <span class="selector-class">.sign-up-button</span> &#123;</span></span><br><span class="line">margin-top: 20px;</span><br><span class="line">width: 100%;</span><br><span class="line">padding: 9px 18px;</span><br><span class="line">font-size: 18px;</span><br><span class="line">border: none;</span><br><span class="line">border-radius: 25px;</span><br><span class="line"><span class="css"><span class="selector-tag">color</span>: <span class="selector-id">#fff</span>;</span></span><br><span class="line"><span class="css"><span class="selector-tag">background</span>: <span class="selector-id">#42c02e</span>;</span></span><br><span class="line">cursor: pointer;</span><br><span class="line">outline: none;</span><br><span class="line">display: block;</span><br><span class="line">clear: both</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.sign-in-button</span><span class="selector-pseudo">:hover</span>,<span class="selector-class">.sign</span> <span class="selector-class">.sign-up-button</span><span class="selector-pseudo">:hover</span> &#123;</span></span><br><span class="line"><span class="css"><span class="selector-tag">background</span>: <span class="selector-id">#3db922</span></span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.sign-in-button</span> &#123;</span></span><br><span class="line"><span class="css"><span class="selector-tag">background</span>: <span class="selector-id">#3194d0</span></span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.sign-in-button</span><span class="selector-pseudo">:hover</span> &#123;</span></span><br><span class="line"><span class="css"><span class="selector-tag">background</span>: <span class="selector-id">#187cb7</span></span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.btn-in-resend</span>,<span class="selector-class">.sign</span> <span class="selector-class">.btn-up-resend</span> &#123;</span></span><br><span class="line">position: absolute;</span><br><span class="line">top: 7px;</span><br><span class="line">right: 7px;</span><br><span class="line">width: 100px;</span><br><span class="line">height: 36px;</span><br><span class="line">font-size: 13px;</span><br><span class="line"><span class="css"><span class="selector-tag">color</span>: <span class="selector-id">#fff</span>;</span></span><br><span class="line"><span class="css"><span class="selector-tag">background-color</span>: <span class="selector-id">#42c02e</span>;</span></span><br><span class="line">border-radius: 20px;</span><br><span class="line">line-height: 36px</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.btn-in-resend</span> &#123;</span></span><br><span class="line"><span class="css"><span class="selector-tag">background-color</span>: <span class="selector-id">#3194d0</span></span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.sign-up-msg</span> &#123;</span></span><br><span class="line">margin: 10px 0;</span><br><span class="line">padding: 0;</span><br><span class="line">text-align: center;</span><br><span class="line">font-size: 12px;</span><br><span class="line">line-height: 20px;</span><br><span class="line"><span class="css"><span class="selector-tag">color</span>: <span class="selector-id">#969696</span></span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.sign-up-msg</span> <span class="selector-tag">a</span>,<span class="selector-class">.sign</span> <span class="selector-class">.sign-up-msg</span> <span class="selector-tag">a</span><span class="selector-pseudo">:hover</span> &#123;</span></span><br><span class="line"><span class="css"><span class="selector-tag">color</span>: <span class="selector-id">#3194d0</span></span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.overseas</span> <span class="selector-tag">input</span> &#123;</span></span><br><span class="line">padding-left: 110px!important</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.overseas</span> <span class="selector-class">.overseas-number</span> &#123;</span></span><br><span class="line">position: absolute;</span><br><span class="line">top: 0;</span><br><span class="line">left: 0;</span><br><span class="line">width: 100px;</span><br><span class="line">height: 50px;</span><br><span class="line">font-size: 18px;</span><br><span class="line"><span class="css"><span class="selector-tag">color</span>: <span class="selector-id">#969696</span>;</span></span><br><span class="line"><span class="css"><span class="selector-tag">border-right</span>: 1<span class="selector-tag">px</span> <span class="selector-tag">solid</span> <span class="selector-id">#c8c8c8</span></span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.overseas</span> <span class="selector-class">.overseas-number</span> <span class="selector-tag">span</span> &#123;</span></span><br><span class="line">margin-top: 17px;</span><br><span class="line">padding-left: 35px;</span><br><span class="line">text-align: left;</span><br><span class="line">font-size: 14px;</span><br><span class="line">display: block</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.overseas</span> <span class="selector-class">.dropdown-menu</span> &#123;</span></span><br><span class="line">width: 100%;</span><br><span class="line">max-height: 285px;</span><br><span class="line">font-size: 14px;</span><br><span class="line">border-radius: 0 0 4px 4px;</span><br><span class="line">overflow-y: auto</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.overseas</span> <span class="selector-class">.dropdown-menu</span> <span class="selector-tag">li</span> <span class="selector-class">.nation-code</span> &#123;</span></span><br><span class="line">width: 65px;</span><br><span class="line">display: inline-block</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.overseas</span> <span class="selector-class">.dropdown-menu</span> <span class="selector-tag">li</span> <span class="selector-tag">a</span> &#123;</span></span><br><span class="line">padding: 6px 20px;</span><br><span class="line">font-size: 14px;</span><br><span class="line">line-height: 20px</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.overseas</span> <span class="selector-class">.dropdown-menu</span> <span class="selector-tag">li</span> <span class="selector-tag">a</span><span class="selector-pseudo">::hover</span> &#123;</span></span><br><span class="line"><span class="css"><span class="selector-tag">color</span>: <span class="selector-id">#fff</span>;</span></span><br><span class="line"><span class="css"><span class="selector-tag">background-color</span>: <span class="selector-id">#f5f5f5</span></span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.more-sign</span> &#123;</span></span><br><span class="line">margin-top: 50px</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.more-sign</span> <span class="selector-tag">h6</span> &#123;</span></span><br><span class="line">position: relative;</span><br><span class="line">margin: 0 0 10px;</span><br><span class="line">font-size: 12px;</span><br><span class="line"><span class="css"><span class="selector-tag">color</span>: <span class="selector-id">#b5b5b5</span></span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.more-sign</span> <span class="selector-tag">h6</span><span class="selector-pseudo">:before</span> &#123;</span></span><br><span class="line">left: 30px</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.more-sign</span> <span class="selector-tag">h6</span><span class="selector-pseudo">:after</span>,<span class="selector-class">.sign</span> <span class="selector-class">.more-sign</span> <span class="selector-tag">h6</span><span class="selector-pseudo">:before</span> &#123;</span></span><br><span class="line">content: "";</span><br><span class="line"><span class="css"><span class="selector-tag">border-top</span>: 1<span class="selector-tag">px</span> <span class="selector-tag">solid</span> <span class="selector-id">#b5b5b5</span>;</span></span><br><span class="line">display: block;</span><br><span class="line">position: absolute;</span><br><span class="line">width: 60px;</span><br><span class="line">top: 5px</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.more-sign</span> <span class="selector-tag">h6</span><span class="selector-pseudo">:after</span> &#123;</span></span><br><span class="line">right: 30px</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.more-sign</span> <span class="selector-tag">ul</span> &#123;</span></span><br><span class="line">margin-bottom: 10px;</span><br><span class="line">list-style: none</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.more-sign</span> <span class="selector-tag">ul</span> <span class="selector-tag">li</span> &#123;</span></span><br><span class="line">margin: 0 5px;</span><br><span class="line">display: inline-block</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.more-sign</span> <span class="selector-tag">ul</span> <span class="selector-tag">a</span> &#123;</span></span><br><span class="line">width: 50px;</span><br><span class="line">height: 50px;</span><br><span class="line">line-height: 50px;</span><br><span class="line">display: block</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.more-sign</span> <span class="selector-tag">ul</span> <span class="selector-tag">i</span> &#123;</span></span><br><span class="line">font-size: 28px</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.more-sign</span> <span class="selector-class">.ic-weibo</span> &#123;</span></span><br><span class="line"><span class="css"><span class="selector-tag">color</span>: <span class="selector-id">#e05244</span></span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.more-sign</span> <span class="selector-class">.ic-wechat</span> &#123;</span></span><br><span class="line"><span class="css"><span class="selector-tag">color</span>: <span class="selector-id">#00bb29</span></span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.more-sign</span> <span class="selector-class">.ic-qq_connect</span> &#123;</span></span><br><span class="line"><span class="css"><span class="selector-tag">color</span>: <span class="selector-id">#498ad5</span></span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.more-sign</span> <span class="selector-class">.ic-douban</span> &#123;</span></span><br><span class="line"><span class="css"><span class="selector-tag">color</span>: <span class="selector-id">#00820f</span></span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.more-sign</span> <span class="selector-class">.ic-more</span> &#123;</span></span><br><span class="line"><span class="css"><span class="selector-tag">color</span>: <span class="selector-id">#999</span></span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.more-sign</span> <span class="selector-class">.weibo-loading</span> &#123;</span></span><br><span class="line">pointer-events: none;</span><br><span class="line">cursor: pointer;</span><br><span class="line">position: relative</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.more-sign</span> <span class="selector-class">.weibo-loading</span><span class="selector-pseudo">:after</span> &#123;</span></span><br><span class="line">content: "";</span><br><span class="line">position: absolute;</span><br><span class="line">left: 0;</span><br><span class="line">top: 0;</span><br><span class="line">width: 100%;</span><br><span class="line">height: 100%;</span><br><span class="line"><span class="css"><span class="selector-tag">background-color</span>: <span class="selector-id">#fff</span></span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-tag">body</span><span class="selector-class">.reader-night-mode</span> <span class="selector-class">.sign</span> <span class="selector-class">.more-sign</span> <span class="selector-class">.weibo-loading</span><span class="selector-pseudo">:after</span> &#123;</span></span><br><span class="line"><span class="css"><span class="selector-tag">background-color</span>: <span class="selector-id">#3f3f3f</span></span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.more-sign</span> <span class="selector-class">.weibo-loading</span><span class="selector-pseudo">:before</span> &#123;</span></span><br><span class="line">content: "";</span><br><span class="line">position: absolute;</span><br><span class="line">top: 50%;</span><br><span class="line">left: 50%;</span><br><span class="line">width: 20px;</span><br><span class="line">height: 20px;</span><br><span class="line">margin: -10px 0 0 -10px;</span><br><span class="line">border-radius: 10px;</span><br><span class="line"><span class="css"><span class="selector-tag">border</span>: 2<span class="selector-tag">px</span> <span class="selector-tag">solid</span> <span class="selector-id">#e05244</span>;</span></span><br><span class="line">border-bottom-color: transparent;</span><br><span class="line">vertical-align: middle;</span><br><span class="line"><span class="css"><span class="selector-tag">-webkit-animation</span>: <span class="selector-tag">rolling</span> <span class="selector-class">.8s</span> <span class="selector-tag">infinite</span> <span class="selector-tag">linear</span>;</span></span><br><span class="line"><span class="css"><span class="selector-tag">animation</span>: <span class="selector-tag">rolling</span> <span class="selector-class">.8s</span> <span class="selector-tag">infinite</span> <span class="selector-tag">linear</span>;</span></span><br><span class="line">z-index: 1</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="keyword">@keyframes</span> rolling &#123;</span></span><br><span class="line">0% &#123;</span><br><span class="line">-webkit-transform: rotate(0deg);</span><br><span class="line">transform: rotate(0deg)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">to &#123;</span><br><span class="line">-webkit-transform: rotate(1turn);</span><br><span class="line">transform: rotate(1turn)</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="keyword">@-webkit-keyframes</span> rolling &#123;</span></span><br><span class="line">0% &#123;</span><br><span class="line">-webkit-transform: rotate(0deg)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">to &#123;</span><br><span class="line">-webkit-transform: rotate(1turn)</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.reset-password-input</span> &#123;</span></span><br><span class="line">border-radius: 4px!important</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.return</span> &#123;</span></span><br><span class="line">margin-left: -8px;</span><br><span class="line"><span class="css"><span class="selector-tag">color</span>: <span class="selector-id">#969696</span></span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.return</span><span class="selector-pseudo">:hover</span> &#123;</span></span><br><span class="line"><span class="css"><span class="selector-tag">color</span>: <span class="selector-id">#333</span></span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.return</span> <span class="selector-tag">i</span> &#123;</span></span><br><span class="line">margin-right: 5px</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.icheckbox_square-green</span> &#123;</span></span><br><span class="line">display: inline-block;</span><br><span class="line">*display: inline;</span><br><span class="line">vertical-align: middle;</span><br><span class="line">margin: 0;</span><br><span class="line">padding: 0;</span><br><span class="line">width: 18px;</span><br><span class="line">height: 18px;</span><br><span class="line">background: url(/static/image/green.png) no-repeat;</span><br><span class="line">border: none;</span><br><span class="line">cursor: pointer;</span><br><span class="line">background-position: 0 0</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.icheckbox_square-green</span><span class="selector-class">.hover</span> &#123;</span></span><br><span class="line">background-position: -20px 0</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.icheckbox_square-green</span><span class="selector-class">.checked</span> &#123;</span></span><br><span class="line">background-position: -40px 0</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.icheckbox_square-green</span><span class="selector-class">.disabled</span> &#123;</span></span><br><span class="line">background-position: -60px 0;</span><br><span class="line">cursor: default</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.icheckbox_square-green</span><span class="selector-class">.checked</span><span class="selector-class">.disabled</span> &#123;</span></span><br><span class="line">background-position: -80px 0</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.geetest_panel_box</span>&gt;* &#123;</span></span><br><span class="line">box-sizing: content-box</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="keyword">@media</span> (<span class="attribute">max-width:</span><span class="number">768px</span>) &#123;</span></span><br><span class="line">body &#123;</span><br><span class="line">min-width: 0</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> &#123;</span></span><br><span class="line">height: auto;</span><br><span class="line">min-height: 0;</span><br><span class="line">background-color: transparent</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.logo</span> &#123;</span></span><br><span class="line">display: none</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.sign</span> <span class="selector-class">.main</span> &#123;</span></span><br><span class="line">position: absolute;</span><br><span class="line">left: 50%;</span><br><span class="line">margin: 0 0 0 -200px;</span><br><span class="line">box-shadow: none</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br></pre></td></tr></table></figure><p>服务端完成手机短信的校验和冷却的判断</p><p>视图代码，views.py，代码：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Create your views here.</span></span><br><span class="line"><span class="keyword">from</span> rest_framework.views <span class="keyword">import</span> APIView</span><br><span class="line"><span class="keyword">from</span> django.conf <span class="keyword">import</span> settings</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"><span class="keyword">from</span> urllib.parse <span class="keyword">import</span> urlencode</span><br><span class="line"><span class="keyword">from</span> urllib.request <span class="keyword">import</span> urlopen</span><br><span class="line"><span class="keyword">from</span> rest_framework.response <span class="keyword">import</span> Response</span><br><span class="line"><span class="keyword">from</span> rest_framework <span class="keyword">import</span> status</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">CaptchaAPIView</span><span class="params">(APIView)</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get</span><span class="params">(self,request)</span>:</span></span><br><span class="line">        <span class="string">"""验证码的验证结果校验"""</span></span><br><span class="line">        AppSecretKey = settings.TENCENT_CAPTCHA[<span class="string">"App_Secret_Key"</span>]</span><br><span class="line">        appid = settings.TENCENT_CAPTCHA[<span class="string">"APPID"</span>]</span><br><span class="line">        Ticket = request.query_params.get(<span class="string">"ticket"</span>)</span><br><span class="line">        Randstr = request.query_params.get(<span class="string">"randstr"</span>)</span><br><span class="line">        UserIP = request._request.META.get(<span class="string">"REMOTE_ADDR"</span>)</span><br><span class="line">        print(<span class="string">"用户ID地址：%s"</span> % UserIP)</span><br><span class="line">        params = &#123;</span><br><span class="line">            <span class="string">"aid"</span>: appid,</span><br><span class="line">            <span class="string">"AppSecretKey"</span>: AppSecretKey,</span><br><span class="line">            <span class="string">"Ticket"</span>: Ticket,</span><br><span class="line">            <span class="string">"Randstr"</span>: Randstr,</span><br><span class="line">            <span class="string">"UserIP"</span>: UserIP</span><br><span class="line">        &#125;</span><br><span class="line">        params = urlencode(params)</span><br><span class="line"></span><br><span class="line">        f = urlopen(<span class="string">"%s?%s"</span> % (settings.TENCENT_CAPTCHA[<span class="string">"GATEWAY"</span>], params))</span><br><span class="line">        content = f.read()</span><br><span class="line">        res = json.loads(content)</span><br><span class="line">        print(res)</span><br><span class="line">        <span class="keyword">if</span> res:</span><br><span class="line">            error_code = res[<span class="string">"response"</span>]</span><br><span class="line">            <span class="keyword">if</span> error_code == <span class="string">"1"</span>:</span><br><span class="line">                <span class="keyword">return</span> Response(<span class="string">"验证通过！"</span>)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="keyword">return</span> Response(<span class="string">"验证失败！%s"</span> % res[<span class="string">"err_msg"</span>], status=status.HTTP_400_BAD_REQUEST)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">return</span> Response(<span class="string">"验证失败！"</span>, status=status.HTTP_400_BAD_REQUEST)</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> rest_framework.generics <span class="keyword">import</span> CreateAPIView</span><br><span class="line"><span class="keyword">from</span> .models <span class="keyword">import</span> User</span><br><span class="line"><span class="keyword">from</span> .serializers <span class="keyword">import</span> UserModelSerializer</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">UserCreateAPIView</span><span class="params">(CreateAPIView)</span>:</span></span><br><span class="line">    queryset = User.objects.all()</span><br><span class="line">    serializer_class = UserModelSerializer</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> renranapi.libs.yuntongxun.sms <span class="keyword">import</span> CCP</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">from</span> django_redis <span class="keyword">import</span> get_redis_connection</span><br><span class="line"><span class="keyword">from</span> renranapi.settings <span class="keyword">import</span> constants</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">SMSCodeAPIView</span><span class="params">(APIView)</span>:</span></span><br><span class="line">    <span class="string">"""</span></span><br><span class="line"><span class="string">    短信验证码</span></span><br><span class="line"><span class="string">    """</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get</span><span class="params">(self, request, mobile)</span>:</span></span><br><span class="line">        <span class="string">"""</span></span><br><span class="line"><span class="string">        短信验证码</span></span><br><span class="line"><span class="string">        """</span></span><br><span class="line">        redis_conn = get_redis_connection(<span class="string">'sms_code'</span>)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 手机号是否处于发送短信的冷却时间内</span></span><br><span class="line">        interval = redis_conn.get(<span class="string">"sms_time_%s"</span> % mobile)</span><br><span class="line">        <span class="keyword">if</span> interval <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>:</span><br><span class="line">            <span class="keyword">return</span> Response(<span class="string">"不能频繁发送短信！"</span>)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 生成短信验证码</span></span><br><span class="line">        sms_code = <span class="string">"%06d"</span> % random.randint(<span class="number">0</span>, <span class="number">999999</span>)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 保存短信验证码与发送记录</span></span><br><span class="line">        <span class="comment"># 使用redis提供的管道操作可以一次性执行多条redis命令</span></span><br><span class="line">        pl = redis_conn.pipeline()</span><br><span class="line">        pl.multi()</span><br><span class="line">        pl.setex(<span class="string">"sms_%s"</span> % mobile, constants.SMS_CODE_EXPIRE, sms_code)      <span class="comment"># 设置短信有效期</span></span><br><span class="line">        pl.setex(<span class="string">"sms_time_%s"</span> % mobile, constants.SMS_CODE_INTERVAL, <span class="string">"_"</span>)    <span class="comment"># 设置发送短信间隔为60s</span></span><br><span class="line">        pl.execute()</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 发送短信验证码</span></span><br><span class="line">        ccp = CCP()</span><br><span class="line">        ccp.send_template_sms(mobile, [sms_code, constants.SMS_CODE_EXPIRE//<span class="number">60</span>], settings.SMS.get(<span class="string">"_templateID"</span>))</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> Response(&#123;<span class="string">"message"</span>: <span class="string">"OK"</span>&#125;, status.HTTP_200_OK)</span><br></pre></td></tr></table></figure><p>序列化器：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> rest_framework <span class="keyword">import</span> serializers</span><br><span class="line"><span class="keyword">from</span> .models <span class="keyword">import</span> User</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">from</span> django_redis <span class="keyword">import</span> get_redis_connection</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">UserModelSerializer</span><span class="params">(serializers.ModelSerializer)</span>:</span></span><br><span class="line">    <span class="string">"""用户信息序列化器"""</span></span><br><span class="line">    sms_code = serializers.CharField(required=<span class="literal">True</span>, write_only=<span class="literal">True</span>, max_length=<span class="number">5</span>, help_text=<span class="string">"短信验证码"</span>)</span><br><span class="line">    token = serializers.CharField(read_only=<span class="literal">True</span>, help_text=<span class="string">"jwt登录认证"</span>)</span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">Meta</span>:</span></span><br><span class="line">        model = User</span><br><span class="line">        fields = [<span class="string">"id"</span>,<span class="string">"username"</span>,<span class="string">"mobile"</span>,<span class="string">"password"</span>,<span class="string">"nickname"</span>,<span class="string">"sms_code"</span>,<span class="string">"token"</span>]</span><br><span class="line">        extra_kwargs = &#123;</span><br><span class="line">            <span class="string">"id"</span>:&#123;<span class="string">"read_only"</span>:<span class="literal">True</span>, &#125;,</span><br><span class="line">            <span class="string">"username"</span>:&#123;<span class="string">"read_only"</span>:<span class="literal">True</span>, &#125;,</span><br><span class="line">            <span class="string">"mobile"</span>:&#123;<span class="string">"required"</span>:<span class="literal">True</span>, <span class="string">"write_only"</span>:<span class="literal">True</span>, &#125;,</span><br><span class="line">            <span class="string">"password"</span>:&#123;<span class="string">"required"</span>:<span class="literal">True</span>, <span class="string">"write_only"</span>:<span class="literal">True</span>, <span class="string">"max_length"</span>: <span class="number">16</span>, <span class="string">"min_length"</span>: <span class="number">6</span>&#125;,</span><br><span class="line">            <span class="string">"nickname"</span>:&#123;<span class="string">"required"</span>:<span class="literal">True</span> &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">validate</span><span class="params">(self, attrs)</span>:</span></span><br><span class="line">        <span class="comment"># 1. 验证手机号码是否格式正确</span></span><br><span class="line">        mobile = attrs.get(<span class="string">"mobile"</span>)</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> re.match(<span class="string">"^1[3-9]\d&#123;9&#125;$"</span>, mobile):</span><br><span class="line">            <span class="keyword">raise</span> serializers.ValidationError(<span class="string">"手机号码格式错误！"</span>)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 2. 验证手机号是否注册了</span></span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            User.objects.get(mobile=mobile)</span><br><span class="line">            <span class="keyword">raise</span> serializers.ValidationError(<span class="string">"手机号码被占用！"</span>)</span><br><span class="line">        <span class="keyword">except</span> User.DoesNotExist:</span><br><span class="line">            <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"># 3. 昵称是否被注册了</span></span><br><span class="line">        nickname = attrs.get(<span class="string">"nickname"</span>)</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            User.objects.get(nickname=nickname)</span><br><span class="line">            <span class="keyword">raise</span> serializers.ValidationError(<span class="string">"用户昵称被占用！"</span>)</span><br><span class="line">        <span class="keyword">except</span> User.DoesNotExist:</span><br><span class="line">            <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"># todo 4. 验证手机短信是否正确</span></span><br><span class="line">        redis_conn = get_redis_connection(<span class="string">"sms_code"</span>)</span><br><span class="line">        redis_sms_code = redis_conn.get(<span class="string">"sms_%s"</span> % mobile).decode()</span><br><span class="line">        client_sms_code = attrs.get(<span class="string">"sms_code"</span>)</span><br><span class="line">        <span class="keyword">if</span> redis_sms_code != client_sms_code:</span><br><span class="line">            <span class="keyword">raise</span> serializers.ValidationError(<span class="string">"短信验证码填写有误！"</span>)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> attrs</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">create</span><span class="params">(self, validated_data)</span>:</span></span><br><span class="line">        <span class="string">"""保存用户注册信息"""</span></span><br><span class="line">        mobile = validated_data.get(<span class="string">"mobile"</span>)</span><br><span class="line">        nickname = validated_data.get(<span class="string">"nickname"</span>)</span><br><span class="line">        password = validated_data.get(<span class="string">"password"</span>)</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            user = User.objects.create_user(</span><br><span class="line">                username=mobile,</span><br><span class="line">                mobile=mobile,</span><br><span class="line">                nickname=nickname,</span><br><span class="line">                password=password</span><br><span class="line">            )</span><br><span class="line"></span><br><span class="line">            <span class="comment"># 清除redis中的短信记录</span></span><br><span class="line">            redis_conn = get_redis_connection(<span class="string">"sms_code"</span>)</span><br><span class="line">            redis_conn.delete(<span class="string">"sms_%s"</span> % mobile)</span><br><span class="line">            redis_conn.delete(<span class="string">"sms_time_%s"</span> % mobile)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            <span class="keyword">raise</span> serializers.ValidationError(<span class="string">"用户信息注册失败！"</span>)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 返回jwt登录token</span></span><br><span class="line">        <span class="keyword">from</span> rest_framework_jwt.settings <span class="keyword">import</span> api_settings</span><br><span class="line"></span><br><span class="line">        jwt_payload_handler = api_settings.JWT_PAYLOAD_HANDLER</span><br><span class="line">        jwt_encode_handler = api_settings.JWT_ENCODE_HANDLER</span><br><span class="line"></span><br><span class="line">        payload = jwt_payload_handler(user)</span><br><span class="line">        user.token = jwt_encode_handler(payload)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> user</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      登录注册 用户的登陆认证 前端显示登陆页面 登录页组件,后端实现登陆认证,Django默认已经提供了认证系统Auth模块。认证系统包含：用户管理,权限系统,【RBAC权限机制 Role-Base Access Control基于用户角色的访问控制机制】...
    
    </summary>
    
    
      <category term="开源项目" scheme="http://yoursite.com/categories/%E5%BC%80%E6%BA%90%E9%A1%B9%E7%9B%AE/"/>
    
    
      <category term="荏苒商城" scheme="http://yoursite.com/tags/%E8%8D%8F%E8%8B%92%E5%95%86%E5%9F%8E/"/>
    
  </entry>
  
  <entry>
    <title>[荏苒商城项目配置]</title>
    <link href="http://yoursite.com/2020/03/23/%E8%8D%8F%E8%8B%92%E5%95%86%E5%9F%8E%E9%A1%B9%E7%9B%AE%E9%85%8D%E7%BD%AE/"/>
    <id>http://yoursite.com/2020/03/23/%E8%8D%8F%E8%8B%92%E5%95%86%E5%9F%8E%E9%A1%B9%E7%9B%AE%E9%85%8D%E7%BD%AE/</id>
    <published>2020-03-23T15:03:58.000Z</published>
    <updated>2020-05-23T15:03:56.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="1-项目配置"><a href="#1-项目配置" class="headerlink" title="1-项目配置"></a>1-项目配置</h1><h2 id="4-5-日志配置"><a href="#4-5-日志配置" class="headerlink" title="4.5 日志配置"></a>4.5 日志配置</h2><p>刚搭建的web项目或者没有明确需要调用日志的系统，一般我们直接使用python提供的longging模块来配置日志功能即可。如果类似游戏或者需要对日志进行分析的系统，则一般在服务器中配置ELK日志分析系统的。</p><p>对于在django中配置的日志，那么django是没有自己实现日志功能的，而是调用了python解析器提供的日志模块loggings模块。所以，我们在settings/dev.py文件中追加如下配置：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 日志配置</span></span><br><span class="line">LOGGING = &#123;</span><br><span class="line">    <span class="string">'version'</span>: <span class="number">1</span>,</span><br><span class="line">    <span class="string">'disable_existing_loggers'</span>: <span class="literal">False</span>,</span><br><span class="line">    <span class="string">'formatters'</span>: &#123; <span class="comment"># 日志的处理格式</span></span><br><span class="line">        <span class="string">'verbose'</span>: &#123;</span><br><span class="line">            <span class="string">'format'</span>: <span class="string">'%(levelname)s %(asctime)s %(module)s %(lineno)d %(message)s'</span></span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="string">'simple'</span>: &#123;</span><br><span class="line">            <span class="string">'format'</span>: <span class="string">'%(levelname)s %(module)s %(lineno)d %(message)s'</span></span><br><span class="line">        &#125;,</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="string">'filters'</span>: &#123;</span><br><span class="line">        <span class="string">'require_debug_true'</span>: &#123;</span><br><span class="line">            <span class="string">'()'</span>: <span class="string">'django.utils.log.RequireDebugTrue'</span>,</span><br><span class="line">        &#125;,</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="string">'handlers'</span>: &#123;</span><br><span class="line">        <span class="string">'console'</span>: &#123;</span><br><span class="line">            <span class="string">'level'</span>: <span class="string">'DEBUG'</span>,</span><br><span class="line">            <span class="string">'filters'</span>: [<span class="string">'require_debug_true'</span>],</span><br><span class="line">            <span class="string">'class'</span>: <span class="string">'logging.StreamHandler'</span>,</span><br><span class="line">            <span class="string">'formatter'</span>: <span class="string">'simple'</span></span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="string">'file'</span>: &#123;</span><br><span class="line">            <span class="string">'level'</span>: <span class="string">'INFO'</span>,</span><br><span class="line">            <span class="string">'class'</span>: <span class="string">'logging.handlers.RotatingFileHandler'</span>,</span><br><span class="line">            <span class="comment"># 日志位置,日志文件名,日志保存目录必须手动创建</span></span><br><span class="line">            <span class="string">'filename'</span>: os.path.join(os.path.dirname(BASE_DIR), <span class="string">"logs/renran.log"</span>),</span><br><span class="line">            <span class="comment"># 单个日志文件的最大值,这里我们设置300M</span></span><br><span class="line">            <span class="string">'maxBytes'</span>: <span class="number">300</span> * <span class="number">1024</span> * <span class="number">1024</span>,</span><br><span class="line">            <span class="comment"># 备份日志文件的数量,设置最大日志数量为10</span></span><br><span class="line">            <span class="string">'backupCount'</span>: <span class="number">10</span>,</span><br><span class="line">            <span class="comment"># 日志格式:详细格式</span></span><br><span class="line">            <span class="string">'formatter'</span>: <span class="string">'verbose'</span></span><br><span class="line">        &#125;,</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="comment"># 日志对象</span></span><br><span class="line">    <span class="string">'loggers'</span>: &#123;</span><br><span class="line">        <span class="string">'django'</span>: &#123; <span class="comment"># 固定，将来django内部也会有异常的处理，只会调用django下标的日志对象</span></span><br><span class="line">            <span class="string">'handlers'</span>: [<span class="string">'console'</span>, <span class="string">'file'</span>],</span><br><span class="line">            <span class="string">'propagate'</span>: <span class="literal">True</span>, <span class="comment"># 是否让日志信息继续冒泡给其他的日志处理系统</span></span><br><span class="line">        &#125;,</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="4-6-异常处理"><a href="#4-6-异常处理" class="headerlink" title="4.6 异常处理"></a>4.6 异常处理</h2><p>新建utils/exceptions.py</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> rest_framework.views <span class="keyword">import</span> exception_handler</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> django.db <span class="keyword">import</span> DatabaseError</span><br><span class="line"><span class="keyword">from</span> rest_framework.response <span class="keyword">import</span> Response</span><br><span class="line"><span class="keyword">from</span> rest_framework <span class="keyword">import</span> status</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> logging</span><br><span class="line">logger = logging.getLogger(<span class="string">'django'</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">custom_exception_handler</span><span class="params">(exc, context)</span>:</span></span><br><span class="line">    <span class="string">"""</span></span><br><span class="line"><span class="string">    自定义异常处理</span></span><br><span class="line"><span class="string">    :param exc: 异常类</span></span><br><span class="line"><span class="string">    :param context: 抛出异常的上下文</span></span><br><span class="line"><span class="string">    :return: Response响应对象</span></span><br><span class="line"><span class="string">    """</span></span><br><span class="line">    <span class="comment"># 调用drf框架原生的异常处理方法</span></span><br><span class="line">    response = exception_handler(exc, context)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> response <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">        view = context[<span class="string">'view'</span>]</span><br><span class="line">        <span class="keyword">if</span> isinstance(exc, DatabaseError):</span><br><span class="line">            <span class="comment"># 数据库异常</span></span><br><span class="line">            logger.error(<span class="string">'[%s] %s'</span> % (view, exc))</span><br><span class="line">            response = Response(&#123;<span class="string">'message'</span>: <span class="string">'服务器内部错误'</span>&#125;, status=status.HTTP_507_INSUFFICIENT_STORAGE)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> response</span><br></pre></td></tr></table></figure><p>settings/dev.py配置文件中添加</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">REST_FRAMEWORK &#x3D; &#123;</span><br><span class="line">    # 异常处理</span><br><span class="line">    &#39;EXCEPTION_HANDLER&#39;: &#39;renranapi.utils.exceptions.custom_exception_handler&#39;,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="4-7-创建数据库"><a href="#4-7-创建数据库" class="headerlink" title="4.7 创建数据库"></a>4.7 创建数据库</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">create database renran default charset=utf8mb4;</span><br></pre></td></tr></table></figure><p>为当前项目创建数据库用户[这个用户只能看到这个数据库]</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># create user 用户名 identified by '登录密码';       # 创建用户</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># grant 权限 on 数据库名.表名 to '用户名'@'登录主机';   # 赋予权限给用户</span></span><br><span class="line"><span class="comment"># * 可以表示任意数据库，也可以表示任意表，也可以表示任意登录主机</span></span><br><span class="line"><span class="comment"># all privileges 表示所有权限，也可以设置 单个权限或多个权限</span></span><br><span class="line"><span class="comment"># grant select,insert,update,delete on ....  # 只赋予增删查改的权限</span></span><br><span class="line"><span class="comment"># grant select on ...   # 只赋予查询权限</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># flush privileges;                                # 刷新权限</span></span><br><span class="line"></span><br><span class="line">create user renran_user identified by <span class="string">'renran'</span>;</span><br><span class="line">grant all privileges on renran.* to <span class="string">'renran_user'</span>@<span class="string">'*'</span>;</span><br><span class="line">flush privileges;</span><br></pre></td></tr></table></figure><h2 id="4-8-配置数据库连接"><a href="#4-8-配置数据库连接" class="headerlink" title="4.8 配置数据库连接"></a>4.8 配置数据库连接</h2><p>打开settings/dev.py文件，并配置</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">DATABASES = &#123;</span><br><span class="line">    <span class="string">"default"</span>: &#123;</span><br><span class="line">        <span class="string">"ENGINE"</span>: <span class="string">"django.db.backends.mysql"</span>,</span><br><span class="line">        <span class="string">"HOST"</span>: <span class="string">"127.0.0.1"</span>,</span><br><span class="line">        <span class="string">"PORT"</span>: <span class="number">3306</span>,</span><br><span class="line">        <span class="string">"USER"</span>: <span class="string">"renran_user"</span>,</span><br><span class="line">        <span class="string">"PASSWORD"</span>: <span class="string">"renran"</span>,</span><br><span class="line">        <span class="string">"NAME"</span>: <span class="string">"renran"</span>,</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>在项目主模块的 <code>__init__.py</code>中导入pymysql</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pymysqlpymysql.install_as_MySQLdb()</span><br></pre></td></tr></table></figure><h3 id="调整错误"><a href="#调整错误" class="headerlink" title="调整错误"></a>调整错误</h3><p>数据库版本检测导致的错误</p><p><img src="/images/1557453985484.png" alt="1557453985484.png"></p><p>数据库的版本检测代码注释掉。</p><p><img src="/images/1557454099123.png" alt="1557454099123.png"></p><p>因为python3版本的原因，字符串的编码问题</p><p><img src="/images/1557454044879.png" alt="1557454044879.png"></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">把<span class="number">146</span>的代码从下面改动query = query.decode(errors=<span class="string">'replace'</span>)改成：query = query.encode(errors=<span class="string">'replace'</span>)</span><br></pre></td></tr></table></figure><h1 id="5-搭建前端项目"><a href="#5-搭建前端项目" class="headerlink" title="5. 搭建前端项目"></a>5. 搭建前端项目</h1><h2 id="5-1-创建项目目录"><a href="#5-1-创建项目目录" class="headerlink" title="5.1 创建项目目录"></a>5.1 创建项目目录</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> 项目根目录vue init webpack 客户端项目目录</span><br></pre></td></tr></table></figure><p>例如，我要把项目保存在~/Desktop桌面目录下，可以如下操作：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> ~/Desktop/renranvue init webpack renran_pc</span><br></pre></td></tr></table></figure><p>把vue项目构建好了，运行测试服务器。</p><blockquote><p>接下来，在ubuntu使用pycharm同时通过2个窗口打开项目，一般先打开前端项目，再打开服务端项目，否则可能出现卡死的情况，此时可以先通过终端黑窗口执行以下命令，关闭pycharm，再重新先打开前端项目，接着打开后端项目。ps aux | grep pycharm # 查看系统所有的进程ID，搜索出pycharmkill -9 5794 # 关闭指定进程ID对应的服务。</p></blockquote><p><img src="/images/1557451125218.png" alt="1557451125218.png"></p><p>打开项目已经，在pycharm的终端下运行vue项目，查看效果。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm run dev</span><br></pre></td></tr></table></figure><p>接下来，我们根据终端上效果显示的对应地址来访问项目(如果有多个vue项目在运行，8080端口被占据了，服务器会自动改端口，所以根据自己实际在操作中看到的地址来访问。)</p><p>访问：<a href="http://locahost:8080。效果：">http://locahost:8080。效果：</a></p><p><img src="/images/1557451188340.png" alt="1557451188340.png"></p><p>我们也可以把我们的前端项目进行git源代码管理</p><h2 id="5-2-初始化前端项目"><a href="#5-2-初始化前端项目" class="headerlink" title="5.2 初始化前端项目"></a>5.2 初始化前端项目</h2><p>清除默认的HelloWorld组件和APP.vue中的默认样式</p><p><img src="/images/1557451289161.png" alt="1557451289161.png"></p><p>接下来，我们可以查看效果了，一张白纸~</p><p><img src="/images/1557451300406.png" alt="1557451300406.png"></p><h2 id="5-3-安装路由vue-router"><a href="#5-3-安装路由vue-router" class="headerlink" title="5.3 安装路由vue-router"></a>5.3 安装路由vue-router</h2><h3 id="5-3-1-下载路由组件"><a href="#5-3-1-下载路由组件" class="headerlink" title="5.3.1 下载路由组件"></a>5.3.1 下载路由组件</h3><p>如果前面没有选择安装vue-router，则使用以下命令安装路由组件：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i vue-router -S</span><br></pre></td></tr></table></figure><p>执行效果：</p><p><img src="/images/1557451350882.png" alt="1557451350882.png"></p><h3 id="5-3-2-配置路由"><a href="#5-3-2-配置路由" class="headerlink" title="5.3.2 配置路由"></a>5.3.2 配置路由</h3><h3 id="5-3-2-1-初始化路由对象"><a href="#5-3-2-1-初始化路由对象" class="headerlink" title="5.3.2.1 初始化路由对象"></a>5.3.2.1 初始化路由对象</h3><p>在src目录下创建router路由目录，在router目录下创建index.js路由文件</p><p>index.js路由文件中，编写初始化路由对象的代码 .</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> Vue <span class="keyword">from</span> <span class="string">"vue"</span></span><br><span class="line"><span class="keyword">import</span> Router <span class="keyword">from</span> <span class="string">"vue-router"</span></span><br><span class="line"></span><br><span class="line">// 这里导入可以让让用户访问的组件</span><br><span class="line"></span><br><span class="line">Vue.use(Router);</span><br><span class="line"></span><br><span class="line">export default new Router(&#123;</span><br><span class="line">  // 设置路由模式为‘history’，去掉默认的<span class="comment">#</span></span><br><span class="line">  mode: <span class="string">"history"</span>,</span><br><span class="line">  routes:[</span><br><span class="line">    // 路由列表</span><br><span class="line">    &#123;</span><br><span class="line">      path: <span class="string">'/'</span>,</span><br><span class="line">    &#125;</span><br><span class="line">  ]</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p><img src="/images/1557451480681.png" alt="1557451480681.png"></p><h3 id="5-3-2-2-注册路由信息"><a href="#5-3-2-2-注册路由信息" class="headerlink" title="5.3.2.2 注册路由信息"></a>5.3.2.2 注册路由信息</h3><p>打开main.js文件，把router对象注册到vue中.代码：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">// The Vue build version to load <span class="keyword">with</span> the `<span class="keyword">import</span>` command</span><br><span class="line">// (runtime-only <span class="keyword">or</span> standalone) has been set <span class="keyword">in</span> webpack.base.conf <span class="keyword">with</span> an alias.</span><br><span class="line"><span class="keyword">import</span> Vue <span class="keyword">from</span> <span class="string">'vue'</span></span><br><span class="line"><span class="keyword">import</span> App <span class="keyword">from</span> <span class="string">'./App'</span></span><br><span class="line"><span class="keyword">import</span> router <span class="keyword">from</span> <span class="string">'./routers/index'</span>;</span><br><span class="line"></span><br><span class="line">Vue.config.productionTip = false</span><br><span class="line"></span><br><span class="line">/* eslint-disable no-new */</span><br><span class="line">new Vue(&#123;</span><br><span class="line">  el: <span class="string">'#app'</span>,</span><br><span class="line">  router,</span><br><span class="line">  components: &#123; App &#125;,</span><br><span class="line">  template: <span class="string">'&lt;App/&gt;'</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p><img src="/images/1557451533378.png" alt="1557451533378.png"></p><h3 id="5-3-2-3-在视图中显示路由对应的内容"><a href="#5-3-2-3-在视图中显示路由对应的内容" class="headerlink" title="5.3.2.3 在视图中显示路由对应的内容"></a>5.3.2.3 在视图中显示路由对应的内容</h3><p>在App.vue组件中，添加显示路由对应的内容。</p><p><img src="/images/1557451572377.png" alt="1557451572377.png"></p><p>代码：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div id&#x3D;&quot;app&quot;&gt;</span><br><span class="line">    &lt;router-view&#x2F;&gt;</span><br><span class="line">  &lt;&#x2F;div&gt;</span><br><span class="line">&lt;&#x2F;template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">export default &#123;</span><br><span class="line">  name: &#39;App&#39;,</span><br><span class="line">  components: &#123;</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;&#x2F;script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style&gt;</span><br><span class="line"></span><br><span class="line">&lt;&#x2F;style&gt;</span><br></pre></td></tr></table></figure><h3 id="5-3-2-4-创建并提供前端首页的组件"><a href="#5-3-2-4-创建并提供前端首页的组件" class="headerlink" title="5.3.2.4 创建并提供前端首页的组件"></a>5.3.2.4 创建并提供前端首页的组件</h3><p>routers/index.js</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">// <span class="keyword">import</span> Vue <span class="keyword">from</span> <span class="string">"vue"</span></span><br><span class="line">// <span class="keyword">import</span> Router <span class="keyword">from</span> <span class="string">"vue-router"</span></span><br><span class="line">//</span><br><span class="line">//</span><br><span class="line">// // 这里导入可以让让用户访问的组件</span><br><span class="line"><span class="keyword">import</span> Home <span class="keyword">from</span> <span class="string">"../components/Home"</span></span><br><span class="line">// Vue.use(Router);</span><br><span class="line">//</span><br><span class="line">// export default new Router(&#123;</span><br><span class="line">//   // 设置路由模式为‘history’，去掉默认的<span class="comment">#</span></span><br><span class="line">//   mode: <span class="string">"history"</span>,</span><br><span class="line">//   routes:[</span><br><span class="line">//     // 路由列表</span><br><span class="line">     &#123;</span><br><span class="line">       name:<span class="string">"Home"</span>,</span><br><span class="line">       path:<span class="string">"/"</span>,</span><br><span class="line">       component:Home,</span><br><span class="line">     &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">       name:<span class="string">"Home"</span>,</span><br><span class="line">       path:<span class="string">"/home"</span>,</span><br><span class="line">       component:Home,</span><br><span class="line">     &#125;,</span><br><span class="line">   ]</span><br><span class="line">// &#125;)</span><br></pre></td></tr></table></figure><h3 id="创建Home组件"><a href="#创建Home组件" class="headerlink" title="创建Home组件"></a>创建Home组件</h3><p>components/Home.vue</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div id=<span class="string">"home"</span>&gt;</span><br><span class="line">    前端首页</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line">&lt;script&gt;</span><br><span class="line">  export default &#123;</span><br><span class="line">      name:<span class="string">"Home"</span>,</span><br><span class="line">      data()&#123;</span><br><span class="line">          <span class="keyword">return</span> &#123;</span><br><span class="line">              </span><br><span class="line">          &#125;</span><br><span class="line">      &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style scoped&gt;</span><br><span class="line"></span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure><p><img src="/images/1557451775965.png" alt="1557451775965.png"></p><p>1557451775965</p><h2 id="5-4-前端初始化全局变量和全局方法"><a href="#5-4-前端初始化全局变量和全局方法" class="headerlink" title="5.4 前端初始化全局变量和全局方法"></a>5.4 前端初始化全局变量和全局方法</h2><p>在src目录下创建settings.js站点开发配置文件：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">export default &#123;</span><br><span class="line">  Host:<span class="string">"http://127.0.0.1"</span>,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>在main.js中引入</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">// // The Vue build version to load <span class="keyword">with</span> the `<span class="keyword">import</span>` command</span><br><span class="line">// // (runtime-only <span class="keyword">or</span> standalone) has been set <span class="keyword">in</span> webpack.base.conf <span class="keyword">with</span> an alias.</span><br><span class="line">// <span class="keyword">import</span> Vue <span class="keyword">from</span> <span class="string">'vue'</span></span><br><span class="line">// <span class="keyword">import</span> App <span class="keyword">from</span> <span class="string">'./App'</span></span><br><span class="line">// <span class="keyword">import</span> router <span class="keyword">from</span> <span class="string">'./routers/index'</span>;</span><br><span class="line"><span class="keyword">import</span> settings <span class="keyword">from</span> <span class="string">"./settings"</span></span><br><span class="line">// Vue.config.productionTip = false;</span><br><span class="line">Vue.prototype.$settings = settings;</span><br><span class="line">//</span><br><span class="line">// /* eslint-disable no-new */</span><br><span class="line">// new Vue(&#123;</span><br><span class="line">//   el: <span class="string">'#app'</span>,</span><br><span class="line">//   router,</span><br><span class="line">//   components: &#123; App &#125;,</span><br><span class="line">//   template: <span class="string">'&lt;App/&gt;'</span></span><br><span class="line">// &#125;);</span><br></pre></td></tr></table></figure><h2 id="5-5-引入ElementUI"><a href="#5-5-引入ElementUI" class="headerlink" title="5.5 引入ElementUI"></a>5.5 引入ElementUI</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i element-ui -S</span><br></pre></td></tr></table></figure><p>上面的命令等同于</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install element-ui --save</span><br></pre></td></tr></table></figure><p>执行命令效果：</p><p><img src="/images/1557452146253.png" alt="1557452146253.png"></p><h3 id="5-5-1-配置ElementUI到项目中"><a href="#5-5-1-配置ElementUI到项目中" class="headerlink" title="5.5.1 配置ElementUI到项目中"></a>5.5.1 配置ElementUI到项目中</h3><p>在main.js中导入ElementUI，并调用。</p><p>代码：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">// The Vue build version to load <span class="keyword">with</span> the `<span class="keyword">import</span>` command</span><br><span class="line">// (runtime-only <span class="keyword">or</span> standalone) has been set <span class="keyword">in</span> webpack.base.conf <span class="keyword">with</span> an alias.</span><br><span class="line">// <span class="keyword">import</span> Vue <span class="keyword">from</span> <span class="string">'vue'</span></span><br><span class="line">// <span class="keyword">import</span> App <span class="keyword">from</span> <span class="string">'./App'</span></span><br><span class="line">// <span class="keyword">import</span> router <span class="keyword">from</span> <span class="string">'./routers/index'</span>;</span><br><span class="line"></span><br><span class="line">// 开发配置文件</span><br><span class="line">// <span class="keyword">import</span> settings <span class="keyword">from</span> <span class="string">"./settings"</span></span><br><span class="line">// Vue.prototype.$settings = settings;</span><br><span class="line"></span><br><span class="line">// elementUI 导入</span><br><span class="line"><span class="keyword">import</span> ElementUI <span class="keyword">from</span> <span class="string">'element-ui'</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="string">"element-ui/lib/theme-chalk/index.css"</span>;</span><br><span class="line">// 调用插件</span><br><span class="line">Vue.use(ElementUI);</span><br><span class="line"></span><br><span class="line">// Vue.config.productionTip = false;</span><br><span class="line"></span><br><span class="line">/* eslint-disable no-new */</span><br><span class="line">// new Vue(&#123;</span><br><span class="line">//   el: <span class="string">'#app'</span>,</span><br><span class="line">//   router,</span><br><span class="line">//   components: &#123; App &#125;,</span><br><span class="line">//   template: <span class="string">'&lt;App/&gt;'</span></span><br><span class="line">// &#125;);</span><br></pre></td></tr></table></figure><p>效果：</p><p><img src="/images/1557452192638.png" alt="1557452192638.png"></p><p>重新项目，如果出现Error，关于.gitkeep，则直接删除这个文件即可。</p><p>成功引入了ElementUI以后，接下来我们就可以开始进入前端页面开发，首先是首页。</p><p>接下来我们把之前完成的首页，直接拿过来使用[注意除了组件以外,还有静态文件也需要拿过来,包括App.vue里面的公共样式]，并运行项目。</p><p>创建static/css/reset.css，全局css初始化代码</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">body</span>,<span class="selector-tag">h1</span>,<span class="selector-tag">h2</span>,<span class="selector-tag">h3</span>,<span class="selector-tag">h4</span>,<span class="selector-tag">h5</span>,<span class="selector-tag">ul</span>,<span class="selector-tag">p</span>&#123;</span><br><span class="line">    <span class="attribute">padding</span>: <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">margin</span>:<span class="number">0</span>;</span><br><span class="line">    <span class="attribute">font-weight</span>: normal;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="selector-tag">body</span>&#123;</span><br><span class="line">    <span class="attribute">margin-top</span>: <span class="number">80px</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="selector-tag">a</span>&#123;</span><br><span class="line">    <span class="attribute">text-decoration</span>: none;</span><br><span class="line">    <span class="attribute">color</span>: <span class="number">#4a4a4a</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="selector-tag">a</span><span class="selector-pseudo">:hover</span>&#123;</span><br><span class="line">    <span class="attribute">color</span>: <span class="number">#000</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="selector-tag">input</span>&#123;</span><br><span class="line">    <span class="attribute">outline</span>: none;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="selector-tag">ul</span>&#123;</span><br><span class="line">    <span class="attribute">list-style</span>: none;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="selector-tag">img</span>&#123;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="selector-class">.header</span> <span class="selector-class">.el-menu</span> <span class="selector-tag">li</span> <span class="selector-class">.el-submenu__title</span>&#123;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">26px</span><span class="meta">!important</span>;</span><br><span class="line">    <span class="attribute">line-height</span>: <span class="number">26px</span><span class="meta">!important</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="selector-class">.el-menu--popup</span>&#123;</span><br><span class="line">    <span class="attribute">min-width</span>: <span class="number">140px</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="selector-class">.el-checkbox__inner</span>&#123;</span><br><span class="line">    <span class="attribute">width</span>:<span class="number">16px</span>;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">16px</span>;</span><br><span class="line">    <span class="attribute">border</span>: <span class="number">1px</span> solid <span class="number">#999</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="selector-class">.el-checkbox__inner</span><span class="selector-pseudo">:after</span>&#123;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">6px</span>;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">8px</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="selector-class">.el-form-item__content</span>&#123;</span><br><span class="line">    <span class="attribute">margin-left</span>:<span class="number">0px</span><span class="meta">!important</span>;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">50px</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="selector-class">.full-left</span>&#123;</span><br><span class="line">    <span class="attribute">float</span>: left;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="selector-class">.full-right</span>&#123;</span><br><span class="line">    <span class="attribute">float</span>: right;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure><p>main.js</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">// 引入初始化样式<span class="keyword">import</span> <span class="string">"../static/css/reset.css"</span>;</span><br></pre></td></tr></table></figure><p>Home.vue中添加代码：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"home"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">Header</span>&gt;</span><span class="tag">&lt;/<span class="name">Header</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"container"</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"row"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"main"</span>&gt;</span></span><br><span class="line">          <span class="comment">&lt;!-- Banner --&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"banner"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">el-carousel</span> <span class="attr">height</span>=<span class="string">"272px"</span> <span class="attr">indicator-position</span>=<span class="string">"none"</span> <span class="attr">interval</span>=<span class="string">"2000"</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">el-carousel-item</span> <span class="attr">v-for</span>=<span class="string">"item in 4"</span> <span class="attr">:key</span>=<span class="string">"item"</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">h3</span> <span class="attr">class</span>=<span class="string">"small"</span>&gt;</span>&#123;&#123; item &#125;&#125;<span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;/<span class="name">el-carousel-item</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">el-carousel</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"list-container"</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!-- 文章列表模块 --&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">ul</span> <span class="attr">class</span>=<span class="string">"note-list"</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">li</span> <span class="attr">class</span>=<span class="string">""</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"content"</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">a</span> <span class="attr">class</span>=<span class="string">"title"</span> <span class="attr">target</span>=<span class="string">"_blank"</span> <span class="attr">href</span>=<span class="string">""</span>&gt;</span>常做此运动，让你性福加倍<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">p</span> <span class="attr">class</span>=<span class="string">"abstract"</span>&gt;</span>运动，是人类在发展过程中有意识地对自己身体素质的培养的各种活动 运动的方式多种多样 不仅仅是我们常知的跑步，球类，游泳等 今天就为大家介绍一种男...<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"meta"</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"jsd-meta"</span>&gt;</span></span><br><span class="line">                      <span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">"/static/image/paid1.svg"</span> <span class="attr">alt</span>=<span class="string">""</span>&gt;</span> 4.8</span><br><span class="line">                    <span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">a</span> <span class="attr">class</span>=<span class="string">"nickname"</span> <span class="attr">target</span>=<span class="string">"_blank"</span> <span class="attr">href</span>=<span class="string">""</span>&gt;</span>上班族也健身<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">a</span> <span class="attr">target</span>=<span class="string">"_blank"</span> <span class="attr">href</span>=<span class="string">""</span>&gt;</span></span><br><span class="line">                      <span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">"/static/image/comment.svg"</span> <span class="attr">alt</span>=<span class="string">""</span>&gt;</span> 4</span><br><span class="line">                    <span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span>&gt;</span><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">"/static/image/like.svg"</span> <span class="attr">alt</span>=<span class="string">""</span>&gt;</span> 31<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">li</span> <span class="attr">class</span>=<span class="string">"have-img"</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">a</span> <span class="attr">class</span>=<span class="string">"wrap-img"</span> <span class="attr">href</span>=<span class="string">""</span> <span class="attr">target</span>=<span class="string">"_blank"</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">img</span> <span class="attr">class</span>=<span class="string">"img-blur-done"</span> <span class="attr">src</span>=<span class="string">"/static/image/10907624-107943365323e5b9.jpeg"</span> /&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"content"</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">a</span> <span class="attr">class</span>=<span class="string">"title"</span> <span class="attr">target</span>=<span class="string">"_blank"</span> <span class="attr">href</span>=<span class="string">""</span>&gt;</span>“不耻下问”，正在毁掉你的人生<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">p</span> <span class="attr">class</span>=<span class="string">"abstract"</span>&gt;</span></span><br><span class="line">                    在过去，遇到不懂的问题，你不耻下问，找个人问问就行；在现在，如果你还这么干，多半会被认为是“搜商低”。 昨天，35岁的表姐把我拉黑了。 表姐是医...</span><br><span class="line">                  <span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"meta"</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"jsd-meta"</span>&gt;</span></span><br><span class="line">                      <span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">"/static/image/paid1.svg"</span> <span class="attr">alt</span>=<span class="string">""</span>&gt;</span> 6.7</span><br><span class="line">                    <span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">a</span> <span class="attr">class</span>=<span class="string">"nickname"</span> <span class="attr">target</span>=<span class="string">"_blank"</span> <span class="attr">href</span>=<span class="string">""</span>&gt;</span>_飞鱼<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">a</span> <span class="attr">target</span>=<span class="string">"_blank"</span> <span class="attr">href</span>=<span class="string">""</span>&gt;</span></span><br><span class="line">                      <span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">"/static/image/comment.svg"</span> <span class="attr">alt</span>=<span class="string">""</span>&gt;</span> 33</span><br><span class="line">                    <span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span>&gt;</span><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">"/static/image/like.svg"</span> <span class="attr">alt</span>=<span class="string">""</span>&gt;</span> 113<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span>&gt;</span><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">"/static/image/shang.svg"</span> <span class="attr">alt</span>=<span class="string">""</span>&gt;</span> 2<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!-- 文章列表模块 --&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">""</span> <span class="attr">class</span>=<span class="string">"load-more"</span>&gt;</span>阅读更多<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"aside"</span>&gt;</span></span><br><span class="line">          <span class="comment">&lt;!-- 推荐作者 --&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"recommended-author-wrap"</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!----&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"recommended-authors"</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"title"</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">span</span>&gt;</span>推荐作者<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">a</span> <span class="attr">class</span>=<span class="string">"page-change"</span>&gt;</span><span class="tag">&lt;<span class="name">img</span> <span class="attr">class</span>=<span class="string">"icon-change"</span> <span class="attr">src</span>=<span class="string">"/static/image/exchange-rate.svg"</span> <span class="attr">alt</span>=<span class="string">""</span>&gt;</span>换一批<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">ul</span> <span class="attr">class</span>=<span class="string">"list"</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">""</span> <span class="attr">target</span>=<span class="string">"_blank"</span> <span class="attr">class</span>=<span class="string">"avatar"</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">"/static/image/avatar.webp"</span> /&gt;</span></span><br><span class="line">                  <span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">a</span> <span class="attr">class</span>=<span class="string">"follow"</span> <span class="attr">state</span>=<span class="string">"0"</span>&gt;</span><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">"/static/image/follow.svg"</span> <span class="attr">alt</span>=<span class="string">""</span> /&gt;</span>关注<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">""</span> <span class="attr">target</span>=<span class="string">"_blank"</span> <span class="attr">class</span>=<span class="string">"name"</span>&gt;</span>董克平日记<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">p</span>&gt;</span>写了807.1k字 · 2.5k喜欢<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">""</span> <span class="attr">target</span>=<span class="string">"_blank"</span> <span class="attr">class</span>=<span class="string">"avatar"</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">"/static/image/avatar.webp"</span> /&gt;</span></span><br><span class="line">                  <span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">a</span> <span class="attr">class</span>=<span class="string">"follow"</span> <span class="attr">state</span>=<span class="string">"0"</span>&gt;</span><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">"/static/image/follow.svg"</span> <span class="attr">alt</span>=<span class="string">""</span> /&gt;</span>关注<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">""</span> <span class="attr">target</span>=<span class="string">"_blank"</span> <span class="attr">class</span>=<span class="string">"name"</span>&gt;</span>董克平日记<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">p</span>&gt;</span>写了807.1k字 · 2.5k喜欢<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line"></span><br><span class="line">              <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">""</span> <span class="attr">target</span>=<span class="string">"_blank"</span> <span class="attr">class</span>=<span class="string">"find-more"</span>&gt;</span>查看全部 &gt;<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">              <span class="comment">&lt;!----&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">Footer</span>&gt;</span><span class="tag">&lt;/<span class="name">Footer</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript">  <span class="keyword">import</span> Header <span class="keyword">from</span> <span class="string">"./common/Header"</span>;</span></span><br><span class="line"><span class="javascript">  <span class="keyword">import</span> Footer <span class="keyword">from</span> <span class="string">"./common/Footer"</span>;</span></span><br><span class="line"><span class="javascript">  <span class="keyword">export</span> <span class="keyword">default</span> &#123;</span></span><br><span class="line"><span class="actionscript">      name:<span class="string">"Home"</span>,</span></span><br><span class="line">      data()&#123;</span><br><span class="line"><span class="actionscript">          <span class="keyword">return</span> &#123;</span></span><br><span class="line"></span><br><span class="line">          &#125;</span><br><span class="line">      &#125;,</span><br><span class="line">      components:&#123;</span><br><span class="line">        Header,</span><br><span class="line">        Footer,</span><br><span class="line">      &#125;</span><br><span class="line">  &#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span> <span class="attr">scoped</span>&gt;</span></span><br><span class="line"><span class="css"><span class="selector-class">.container</span>&#123;</span></span><br><span class="line">    width: 960px;</span><br><span class="line">    margin-right: auto;</span><br><span class="line">    margin-left: auto;</span><br><span class="line">    padding-left: 15px;</span><br><span class="line">    padding-right: 15px;</span><br><span class="line">    box-sizing: border-box;</span><br><span class="line">&#125;</span><br><span class="line"><span class="css"><span class="selector-class">.container</span><span class="selector-pseudo">:after</span>, <span class="selector-class">.container</span><span class="selector-pseudo">:before</span> &#123;</span></span><br><span class="line">    content: " ";</span><br><span class="line">    display: table;</span><br><span class="line">&#125;</span><br><span class="line"><span class="css"><span class="selector-class">.row</span> &#123;</span></span><br><span class="line">    margin-left: -15px;</span><br><span class="line">    margin-right: -15px;</span><br><span class="line">&#125;</span><br><span class="line"><span class="css"><span class="selector-class">.row</span><span class="selector-pseudo">:after</span>, <span class="selector-class">.row</span><span class="selector-pseudo">:before</span> &#123;</span></span><br><span class="line">    content: " ";</span><br><span class="line">    display: table;</span><br><span class="line">&#125;</span><br><span class="line"><span class="css"><span class="selector-class">.main</span> &#123;</span></span><br><span class="line">    padding-top: 30px;</span><br><span class="line">    padding-right: 0;</span><br><span class="line">    position: relative;</span><br><span class="line">    min-height: 1px;</span><br><span class="line">    padding-left: 15px;</span><br><span class="line"><span class="css">    <span class="selector-tag">width</span>: 66<span class="selector-class">.66667</span>%;</span></span><br><span class="line">    float: left;</span><br><span class="line">    box-sizing: border-box;</span><br><span class="line">&#125;</span><br><span class="line"><span class="css"><span class="selector-class">.main</span> <span class="selector-class">.banner</span>&#123;</span></span><br><span class="line">    width: 640px;</span><br><span class="line">    height: 272px;</span><br><span class="line">&#125;</span><br><span class="line"><span class="css"><span class="selector-class">.note-list</span> &#123;</span></span><br><span class="line">    margin: 0;</span><br><span class="line">    padding: 0;</span><br><span class="line">    list-style: none;</span><br><span class="line">&#125;</span><br><span class="line"><span class="css"><span class="selector-class">.note-list</span> <span class="selector-tag">li</span> &#123;</span></span><br><span class="line">    position: relative;</span><br><span class="line">    width: 100%;</span><br><span class="line">    margin: 0 0 15px;</span><br><span class="line">    padding: 15px 2px 20px 0;</span><br><span class="line"><span class="css">    <span class="selector-tag">border-bottom</span>: 1<span class="selector-tag">px</span> <span class="selector-tag">solid</span> <span class="selector-id">#f0f0f0</span>;</span></span><br><span class="line">    word-wrap: break-word;</span><br><span class="line">    line-height: 20px;</span><br><span class="line">&#125;</span><br><span class="line"><span class="css"><span class="selector-class">.note-list</span> <span class="selector-tag">li</span><span class="selector-class">.have-img</span> &#123;</span></span><br><span class="line">    min-height: 140px;</span><br><span class="line">&#125;</span><br><span class="line"><span class="css"><span class="selector-class">.note-list</span> <span class="selector-class">.have-img</span> <span class="selector-class">.wrap-img</span> &#123;</span></span><br><span class="line">    position: absolute;</span><br><span class="line">    top: 50%;</span><br><span class="line">    margin-top: -60px;</span><br><span class="line">    right: 0;</span><br><span class="line">    width: 150px;</span><br><span class="line">    height: 100px;</span><br><span class="line">&#125;</span><br><span class="line"><span class="css"><span class="selector-class">.note-list</span> <span class="selector-class">.have-img</span> <span class="selector-class">.wrap-img</span> <span class="selector-tag">img</span> &#123;</span></span><br><span class="line">    width: 100%;</span><br><span class="line">    height: 100%;</span><br><span class="line">    border-radius: 4px;</span><br><span class="line"><span class="css">    <span class="selector-tag">border</span>: 1<span class="selector-tag">px</span> <span class="selector-tag">solid</span> <span class="selector-id">#f0f0f0</span>;</span></span><br><span class="line">    vertical-align: middle;</span><br><span class="line">&#125;</span><br><span class="line"><span class="css"><span class="selector-class">.main</span> <span class="selector-class">.note-list</span> <span class="selector-class">.have-img</span> <span class="selector-class">.content</span> &#123;</span></span><br><span class="line">    padding-right: 165px;</span><br><span class="line">    box-sizing: border-box;</span><br><span class="line">&#125;</span><br><span class="line"><span class="css"><span class="selector-class">.note-list</span> <span class="selector-class">.title</span> &#123;</span></span><br><span class="line">    margin: -7px 0 4px;</span><br><span class="line">    display: inherit;</span><br><span class="line">    font-size: 18px;</span><br><span class="line">    font-weight: 700;</span><br><span class="line"><span class="css">    <span class="selector-tag">line-height</span>: 1<span class="selector-class">.5</span>;</span></span><br><span class="line"><span class="css">    <span class="selector-tag">color</span>: <span class="selector-id">#333</span>;</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="css"><span class="selector-class">.note-list</span> <span class="selector-class">.title</span><span class="selector-pseudo">:hover</span>&#123;</span></span><br><span class="line">    text-decoration: underline;</span><br><span class="line">&#125;</span><br><span class="line"><span class="css"><span class="selector-class">.note-list</span> <span class="selector-class">.abstract</span> &#123;</span></span><br><span class="line">    margin: 0 0 8px;</span><br><span class="line">    font-size: 13px;</span><br><span class="line">    line-height: 24px;</span><br><span class="line"><span class="css">    <span class="selector-tag">color</span>: <span class="selector-id">#999</span>;</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="css"><span class="selector-class">.note-list</span> <span class="selector-class">.meta</span> &#123;</span></span><br><span class="line">    padding-right: 0!important;</span><br><span class="line">    font-size: 12px;</span><br><span class="line">    font-weight: 400;</span><br><span class="line">    line-height: 20px;</span><br><span class="line">&#125;</span><br><span class="line"><span class="css"><span class="selector-class">.note-list</span> <span class="selector-class">.meta</span> <span class="selector-tag">span</span> &#123;</span></span><br><span class="line">    margin-right: 10px;</span><br><span class="line"><span class="css">    <span class="selector-tag">color</span>: <span class="selector-id">#b4b4b4</span>;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.jsd-meta</span> &#123;</span></span><br><span class="line"><span class="css">    <span class="selector-tag">color</span>: <span class="selector-id">#ea6f5a</span>!<span class="selector-tag">important</span>;</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="css"><span class="selector-class">.note-list</span> <span class="selector-class">.meta</span> <span class="selector-tag">a</span>, <span class="selector-class">.note-list</span> <span class="selector-class">.meta</span> <span class="selector-tag">a</span><span class="selector-pseudo">:hover</span> &#123;</span></span><br><span class="line"><span class="css">    <span class="selector-tag">transition</span>: <span class="selector-class">.1s</span> <span class="selector-tag">ease-in</span>;</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="css"><span class="selector-class">.note-list</span> <span class="selector-class">.meta</span> <span class="selector-tag">a</span> &#123;</span></span><br><span class="line">    margin-right: 10px;</span><br><span class="line"><span class="css">    <span class="selector-tag">color</span>: <span class="selector-id">#b4b4b4</span>;</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="css"><span class="selector-class">.note-list</span> <span class="selector-class">.meta</span> <span class="selector-tag">img</span>&#123;</span></span><br><span class="line">    width: 15px;</span><br><span class="line">    vertical-align: middle;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.main</span> <span class="selector-class">.load-more</span> &#123;</span></span><br><span class="line">    width: 100%;</span><br><span class="line">    border-radius: 20px;</span><br><span class="line"><span class="css">    <span class="selector-tag">background-color</span>: <span class="selector-id">#a5a5a5</span>;</span></span><br><span class="line">    margin: 30px auto 60px;</span><br><span class="line">    padding: 10px 15px;</span><br><span class="line">    text-align: center;</span><br><span class="line">    font-size: 15px;</span><br><span class="line"><span class="css">    <span class="selector-tag">color</span>: <span class="selector-id">#fff</span>;</span></span><br><span class="line">    display: block;</span><br><span class="line"><span class="css">    <span class="selector-tag">line-height</span>: 1<span class="selector-class">.42857</span>;</span></span><br><span class="line">    box-sizing: border-box;</span><br><span class="line">&#125;</span><br><span class="line"><span class="css"><span class="selector-class">.main</span> <span class="selector-class">.load-more</span><span class="selector-pseudo">:hover</span> &#123;</span></span><br><span class="line"><span class="css">    <span class="selector-tag">background-color</span>: <span class="selector-id">#9b9b9b</span>;</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="css"><span class="selector-class">.aside</span> &#123;</span></span><br><span class="line">    padding: 30px 0 0;</span><br><span class="line"><span class="css">    <span class="selector-tag">margin-left</span>: 4<span class="selector-class">.16667</span>%;</span></span><br><span class="line"><span class="css">    <span class="selector-tag">width</span>: 29<span class="selector-class">.16667</span>%;</span></span><br><span class="line">    float: left;</span><br><span class="line">    position: relative;</span><br><span class="line">    min-height: 1px;</span><br><span class="line">    box-sizing: border-box;</span><br><span class="line">&#125;</span><br><span class="line"><span class="css"><span class="selector-class">.recommended-authors</span> &#123;</span></span><br><span class="line">    margin-bottom: 20px;</span><br><span class="line">    padding-top: 0;</span><br><span class="line">    font-size: 13px;</span><br><span class="line">    text-align: center;</span><br><span class="line">&#125;</span><br><span class="line"><span class="css"><span class="selector-class">.recommended-authors</span> <span class="selector-class">.title</span> &#123;</span></span><br><span class="line">    text-align: left;</span><br><span class="line">&#125;</span><br><span class="line"><span class="css"><span class="selector-class">.recommended-authors</span> <span class="selector-class">.title</span> <span class="selector-tag">span</span> &#123;</span></span><br><span class="line">    font-size: 14px;</span><br><span class="line"><span class="css">    <span class="selector-tag">color</span>: <span class="selector-id">#969696</span>;</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="css"><span class="selector-class">.recommended-authors</span> <span class="selector-class">.title</span> <span class="selector-class">.page-change</span> &#123;</span></span><br><span class="line">    float: right;</span><br><span class="line">    display: inline-block;</span><br><span class="line">    font-size: 16px;</span><br><span class="line"><span class="css">    <span class="selector-tag">color</span>: <span class="selector-id">#969696</span>;</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="css"><span class="selector-class">.icon-change</span>&#123;</span></span><br><span class="line">    width: 16px;</span><br><span class="line">    vertical-align: middle;</span><br><span class="line">&#125;</span><br><span class="line"><span class="css"><span class="selector-class">.recommended-authors</span> <span class="selector-class">.list</span> &#123;</span></span><br><span class="line">    margin: 0 0 20px;</span><br><span class="line">    text-align: left;</span><br><span class="line">    list-style: none;</span><br><span class="line">&#125;</span><br><span class="line"><span class="css"><span class="selector-class">.recommended-authors</span> <span class="selector-class">.list</span> <span class="selector-tag">li</span> &#123;</span></span><br><span class="line">    margin-top: 15px;</span><br><span class="line">    line-height: 20px;</span><br><span class="line">&#125;</span><br><span class="line"><span class="css"><span class="selector-class">.recommended-authors</span> <span class="selector-class">.list</span> <span class="selector-class">.avatar</span> &#123;</span></span><br><span class="line">    float: left;</span><br><span class="line">    width: 48px;</span><br><span class="line">    height: 48px;</span><br><span class="line">    margin-right: 10px;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.avatar</span> &#123;</span></span><br><span class="line">    width: 24px;</span><br><span class="line">    height: 24px;</span><br><span class="line">    display: block;</span><br><span class="line">    cursor: pointer;</span><br><span class="line">&#125;</span><br><span class="line"><span class="css"><span class="selector-class">.avatar</span> <span class="selector-tag">img</span> &#123;</span></span><br><span class="line">    width: 100%;</span><br><span class="line">    height: 100%;</span><br><span class="line"><span class="css">    <span class="selector-tag">border</span>: 1<span class="selector-tag">px</span> <span class="selector-tag">solid</span> <span class="selector-id">#ddd</span>;</span></span><br><span class="line">    border-radius: 50%;</span><br><span class="line">&#125;</span><br><span class="line"><span class="css"><span class="selector-class">.follow</span>&#123;</span></span><br><span class="line">    font-size: 14px;</span><br><span class="line"><span class="css">    <span class="selector-tag">color</span>: <span class="selector-id">#42c02e</span>;</span></span><br><span class="line"><span class="css">    <span class="selector-tag">border-color</span>: <span class="selector-id">#42c02e</span>;</span></span><br><span class="line">    font-weight: 400;</span><br><span class="line">    line-height: normal;</span><br><span class="line">&#125;</span><br><span class="line"><span class="css"><span class="selector-class">.follow</span> <span class="selector-tag">img</span>&#123;</span></span><br><span class="line">    width: 14px;</span><br><span class="line">&#125;</span><br><span class="line"><span class="css"><span class="selector-class">.recommended-authors</span> <span class="selector-class">.list</span> <span class="selector-class">.follow</span>, <span class="selector-class">.recommended-authors</span> <span class="selector-class">.list</span> <span class="selector-class">.follow-cancel</span>, <span class="selector-class">.recommended-authors</span> <span class="selector-class">.list</span> <span class="selector-class">.follow-each</span>, <span class="selector-class">.recommended-authors</span> <span class="selector-class">.list</span> <span class="selector-class">.following</span> &#123;</span></span><br><span class="line">    float: right;</span><br><span class="line">    margin-top: 5px;</span><br><span class="line">    padding: 0;</span><br><span class="line">    font-size: 13px;</span><br><span class="line"><span class="css">    <span class="selector-tag">color</span>: <span class="selector-id">#42c02e</span>;</span></span><br><span class="line">    box-sizing: border-box;</span><br><span class="line">&#125;</span><br><span class="line"><span class="css"><span class="selector-class">.recommended-authors</span> <span class="selector-class">.list</span> <span class="selector-class">.name</span> &#123;</span></span><br><span class="line">    padding-top: 5px;</span><br><span class="line">    margin-right: 60px;</span><br><span class="line">    font-size: 14px;</span><br><span class="line">    display: block;</span><br><span class="line">    box-sizing: border-box;</span><br><span class="line">&#125;</span><br><span class="line"><span class="css"><span class="selector-class">.recommended-authors</span> <span class="selector-class">.list</span> <span class="selector-tag">p</span> &#123;</span></span><br><span class="line">    font-size: 12px;</span><br><span class="line"><span class="css">    <span class="selector-tag">color</span>: <span class="selector-id">#969696</span>;</span></span><br><span class="line">    margin: 0 0 10px;</span><br><span class="line">    box-sizing: border-box;</span><br><span class="line">&#125;</span><br><span class="line"><span class="css"><span class="selector-class">.recommended-authors</span> <span class="selector-class">.find-more</span> &#123;</span></span><br><span class="line">    position: absolute;</span><br><span class="line">    padding: 7px 7px 7px 12px;</span><br><span class="line">    left: 0;</span><br><span class="line">    width: 100%;</span><br><span class="line">    font-size: 13px;</span><br><span class="line"><span class="css">    <span class="selector-tag">color</span>: <span class="selector-id">#787878</span>;</span></span><br><span class="line"><span class="css">    <span class="selector-tag">background-color</span>: <span class="selector-id">#f7f7f7</span>;</span></span><br><span class="line"><span class="css">    <span class="selector-tag">border</span>: 1<span class="selector-tag">px</span> <span class="selector-tag">solid</span> <span class="selector-id">#dcdcdc</span>;</span></span><br><span class="line">    border-radius: 4px;</span><br><span class="line">&#125;</span><br><span class="line"><span class="css"><span class="selector-class">.row</span><span class="selector-pseudo">:after</span> &#123;</span></span><br><span class="line">    clear: both;</span><br><span class="line">&#125;</span><br><span class="line"><span class="css"><span class="selector-class">.el-carousel__item</span> <span class="selector-tag">h3</span> &#123;</span></span><br><span class="line"><span class="css">    <span class="selector-tag">color</span>: <span class="selector-id">#475669</span>;</span></span><br><span class="line">    font-size: 14px;</span><br><span class="line"><span class="css">    <span class="selector-tag">opacity</span>: 0<span class="selector-class">.75</span>;</span></span><br><span class="line">    line-height: 150px;</span><br><span class="line">    margin: 0;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.el-carousel__item</span><span class="selector-pseudo">:nth-child(2n)</span> &#123;</span></span><br><span class="line"><span class="css">    <span class="selector-tag">background-color</span>: <span class="selector-id">#99a9bf</span>;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-class">.el-carousel__item</span><span class="selector-pseudo">:nth-child(2n+1)</span> &#123;</span></span><br><span class="line"><span class="css">    <span class="selector-tag">background-color</span>: <span class="selector-id">#d3dce6</span>;</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br></pre></td></tr></table></figure><p>main.js代码：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F; iconfont字体import &quot;..&#x2F;static&#x2F;css&#x2F;iconfont.css&quot;;import &quot;..&#x2F;static&#x2F;css&#x2F;iconfont.eot&quot;;</span><br></pre></td></tr></table></figure><p>components/common/Header.vue</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div class&#x3D;&quot;header&quot;&gt;</span><br><span class="line">    &lt;nav class&#x3D;&quot;navbar&quot;&gt;</span><br><span class="line">      &lt;div class&#x3D;&quot;width-limit&quot;&gt;</span><br><span class="line">        &lt;!-- 左上方 Logo --&gt;</span><br><span class="line">        &lt;a class&#x3D;&quot;logo&quot; href&#x3D;&quot;&#x2F;&quot;&gt;&lt;img src&#x3D;&quot;&#x2F;static&#x2F;image&#x2F;nav-logo.png&quot; &#x2F;&gt;&lt;&#x2F;a&gt;</span><br><span class="line"></span><br><span class="line">        &lt;!-- 右上角 --&gt;</span><br><span class="line">        &lt;!-- 未登录显示登录&#x2F;注册&#x2F;写文章 --&gt;</span><br><span class="line">        &lt;a class&#x3D;&quot;btn write-btn&quot; target&#x3D;&quot;_blank&quot; href&#x3D;&quot;&#x2F;writer&quot;&gt;&lt;img class&#x3D;&quot;icon-write&quot; src&#x3D;&quot;&#x2F;static&#x2F;image&#x2F;write.svg&quot;&gt;写文章&lt;&#x2F;a&gt;</span><br><span class="line">        &lt;a class&#x3D;&quot;btn sign-up&quot; id&#x3D;&quot;sign_up&quot; href&#x3D;&quot;&#x2F;register&quot;&gt;注册&lt;&#x2F;a&gt;</span><br><span class="line">        &lt;a class&#x3D;&quot;btn log-in&quot; id&#x3D;&quot;sign_in&quot; href&#x3D;&quot;&#x2F;login&quot;&gt;登录&lt;&#x2F;a&gt;</span><br><span class="line">        &lt;div class&#x3D;&quot;container&quot;&gt;</span><br><span class="line">          &lt;div class&#x3D;&quot;collapse navbar-collapse&quot; id&#x3D;&quot;menu&quot;&gt;</span><br><span class="line">            &lt;ul class&#x3D;&quot;nav navbar-nav&quot;&gt;</span><br><span class="line">              &lt;li class&#x3D;&quot;tab active&quot;&gt;</span><br><span class="line">                &lt;a href&#x3D;&quot;&#x2F;&quot;&gt;</span><br><span class="line">                  &lt;img class&#x3D;&quot;menu-icon&quot; src&#x3D;&quot;&#x2F;static&#x2F;image&#x2F;menu.svg&quot;&gt;</span><br><span class="line">                  &lt;span class&#x3D;&quot;menu-text&quot;&gt;首页&lt;&#x2F;span&gt;</span><br><span class="line">                &lt;&#x2F;a&gt;</span><br><span class="line">              &lt;&#x2F;li&gt;</span><br><span class="line">              &lt;li class&#x3D;&quot;search&quot;&gt;</span><br><span class="line">                &lt;form target&#x3D;&quot;_blank&quot; action&#x3D;&quot;&#x2F;search&quot; accept-charset&#x3D;&quot;UTF-8&quot; method&#x3D;&quot;get&quot;&gt;</span><br><span class="line">                  &lt;input type&#x3D;&quot;text&quot; name&#x3D;&quot;q&quot; id&#x3D;&quot;q&quot; value&#x3D;&quot;&quot; autocomplete&#x3D;&quot;off&quot; placeholder&#x3D;&quot;搜索&quot; class&#x3D;&quot;search-input&quot;&gt;</span><br><span class="line">                  &lt;a class&#x3D;&quot;search-btn&quot; href&#x3D;&quot;javascript:void(0)&quot;&gt;&lt;&#x2F;a&gt;</span><br><span class="line">                &lt;&#x2F;form&gt;</span><br><span class="line">              &lt;&#x2F;li&gt;</span><br><span class="line">            &lt;&#x2F;ul&gt;</span><br><span class="line">          &lt;&#x2F;div&gt;</span><br><span class="line">        &lt;&#x2F;div&gt;</span><br><span class="line"></span><br><span class="line">        &lt;!-- 如果用户登录，显示下拉菜单 --&gt;</span><br><span class="line">      &lt;&#x2F;div&gt;</span><br><span class="line">    &lt;&#x2F;nav&gt;</span><br><span class="line">  &lt;&#x2F;div&gt;</span><br><span class="line">&lt;&#x2F;template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">    export default &#123;</span><br><span class="line">        name: &quot;Header&quot;</span><br><span class="line">    &#125;</span><br><span class="line">&lt;&#x2F;script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style scoped&gt;</span><br><span class="line">.header&#123;</span><br><span class="line">  height: 56px;</span><br><span class="line">&#125;</span><br><span class="line">.container &#123;</span><br><span class="line">    width: 960px;</span><br><span class="line">    margin-right: auto;</span><br><span class="line">    margin-left: auto;</span><br><span class="line">    padding-left: 15px;</span><br><span class="line">    padding-right: 15px;</span><br><span class="line">&#125;</span><br><span class="line">.container:after, .container:before &#123;</span><br><span class="line">    content: &quot; &quot;;</span><br><span class="line">    display: table;</span><br><span class="line">&#125;</span><br><span class="line">.container:after &#123;</span><br><span class="line">    clear: both;</span><br><span class="line">&#125;</span><br><span class="line">.navbar &#123;</span><br><span class="line">    background-color: #fff;</span><br><span class="line">    border-color: #f0f0f0;</span><br><span class="line">    top: 0;</span><br><span class="line">    border-width: 0 0 1px;</span><br><span class="line">    border-radius: 0;</span><br><span class="line">&#125;</span><br><span class="line">.navbar-nav &#123;</span><br><span class="line">    float: left;</span><br><span class="line">    margin: 0;</span><br><span class="line">&#125;</span><br><span class="line">.navbar:after, .navbar:before &#123;</span><br><span class="line">    content: &quot; &quot;;</span><br><span class="line">    display: table;</span><br><span class="line">    box-sizing: border-box;</span><br><span class="line">&#125;</span><br><span class="line">.nav:after, .nav:before &#123;</span><br><span class="line">    content: &quot; &quot;;</span><br><span class="line">    display: table;</span><br><span class="line">&#125;</span><br><span class="line">nav .width-limit &#123;</span><br><span class="line">    min-width: 768px;</span><br><span class="line">    max-width: 1440px;</span><br><span class="line">    margin: 0 auto;</span><br><span class="line">&#125;</span><br><span class="line">nav .logo &#123;</span><br><span class="line">    float: left;</span><br><span class="line">    height: 56px;</span><br><span class="line">    padding: 0;</span><br><span class="line">&#125;</span><br><span class="line">nav .logo img &#123;</span><br><span class="line">    height: 100%;</span><br><span class="line">    vertical-align: middle;</span><br><span class="line">    border: 0;</span><br><span class="line">&#125;</span><br><span class="line">.btn &#123;</span><br><span class="line">    display: inline-block;</span><br><span class="line">    margin-bottom: 0;</span><br><span class="line">    font-weight: 400;</span><br><span class="line">    text-align: center;</span><br><span class="line">    vertical-align: middle;</span><br><span class="line">    touch-action: manipulation;</span><br><span class="line">    cursor: pointer;</span><br><span class="line">    background-image: none;</span><br><span class="line">    border: 1px solid transparent;</span><br><span class="line">    white-space: nowrap;</span><br><span class="line">    padding: 6px 12px;</span><br><span class="line">    font-size: 14px;</span><br><span class="line">    line-height: 1.42857;</span><br><span class="line">    border-radius: 4px;</span><br><span class="line">&#125;</span><br><span class="line">nav .write-btn &#123;</span><br><span class="line">    float: right;</span><br><span class="line">    width: 100px;</span><br><span class="line">    height: 24px;</span><br><span class="line">    line-height: 24px;</span><br><span class="line">    margin: 8px 12px 0;</span><br><span class="line">    border-radius: 20px;</span><br><span class="line">    font-size: 15px;</span><br><span class="line">    color: #fff;</span><br><span class="line">    background-color: #ea6f5a;</span><br><span class="line">    text-decoration: none;</span><br><span class="line">&#125;</span><br><span class="line">nav .log-in, nav .log-in:hover &#123;</span><br><span class="line">    color: #969696;</span><br><span class="line">&#125;</span><br><span class="line">nav .log-in &#123;</span><br><span class="line">    float: right;</span><br><span class="line">    margin: 11px 6px 0 10px;</span><br><span class="line">    font-size: 15px;</span><br><span class="line">&#125;</span><br><span class="line">nav .sign-up &#123;</span><br><span class="line">    float: right;</span><br><span class="line">    width: 80px;</span><br><span class="line">    height: 24px;</span><br><span class="line">    line-height: 24px;</span><br><span class="line">    margin: 9px 5px 0 15px;</span><br><span class="line">    border: 1px solid rgba(236,97,73,.7);</span><br><span class="line">    border-radius: 20px;</span><br><span class="line">    font-size: 15px;</span><br><span class="line">    color: #ea6f5a;</span><br><span class="line">    background-color: transparent;</span><br><span class="line">&#125;</span><br><span class="line">nav .icon-write &#123;</span><br><span class="line">    margin-right: 3px;</span><br><span class="line">    width: 19px;</span><br><span class="line">    height: 19px;</span><br><span class="line">    vertical-align: middle;</span><br><span class="line">&#125;</span><br><span class="line">nav .menu-text&#123;</span><br><span class="line">    font-size: 17px;</span><br><span class="line">    color: #ea6f5a;</span><br><span class="line">&#125;</span><br><span class="line">nav .menu-icon &#123;</span><br><span class="line">    width: 20px;</span><br><span class="line">    height: 20px;</span><br><span class="line">    vertical-align: sub;</span><br><span class="line">    margin-right: 3px;</span><br><span class="line">&#125;</span><br><span class="line">nav .nav .tab a &#123;</span><br><span class="line">    height: 56px;</span><br><span class="line">    line-height: 26px;</span><br><span class="line">    padding: 15px;</span><br><span class="line">    color: #ea6f5a;</span><br><span class="line">    background: none;</span><br><span class="line">&#125;</span><br><span class="line">nav .navbar-nav li &#123;</span><br><span class="line">    margin-right: 10px;</span><br><span class="line">    float: left;</span><br><span class="line">    position: relative;</span><br><span class="line">    display: block;</span><br><span class="line">    box-sizing: border-box;</span><br><span class="line">    height: 56px;</span><br><span class="line">    line-height: 56px;</span><br><span class="line">&#125;</span><br><span class="line">.navbar-nav &#123;</span><br><span class="line">    float: left;</span><br><span class="line">    margin: 0;</span><br><span class="line">&#125;</span><br><span class="line">nav form &#123;</span><br><span class="line">    position: relative;</span><br><span class="line">    top: 9px;</span><br><span class="line">    margin: 0 0 20px;</span><br><span class="line">    box-sizing: border-box;</span><br><span class="line">    line-height: 20px;</span><br><span class="line">&#125;</span><br><span class="line">nav form .search-input &#123;</span><br><span class="line">    padding: 0 40px 0 20px;</span><br><span class="line">    height: 38px;</span><br><span class="line">    font-size: 14px;</span><br><span class="line">    border: 1px solid #eee;</span><br><span class="line">    border-radius: 40px;</span><br><span class="line">    background: #eee;</span><br><span class="line">    transition: width .5s;</span><br><span class="line">    width: 240px;</span><br><span class="line">    outline: none;</span><br><span class="line">&#125;</span><br><span class="line">nav form .search-input:focus &#123;</span><br><span class="line">    width: 320px;</span><br><span class="line">    outline: none;</span><br><span class="line">&#125;</span><br><span class="line">.navbar-default .navbar-collapse, .navbar-default .navbar-form &#123;</span><br><span class="line">    border-color: #e7e7e7;</span><br><span class="line">    padding-left: 0;</span><br><span class="line">    padding-right: 0;</span><br><span class="line">    box-sizing: border-box;</span><br><span class="line">    width: auto;</span><br><span class="line">    border-top: 0;</span><br><span class="line">    box-shadow: none;</span><br><span class="line">&#125;</span><br><span class="line">.navbar &#123;</span><br><span class="line">    background-color: #fff;</span><br><span class="line">    top: 0;</span><br><span class="line">    border-radius: 0;</span><br><span class="line">    position: fixed;</span><br><span class="line">    right: 0;</span><br><span class="line">    left: 0;</span><br><span class="line">    z-index: 1030;</span><br><span class="line">    min-height: 50px;</span><br><span class="line">    margin-bottom: 20px;</span><br><span class="line">    border-bottom: 1px solid #f0f0f0;</span><br><span class="line">&#125;</span><br><span class="line">nav &#123;</span><br><span class="line">    height: 56px;</span><br><span class="line">&#125;</span><br><span class="line">.navbar:after, .navbar:before &#123;</span><br><span class="line">    content: &quot; &quot;;</span><br><span class="line">    display: table;</span><br><span class="line">&#125;</span><br><span class="line">nav form .search-btn &#123;</span><br><span class="line">    position: absolute;</span><br><span class="line">    display: block;</span><br><span class="line">    top: 0;</span><br><span class="line">    right: 10px;</span><br><span class="line">    width: 30px;</span><br><span class="line">    height: 30px;</span><br><span class="line">    padding: 0;</span><br><span class="line">    margin: 5px -1px 0 0;</span><br><span class="line">    background: transparent url(&quot;..&#x2F;..&#x2F;..&#x2F;static&#x2F;image&#x2F;search-focus.svg&quot;) no-repeat 6px 6px;</span><br><span class="line">    background-size: 20px;</span><br><span class="line">&#125;</span><br><span class="line">nav form .search-input:focus~a&#123;</span><br><span class="line">    border-radius: 50%;</span><br><span class="line">    background-color: #696969;</span><br><span class="line">    background-image: url(&quot;..&#x2F;..&#x2F;..&#x2F;static&#x2F;image&#x2F;search-blur.svg&quot;);</span><br><span class="line">&#125;</span><br><span class="line">nav .sign-up:hover &#123;</span><br><span class="line">    color: #ec6149;</span><br><span class="line">    border-color: #ec6149;</span><br><span class="line">    background-color: rgba(236,97,73,.05);</span><br><span class="line">&#125;</span><br><span class="line">nav .write-btn:focus, nav .write-btn:hover &#123;</span><br><span class="line">    color: #fff;</span><br><span class="line">    background-color: #ec6149;</span><br><span class="line">&#125;</span><br><span class="line">&lt;&#x2F;style&gt;</span><br></pre></td></tr></table></figure><p>components/common/Footer.vue</p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">&lt;footer <span class="class"><span class="keyword">class</span></span>=<span class="string">"container"</span>&gt;</span><br><span class="line">  &lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">"row"</span>&gt;</span><br><span class="line">    &lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">"main"</span>&gt;</span><br><span class="line">      &lt;a target=<span class="string">"_blank"</span> href=<span class="string">""</span>&gt;关于荏苒&lt;<span class="regexp">/a&gt;</span></span><br><span class="line"><span class="regexp">      &lt;em&gt; · &lt;/</span>em&gt;</span><br><span class="line">      &lt;a target=<span class="string">"_blank"</span> href=<span class="string">""</span>&gt;联系我们&lt;<span class="regexp">/a&gt;</span></span><br><span class="line"><span class="regexp">      &lt;em&gt; · &lt;/</span>em&gt;</span><br><span class="line">      &lt;a target=<span class="string">"_blank"</span> href=<span class="string">""</span>&gt;加入我们&lt;<span class="regexp">/a&gt;</span></span><br><span class="line"><span class="regexp">      &lt;em&gt; · &lt;/</span>em&gt;</span><br><span class="line">      &lt;a target=<span class="string">"_blank"</span> href=<span class="string">""</span>&gt;帮助中心&lt;<span class="regexp">/a&gt;</span></span><br><span class="line"><span class="regexp">      &lt;em&gt; · &lt;/</span>em&gt;</span><br><span class="line">      &lt;a target=<span class="string">"_blank"</span> href=<span class="string">"http://www.jianshu.com/p/cabc8fa39830"</span>&gt;合作伙伴&lt;<span class="regexp">/a&gt;</span></span><br><span class="line"><span class="regexp">      &lt;div class="icp"&gt;©2016-2019 广州荏苒信息科技有限公司 /</span> 荏苒 / 粤ICP备<span class="number">16018329</span>号<span class="number">-5</span> /&lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">    &lt;/</span>div&gt;</span><br><span class="line">  &lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">&lt;/</span>footer&gt;</span><br><span class="line">&lt;<span class="regexp">/template&gt;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">&lt;script&gt;</span></span><br><span class="line"><span class="regexp">    export default &#123;</span></span><br><span class="line"><span class="regexp">        name: "Footer"</span></span><br><span class="line"><span class="regexp">    &#125;</span></span><br><span class="line"><span class="regexp">&lt;/</span>script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style scoped&gt;</span><br><span class="line">.container &#123;</span><br><span class="line">    width: <span class="number">960</span>px;</span><br><span class="line">    margin-right: auto;</span><br><span class="line">    margin-left: auto;</span><br><span class="line">    padding-left: <span class="number">15</span>px;</span><br><span class="line">    padding-right: <span class="number">15</span>px;</span><br><span class="line">    margin-bottom: <span class="number">20</span>px;</span><br><span class="line">    box-sizing: border-box;</span><br><span class="line">&#125;</span><br><span class="line">.container:after, .container:before &#123;</span><br><span class="line">    content: <span class="string">" "</span>;</span><br><span class="line">    display: table;</span><br><span class="line">&#125;</span><br><span class="line">footer .row &#123;</span><br><span class="line">    padding-top: <span class="number">25</span>px;</span><br><span class="line">    box-sizing: border-box;</span><br><span class="line">    margin-left: <span class="number">-15</span>px;</span><br><span class="line">    margin-right: <span class="number">-15</span>px;</span><br><span class="line">&#125;</span><br><span class="line">footer .main &#123;</span><br><span class="line">    padding-right: <span class="number">0</span>;</span><br><span class="line">    font-size: <span class="number">13</span>px;</span><br><span class="line">    color: #969696;</span><br><span class="line">  width: <span class="number">70.83333</span>%;</span><br><span class="line">&#125;</span><br><span class="line">footer .icp, footer .icp a &#123;</span><br><span class="line">    color: #c8c8c8;</span><br><span class="line">&#125;</span><br><span class="line">footer .icp &#123;</span><br><span class="line">    margin-top: <span class="number">10</span>px;</span><br><span class="line">    font-size: <span class="number">12</span>px;</span><br><span class="line">&#125;</span><br><span class="line">footer .main a &#123;</span><br><span class="line">    color: #969696;</span><br><span class="line">    display: inline-block;</span><br><span class="line">&#125;</span><br><span class="line">.row:after &#123;</span><br><span class="line">    clear: both;</span><br><span class="line">&#125;</span><br><span class="line">&lt;<span class="regexp">/style&gt;</span></span><br></pre></td></tr></table></figure><h1 id="6-跨域CORS"><a href="#6-跨域CORS" class="headerlink" title="6. 跨域CORS"></a>6. 跨域CORS</h1><p>我们现在为前端和后端分别设置两个不同的域名：</p><p><a href="https://www.notion.so/6c3910a07a18421787f41719768f07f9" target="_blank" rel="noopener">Untitled</a></p><p>编辑<code>/etc/hosts</code>文件，可以设置本地域名</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo vim /etc/hosts</span><br></pre></td></tr></table></figure><p>在文件中增加两条信息</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1   api.renran.cn</span><br><span class="line">127.0.0.1   www.moluo.net</span><br></pre></td></tr></table></figure><p>访问<a href="http://www.renrancn" target="_blank" rel="noopener">http://www.renrancn</a>网址，效果：</p><p><img src="/images/1572915815759.png" alt="1572915815759.png"></p><p>上面并不是错误，而是没人监听了这个地址和端口了，解决方法：</p><p>暂停运行前端项目，并修改配置文件config/index.js</p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">host: <span class="string">'www.renran.cn'</span>, <span class="comment">// can be overwritten by process.env.HOST</span></span><br><span class="line">    port: <span class="number">8080</span>, <span class="comment">// can be overwritten by process.env.PORT, if port is in use, a free one will be determined</span></span><br><span class="line">    autoOpenBrowser: <span class="literal">true</span>,</span><br></pre></td></tr></table></figure><p>保存修改信息，并重启项目</p><p><img src="/images/1557454684623.png" alt="1557454684623.png"></p><p>通过浏览器访问drf项目,会出现以下错误信息</p><p><img src="/images/1557454965635.png" alt="1557454965635.png"></p><p>可以通过settings/dev.py的ALLOWED_HOSTS,设置允许访问</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 设置哪些客户端可以通过地址访问到后端</span></span><br><span class="line">ALLOWED_HOSTS = [</span><br><span class="line">    <span class="string">'api.renran.cn'</span>,</span><br><span class="line">]</span><br></pre></td></tr></table></figure><p><img src="/images/1557455086164.png" alt="1557455086164.png"></p><p>让用户访问的时候，使用api.renran.cn:8000</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1. 修改pycharm的manage.py的配置参数</span><br></pre></td></tr></table></figure><p><img src="/images/1557455152863.png" alt="1557455152863.png"></p><p>现在，前端与后端分处不同的域名，我们需要为后端添加跨域访问的支持</p><p>否则前端无法使用axios无法请求后端提供的api数据，我们使用CORS来解决后端对跨域访问的支持。</p><p>使用django-cors-headers扩展</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">在 Response(headers&#x3D;&#123;&quot;Access-Control-Allow-Origin&quot;:&#39;客户端地址&#x2F;*&#39;&#125;)</span><br></pre></td></tr></table></figure><p>文档：<a href="https://github.com/ottoyiu/django-cors-headers/" target="_blank" rel="noopener">https://github.com/ottoyiu/django-cors-headers/</a></p><p>安装</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install django-cors-headers</span><br></pre></td></tr></table></figure><p>settings/dev.py，添加应用</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">INSTALLED_APPS = (</span><br><span class="line">    ...</span><br><span class="line">    <span class="string">'corsheaders'</span>,</span><br><span class="line">    ...</span><br><span class="line">)</span><br></pre></td></tr></table></figure><p>中间层设置【必须写在第一个位置】</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">MIDDLEWARE = [</span><br><span class="line">    <span class="string">'corsheaders.middleware.CorsMiddleware'</span>,</span><br><span class="line">    ...</span><br><span class="line">]</span><br></pre></td></tr></table></figure><p>添加白名单</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># CORS组的配置信息</span></span><br><span class="line">CORS_ORIGIN_WHITELIST = (</span><br><span class="line">    <span class="string">'http://www.moluo.net:8080'</span>,</span><br><span class="line">)</span><br><span class="line">CORS_ALLOW_CREDENTIALS = <span class="literal">False</span>  <span class="comment"># 允许ajax跨域请求时携带cookie</span></span><br></pre></td></tr></table></figure><p><img src="/images/1572916750522.png" alt="1572916750522.png"></p><p>完成了上面的步骤，我们就可以通过后端提供数据给前端使用ajax访问了。</p><p>前端使用 axios就可以访问到后端提供给的数据接口，但是如果要附带cookie信息，前端还要设置一下。</p><p>前端引入axios插件并配置允许axios发送cookie信息[axios本身也不允许ajax发送cookie到后端]</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i axios -S</span><br></pre></td></tr></table></figure><p><img src="/images/1557455747921.png" alt="1557455747921.png"></p><p>在main.js中引用 axios插件</p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> axios <span class="keyword">from</span> <span class="string">'axios'</span>; <span class="comment">// 从node_modules目录中导入包</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 允许ajax发送请求时附带cookie，设置为不允许</span></span><br><span class="line">axios.defaults.withCredentials = <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line">Vue.prototype.$axios = axios; <span class="comment">// 把对象挂载vue中</span></span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      刚搭建的web项目或者没有明确需要调用日志的系统，一般我们直接使用python提供的longging模块来配置日志功能即可。如果类似游戏或者需要对日志进行分析的系统，则一般在服务器中配置ELK日志分析系统的...
    
    </summary>
    
    
      <category term="开源项目" scheme="http://yoursite.com/categories/%E5%BC%80%E6%BA%90%E9%A1%B9%E7%9B%AE/"/>
    
    
      <category term="荏苒商城" scheme="http://yoursite.com/tags/%E8%8D%8F%E8%8B%92%E5%95%86%E5%9F%8E/"/>
    
  </entry>
  
  <entry>
    <title>[荏苒商城项目分析]</title>
    <link href="http://yoursite.com/2020/03/22/%E8%8D%8F%E8%8B%92%E5%95%86%E5%9F%8E%E9%A1%B9%E7%9B%AE%E5%88%86%E6%9E%90/"/>
    <id>http://yoursite.com/2020/03/22/%E8%8D%8F%E8%8B%92%E5%95%86%E5%9F%8E%E9%A1%B9%E7%9B%AE%E5%88%86%E6%9E%90/</id>
    <published>2020-03-22T15:03:56.000Z</published>
    <updated>2020-05-23T15:03:56.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="1-项目开发基础概念"><a href="#1-项目开发基础概念" class="headerlink" title="1. 项目开发基础概念"></a>1. 项目开发基础概念</h1><h2 id="1-1-企业的web项目类型"><a href="#1-1-企业的web项目类型" class="headerlink" title="1.1 企业的web项目类型"></a>1.1 企业的web项目类型</h2><ol><li><p>商城</p><p>主要把现实中的商务交易通过互联网平台实现的电子交易模式的网站。商城会根据不同的交易双方划分成不同的电子商务模式。根据不同的电子商务模式，有可能把商城划分成不同类型的商城，常见的电子商务模式：</p><p>B2C[企业对个人的交易，由企业提供商品，个人选购，Business-to-Consumer]: 一般常见的官网商城。</p><p>​    B2C也叫直销商城，或者垂直商城，也可以叫自营商城。</p><p>B2B[企业对企业的交易，由企业提供商品，另一个企业进行批发或采购，Business-to-Business]，</p><p>​    B2B也叫批发商城，例如与：1688</p><p>C2C[个人对个人的交易，网站官网不参与交易，而是提供了一个平台给用户之间进行交易，Consumer-to-Consumer]，一般常见的就是二手商品交易平台或者拍卖平台。例如淘宝，孔夫子二手书网。</p><p>B2B2C[一个商家在另一个企业平台上对个人的交易]，一般叫进驻商城，购物平台。例如：天猫，京东，当当。</p><p>C2B[个人对企业的交易，由个人发起需求，企业接单完成商品]，一般也叫订购(定制)商城，例如：小米，3D打印。</p><p>O2O[线上付费，线下体验的交易]，常见的外卖平台，大众点评，12306。。。</p><blockquote><p>  注意：不同的商城，会因为不同的电子商务模式而存在不同的功能和交易流程，所以，开发商城时，一定先分析清楚当前项目属于什么样的电子商务模式。当然，因为市场，需求和时间的改变，电子商务模式也会发生变化的。一旦发生电子商务模式的变化，在企业中，往往不适合在原有网站上面改造，而是建议重构。</p></blockquote></li></ol><ol start="2"><li><p>门户网站[企业站和门户站]</p></li><li><p>社交网络</p><p>具备社交因素的网站。能够添加好友，发送私信，划分群组。。</p><p>例如：知乎，微博，脉脉，脸书</p></li></ol><ol start="4"><li><p>资讯论坛</p><p>例如：招聘网站，今日头条，天涯，百度贴吧。。。</p></li></ol><ol start="5"><li><p>内部系统</p><p>OA[线上办公管理系统]，CRM[客户关系管理系统]，ERP[企业权限管理系统]，要求权限比较高的，对于企业的业务进行专门定制的，很多时候开发过程中需要根据业务实现各种流程根据。</p></li></ol><ol start="6"><li><p>个人博客</p><p>一般都是文章展示，往往就是团队，组织，机构，个人展示最近动态或者技术分享，生活分享的网站。</p></li></ol><ol start="7"><li><p>内容收费站</p><p>妹子图，爱奇艺，优酷，软甲下载站，音乐下载网，音乐视听网。。。。</p></li></ol><h2 id="1-2-企业项目开发流程"><a href="#1-2-企业项目开发流程" class="headerlink" title="1.2 企业项目开发流程"></a>1.2 企业项目开发流程</h2><p><img src="/images/%E5%BC%80%E5%8F%91%E6%B5%81%E7%A8%8B.png" alt="开发流程"></p><p><img src="/images/0a4ede2ba0d4a7302763a65.jpg" alt="img"></p><h2 id="1-3-立项申请阶段"><a href="#1-3-立项申请阶段" class="headerlink" title="1.3 立项申请阶段"></a>1.3 立项申请阶段</h2><p>立项其实就是对产品项目能不能做和怎么做，提出理论基础。大的互联网公司都有比较正规的立项流程。</p><p><img src="https://gitee.com/wjxyzs/img/raw/master/img/1594224193(1).png" alt=""></p><p>通常公司内部要研发一款软硬件的产品之前，都要经过市场评估和调研分析，产生一份<code>产品项目立项报告</code>给公司。</p><p>产品项目立项报告一般包含以下内容：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">项目概述</span><br><span class="line">需求市场</span><br><span class="line">需求分析和项目建设的必要性</span><br><span class="line">业务分析</span><br><span class="line">总体建设方案</span><br><span class="line">项目风险和风险管理</span><br><span class="line">可行性分析阶段</span><br></pre></td></tr></table></figure><p>参考资料：<a href="https://blog.csdn.net/m0_37370820/article/details/81077886" target="_blank" rel="noopener">https://blog.csdn.net/m0_37370820/article/details/81077886</a></p><h1 id="2-需求分析"><a href="#2-需求分析" class="headerlink" title="2. 需求分析"></a>2. 需求分析</h1><h2 id="2-1-登录注册"><a href="#2-1-登录注册" class="headerlink" title="2.1 登录注册"></a>2.1 登录注册</h2><p>功能：用户登录、多条件登录、jwt认证、记住密码、QQ第三方登录、</p><p>​            用户注册、短信发送、短信冷却倒计时、腾讯防水墙验证码、Celery异步发送短信和邮件</p><p>​            邮箱找回重置密码、使用itsdangerous对数据进行加密解密</p><p><img src="/images/1577990861697.png" alt="1577990861697"></p><p><img src="/images/1577991263742.png" alt="1577991263742"></p><p><img src="/images/1577991344099.png" alt="1577991344099"></p><p><img src="/images/1577991766752.png" alt="1577991766752"></p><h2 id="2-2-首页"><a href="#2-2-首页" class="headerlink" title="2.2 首页"></a>2.2 首页</h2><p>功能：无限级别导航菜单、轮播图、退出登录、内容列表下拉刷新</p><p>​        采用分布式存储系统FastDFS存储网站内容图片，基于docker进行安装部署FastDFS</p><p>​            feed流内容推送[feed是将用户主动订阅的内容组合在一起形成内容聚合器，帮助用户持续地获取最新内容]</p><p>​        智能推荐原创作者、关注作者和取消关注</p><p>​        django集成markdown富文本编辑器</p><p><img src="/images/1577990588403.png" alt="1577990588403"></p><h2 id="2-3-内容详情"><a href="#2-3-内容详情" class="headerlink" title="2.3 内容详情"></a>2.3 内容详情</h2><p>功能：文章内容实现专题、文集等归纳类目</p><p>​           内容基本展示、作者信息展示、作者热门文章展示、同类专题内容推荐、</p><p>​           文章评论、无限级别评论回复、评论分页、评论排序、分享内容、收藏内容、评论点赞和踩</p><p>​           点赞内容、赞赏支持</p><p>​       基于redis保存我的浏览历史记录</p><p>​       内容购买</p><p><img src="/images/1577993236784.png" alt="1577993236784"></p><p><img src="/images/1577993459126.png" alt="1577993459126"></p><p><img src="/images/1577993610205.png" alt="1577993610205"></p><p><img src="/images/1577993632021.png" alt="1577993632021"></p><h2 id="2-4-内容搜索页"><a href="#2-4-内容搜索页" class="headerlink" title="2.4 内容搜索页"></a>2.4 内容搜索页</h2><p>功能：基于ElasticSearch实现中文分词，使用django-haystack配合完成内容搜索。</p><p>​            搜索内容结果实现分页展示</p><p>​        按不同条件筛选展示内容</p><p>​            搜索历史记录</p><p>​            </p><p><img src="/images/1577994346242.png" alt="1577994346242"></p><h2 id="2-5-个人中心"><a href="#2-5-个人中心" class="headerlink" title="2.5 个人中心"></a>2.5 个人中心</h2><h3 id="2-5-1-我的首页"><a href="#2-5-1-我的首页" class="headerlink" title="2.5.1 我的首页"></a>2.5.1 我的首页</h3><p>功能：个人信息基本展示、采用timeline模式展示我的动态、展示最新评论、展示我的热门内容、展示我的文集</p><p>​            基于ajax实现鱼书功能[在线聊天]、</p><p><img src="/images/1577994901235.png" alt="1577994901235"></p><p><img src="/images/1577995094611.png" alt="1577995094611"></p><h3 id="2-5-2-收藏和喜欢的的文章"><a href="#2-5-2-收藏和喜欢的的文章" class="headerlink" title="2.5.2 收藏和喜欢的的文章"></a>2.5.2 收藏和喜欢的的文章</h3><p><img src="/images/1577995261184.png" alt="1577995261184"></p><h3 id="2-4-3-我的钱包"><a href="#2-4-3-我的钱包" class="headerlink" title="2.4.3 我的钱包"></a>2.4.3 我的钱包</h3><p>功能：基于支付宝转账到个人账户接口实现余额提现、</p><p>​            资金流水记录</p><p>​        </p><p><img src="/images/1577995290426.png" alt="1577995290426"></p><h3 id="2-4-5-我的基本信息设置"><a href="#2-4-5-我的基本信息设置" class="headerlink" title="2.4.5 我的基本信息设置"></a>2.4.5 我的基本信息设置</h3><p>功能：基本信息修改、用户地址信息功能修改、账户所有内容打包下载</p><p><img src="/images/1577995354497.png" alt="1577995354497"></p><h3 id="2-4-6-我的粉丝"><a href="#2-4-6-我的粉丝" class="headerlink" title="2.4.6 我的粉丝"></a>2.4.6 我的粉丝</h3><p>功能：关注和取消关注</p><p><img src="/images/1577995776589.png" alt="1577995776589"></p><h1 id="3-环境搭建"><a href="#3-环境搭建" class="headerlink" title="3. 环境搭建"></a>3. 环境搭建</h1><h2 id="3-1-创建虚拟环境"><a href="#3-1-创建虚拟环境" class="headerlink" title="3.1 创建虚拟环境"></a>3.1 创建虚拟环境</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 如果当前系统中没有虚拟环境，则使用以下命令安装虚拟环境：</span></span><br><span class="line"><span class="comment"># pip3 install virtualenv  -i https://pypi.tuna.tsinghua.edu.cn/simple</span></span><br><span class="line"><span class="comment"># pip3 install virtualenvwrapper -i https://pypi.tuna.tsinghua.edu.cn/simple</span></span><br><span class="line"><span class="comment"># pip3 install virtualenvwrapper-win -i https://pypi.tuna.tsinghua.edu.cn/simple</span></span><br><span class="line"></span><br><span class="line">mkvirtualenv renran</span><br></pre></td></tr></table></figure><p>如果自己的开发机子中存在多个版本的python，则可以指定python解析器的版本</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mkvirtualenv renran -p python3</span><br></pre></td></tr></table></figure><h2 id="3-2-相关命令"><a href="#3-2-相关命令" class="headerlink" title="3.2 相关命令"></a>3.2 相关命令</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">创建虚拟环境：                mkvirtualenv 虚拟环境名称</span><br><span class="line">创建虚拟环境(指定python版本)： mkvirtualenv 虚拟环境名称 -p python3</span><br><span class="line">查看所有虚拟环境：             workon</span><br><span class="line">使用虚拟环境：                workon 虚拟环境名称</span><br><span class="line">退出虚拟环境：                deactivate</span><br><span class="line">删除虚拟环境（必须先退出虚拟环境内部才能删除当前虚拟环境）:</span><br><span class="line">                           rmvirtualenv 虚拟环境名称</span><br><span class="line">    </span><br><span class="line">其他相关命令：</span><br><span class="line">查看虚拟环境中安装的包：              pip freeze  或者 pip list</span><br><span class="line">收集当前环境中安装的包及其版本：        pip freeze &gt; requirements.txt</span><br><span class="line">在部署项目的服务器中安装项目使用的模块： pip install -r requirements.txt</span><br></pre></td></tr></table></figure><p>提示:</p><ul><li><p>虚拟环境只会管理环境内部的模块和python解析器,对于源代码是毫无关系</p></li><li><p>创建虚拟环境需要联网</p></li><li><p>创建成功后, 会自动工作在这个虚拟环境上</p></li><li><p>工作在虚拟环境上, 提示符最前面会出现 “(虚拟环境名称)”</p></li></ul><h2 id="3-3-技术选型"><a href="#3-3-技术选型" class="headerlink" title="3.3 技术选型"></a>3.3 技术选型</h2><h3 id="外部依赖"><a href="#外部依赖" class="headerlink" title="外部依赖"></a>外部依赖</h3><ol><li><p>注册支付宝的开发者账号</p></li><li><p>注册阿里云/腾讯云账号,如果可以购买一个服务器【<a href="http://www.aliyun.com】" target="_blank" rel="noopener">www.aliyun.com】</a></p></li><li><p>注册容联云短信接口平台的账号【<a href="http://www.yuntongxun.com】" target="_blank" rel="noopener">www.yuntongxun.com】</a></p></li><li><p>注册腾讯开发者账户，申请QQ互联开发者实名认证【<a href="http://connect.qq.com】" target="_blank" rel="noopener">http://connect.qq.com】</a></p></li><li><p>申请163或者QQ邮箱开通smtp/pop3服务【<a href="http://mail.163.com】" target="_blank" rel="noopener">http://mail.163.com】</a></p></li><li><p>注册gitee[码云]的账号</p></li><li><p>如果有条件的,可以申请一个域名进行备案[ICP备案和公安部备案],如果没有的话, 可以注册natapp</p><p>公安部备案平台：<a href="http://www.beian.gov.cn/" target="_blank" rel="noopener">http://www.beian.gov.cn/</a></p></li></ol><h4 id="依赖包安装"><a href="#依赖包安装" class="headerlink" title="依赖包安装"></a>依赖包安装</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">pip install django&#x3D;&#x3D;2.2.0  -i https:&#x2F;&#x2F;pypi.douban.com&#x2F;simple</span><br><span class="line"></span><br><span class="line">pip install djangorestframework  -i https:&#x2F;&#x2F;pypi.douban.com&#x2F;simple</span><br><span class="line"></span><br><span class="line">pip install PymySQL  -i https:&#x2F;&#x2F;pypi.douban.com&#x2F;simple</span><br><span class="line"></span><br><span class="line">pip install Pillow  -i https:&#x2F;&#x2F;pypi.douban.com&#x2F;simple</span><br><span class="line"></span><br><span class="line">pip install django-redis  -i https:&#x2F;&#x2F;pypi.douban.com&#x2F;simple</span><br></pre></td></tr></table></figure><h1 id="4-搭建项目"><a href="#4-搭建项目" class="headerlink" title="4. 搭建项目"></a>4. 搭建项目</h1><h2 id="4-1-创建项目"><a href="#4-1-创建项目" class="headerlink" title="4.1 创建项目"></a>4.1 创建项目</h2><p>项目所在路径不要使用中文或者空格或者除了下划线的其它特殊符号</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">cd ~/Desktop</span><br><span class="line">mkdir renran</span><br><span class="line">cd renran</span><br><span class="line">django-admin startproject renranapi</span><br></pre></td></tr></table></figure><h2 id="4-3-打开项目"><a href="#4-3-打开项目" class="headerlink" title="4.3 打开项目"></a>4.3 打开项目</h2><p>在pycharm中打开项目</p><p><img src="/images/1593659898433.png" alt="1593659898433"></p><p><img src="/images/1578105222972.png" alt="1578105222972"></p><p>选择菜单file, 点选settings… 设置虚拟环境</p><p><img src="/images/1553139497155.png" alt="1553139497155"></p><p>点击右边的齿轮，选择Add</p><p><img src="/images/1578104421692.png" alt="1578104421692"></p><p><img src="/images/1578104445382.png" alt="1578104445382"></p><p>启动django项目中的manage.py</p><p><img src="/images/1578105329159.png" alt="1578105329159"></p><p>因为仅启动manage.py，所以项目不会运行，所以需要配置启动manage.py的参数。</p><p><img src="/images/1578104595762.png" alt="1578104595762"></p><p>点选“Edit Configurations”，在新窗口中的Parammeters中加上以下内容</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">runserver 0.0.0.0:8000</span><br></pre></td></tr></table></figure><p><img src="/images/1578104637328.png" alt="1578104637328"></p><p>再次运行manage.py</p><p><img src="/images/1578104662964.png" alt="1578104662964"></p><p>效果：</p><p><img src="/images/1557367991756.png" alt="1557367991756"></p><p>提示：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">在pycharm中如果要使用已经创建好的虚拟环境，则必须设置pycharm中的python解释器，设置为虚拟环境中的python。</span><br></pre></td></tr></table></figure><h2 id="4-2-调整目录"><a href="#4-2-调整目录" class="headerlink" title="4.2 调整目录"></a>4.2 调整目录</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">renran&#x2F;</span><br><span class="line">  ├── docs&#x2F;          # 项目相关资料保存目录</span><br><span class="line">      ├ 项目开发日志&#x2F;项目开发文档.md  </span><br><span class="line">  ├── reran_pc&#x2F;     # 前端项目目录</span><br><span class="line">  ├── reranapi&#x2F;      # api服务端项目目录</span><br><span class="line">       ├── logs&#x2F;          # 项目运行时&#x2F;开发时日志目录</span><br><span class="line">       ├── manage.py</span><br><span class="line">       ├── reranapi&#x2F;      # 项目主应用，开发时的代码保存</span><br><span class="line">       │    ├── apps&#x2F;      # 开发者的代码保存目录，以模块[子应用]为目录保存</span><br><span class="line">       │    ├── libs&#x2F;      # 第三方类库的保存目录[第三方组件、模块]</span><br><span class="line">       │    ├── settings&#x2F;</span><br><span class="line">       │         ├── dev.py   # 项目开发时的本地配置[不需要上传到线上或者服务器]</span><br><span class="line">       │         ├── prod.py  # 项目上线时的运行配置</span><br><span class="line">       │    ├── urls.py    # 总路由</span><br><span class="line">       │    ├── utils&#x2F;     # 多个模块[子应用]的公共函数类库[自己开发的组件]</span><br><span class="line">       └── scripts&#x2F;       # 保存项目运营时的脚本文件</span><br></pre></td></tr></table></figure><p>在编辑中开发项目时,必须指定项目目录才能运行,例如,开发后端项目,则必须选择的目录是luffyapi</p><h3 id="4-2-1-分不同环境进行项目配置"><a href="#4-2-1-分不同环境进行项目配置" class="headerlink" title="4.2.1 分不同环境进行项目配置"></a>4.2.1 分不同环境进行项目配置</h3><p>开发者本地的环境、目录、数据库密码和线上的服务器都会不一样,所以我们的配置文件可以针对不同的系统分成多分.</p><ol><li>在项目主应用下,创建一个settings的配置文件存储目录</li><li>根据线上线下两种情况分别创建2个配置文件 dev.py和prod.py</li><li>把原来项目主应用的 settings.py 配置内容复制2份到dev.py和prod.py里面</li><li>把原来的settings.py配置文件修改文件名，例如settings_old或者直接删除settings.py</li></ol><p>新的配置文件目录settings:</p><p><img src="/images/1578105541412.png" alt="1578105541412"></p><p>接下来,就可以在manage.py中根据不同的开发环境导入对应的配置文件了.</p><p><img src="/images/1557368958823.png" alt="1557368958823"></p><h2 id="4-3-创建代码版本"><a href="#4-3-创建代码版本" class="headerlink" title="4.3 创建代码版本"></a>4.3 创建代码版本</h2><p>cd进入到自己希望存储代码的目录路径，并创建本地仓库.git【pycharm直接打开终端就是项目根目录了。无须cd了】<br>新创建的本地仓库.git是个空仓库</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">cd ~/Desktop/renran</span><br><span class="line">git init     <span class="comment"># 为当前目录创建一个git仓库</span></span><br><span class="line">ls -la       <span class="comment"># linux下列出当前目录所有目录文件，包括隐藏文件</span></span><br></pre></td></tr></table></figure><p><img src="/images//1585726362762.png" alt="1585726362762"></p><h3 id="4-3-1-配置用户名和邮箱"><a href="#4-3-1-配置用户名和邮箱" class="headerlink" title="4.3.1 配置用户名和邮箱"></a>4.3.1 配置用户名和邮箱</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">git config --global user.name &#39;moluo&#39;</span><br><span class="line">git config --global user.email &#39;649641514@qq.com&#39;</span><br></pre></td></tr></table></figure><h2 id="4-4-在gitee平台创建工程"><a href="#4-4-在gitee平台创建工程" class="headerlink" title="4.4 在gitee平台创建工程"></a>4.4 在gitee平台创建工程</h2><p>公司一般都会有自己的代码仓库，一般都是自己搭建，也有使用第三方提供代码管理平台。</p><p>常用的代码管理平台：github、gitee(码云)</p><p>如果公司自己搭建的代码管理平台，gitlab框架</p><p>1） 创建私有项目库</p><p><img src="/images//1578106172369.png" alt="1578106172369"></p><p><img src="/images//1578106188249.png" alt="1578106188249"></p><p>创建私有/公有空仓库以后的界面:</p><p><img src="/images//1578106470078.png" alt="1578106470078"></p><p>2）克隆项目到本地</p><p>注意：<br>    我们当前项目不需要这个步骤<br>        这个步骤是 当以后我们进入公司里面，参与人家已经在做的项目时，别人已经有仓库了，但是我们是新人加入项目中的，那么我们不需要在自己本地进行git init，直接git clone 复制别人的仓库代码</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">git clone 仓库地址</span><br><span class="line">注意，如果当前目录下出现git仓库同名目录时，会克隆失败。</span><br></pre></td></tr></table></figure><p>3）创建并切换分支到dev</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"># git branch dev      # 创建本地分支dev,dev是自定义</span><br><span class="line"># git checkout dev    # 切换本地分支代码</span><br><span class="line">git checkout -b dev   # 这里是上面两句代码的简写</span><br><span class="line">git branch -d dev     # 删除分支</span><br></pre></td></tr></table></figure><p>git提交</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">git add 代码目录   # 添加代码到上传队列</span><br><span class="line">git status        # 查看当前项目的版本状态</span><br><span class="line">git commit -m '添加项目代码'  # 提交代码到本地仓库， -m 表示本次提交的描述</span><br></pre></td></tr></table></figure><p>推送到远端</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git push origin dev:dev</span><br></pre></td></tr></table></figure><p>如果推送代码,出现以下提示: git pull ….,则表示当前本地的代码和线上的代码版本不同.</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">1. 把线上的代码执行以下命令,拉取到本地,进行同步</span><br><span class="line">git pull</span><br><span class="line"></span><br><span class="line">2. 根据提示,移除多余的冲突的文件,也可以删除.</span><br><span class="line">完成这些步骤以后,再次add,commit,push即可.</span><br></pre></td></tr></table></figure><p>接下来，我们就把上面创建好的本地项目提交到gitee码云上面</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># .表示当前目录下所有的文件或目录提交到上传队列[上传队列也叫"暂存区"]</span></span><br><span class="line"><span class="comment"># 切换当前工作目录到项目根目录 cd ~/Desktop/renran/</span></span><br><span class="line">git add .</span><br><span class="line"></span><br><span class="line"><span class="comment"># 把本地上传队列的代码提交到本地仓库</span></span><br><span class="line">git commit -m <span class="string">"项目初始化搭建"</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 给本地的git版本控制软件设置项目的远程仓库地址</span></span><br><span class="line">git remote add origin https://gitee.com/moluo/renran.git</span><br><span class="line"></span><br><span class="line"><span class="comment"># 提交代码给远程仓库</span></span><br><span class="line">git push -u origin master</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">扩展：</span><br><span class="line">1. 通过 git status 可以查看当前项目的代码版本状态</span><br><span class="line">2. 通过 git reflog 可以查看代码版本日志[简单格式]</span><br><span class="line">3. 通过 git log    可以查看代码版本日志[详细格式]</span><br></pre></td></tr></table></figure><p>最终就可以成功提交了代码版本到gitee平台。</p><p>上面虽然成功移交了代码版本，但是一些不需要的文件也被提交上去了。</p><p>所以，我们针对一些不需要的文件，可以选择从代码版本中删除，并且使用<code>.gitignore</code>把这些垃圾文件过滤掉。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">git rm 文件  <span class="comment"># 删除单个文件</span></span><br><span class="line">git rm -rf 目录  <span class="comment"># 递归删除目录</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 以下操作建议通过ubuntu的终端来完成，不要使用pycharm提供，否则删除.idea还会继续生成。</span></span><br><span class="line">git rm -rf .idea</span><br><span class="line">git rm db.sqlite3</span><br><span class="line"><span class="comment"># 注意，上面的操作只是从项目的源代码中删除，但是git是不知情的，所以我们需要同步。</span></span><br><span class="line">git add .</span><br><span class="line">git commit -m <span class="string">"删除不必要的文件或目录"</span></span><br><span class="line">git push -u origin master</span><br></pre></td></tr></table></figure><p>使用<code>.gitignore</code>把一些垃圾文件过滤掉。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">vim .gitignore</span><br><span class="line"></span><br><span class="line">renranapi&#x2F;.idea</span><br><span class="line">renranapi&#x2F;.idea&#x2F;*</span><br><span class="line">renranapi&#x2F;db.sqlite3</span><br></pre></td></tr></table></figure><p>开发时我们经常会使用pycharm的提供的git管理工具来完成代码的拉取和推送。</p><p><img src="/images//1557375896356.png" alt="1557375896356"></p>]]></content>
    
    <summary type="html">
    
      项目开发基础概念 企业的web项目类型,商城主要把现实中的商务交易通过互联网平台实现的电子交易模式的网站。商城会根据不同的交易双方划分成不同的电子商务模式。根据不同的电子商务模式，有可能把商城划分成不同类...
    
    </summary>
    
    
      <category term="开源项目" scheme="http://yoursite.com/categories/%E5%BC%80%E6%BA%90%E9%A1%B9%E7%9B%AE/"/>
    
    
      <category term="荏苒商城" scheme="http://yoursite.com/tags/%E8%8D%8F%E8%8B%92%E5%95%86%E5%9F%8E/"/>
    
  </entry>
  
  <entry>
    <title>[事务与其他介绍]</title>
    <link href="http://yoursite.com/2020/03/13/%E4%BA%8B%E5%8A%A1%E4%B8%8E%E5%85%B6%E4%BB%96%E4%BB%8B%E7%BB%8D/"/>
    <id>http://yoursite.com/2020/03/13/%E4%BA%8B%E5%8A%A1%E4%B8%8E%E5%85%B6%E4%BB%96%E4%BB%8B%E7%BB%8D/</id>
    <published>2020-03-13T00:58:29.000Z</published>
    <updated>2020-05-09T10:11:29.000Z</updated>
    
    <content type="html"><![CDATA[<h3 id="视图"><a href="#视图" class="headerlink" title="视图"></a>视图</h3><ul><li><p>什么是视图</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&quot;&quot;&quot;</span><br><span class="line">视图就是通过查询得到一张虚拟表，然后保存下来，下次可以直接使用</span><br><span class="line">其实视图也是表</span><br><span class="line">&quot;&quot;&quot;</span><br></pre></td></tr></table></figure></li><li><p>为什么要用视图</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&quot;&quot;&quot;</span><br><span class="line">如果要频繁的操作一张虚拟表(拼表组成的)，你就可以制作成视图 后续直接操作</span><br><span class="line">&quot;&quot;&quot;</span><br></pre></td></tr></table></figure></li><li><p>如何操作</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 固定语法</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">view</span> 表名 <span class="keyword">as</span> 虚拟表的查询<span class="keyword">sql</span>语句</span><br><span class="line"></span><br><span class="line"><span class="comment"># 具体操作</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">view</span> teacher2course <span class="keyword">as</span></span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> teacher <span class="keyword">INNER</span> <span class="keyword">JOIN</span> course</span><br><span class="line"><span class="keyword">on</span> teacher.tid = course.teacher_id</span><br><span class="line">;</span><br></pre></td></tr></table></figure></li><li><p>注意</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&quot;&quot;&quot;</span><br><span class="line">1 创建视图在硬盘上只会有表结构 没有表数据(数据还是来自于之前的表)</span><br><span class="line">2 视图一般只用来查询 里面的数据不要继续修改 可能会影响真正的表</span><br><span class="line">&quot;&quot;&quot;</span><br></pre></td></tr></table></figure></li><li><p>视图到底使用频率高不高呢？</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&quot;&quot;&quot;</span><br><span class="line">不高</span><br><span class="line">当你创建了很多视图之后 会造成表的不好维护 </span><br><span class="line">&quot;&quot;&quot;</span><br><span class="line"># 总结</span><br><span class="line">视图了解即可 基本不用！！！</span><br></pre></td></tr></table></figure></li></ul><h3 id="触发器-了解"><a href="#触发器-了解" class="headerlink" title="触发器(了解)"></a>触发器(了解)</h3><p>在满足对表数据进行增、删、改的情况下，自动触发的功能</p><p>使用触发器可以帮助我们实现监控、日志…</p><p>触发器可以在六种情况下自动触发 增前 增后 删前删后 改前改后</p><h3 id="基本语法结构"><a href="#基本语法结构" class="headerlink" title="基本语法结构"></a>基本语法结构</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">trigger</span> 触发器的名字  <span class="keyword">before</span>/<span class="keyword">after</span> <span class="keyword">insert</span>/<span class="keyword">update</span>/<span class="keyword">delete</span> <span class="keyword">on</span> 表名</span><br><span class="line"><span class="keyword">for</span> <span class="keyword">each</span> <span class="keyword">row</span></span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line"><span class="keyword">sql</span>语句</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 具体使用 针对触发器的名字 我们通常需要做到见名知意</span></span><br><span class="line"><span class="comment"># 针对增</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">trigger</span> tri_before_insert_t1  <span class="keyword">before</span> <span class="keyword">insert</span> <span class="keyword">on</span> t1</span><br><span class="line"><span class="keyword">for</span> <span class="keyword">each</span> <span class="keyword">row</span></span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line"><span class="keyword">sql</span>语句</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">trigger</span> tri_after_insert_t1  <span class="keyword">after</span> <span class="keyword">insert</span> <span class="keyword">on</span> t1</span><br><span class="line"><span class="keyword">for</span> <span class="keyword">each</span> <span class="keyword">row</span></span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line"><span class="keyword">sql</span>语句</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"><span class="string">"""针对删除和修改 书写格式一致"""</span></span><br><span class="line"></span><br><span class="line">ps:修改MySQL默认的语句结束符  只作用于当前窗口</span><br><span class="line">delimiter $$  将默认的结束符号由;改为$$</span><br><span class="line">    delimiter ;</span><br><span class="line">    </span><br><span class="line"><span class="comment"># 案例</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> cmd (</span><br><span class="line">    <span class="keyword">id</span> <span class="built_in">INT</span> PRIMARY <span class="keyword">KEY</span> auto_increment,</span><br><span class="line">    <span class="keyword">USER</span> <span class="built_in">CHAR</span> (<span class="number">32</span>),</span><br><span class="line">    priv <span class="built_in">CHAR</span> (<span class="number">10</span>),</span><br><span class="line">    cmd <span class="built_in">CHAR</span> (<span class="number">64</span>),</span><br><span class="line">    sub_time datetime, <span class="comment">#提交时间</span></span><br><span class="line">    <span class="keyword">success</span> enum (<span class="string">'yes'</span>, <span class="string">'no'</span>) <span class="comment">#0代表执行失败</span></span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> errlog (</span><br><span class="line">    <span class="keyword">id</span> <span class="built_in">INT</span> PRIMARY <span class="keyword">KEY</span> auto_increment,</span><br><span class="line">    err_cmd <span class="built_in">CHAR</span> (<span class="number">64</span>),</span><br><span class="line">    err_time datetime</span><br><span class="line">);</span><br><span class="line">"""</span><br><span class="line">当cmd表中的记录succes字段是no那么就触发触发器的执行去errlog表中插入数据</span><br><span class="line">NEW指代的就是一条条数据对象</span><br><span class="line">"""</span><br><span class="line">delimiter $$</span><br><span class="line"><span class="keyword">create</span> <span class="keyword">trigger</span> tri_after_insert_cmd <span class="keyword">after</span> <span class="keyword">insert</span> <span class="keyword">on</span> cmd </span><br><span class="line"><span class="keyword">for</span> <span class="keyword">each</span> <span class="keyword">row</span></span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line"><span class="keyword">if</span> NEW.success = <span class="string">'no'</span> <span class="keyword">then</span></span><br><span class="line">    <span class="keyword">insert</span> <span class="keyword">into</span> errlog(err_cmd,err_time) <span class="keyword">values</span>(NEW.cmd,NEW.sub_time);</span><br><span class="line">    <span class="keyword">end</span> <span class="keyword">if</span>;</span><br><span class="line"><span class="keyword">end</span> $$</span><br><span class="line">delimiter ;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 朝cmd表插入数据</span></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> cmd (</span><br><span class="line">    <span class="keyword">USER</span>,</span><br><span class="line">    priv,</span><br><span class="line">    cmd,</span><br><span class="line">    sub_time,</span><br><span class="line">    <span class="keyword">success</span></span><br><span class="line">)</span><br><span class="line"><span class="keyword">VALUES</span></span><br><span class="line">    (<span class="string">'jason'</span>,<span class="string">'0755'</span>,<span class="string">'ls -l /etc'</span>,<span class="keyword">NOW</span>(),<span class="string">'yes'</span>),</span><br><span class="line">    (<span class="string">'jason'</span>,<span class="string">'0755'</span>,<span class="string">'cat /etc/passwd'</span>,<span class="keyword">NOW</span>(),<span class="string">'no'</span>),</span><br><span class="line">    (<span class="string">'jason'</span>,<span class="string">'0755'</span>,<span class="string">'useradd xxx'</span>,<span class="keyword">NOW</span>(),<span class="string">'no'</span>),</span><br><span class="line">    (<span class="string">'jason'</span>,<span class="string">'0755'</span>,<span class="string">'ps aux'</span>,<span class="keyword">NOW</span>(),<span class="string">'yes'</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment"># 删除触发器</span></span><br><span class="line"><span class="keyword">drop</span> <span class="keyword">trigger</span> tri_after_insert_cmd;</span><br></pre></td></tr></table></figure><h3 id="事务"><a href="#事务" class="headerlink" title="事务"></a>事务</h3><ul><li><p>什么是事务</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&quot;&quot;&quot;</span><br><span class="line">开启一个事务可以包含多条sql语句 这些sql语句要么同时成功</span><br><span class="line">要么一个都别想成功 称之为事务的原子性</span><br><span class="line">&quot;&quot;&quot;</span><br></pre></td></tr></table></figure></li><li><p>事务的作用</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&quot;&quot;&quot;</span><br><span class="line">保证了对数据操作的安全性</span><br><span class="line">&quot;&quot;&quot;</span><br><span class="line">eg:还钱的例子</span><br><span class="line">    egon用银行卡给我的支付宝转账1000</span><br><span class="line">    1 将egon银行卡账户的数据减1000块</span><br><span class="line">        2 将jason支付宝账户的数据加1000块</span><br><span class="line">    </span><br><span class="line">   你在操作多条数据的时候可能会出现某几条操作不成功的情况</span><br></pre></td></tr></table></figure></li><li><p>事务的四大特性</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">&quot;&quot;&quot;</span><br><span class="line">ACID</span><br><span class="line">A:原子性</span><br><span class="line">一个事务是一个不可分割的单位，事务中包含的诸多操作</span><br><span class="line">要么同时成功要么同时失败</span><br><span class="line">C:一致性</span><br><span class="line">事务必须是使数据库从一个一致性的状态变到另外一个一致性的状态</span><br><span class="line">一致性跟原子性是密切相关的</span><br><span class="line">I:隔离性</span><br><span class="line">一个事务的执行不能被其他事务干扰</span><br><span class="line">（即一个事务内部的操作及使用到的数据对并发的其他事务是隔离的，并发执行的事务之间也是互相不干扰的）</span><br><span class="line">D:持久性</span><br><span class="line">也叫&quot;永久性&quot;</span><br><span class="line">一个事务一旦提交成功执行成功 那么它对数据库中数据的修改应该是永久的</span><br><span class="line">接下来的其他操作或者故障不应该对其有任何的影响</span><br><span class="line">&quot;&quot;&quot;</span><br></pre></td></tr></table></figure></li><li><p>如何使用事务</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 事务相关的关键字</span></span><br><span class="line"><span class="comment"># 1 开启事务</span></span><br><span class="line"><span class="keyword">start</span> <span class="keyword">transaction</span>;</span><br><span class="line"><span class="comment"># 2 回滚(回到事务执行之前的状态)</span></span><br><span class="line"><span class="keyword">rollback</span>;</span><br><span class="line"><span class="comment"># 3 确认(确认之后就无法回滚了)</span></span><br><span class="line"><span class="keyword">commit</span>;</span><br><span class="line"></span><br><span class="line">"""模拟转账功能"""</span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> <span class="keyword">user</span>(</span><br><span class="line"><span class="keyword">id</span> <span class="built_in">int</span> primary <span class="keyword">key</span> auto_increment,</span><br><span class="line">    <span class="keyword">name</span> <span class="built_in">char</span>(<span class="number">16</span>),</span><br><span class="line">    balance <span class="built_in">int</span></span><br><span class="line">);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> <span class="keyword">user</span>(<span class="keyword">name</span>,balance) <span class="keyword">values</span></span><br><span class="line">(<span class="string">'jason'</span>,<span class="number">1000</span>),</span><br><span class="line">(<span class="string">'egon'</span>,<span class="number">1000</span>),</span><br><span class="line">(<span class="string">'tank'</span>,<span class="number">1000</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment"># 1 先开启事务</span></span><br><span class="line"><span class="keyword">start</span> <span class="keyword">transaction</span>;</span><br><span class="line"><span class="comment"># 2 多条sql语句</span></span><br><span class="line"><span class="keyword">update</span> <span class="keyword">user</span> <span class="keyword">set</span> balance=<span class="number">900</span> <span class="keyword">where</span> <span class="keyword">name</span>=<span class="string">'jason'</span>;</span><br><span class="line"><span class="keyword">update</span> <span class="keyword">user</span> <span class="keyword">set</span> balance=<span class="number">1010</span> <span class="keyword">where</span> <span class="keyword">name</span>=<span class="string">'egon'</span>;</span><br><span class="line"><span class="keyword">update</span> <span class="keyword">user</span> <span class="keyword">set</span> balance=<span class="number">1090</span> <span class="keyword">where</span> <span class="keyword">name</span>=<span class="string">'tank'</span>;</span><br><span class="line"></span><br><span class="line">"""</span><br><span class="line">总结</span><br><span class="line">当你想让多条sql语句保持一致性 要么同时成功要么同时失败 </span><br><span class="line">你就应该考虑使用事务</span><br><span class="line">"""</span><br></pre></td></tr></table></figure><h3 id="存储过程-了解"><a href="#存储过程-了解" class="headerlink" title="存储过程(了解)"></a>存储过程(了解)</h3><p>存储过程就类似于python中的自定义函数</p><p>它的内部包含了一系列可以执行的sql语句，存储过程存放于MySQL服务端中，你可以直接通过调用存储过程触发内部sql语句的执行</p><p><strong>基本使用</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">procedure</span> 存储过程的名字(形参<span class="number">1</span>,形参<span class="number">2</span>,...)</span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line"><span class="keyword">sql</span>代码</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"><span class="comment"># 调用</span></span><br><span class="line"><span class="keyword">call</span> 存储过程的名字();</span><br></pre></td></tr></table></figure><h3 id="三种开发模型"><a href="#三种开发模型" class="headerlink" title="三种开发模型"></a>三种开发模型</h3><p>第一种</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&quot;&quot;&quot;</span><br><span class="line">应用程序:程序员写代码开发</span><br><span class="line">MySQL:提前编写好存储过程，供应用程序调用</span><br><span class="line"></span><br><span class="line">好处:开发效率提升了 执行效率也上去了</span><br><span class="line">缺点:考虑到认为元素、跨部门沟通的问题  后续的存储过程的扩展性差</span><br><span class="line">&quot;&quot;&quot;</span><br></pre></td></tr></table></figure><p>第二种</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&quot;&quot;&quot;</span><br><span class="line">应用程序:程序员写代码开发之外 设计到数据库操作也自己动手写</span><br><span class="line">优点:扩展性很高</span><br><span class="line">缺点:</span><br><span class="line">开发效率降低</span><br><span class="line">编写sql语句太过繁琐 而且后续还需要考虑sql优化的问题</span><br><span class="line">&quot;&quot;&quot;</span><br></pre></td></tr></table></figure><p>第三种</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&quot;&quot;&quot;</span><br><span class="line">应用程序:只写程序代码 不写sql语句 基于别人写好的操作MySQL的python框架直接调用操作即可ORM框架  </span><br><span class="line">优点:开发效率比上面两种情况都要高 </span><br><span class="line">缺点:语句的扩展性差 可能会出现效率低下的问题 </span><br><span class="line">&quot;&quot;&quot;</span><br></pre></td></tr></table></figure><p>第一种基本不用。一般都是第三种，出现效率问题再动手写sql</p></li><li><p>存储过程具体演示</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">delimiter $$</span><br><span class="line"><span class="keyword">create</span> <span class="keyword">procedure</span> p1(</span><br><span class="line"><span class="keyword">in</span> m <span class="built_in">int</span>,  <span class="comment"># 只进不出  m不能返回出去</span></span><br><span class="line">    <span class="keyword">in</span> n <span class="built_in">int</span>,</span><br><span class="line">    <span class="keyword">out</span> res <span class="built_in">int</span>  <span class="comment"># 该形参可以返回出去</span></span><br><span class="line">)</span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line"><span class="keyword">select</span> tname <span class="keyword">from</span> teacher <span class="keyword">where</span> tid&gt;m <span class="keyword">and</span> tid&lt;n;</span><br><span class="line">    <span class="keyword">set</span> res=<span class="number">666</span>;  <span class="comment"># 将res变量修改 用来标识当前的存储过程代码确实执行了</span></span><br><span class="line"><span class="keyword">end</span> $$</span><br><span class="line">delimiter ;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 针对形参res 不能直接传数据 应该传一个变量名</span></span><br><span class="line"><span class="comment"># 定义变量</span></span><br><span class="line"><span class="keyword">set</span> @ret = <span class="number">10</span>;</span><br><span class="line"><span class="comment"># 查看变量对应的值</span></span><br><span class="line"><span class="keyword">select</span> @ret;</span><br></pre></td></tr></table></figure><p>在pymysql模块中如何调用存储过程呢？</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">import pymysql</span><br><span class="line"></span><br><span class="line">conn = pymysql.connect(</span><br><span class="line">    host = '127.0.0.1',</span><br><span class="line">    port = 3306,</span><br><span class="line">    user = 'root',</span><br><span class="line">    passwd = '123456',</span><br><span class="line">    db = 'day48',</span><br><span class="line">    charset = 'utf8',</span><br><span class="line">    autocommit = True</span><br><span class="line">)</span><br><span class="line">cursor = conn.cursor(pymysql.cursors.DictCursor)</span><br><span class="line"><span class="comment"># 调用存储过程</span></span><br><span class="line">cursor.callproc('p1',(1,5,10))</span><br><span class="line">"""</span><br><span class="line">@_p1_0=1</span><br><span class="line">@_p1_1=5</span><br><span class="line">@_p1_2=10</span><br><span class="line">"""</span><br><span class="line"><span class="comment"># print(cursor.fetchall())</span></span><br><span class="line">cursor.execute(<span class="string">'select @_p1_2;'</span>)</span><br><span class="line">print(cursor.fetchall())</span><br></pre></td></tr></table></figure><h3 id="函数"><a href="#函数" class="headerlink" title="函数"></a>函数</h3><p>跟存储过程是有区别的，存储过程是自定义函数，函数就类似于是内置函数</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">('jason','0755','ls -l /etc',NOW(),'yes')</span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> blog (</span><br><span class="line">    <span class="keyword">id</span> <span class="built_in">INT</span> PRIMARY <span class="keyword">KEY</span> auto_increment,</span><br><span class="line">    <span class="keyword">NAME</span> <span class="built_in">CHAR</span> (<span class="number">32</span>),</span><br><span class="line">    sub_time datetime</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> blog (<span class="keyword">NAME</span>, sub_time)</span><br><span class="line"><span class="keyword">VALUES</span></span><br><span class="line">    (<span class="string">'第1篇'</span>,<span class="string">'2015-03-01 11:31:21'</span>),</span><br><span class="line">    (<span class="string">'第2篇'</span>,<span class="string">'2015-03-11 16:31:21'</span>),</span><br><span class="line">    (<span class="string">'第3篇'</span>,<span class="string">'2016-07-01 10:21:31'</span>),</span><br><span class="line">    (<span class="string">'第4篇'</span>,<span class="string">'2016-07-22 09:23:21'</span>),</span><br><span class="line">    (<span class="string">'第5篇'</span>,<span class="string">'2016-07-23 10:11:11'</span>),</span><br><span class="line">    (<span class="string">'第6篇'</span>,<span class="string">'2016-07-25 11:21:31'</span>),</span><br><span class="line">    (<span class="string">'第7篇'</span>,<span class="string">'2017-03-01 15:33:21'</span>),</span><br><span class="line">    (<span class="string">'第8篇'</span>,<span class="string">'2017-03-01 17:32:21'</span>),</span><br><span class="line">    (<span class="string">'第9篇'</span>,<span class="string">'2017-03-01 18:31:21'</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> <span class="keyword">date_format</span>(sub_time,<span class="string">'%Y-%m'</span>),<span class="keyword">count</span>(<span class="keyword">id</span>) <span class="keyword">from</span> blog <span class="keyword">group</span> <span class="keyword">by</span> <span class="keyword">date_format</span>(sub_time,<span class="string">'%Y-%m'</span>);</span><br></pre></td></tr></table></figure><h3 id="流程控制-了解"><a href="#流程控制-了解" class="headerlink" title="流程控制(了解)"></a>流程控制(了解)</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># if判断</span></span><br><span class="line">delimiter //</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">PROCEDURE</span> proc_if ()</span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line">    <span class="keyword">declare</span> i <span class="built_in">int</span> <span class="keyword">default</span> <span class="number">0</span>;</span><br><span class="line">    if i = 1 THEN</span><br><span class="line">        <span class="keyword">SELECT</span> <span class="number">1</span>;</span><br><span class="line">    ELSEIF i = 2 THEN</span><br><span class="line">        <span class="keyword">SELECT</span> <span class="number">2</span>;</span><br><span class="line">    ELSE</span><br><span class="line">        <span class="keyword">SELECT</span> <span class="number">7</span>;</span><br><span class="line">    <span class="keyword">END</span> <span class="keyword">IF</span>;</span><br><span class="line"><span class="keyword">END</span> //</span><br><span class="line">delimiter ;</span><br><span class="line"><span class="comment"># while循环</span></span><br><span class="line">delimiter //</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">PROCEDURE</span> proc_while ()</span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line">    <span class="keyword">DECLARE</span> <span class="keyword">num</span> <span class="built_in">INT</span> ;</span><br><span class="line">    <span class="keyword">SET</span> <span class="keyword">num</span> = <span class="number">0</span> ;</span><br><span class="line">    WHILE num &lt; 10 DO</span><br><span class="line">        <span class="keyword">SELECT</span></span><br><span class="line">            <span class="keyword">num</span> ;</span><br><span class="line">        <span class="keyword">SET</span> <span class="keyword">num</span> = <span class="keyword">num</span> + <span class="number">1</span> ;</span><br><span class="line">    <span class="keyword">END</span> <span class="keyword">WHILE</span> ;</span><br></pre></td></tr></table></figure><h3 id="索引"><a href="#索引" class="headerlink" title="索引"></a>索引</h3><p>ps:数据都是存在与硬盘上的，查询数据不可避免的需要进行IO操作</p><p>索引:就是一种数据结构，类似于书的目录。意味着以后在查询数据的应该先找目录再找数据，而不是一页一页的翻书，从而提升查询速度降低IO操作</p><p>索引在MySQL中也叫“键”,是存储引擎用于快速查找记录的一种数据结构</p><ul><li>primary key</li><li>unique key</li><li>index key</li></ul><p>注意foreign key不是用来加速查询用的，不在我们的而研究范围之内</p><p>上面的三种key，前面两种除了可以增加查询速度之外各自还具有约束条件，而最后一种index key没有任何的约束条件，只是用来帮助你快速查询数据</p><p><strong>本质</strong></p><p>通过不断的缩小想要的数据范围筛选出最终的结果，同时将随机事件(一页一页的翻)</p><p>变成顺序事件(先找目录、找数据)</p><p>也就是说有了索引机制，我们可以总是用一种固定的方式查找数据</p><p>一张表中可以有多个索引(多个目录)</p><p>索引虽然能够帮助你加快查询速度但是也有缺点</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&quot;&quot;&quot;</span><br><span class="line">1 当表中有大量数据存在的前提下 创建索引速度会很慢</span><br><span class="line">2 在索引创建完毕之后 对表的查询性能会大幅度的提升 但是写的性能也会大幅度的降低</span><br><span class="line">&quot;&quot;&quot;</span><br><span class="line">索引不要随意的创建！！！</span><br></pre></td></tr></table></figure><h3 id="b-树"><a href="#b-树" class="headerlink" title="b+树"></a>b+树</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&quot;&quot;&quot;</span><br><span class="line">只有叶子节点存放的是真实的数据 其他节点存放的是虚拟数据 仅仅是用来指路的</span><br><span class="line">树的层级越高查询数据所需要经历的步骤就越多(树有几层查询数据就需要几步)</span><br><span class="line"></span><br><span class="line">一个磁盘块存储是有限制的</span><br><span class="line">为什么建议你将id字段作为索引</span><br><span class="line">占得空间少 一个磁盘块能够存储的数据多</span><br><span class="line">那么久降低了树的高度 从而减少查询次数</span><br><span class="line">&quot;&quot;&quot;</span><br></pre></td></tr></table></figure><h3 id="聚集索引-primary-key"><a href="#聚集索引-primary-key" class="headerlink" title="聚集索引(primary key)"></a>聚集索引(primary key)</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&quot;&quot;&quot;</span><br><span class="line">聚集索引指的就是主键 </span><br><span class="line">Innodb  只有两个文件  直接将主键存放在了idb表中 </span><br><span class="line">MyIsam  三个文件  单独将索引存在一个文件</span><br><span class="line">&quot;&quot;&quot;</span><br></pre></td></tr></table></figure><h3 id="辅助索引-unique-index"><a href="#辅助索引-unique-index" class="headerlink" title="辅助索引(unique,index)"></a>辅助索引(unique,index)</h3><p>查询数据的时候不可能一直使用到主键，也有可能会用到name,password等其他字段</p><p>那么这个时候你是没有办法利用聚集索引。这个时候你就可以根据情况给其他字段设置辅助索引(也是一个b+树）</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">"""</span><br><span class="line">叶子节点存放的是数据对应的主键值</span><br><span class="line">先按照辅助索引拿到数据的主键值</span><br><span class="line">之后还是需要去主键的聚集索引里面查询数据</span><br><span class="line">"""</span><br></pre></td></tr></table></figure><h3 id="覆盖索引"><a href="#覆盖索引" class="headerlink" title="覆盖索引"></a>覆盖索引</h3><p>在辅助索引的叶子节点就已经拿到了需要的数据</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 给name设置辅助索引</span></span><br><span class="line"><span class="keyword">select</span> <span class="keyword">name</span> <span class="keyword">from</span> <span class="keyword">user</span> <span class="keyword">where</span> <span class="keyword">name</span>=<span class="string">'jason'</span>;</span><br><span class="line"><span class="comment"># 非覆盖索引</span></span><br><span class="line"><span class="keyword">select</span> age <span class="keyword">from</span> <span class="keyword">user</span> <span class="keyword">where</span> <span class="keyword">name</span>=<span class="string">'jason'</span>;</span><br></pre></td></tr></table></figure><h3 id="测试索引是否有效的代码"><a href="#测试索引是否有效的代码" class="headerlink" title="测试索引是否有效的代码"></a>测试索引是否有效的代码</h3><p>感兴趣就自己试一试 不感兴趣直接忽略</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">**准备**</span><br><span class="line"></span><br><span class="line">​```mysql</span><br><span class="line"><span class="comment">#1. 准备表</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> s1(</span><br><span class="line"><span class="keyword">id</span> <span class="built_in">int</span>,</span><br><span class="line"><span class="keyword">name</span> <span class="built_in">varchar</span>(<span class="number">20</span>),</span><br><span class="line">gender <span class="built_in">char</span>(<span class="number">6</span>),</span><br><span class="line">email <span class="built_in">varchar</span>(<span class="number">50</span>)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="comment">#2. 创建存储过程，实现批量插入记录</span></span><br><span class="line">delimiter $$ <span class="comment">#声明存储过程的结束符号为$$</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">procedure</span> auto_insert1()</span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line">    <span class="keyword">declare</span> i <span class="built_in">int</span> <span class="keyword">default</span> <span class="number">1</span>;</span><br><span class="line">    while(i&lt;3000000)do</span><br><span class="line">        <span class="keyword">insert</span> <span class="keyword">into</span> s1 <span class="keyword">values</span>(i,<span class="string">'jason'</span>,<span class="string">'male'</span>,<span class="keyword">concat</span>(<span class="string">'jason'</span>,i,<span class="string">'@oldboy'</span>));</span><br><span class="line">        <span class="keyword">set</span> i=i+<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">end</span> <span class="keyword">while</span>;</span><br><span class="line"><span class="keyword">END</span>$$ <span class="comment">#$$结束</span></span><br><span class="line">delimiter ; <span class="comment">#重新声明分号为结束符号</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#3. 查看存储过程</span></span><br><span class="line"><span class="keyword">show</span> <span class="keyword">create</span> <span class="keyword">procedure</span> auto_insert1\G </span><br><span class="line"></span><br><span class="line"><span class="comment">#4. 调用存储过程</span></span><br><span class="line"><span class="keyword">call</span> auto_insert1();</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"># 表没有任何索引的情况下</span><br><span class="line">select * from s1 where id&#x3D;30000;</span><br><span class="line"># 避免打印带来的时间损耗</span><br><span class="line">select count(id) from s1 where id &#x3D; 30000;</span><br><span class="line">select count(id) from s1 where id &#x3D; 1;</span><br><span class="line"></span><br><span class="line"># 给id做一个主键</span><br><span class="line">alter table s1 add primary key(id);  # 速度很慢</span><br><span class="line"></span><br><span class="line">select count(id) from s1 where id &#x3D; 1;  # 速度相较于未建索引之前两者差着数量级</span><br><span class="line">select count(id) from s1 where name &#x3D; &#39;jason&#39;  # 速度仍然很慢</span><br><span class="line"></span><br><span class="line">&quot;&quot;&quot;</span><br><span class="line">范围问题</span><br><span class="line">&quot;&quot;&quot;</span><br><span class="line"># 并不是加了索引，以后查询的时候按照这个字段速度就一定快   </span><br><span class="line">select count(id) from s1 where id &gt; 1;  # 速度相较于id &#x3D; 1慢了很多</span><br><span class="line">select count(id) from s1 where id &gt;1 and id &lt; 3;</span><br><span class="line">select count(id) from s1 where id &gt; 1 and id &lt; 10000;</span><br><span class="line">select count(id) from s1 where id !&#x3D; 3;</span><br><span class="line"></span><br><span class="line">alter table s1 drop primary key;  # 删除主键 单独再来研究name字段</span><br><span class="line">select count(id) from s1 where name &#x3D; &#39;jason&#39;;  # 又慢了</span><br><span class="line"></span><br><span class="line">create index idx_name on s1(name);  # 给s1表的name字段创建索引</span><br><span class="line">select count(id) from s1 where name &#x3D; &#39;jason&#39;  # 仍然很慢！！！</span><br><span class="line">&quot;&quot;&quot;</span><br><span class="line">再来看b+树的原理，数据需要区分度比较高，而我们这张表全是jason，根本无法区分</span><br><span class="line">那这个树其实就建成了“一根棍子”</span><br><span class="line">&quot;&quot;&quot;</span><br><span class="line">select count(id) from s1 where name &#x3D; &#39;xxx&#39;;  </span><br><span class="line"># 这个会很快，我就是一根棍，第一个不匹配直接不需要再往下走了</span><br><span class="line">select count(id) from s1 where name like &#39;xxx&#39;;</span><br><span class="line">select count(id) from s1 where name like &#39;xxx%&#39;;</span><br><span class="line">select count(id) from s1 where name like &#39;%xxx&#39;;  # 慢 最左匹配特性</span><br><span class="line"></span><br><span class="line"># 区分度低的字段不能建索引</span><br><span class="line">drop index idx_name on s1;</span><br><span class="line"></span><br><span class="line"># 给id字段建普通的索引</span><br><span class="line">create index idx_id on s1(id);</span><br><span class="line">select count(id) from s1 where id &#x3D; 3;  # 快了</span><br><span class="line">select count(id) from s1 where id*12 &#x3D; 3;  # 慢了  索引的字段一定不要参与计算</span><br><span class="line"></span><br><span class="line">drop index idx_id on s1;</span><br><span class="line">select count(id) from s1 where name&#x3D;&#39;jason&#39; and gender &#x3D; &#39;male&#39; and id &#x3D; 3 and email &#x3D; &#39;xxx&#39;;</span><br><span class="line"># 针对上面这种连续多个and的操作，mysql会从左到右先找区分度比较高的索引字段，先将整体范围降下来再去比较其他条件</span><br><span class="line">create index idx_name on s1(name);</span><br><span class="line">select count(id) from s1 where name&#x3D;&#39;jason&#39; and gender &#x3D; &#39;male&#39; and id &#x3D; 3 and email &#x3D; &#39;xxx&#39;;  # 并没有加速</span><br><span class="line"></span><br><span class="line">drop index idx_name on s1;</span><br><span class="line"># 给name，gender这种区分度不高的字段加上索引并不难加快查询速度</span><br><span class="line"></span><br><span class="line">create index idx_id on s1(id);</span><br><span class="line">select count(id) from s1 where name&#x3D;&#39;jason&#39; and gender &#x3D; &#39;male&#39; and id &#x3D; 3 and email &#x3D; &#39;xxx&#39;;  # 快了  先通过id已经讲数据快速锁定成了一条了</span><br><span class="line">select count(id) from s1 where name&#x3D;&#39;jason&#39; and gender &#x3D; &#39;male&#39; and id &gt; 3 and email &#x3D; &#39;xxx&#39;;  # 慢了  基于id查出来的数据仍然很多，然后还要去比较其他字段</span><br><span class="line"></span><br><span class="line">drop index idx_id on s1</span><br><span class="line"></span><br><span class="line">create index idx_email on s1(email);</span><br><span class="line">select count(id) from s1 where name&#x3D;&#39;jason&#39; and gender &#x3D; &#39;male&#39; and id &gt; 3 and email &#x3D; &#39;xxx&#39;;  # 快 通过email字段一剑封喉</span><br></pre></td></tr></table></figure><h4 id="联合索引"><a href="#联合索引" class="headerlink" title="联合索引"></a>联合索引</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">select count(id) from s1 where name&#x3D;&#39;jason&#39; and gender &#x3D; &#39;male&#39; and id &gt; 3 and email &#x3D; &#39;xxx&#39;;  </span><br><span class="line"># 如果上述四个字段区分度都很高，那给谁建都能加速查询</span><br><span class="line"># 给email加然而不用email字段</span><br><span class="line">select count(id) from s1 where name&#x3D;&#39;jason&#39; and gender &#x3D; &#39;male&#39; and id &gt; 3; </span><br><span class="line"># 给name加然而不用name字段</span><br><span class="line">select count(id) from s1 where gender &#x3D; &#39;male&#39; and id &gt; 3; </span><br><span class="line"># 给gender加然而不用gender字段</span><br><span class="line">select count(id) from s1 where id &gt; 3; </span><br><span class="line"></span><br><span class="line"># 带来的问题是所有的字段都建了索引然而都没有用到，还需要花费四次建立的时间</span><br><span class="line">create index idx_all on s1(email,name,gender,id);  # 最左匹配原则，区分度高的往左放</span><br><span class="line">select count(id) from s1 where name&#x3D;&#39;jason&#39; and gender &#x3D; &#39;male&#39; and id &gt; 3 and email &#x3D; &#39;xxx&#39;;  # 速度变快</span><br></pre></td></tr></table></figure><p>总结:上面这些操作，你感兴趣可以敲一敲，不感兴趣你就可以不用敲了，权当看个乐呵。理论掌握了就行了</p><p>慢查询日志</p><p>设定一个时间检测所有超出该时间的sql语句，然后针对性的进行优化！</p></li></ul>]]></content>
    
    <summary type="html">
    
      什么是视图，视图就是通过查询得到一张虚拟表，然后保存下来，下次可以直接使用，其实视图也是表，为什么要用视图，如果要频繁的操作一张虚拟表(拼表组成的)，你就可以制作成视图 后续直接操作...
    
    </summary>
    
    
      <category term="数据库" scheme="http://yoursite.com/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/"/>
    
    
      <category term="MySQL" scheme="http://yoursite.com/tags/MySQL/"/>
    
  </entry>
  
  <entry>
    <title>[Navicat安装与pymysql模块]</title>
    <link href="http://yoursite.com/2020/03/12/Navicat%E5%AE%89%E8%A3%85%E4%B8%8Epymysql%E6%A8%A1%E5%9D%97/"/>
    <id>http://yoursite.com/2020/03/12/Navicat%E5%AE%89%E8%A3%85%E4%B8%8Epymysql%E6%A8%A1%E5%9D%97/</id>
    <published>2020-03-11T17:58:29.000Z</published>
    <updated>2020-05-10T06:30:29.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="Navicat软件"><a href="#Navicat软件" class="headerlink" title="Navicat软件"></a>Navicat软件</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&quot;&quot;&quot;</span><br><span class="line">一开始学习python的时候 下载python解释器然后直接在终端书写</span><br><span class="line">pycharm能够更加方便快捷的帮助你书写python代码</span><br><span class="line">excel word pdf</span><br><span class="line"></span><br><span class="line">我们在终端操作MySQL 也没有自动提示也无法保存等等 不方便开发</span><br><span class="line">Navicat内部封装了所有的操作数据库的命令 </span><br><span class="line">用户在使用它的时候只需要鼠标点点即可完成操作 无需书写sql语句</span><br><span class="line">&quot;&quot;&quot;</span><br></pre></td></tr></table></figure><p><strong>安装</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">直接百度搜索 有破解版的也有非破解</span><br><span class="line">非破解的有试用期 你如果不嫌麻烦 你就用使用</span><br><span class="line">到期之后重新装再使用 或者破解一下也很简单</span><br><span class="line">https:&#x2F;&#x2F;www.cr173.com&#x2F;soft&#x2F;126934.html</span><br><span class="line">    </span><br><span class="line">下载完成后是一个压缩包 直接解压 然后点击安装 有提醒直接点击next即可</span><br><span class="line"></span><br><span class="line">navicat能够充当多个数据库的客户端</span><br><span class="line"></span><br><span class="line">navicat图形化界面有时候反应速度较慢 你可以选择刷新或者关闭当前窗口再次打开即可</span><br><span class="line"></span><br><span class="line">当你有一些需求该软件无法满足的时候 你就自己动手写sql</span><br></pre></td></tr></table></figure><h3 id="提示"><a href="#提示" class="headerlink" title="提示"></a>提示</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">"""</span><br><span class="line">1 MySQL是不区分大小写的</span><br><span class="line">验证码忽略大小写</span><br><span class="line">内部统一转大写或者小写比较即可</span><br><span class="line">upper</span><br><span class="line">lower</span><br><span class="line"></span><br><span class="line">2 MySQL建议所有的关键字写大写</span><br><span class="line"></span><br><span class="line">3 MySQL中的注释 有两种</span><br><span class="line"><span class="comment">--</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"></span><br><span class="line">4 在navicat中如何快速的注释和解注释</span><br><span class="line">ctrl + ？  加注释</span><br><span class="line">ctrl + ？  基于上述操作再来一次就是解开注释</span><br><span class="line">如果你的navicat版本不一致还有可能是</span><br><span class="line">ctrl + shift + ？解开注释</span><br><span class="line">"""</span><br></pre></td></tr></table></figure><h3 id="练习题"><a href="#练习题" class="headerlink" title="练习题"></a>练习题</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br></pre></td><td class="code"><pre><span class="line">"""</span><br><span class="line">课下一定要把握上课将的这几道题全部自己独立的理解并写出来</span><br><span class="line"></span><br><span class="line">在解决sql查询问题的时候 不要慌</span><br><span class="line">一步一步慢慢来  最终能够东拼西凑出来就过关了！！！</span><br><span class="line"></span><br><span class="line">"""</span><br><span class="line"><span class="comment">-- 1、查询所有的课程的名称以及对应的任课老师姓名</span></span><br><span class="line"><span class="comment">-- SELECT</span></span><br><span class="line"><span class="comment">-- course.cname,</span></span><br><span class="line"><span class="comment">-- teacher.tname </span></span><br><span class="line"><span class="comment">-- FROM</span></span><br><span class="line"><span class="comment">-- course</span></span><br><span class="line"><span class="comment">-- INNER JOIN teacher ON course.teacher_id = teacher.tid;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- 4、查询平均成绩大于八十分的同学的姓名和平均成绩</span></span><br><span class="line"><span class="comment">-- SELECT</span></span><br><span class="line"><span class="comment">-- student.sname,</span></span><br><span class="line"><span class="comment">-- t1.avg_num </span></span><br><span class="line"><span class="comment">-- FROM</span></span><br><span class="line"><span class="comment">-- student</span></span><br><span class="line"><span class="comment">-- INNER JOIN (</span></span><br><span class="line"><span class="comment">-- SELECT</span></span><br><span class="line"><span class="comment">-- score.student_id,</span></span><br><span class="line"><span class="comment">-- avg( num ) AS avg_num </span></span><br><span class="line"><span class="comment">-- FROM</span></span><br><span class="line"><span class="comment">-- score</span></span><br><span class="line"><span class="comment">-- INNER JOIN student ON score.student_id = student.sid </span></span><br><span class="line"><span class="comment">-- GROUP BY</span></span><br><span class="line"><span class="comment">-- score.student_id </span></span><br><span class="line"><span class="comment">-- HAVING</span></span><br><span class="line"><span class="comment">-- AVG( num ) &gt; 80 </span></span><br><span class="line"><span class="comment">-- ) AS t1 ON student.sid = t1.student_id;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- 7、 查询没有报李平老师课的学生姓名</span></span><br><span class="line"><span class="comment"># 分步操作</span></span><br><span class="line"><span class="comment"># 1 先找到李平老师教授的课程id</span></span><br><span class="line"><span class="comment"># 2 再找所有报了李平老师课程的学生id</span></span><br><span class="line"><span class="comment"># 3 之后去学生表里面取反 就可以获取到没有报李平老师课程的学生姓名</span></span><br><span class="line"><span class="comment">-- SELECT</span></span><br><span class="line"><span class="comment">-- student.sname </span></span><br><span class="line"><span class="comment">-- FROM</span></span><br><span class="line"><span class="comment">-- student </span></span><br><span class="line"><span class="comment">-- WHERE</span></span><br><span class="line"><span class="comment">-- sid NOT IN (</span></span><br><span class="line"><span class="comment">-- SELECT DISTINCT</span></span><br><span class="line"><span class="comment">-- score.student_id </span></span><br><span class="line"><span class="comment">-- FROM</span></span><br><span class="line"><span class="comment">-- score </span></span><br><span class="line"><span class="comment">-- WHERE</span></span><br><span class="line"><span class="comment">-- score.course_id IN ( SELECT course.cid FROM teacher INNER JOIN course ON teacher.tid = course.teacher_id WHERE teacher.tname = '李平老师' ) </span></span><br><span class="line"><span class="comment">-- );</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- 8、 查询没有同时选修物理课程和体育课程的学生姓名</span></span><br><span class="line"><span class="comment">--     (只要选了一门的 选了两门和没有选的都不要)</span></span><br><span class="line"><span class="comment"># 1 先查物理和体育课程的id</span></span><br><span class="line"><span class="comment"># 2 再去获取所有选了物理和体育的学生数据</span></span><br><span class="line"><span class="comment"># 3 按照学生分组 利用聚合函数count筛选出只选了一门的学生id</span></span><br><span class="line"><span class="comment"># 4 依旧id获取学生姓名</span></span><br><span class="line"><span class="comment">-- SELECT</span></span><br><span class="line"><span class="comment">-- student.sname </span></span><br><span class="line"><span class="comment">-- FROM</span></span><br><span class="line"><span class="comment">-- student </span></span><br><span class="line"><span class="comment">-- WHERE</span></span><br><span class="line"><span class="comment">-- student.sid IN (</span></span><br><span class="line"><span class="comment">-- SELECT</span></span><br><span class="line"><span class="comment">-- score.student_id </span></span><br><span class="line"><span class="comment">-- FROM</span></span><br><span class="line"><span class="comment">-- score </span></span><br><span class="line"><span class="comment">-- WHERE</span></span><br><span class="line"><span class="comment">-- score.course_id IN ( SELECT course.cid FROM course WHERE course.cname IN ( '物理', '体育' ) ) </span></span><br><span class="line"><span class="comment">-- GROUP BY</span></span><br><span class="line"><span class="comment">-- score.student_id </span></span><br><span class="line"><span class="comment">-- HAVING</span></span><br><span class="line"><span class="comment">-- COUNT( score.course_id ) = 1 </span></span><br><span class="line"><span class="comment">-- );</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- 9、 查询挂科超过两门(包括两门)的学生姓名和班级</span></span><br><span class="line"><span class="comment"># 1 先筛选出所有分数小于60的数据</span></span><br><span class="line"><span class="comment"># 2 按照学生分组 对数据进行计数获取大于等于2的数据</span></span><br><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">class.caption,</span><br><span class="line">student.sname </span><br><span class="line"><span class="keyword">FROM</span></span><br><span class="line"><span class="keyword">class</span></span><br><span class="line"><span class="keyword">INNER</span> <span class="keyword">JOIN</span> student <span class="keyword">ON</span> class.cid = student.class_id </span><br><span class="line"><span class="keyword">WHERE</span></span><br><span class="line">student.sid <span class="keyword">IN</span> (</span><br><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">score.student_id </span><br><span class="line"><span class="keyword">FROM</span></span><br><span class="line">score </span><br><span class="line"><span class="keyword">WHERE</span></span><br><span class="line">score.num &lt; <span class="number">60</span> <span class="keyword">GROUP</span> <span class="keyword">BY</span> score.student_id <span class="keyword">HAVING</span> <span class="keyword">COUNT</span>( score.course_id ) &gt;= <span class="number">2</span> </span><br><span class="line">);</span><br></pre></td></tr></table></figure><h2 id="pymysql模块"><a href="#pymysql模块" class="headerlink" title="pymysql模块"></a>pymysql模块</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">"""</span></span><br><span class="line"><span class="string">支持python代码操作数据库MySQL</span></span><br><span class="line"><span class="string">"""</span></span><br><span class="line">pip3 install pymysql</span><br></pre></td></tr></table></figure><h3 id="sql注入"><a href="#sql注入" class="headerlink" title="sql注入"></a>sql注入</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">"""</span></span><br><span class="line"><span class="string">利用一些语法的特性 书写一些特点的语句实现固定的语法</span></span><br><span class="line"><span class="string">MySQL利用的是MySQL的注释语法</span></span><br><span class="line"><span class="string">select * from user where name='jason' -- jhsadklsajdkla' and password=''</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">select * from user where name='xxx' or 1=1 -- sakjdkljakldjasl' and password=''</span></span><br><span class="line"><span class="string">"""</span></span><br><span class="line">日常生活中很多软件在注册的时候都不能含有特殊符号</span><br><span class="line">因为怕你构造出特定的语句入侵数据库 不安全</span><br><span class="line"></span><br><span class="line"><span class="comment"># 敏感的数据不要自己做拼接 交给execute帮你拼接即可</span></span><br><span class="line"><span class="comment"># 结合数据库完成一个用户的登录功能？</span></span><br><span class="line"><span class="keyword">import</span> pymysql</span><br><span class="line"></span><br><span class="line">conn = pymysql.connect(</span><br><span class="line">    host = <span class="string">'127.0.0.1'</span>,</span><br><span class="line">    port = <span class="number">3306</span>,</span><br><span class="line">    user = <span class="string">'root'</span>,</span><br><span class="line">    password = <span class="string">'123456'</span>,</span><br><span class="line">    database = <span class="string">'day48'</span>,</span><br><span class="line">    charset = <span class="string">'utf8'</span>  <span class="comment"># 编码千万不要加-</span></span><br><span class="line">)  <span class="comment"># 链接数据库</span></span><br><span class="line">cursor = conn.cursor(cursor=pymysql.cursors.DictCursor)</span><br><span class="line"></span><br><span class="line">username = input(<span class="string">'&gt;&gt;&gt;:'</span>)</span><br><span class="line">password = input(<span class="string">'&gt;&gt;&gt;:'</span>)</span><br><span class="line">sql = <span class="string">"select * from user where name=%s and password=%s"</span></span><br><span class="line"><span class="comment"># 不要手动拼接数据 先用%s占位 之后将需要拼接的数据直接交给execute方法即可</span></span><br><span class="line">print(sql)</span><br><span class="line">rows = cursor.execute(sql,(username,password))  <span class="comment"># 自动识别sql里面的%s用后面元组里面的数据替换</span></span><br><span class="line"><span class="keyword">if</span> rows:</span><br><span class="line">    print(<span class="string">'登录成功'</span>)</span><br><span class="line">    print(cursor.fetchall())</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    print(<span class="string">'用户名密码错误'</span>)</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      Navicat软件 一开始学习python的时候 下载python解释器然后直接在终端书写，pycharm能够更加方便快捷的帮助你书写python代码，我们在终端操作MySQL 也没有自动提示也无法保存等等不方便开发，Navicat内部封装了所有的操作数据库的命令...
    
    </summary>
    
    
      <category term="数据库" scheme="http://yoursite.com/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/"/>
    
    
      <category term="MySQL" scheme="http://yoursite.com/tags/MySQL/"/>
    
  </entry>
  
  <entry>
    <title>[聚合函数]</title>
    <link href="http://yoursite.com/2020/03/11/%E8%81%9A%E5%90%88%E5%87%BD%E6%95%B0/"/>
    <id>http://yoursite.com/2020/03/11/%E8%81%9A%E5%90%88%E5%87%BD%E6%95%B0/</id>
    <published>2020-03-10T17:58:29.000Z</published>
    <updated>2020-05-09T08:30:29.000Z</updated>
    
    <content type="html"><![CDATA[<h3 id="前期表准备"><a href="#前期表准备" class="headerlink" title="前期表准备"></a>前期表准备</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> emp(</span><br><span class="line">  <span class="keyword">id</span> <span class="built_in">int</span> <span class="keyword">not</span> <span class="literal">null</span> <span class="keyword">unique</span> auto_increment,</span><br><span class="line">  <span class="keyword">name</span> <span class="built_in">varchar</span>(<span class="number">20</span>) <span class="keyword">not</span> <span class="literal">null</span>,</span><br><span class="line">  sex enum(<span class="string">'male'</span>,<span class="string">'female'</span>) <span class="keyword">not</span> <span class="literal">null</span> <span class="keyword">default</span> <span class="string">'male'</span>, <span class="comment">#大部分是男的</span></span><br><span class="line">  age <span class="built_in">int</span>(<span class="number">3</span>) <span class="keyword">unsigned</span> <span class="keyword">not</span> <span class="literal">null</span> <span class="keyword">default</span> <span class="number">28</span>,</span><br><span class="line">  hire_date <span class="built_in">date</span> <span class="keyword">not</span> <span class="literal">null</span>,</span><br><span class="line">  post <span class="built_in">varchar</span>(<span class="number">50</span>),</span><br><span class="line">  post_comment <span class="built_in">varchar</span>(<span class="number">100</span>),</span><br><span class="line">  salary <span class="keyword">double</span>(<span class="number">15</span>,<span class="number">2</span>),</span><br><span class="line">  office <span class="built_in">int</span>, <span class="comment">#一个部门一个屋子</span></span><br><span class="line">  depart_id <span class="built_in">int</span></span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="comment">#插入记录</span></span><br><span class="line"><span class="comment">#三个部门：教学，销售，运营</span></span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> emp(<span class="keyword">name</span>,sex,age,hire_date,post,salary,office,depart_id) <span class="keyword">values</span></span><br><span class="line">(<span class="string">'jason'</span>,<span class="string">'male'</span>,<span class="number">18</span>,<span class="string">'20170301'</span>,<span class="string">'张江第一帅形象代言'</span>,<span class="number">7300.33</span>,<span class="number">401</span>,<span class="number">1</span>), <span class="comment">#以下是教学部</span></span><br><span class="line">(<span class="string">'tom'</span>,<span class="string">'male'</span>,<span class="number">78</span>,<span class="string">'20150302'</span>,<span class="string">'teacher'</span>,<span class="number">1000000.31</span>,<span class="number">401</span>,<span class="number">1</span>),</span><br><span class="line">(<span class="string">'kevin'</span>,<span class="string">'male'</span>,<span class="number">81</span>,<span class="string">'20130305'</span>,<span class="string">'teacher'</span>,<span class="number">8300</span>,<span class="number">401</span>,<span class="number">1</span>),</span><br><span class="line">(<span class="string">'tony'</span>,<span class="string">'male'</span>,<span class="number">73</span>,<span class="string">'20140701'</span>,<span class="string">'teacher'</span>,<span class="number">3500</span>,<span class="number">401</span>,<span class="number">1</span>),</span><br><span class="line">(<span class="string">'owen'</span>,<span class="string">'male'</span>,<span class="number">28</span>,<span class="string">'20121101'</span>,<span class="string">'teacher'</span>,<span class="number">2100</span>,<span class="number">401</span>,<span class="number">1</span>),</span><br><span class="line">(<span class="string">'jack'</span>,<span class="string">'female'</span>,<span class="number">18</span>,<span class="string">'20110211'</span>,<span class="string">'teacher'</span>,<span class="number">9000</span>,<span class="number">401</span>,<span class="number">1</span>),</span><br><span class="line">(<span class="string">'jenny'</span>,<span class="string">'male'</span>,<span class="number">18</span>,<span class="string">'19000301'</span>,<span class="string">'teacher'</span>,<span class="number">30000</span>,<span class="number">401</span>,<span class="number">1</span>),</span><br><span class="line">(<span class="string">'sank'</span>,<span class="string">'male'</span>,<span class="number">48</span>,<span class="string">'20101111'</span>,<span class="string">'teacher'</span>,<span class="number">10000</span>,<span class="number">401</span>,<span class="number">1</span>),</span><br><span class="line">(<span class="string">'哈哈'</span>,<span class="string">'female'</span>,<span class="number">48</span>,<span class="string">'20150311'</span>,<span class="string">'sale'</span>,<span class="number">3000.13</span>,<span class="number">402</span>,<span class="number">2</span>),<span class="comment">#以下是销售部门</span></span><br><span class="line">(<span class="string">'呵呵'</span>,<span class="string">'female'</span>,<span class="number">38</span>,<span class="string">'20101101'</span>,<span class="string">'sale'</span>,<span class="number">2000.35</span>,<span class="number">402</span>,<span class="number">2</span>),</span><br><span class="line">(<span class="string">'西西'</span>,<span class="string">'female'</span>,<span class="number">18</span>,<span class="string">'20110312'</span>,<span class="string">'sale'</span>,<span class="number">1000.37</span>,<span class="number">402</span>,<span class="number">2</span>),</span><br><span class="line">(<span class="string">'乐乐'</span>,<span class="string">'female'</span>,<span class="number">18</span>,<span class="string">'20160513'</span>,<span class="string">'sale'</span>,<span class="number">3000.29</span>,<span class="number">402</span>,<span class="number">2</span>),</span><br><span class="line">(<span class="string">'拉拉'</span>,<span class="string">'female'</span>,<span class="number">28</span>,<span class="string">'20170127'</span>,<span class="string">'sale'</span>,<span class="number">4000.33</span>,<span class="number">402</span>,<span class="number">2</span>),</span><br><span class="line">(<span class="string">'僧龙'</span>,<span class="string">'male'</span>,<span class="number">28</span>,<span class="string">'20160311'</span>,<span class="string">'operation'</span>,<span class="number">10000.13</span>,<span class="number">403</span>,<span class="number">3</span>), <span class="comment">#以下是运营部门</span></span><br><span class="line">(<span class="string">'程咬金'</span>,<span class="string">'male'</span>,<span class="number">18</span>,<span class="string">'19970312'</span>,<span class="string">'operation'</span>,<span class="number">20000</span>,<span class="number">403</span>,<span class="number">3</span>),</span><br><span class="line">(<span class="string">'程咬银'</span>,<span class="string">'female'</span>,<span class="number">18</span>,<span class="string">'20130311'</span>,<span class="string">'operation'</span>,<span class="number">19000</span>,<span class="number">403</span>,<span class="number">3</span>),</span><br><span class="line">(<span class="string">'程咬铜'</span>,<span class="string">'male'</span>,<span class="number">18</span>,<span class="string">'20150411'</span>,<span class="string">'operation'</span>,<span class="number">18000</span>,<span class="number">403</span>,<span class="number">3</span>),</span><br><span class="line">(<span class="string">'程咬铁'</span>,<span class="string">'female'</span>,<span class="number">18</span>,<span class="string">'20140512'</span>,<span class="string">'operation'</span>,<span class="number">17000</span>,<span class="number">403</span>,<span class="number">3</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment"># 当表字段特别多 展示的时候错乱 可以使用\G分行展示</span></span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> emp\G;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 个别的电脑在插入中文的时候还是会出现乱码或者空白的现象 你可以将字符编码统一设置成GBK</span></span><br></pre></td></tr></table></figure><h3 id="几个重要关键字的执行顺序"><a href="#几个重要关键字的执行顺序" class="headerlink" title="几个重要关键字的执行顺序"></a>几个重要关键字的执行顺序</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 书写顺序</span></span><br><span class="line"><span class="keyword">select</span> <span class="keyword">id</span>,<span class="keyword">name</span> <span class="keyword">from</span> emp <span class="keyword">where</span> <span class="keyword">id</span> &gt; <span class="number">3</span>;</span><br><span class="line"><span class="comment"># 执行顺序</span></span><br><span class="line">from</span><br><span class="line">where</span><br><span class="line"><span class="keyword">select</span></span><br><span class="line"></span><br><span class="line"><span class="string">"""</span></span><br><span class="line"><span class="string">虽然执行顺序和书写顺序不一致 你在写sql语句的时候可能不知道怎么写</span></span><br><span class="line"><span class="string">你就按照书写顺序的方式写sql</span></span><br><span class="line"><span class="string">select * 先用*号占位</span></span><br><span class="line"><span class="string">之后去补全后面的sql语句</span></span><br><span class="line"><span class="string">最后将*号替换后你想要的具体字段</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">"""</span></span><br></pre></td></tr></table></figure><h3 id="where筛选条件"><a href="#where筛选条件" class="headerlink" title="where筛选条件"></a>where筛选条件</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 作用:是对整体数据的一个筛选操作</span></span><br><span class="line"><span class="comment"># 1.查询id大于等于3小于等于6的数据</span></span><br><span class="line"><span class="keyword">select</span> <span class="keyword">id</span>,<span class="keyword">name</span>,age <span class="keyword">from</span> emp <span class="keyword">where</span> <span class="keyword">id</span>&gt;=<span class="number">3</span> <span class="keyword">and</span> <span class="keyword">id</span>&lt;=<span class="number">6</span>;</span><br><span class="line"><span class="keyword">select</span> <span class="keyword">id</span>,<span class="keyword">name</span> <span class="keyword">from</span> emp <span class="keyword">where</span> <span class="keyword">id</span> <span class="keyword">between</span> <span class="number">3</span> <span class="keyword">and</span> <span class="number">6</span>;  两者等价</span><br><span class="line"></span><br><span class="line"><span class="comment"># 2.查询薪资是20000或者18000或者17000的数据</span></span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> emp <span class="keyword">where</span> salary=<span class="number">20000</span> <span class="keyword">or</span> salary=<span class="number">18000</span> <span class="keyword">or</span> salary=<span class="number">17000</span>;</span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> emp <span class="keyword">where</span> salary <span class="keyword">in</span> (<span class="number">20000</span>,<span class="number">18000</span>,<span class="number">17000</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment"># 3.查询员工姓名中包含字母o的员工的姓名和薪资</span></span><br><span class="line">"""</span><br><span class="line">模糊查询</span><br><span class="line">like</span><br><span class="line">%  匹配任意多个字符</span><br><span class="line">_  匹配任意单个字符</span><br><span class="line">"""</span><br><span class="line"><span class="keyword">select</span> <span class="keyword">name</span>,salary <span class="keyword">from</span> emp <span class="keyword">where</span> <span class="keyword">name</span> <span class="keyword">like</span> <span class="string">'%o%'</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 4.查询员工姓名是由四个字符组成的 姓名和薪资  char_length()   _</span></span><br><span class="line"><span class="keyword">select</span> <span class="keyword">name</span>,salary <span class="keyword">from</span> emp <span class="keyword">where</span> <span class="keyword">name</span> <span class="keyword">like</span> <span class="string">'____'</span>;</span><br><span class="line"><span class="keyword">select</span> <span class="keyword">name</span>,salary <span class="keyword">from</span> emp <span class="keyword">where</span> <span class="keyword">char_length</span>(<span class="keyword">name</span>) = <span class="number">4</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 5.查询id小于3或者id大于6的数据</span></span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> emp <span class="keyword">where</span> <span class="keyword">id</span> <span class="keyword">not</span> <span class="keyword">between</span> <span class="number">3</span> <span class="keyword">and</span> <span class="number">6</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 6.查询薪资不在20000,18000,17000范围的数据</span></span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> emp <span class="keyword">where</span> salary <span class="keyword">not</span> <span class="keyword">in</span> (<span class="number">20000</span>,<span class="number">18000</span>,<span class="number">17000</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment"># 7.查询岗位描述为空的员工姓名和岗位名  针对null不用等号 用is</span></span><br><span class="line"><span class="keyword">select</span> <span class="keyword">name</span>,post <span class="keyword">from</span> emp <span class="keyword">where</span> post_comment = <span class="literal">NULL</span>;</span><br><span class="line"><span class="keyword">select</span> <span class="keyword">name</span>,post <span class="keyword">from</span> emp <span class="keyword">where</span> post_comment <span class="keyword">is</span> <span class="literal">NULL</span>;</span><br></pre></td></tr></table></figure><h3 id="group-by分组"><a href="#group-by分组" class="headerlink" title="group by分组"></a>group by分组</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 分组实际应用场景  分组应用场景非常的多</span></span><br><span class="line">男女比例</span><br><span class="line">    部门平均薪资</span><br><span class="line">    部门秃头率</span><br><span class="line">    国家之间数据统计</span><br><span class="line"></span><br><span class="line"><span class="comment"># 1按照部门分组</span></span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> emp <span class="keyword">group</span> <span class="keyword">by</span> post;</span><br><span class="line">"""</span><br><span class="line">分组之后 最小可操作单位应该是组 还不再是组内的单个数据</span><br><span class="line">上述命令在你没有设置严格模式的时候是可正常执行的 返回的是分组之后 每个组的第一条数据 </span><br><span class="line">但是这不符合分组的规范:分组之后不应该考虑单个数据 而应该以组为操作单位(分组之后 没办法直接获取组内单个数据)</span><br><span class="line">如果设置了严格模式 那么上述命令会直接报错 </span><br><span class="line">"""</span><br><span class="line"><span class="keyword">set</span> <span class="keyword">global</span> sql_mode = <span class="string">'strict_trans_tables,only_full_group_by'</span>;</span><br><span class="line"></span><br><span class="line">设置严格模式之后  分组 默认只能拿到分组的依据</span><br><span class="line"><span class="keyword">select</span> post <span class="keyword">from</span> emp <span class="keyword">group</span> <span class="keyword">by</span> post;  </span><br><span class="line">按照什么分组就只能拿到分组 其他字段不能直接获取 需要借助于一些方法(聚合函数)</span><br><span class="line"></span><br><span class="line">"""</span><br><span class="line">什么时候需要分组啊？？？</span><br><span class="line">关键字 </span><br><span class="line">每个 平均 最高 最低 </span><br><span class="line"></span><br><span class="line">聚合函数</span><br><span class="line">max</span><br><span class="line">min</span><br><span class="line">sum</span><br><span class="line">count</span><br><span class="line">avg</span><br><span class="line">"""</span><br><span class="line"><span class="comment"># 1.获取每个部门的最高薪资</span></span><br><span class="line"><span class="keyword">select</span> post,<span class="keyword">max</span>(salary) <span class="keyword">from</span> emp <span class="keyword">group</span> <span class="keyword">by</span> post;</span><br><span class="line"><span class="keyword">select</span> post <span class="keyword">as</span> <span class="string">'部门'</span>,<span class="keyword">max</span>(salary) <span class="keyword">as</span> <span class="string">'最高薪资'</span> <span class="keyword">from</span> emp <span class="keyword">group</span> <span class="keyword">by</span> post;</span><br><span class="line"><span class="keyword">select</span> post <span class="string">'部门'</span>,<span class="keyword">max</span>(salary) <span class="string">'最高薪资'</span> <span class="keyword">from</span> emp <span class="keyword">group</span> <span class="keyword">by</span> post;</span><br><span class="line"><span class="comment"># as可以给字段起别名 也可以直接省略不写 但是不推荐 因为省略的话语意不明确 容易错乱</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 2.获取每个部门的最低薪资</span></span><br><span class="line"><span class="keyword">select</span> post,<span class="keyword">min</span>(salary) <span class="keyword">from</span> emp <span class="keyword">group</span> <span class="keyword">by</span> post;</span><br><span class="line"><span class="comment"># 3.获取每个部门的平均薪资</span></span><br><span class="line"><span class="keyword">select</span> post,<span class="keyword">avg</span>(salary) <span class="keyword">from</span> emp <span class="keyword">group</span> <span class="keyword">by</span> post;</span><br><span class="line"><span class="comment"># 4.获取每个部门的工资总和</span></span><br><span class="line"><span class="keyword">select</span> post,<span class="keyword">sum</span>(salary) <span class="keyword">from</span> emp <span class="keyword">group</span> <span class="keyword">by</span> post;</span><br><span class="line"><span class="comment"># 5.获取每个部门的人数</span></span><br><span class="line"><span class="keyword">select</span> post,<span class="keyword">count</span>(<span class="keyword">id</span>) <span class="keyword">from</span> emp <span class="keyword">group</span> <span class="keyword">by</span> post;  <span class="comment"># 常用 符合逻辑</span></span><br><span class="line"><span class="keyword">select</span> post,<span class="keyword">count</span>(salary) <span class="keyword">from</span> emp <span class="keyword">group</span> <span class="keyword">by</span> post;</span><br><span class="line"><span class="keyword">select</span> post,<span class="keyword">count</span>(age) <span class="keyword">from</span> emp <span class="keyword">group</span> <span class="keyword">by</span> post;</span><br><span class="line"><span class="keyword">select</span> post,<span class="keyword">count</span>(post_comment) <span class="keyword">from</span> emp <span class="keyword">group</span> <span class="keyword">by</span> post;  null不行</span><br><span class="line"></span><br><span class="line"><span class="comment"># 6.查询分组之后的部门名称和每个部门下所有的员工姓名 </span></span><br><span class="line"><span class="comment"># group_concat不单单可以支持你获取分组之后的其他字段值 还支持拼接操作</span></span><br><span class="line"><span class="keyword">select</span> post,<span class="keyword">group_concat</span>(<span class="keyword">name</span>) <span class="keyword">from</span> emp <span class="keyword">group</span> <span class="keyword">by</span> post;</span><br><span class="line"><span class="keyword">select</span> post,<span class="keyword">group_concat</span>(<span class="keyword">name</span>,<span class="string">'_DSB'</span>) <span class="keyword">from</span> emp <span class="keyword">group</span> <span class="keyword">by</span> post;</span><br><span class="line"><span class="keyword">select</span> post,<span class="keyword">group_concat</span>(<span class="keyword">name</span>,<span class="string">':'</span>,salary) <span class="keyword">from</span> emp <span class="keyword">group</span> <span class="keyword">by</span> post;</span><br><span class="line"><span class="comment"># concat不分组的时候用 </span></span><br><span class="line"><span class="keyword">select</span> <span class="keyword">concat</span>(<span class="string">'NAME:'</span>,<span class="keyword">name</span>),<span class="keyword">concat</span>(<span class="string">'SAL:'</span>,salary) <span class="keyword">from</span> emp;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 补充 as语法不单单可以给字段起别名 还可以给表临时起别名</span></span><br><span class="line"><span class="keyword">select</span> emp.id,emp.name <span class="keyword">from</span> emp;  </span><br><span class="line"><span class="keyword">select</span> emp.id,emp.name <span class="keyword">from</span> emp <span class="keyword">as</span> t1;   报错</span><br><span class="line"><span class="keyword">select</span> t1.id,t1.name <span class="keyword">from</span> emp <span class="keyword">as</span> t1;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 查询每个人的年薪  12薪</span></span><br><span class="line"><span class="keyword">select</span> <span class="keyword">name</span>,salary*<span class="number">12</span> <span class="keyword">from</span> emp;</span><br></pre></td></tr></table></figure><h3 id="分组注意事项"><a href="#分组注意事项" class="headerlink" title="分组注意事项"></a>分组注意事项</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 关键字where和group by同时出现的时候group by必须在where的后面</span></span><br><span class="line">where先对整体数据进行过滤之后再分组操作</span><br><span class="line">where筛选条件不能使用聚合函数</span><br><span class="line"><span class="keyword">select</span> <span class="keyword">id</span>,<span class="keyword">name</span>,age <span class="keyword">from</span> emp <span class="keyword">where</span> <span class="keyword">max</span>(salary) &gt; <span class="number">3000</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> <span class="keyword">max</span>(salary) <span class="keyword">from</span> emp;  <span class="comment"># 不分组 默认整体就是一组</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 统计各部门年龄在30岁以上的员工平均薪资</span></span><br><span class="line">1 先求所有年龄大于30岁的员工</span><br><span class="line">    <span class="keyword">select</span> * <span class="keyword">from</span> emp <span class="keyword">where</span> age&gt;<span class="number">30</span>;</span><br><span class="line">    2 再对结果进行分组</span><br><span class="line">     <span class="keyword">select</span> * <span class="keyword">from</span> emp <span class="keyword">where</span> age&gt;<span class="number">30</span> <span class="keyword">group</span> <span class="keyword">by</span> post;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">select</span> post,<span class="keyword">avg</span>(salary) <span class="keyword">from</span> emp <span class="keyword">where</span> age&gt;<span class="number">30</span> <span class="keyword">group</span> <span class="keyword">by</span> post;</span><br></pre></td></tr></table></figure><h3 id="having分组之后的筛选条件"><a href="#having分组之后的筛选条件" class="headerlink" title="having分组之后的筛选条件"></a>having分组之后的筛选条件</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">"""</span><br><span class="line">having的语法根where是一致的</span><br><span class="line">只不过having是在分组之后进行的过滤操作</span><br><span class="line">即having是可以直接使用聚合函数的</span><br><span class="line">"""</span><br><span class="line"><span class="comment"># 统计各部门年龄在30岁以上的员工平均工资并且保留平均薪资大于10000的部门</span></span><br><span class="line"><span class="keyword">select</span> post,<span class="keyword">avg</span>(salary) <span class="keyword">from</span> emp </span><br><span class="line"><span class="keyword">where</span> age&gt;<span class="number">30</span> </span><br><span class="line">    <span class="keyword">group</span> <span class="keyword">by</span> post</span><br><span class="line">        <span class="keyword">having</span> <span class="keyword">avg</span>(salary) &gt; <span class="number">10000</span></span><br><span class="line">        ;</span><br></pre></td></tr></table></figure><h3 id="distinct去重"><a href="#distinct去重" class="headerlink" title="distinct去重"></a>distinct去重</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">"""</span><br><span class="line">一定要注意 必须是完全一样的数据才可以去重！！！</span><br><span class="line">一定不要将逐渐忽视了 有逐渐存在的情况下 是不可能去重的</span><br><span class="line">[</span><br><span class="line">&#123;'id':1,'name':'jason','age':18&#125;,</span><br><span class="line">&#123;'id':2,'name':'jason','age':18&#125;,</span><br><span class="line">&#123;'id':3,'name':'egon','age':18&#125;</span><br><span class="line">]</span><br><span class="line">ORM  对象关系映射   让不懂SQL语句的人也能够非常牛逼的操作数据库</span><br><span class="line">表类</span><br><span class="line">一条条的数据对象</span><br><span class="line">字段对应的值对象的属性</span><br><span class="line"></span><br><span class="line">你再写类 就意味着在创建表</span><br><span class="line">用类生成对象 就意味着再创建数据</span><br><span class="line">对象点属性 就是在获取数据字段对应的值</span><br><span class="line">目的就是减轻python程序员的压力 只需要会python面向对象的知识点就可以操作MySQL</span><br><span class="line">"""</span><br><span class="line"><span class="keyword">select</span> <span class="keyword">distinct</span> <span class="keyword">id</span>,age <span class="keyword">from</span> emp;</span><br><span class="line"><span class="keyword">select</span> <span class="keyword">distinct</span> age <span class="keyword">from</span> emp;</span><br></pre></td></tr></table></figure><h3 id="order-by排序"><a href="#order-by排序" class="headerlink" title="order by排序"></a>order by排序</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> emp <span class="keyword">order</span> <span class="keyword">by</span> salary;</span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> emp <span class="keyword">order</span> <span class="keyword">by</span> salary <span class="keyword">asc</span>;</span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> emp <span class="keyword">order</span> <span class="keyword">by</span> salary <span class="keyword">desc</span>;</span><br><span class="line">"""</span><br><span class="line">order by默认是升序  asc 该asc可以省略不写</span><br><span class="line">也可以修改为降序     desc</span><br><span class="line">"""</span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> emp <span class="keyword">order</span> <span class="keyword">by</span> age <span class="keyword">desc</span>,salary <span class="keyword">asc</span>;</span><br><span class="line"><span class="comment"># 先按照age降序排  如果碰到age相同 则再按照salary升序排</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 统计各部门年龄在10岁以上的员工平均工资并且保留平均薪资大于1000的部门,然后对平均工资降序排序</span></span><br><span class="line"><span class="keyword">select</span> post,<span class="keyword">avg</span>(salary) <span class="keyword">from</span> emp </span><br><span class="line"><span class="keyword">where</span> age&gt;<span class="number">10</span> </span><br><span class="line">    <span class="keyword">group</span> <span class="keyword">by</span> post</span><br><span class="line">        <span class="keyword">having</span> <span class="keyword">avg</span>(salary) &gt; <span class="number">1000</span></span><br><span class="line">        <span class="keyword">order</span> <span class="keyword">by</span> <span class="keyword">avg</span>(salary) <span class="keyword">desc</span></span><br><span class="line">        ;</span><br></pre></td></tr></table></figure><h3 id="limit限制展示条数"><a href="#limit限制展示条数" class="headerlink" title="limit限制展示条数"></a>limit限制展示条数</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> emp;</span><br><span class="line">"""针对数据过多的情况 我们通常都是做分页处理"""</span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> emp <span class="keyword">limit</span> <span class="number">3</span>;  <span class="comment"># 只展示三条数据</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> emp <span class="keyword">limit</span> <span class="number">0</span>,<span class="number">5</span>;</span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> emp <span class="keyword">limit</span> <span class="number">5</span>,<span class="number">5</span>;</span><br><span class="line">第一个参数是起始位置</span><br><span class="line">第二个参数是展示条数</span><br></pre></td></tr></table></figure><h3 id="正则"><a href="#正则" class="headerlink" title="正则"></a>正则</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> emp <span class="keyword">where</span> <span class="keyword">name</span> regexp <span class="string">'^j.*(n|y)$'</span>;</span><br></pre></td></tr></table></figure><h3 id="多表操作"><a href="#多表操作" class="headerlink" title="多表操作"></a>多表操作</h3><p>前期表准备</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#建表</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> dep(</span><br><span class="line"><span class="keyword">id</span> <span class="built_in">int</span>,</span><br><span class="line"><span class="keyword">name</span> <span class="built_in">varchar</span>(<span class="number">20</span>) </span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> emp(</span><br><span class="line"><span class="keyword">id</span> <span class="built_in">int</span> primary <span class="keyword">key</span> auto_increment,</span><br><span class="line"><span class="keyword">name</span> <span class="built_in">varchar</span>(<span class="number">20</span>),</span><br><span class="line">sex enum(<span class="string">'male'</span>,<span class="string">'female'</span>) <span class="keyword">not</span> <span class="literal">null</span> <span class="keyword">default</span> <span class="string">'male'</span>,</span><br><span class="line">age <span class="built_in">int</span>,</span><br><span class="line">dep_id <span class="built_in">int</span></span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="comment">#插入数据</span></span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> dep <span class="keyword">values</span></span><br><span class="line">(<span class="number">200</span>,<span class="string">'技术'</span>),</span><br><span class="line">(<span class="number">201</span>,<span class="string">'人力资源'</span>),</span><br><span class="line">(<span class="number">202</span>,<span class="string">'销售'</span>),</span><br><span class="line">(<span class="number">203</span>,<span class="string">'运营'</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> emp(<span class="keyword">name</span>,sex,age,dep_id) <span class="keyword">values</span></span><br><span class="line">(<span class="string">'jason'</span>,<span class="string">'male'</span>,<span class="number">18</span>,<span class="number">200</span>),</span><br><span class="line">(<span class="string">'egon'</span>,<span class="string">'female'</span>,<span class="number">48</span>,<span class="number">201</span>),</span><br><span class="line">(<span class="string">'kevin'</span>,<span class="string">'male'</span>,<span class="number">18</span>,<span class="number">201</span>),</span><br><span class="line">(<span class="string">'nick'</span>,<span class="string">'male'</span>,<span class="number">28</span>,<span class="number">202</span>),</span><br><span class="line">(<span class="string">'owen'</span>,<span class="string">'male'</span>,<span class="number">18</span>,<span class="number">203</span>),</span><br><span class="line">(<span class="string">'jerry'</span>,<span class="string">'female'</span>,<span class="number">18</span>,<span class="number">204</span>);</span><br></pre></td></tr></table></figure><h3 id="表查询"><a href="#表查询" class="headerlink" title="表查询"></a>表查询</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> dep,emp;  <span class="comment"># 结果   笛卡尔积</span></span><br><span class="line">"""</span><br><span class="line">了解即可 不知道也没关系</span><br><span class="line">"""</span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> emp,dep <span class="keyword">where</span> emp.dep_id = dep.id;</span><br><span class="line"></span><br><span class="line">"""</span><br><span class="line">MySQL也知道 你在后面查询数据过程中 肯定会经常用到拼表操作 </span><br><span class="line">所以特地给你开设了对应的方法</span><br><span class="line">inner join  内连接</span><br><span class="line">left join   左连接</span><br><span class="line">right join  右连接</span><br><span class="line">union全连接</span><br><span class="line">"""</span><br><span class="line"><span class="comment"># inner join  内连接</span></span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> emp <span class="keyword">inner</span> <span class="keyword">join</span> dep <span class="keyword">on</span> emp.dep_id = dep.id;</span><br><span class="line"><span class="comment"># 只拼接两张表中公有的数据部分</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># left join   左连接</span></span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> emp <span class="keyword">left</span> <span class="keyword">join</span> dep <span class="keyword">on</span> emp.dep_id = dep.id;</span><br><span class="line"><span class="comment"># 左表所有的数据都展示出来 没有对应的项就用NULL</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># right join  右连接</span></span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> emp <span class="keyword">right</span> <span class="keyword">join</span> dep <span class="keyword">on</span> emp.dep_id = dep.id;</span><br><span class="line"><span class="comment"># 右表所有的数据都展示出来 没有对应的项就用NULL</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># union全连接  左右两表所有的数据都展示出来</span></span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> emp <span class="keyword">left</span> <span class="keyword">join</span> dep <span class="keyword">on</span> emp.dep_id = dep.id</span><br><span class="line"><span class="keyword">union</span></span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> emp <span class="keyword">right</span> <span class="keyword">join</span> dep <span class="keyword">on</span> emp.dep_id = dep.id;</span><br></pre></td></tr></table></figure><h3 id="子查询"><a href="#子查询" class="headerlink" title="子查询"></a>子查询</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">"""</span><br><span class="line">子查询就是我们平时解决问题的思路</span><br><span class="line">分步骤解决问题</span><br><span class="line">第一步</span><br><span class="line">第二步</span><br><span class="line">...</span><br><span class="line">将一个查询语句的结果当做另外一个查询语句的条件去用</span><br><span class="line">"""</span><br><span class="line"><span class="comment"># 查询部门是技术或者人力资源的员工信息</span></span><br><span class="line">1 先获取部门的id号</span><br><span class="line">    2 再去员工表里面筛选出对应的员工</span><br><span class="line">    <span class="keyword">select</span> <span class="keyword">id</span> <span class="keyword">from</span> dep <span class="keyword">where</span> <span class="keyword">name</span>=<span class="string">'技术'</span> <span class="keyword">or</span> <span class="keyword">name</span> = <span class="string">'人力资源'</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">select</span> <span class="keyword">name</span> <span class="keyword">from</span> emp <span class="keyword">where</span> dep_id <span class="keyword">in</span> (<span class="number">200</span>,<span class="number">201</span>);</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    <span class="keyword">select</span> * <span class="keyword">from</span> emp <span class="keyword">where</span> dep_id <span class="keyword">in</span> (<span class="keyword">select</span> <span class="keyword">id</span> <span class="keyword">from</span> dep <span class="keyword">where</span> <span class="keyword">name</span>=<span class="string">'技术'</span> <span class="keyword">or</span> <span class="keyword">name</span> = <span class="string">'人力资源'</span>);</span><br></pre></td></tr></table></figure><p><strong>总结</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">表的查询结果可以作为其他表的查询条件</span><br><span class="line">也可以通过起别名的方式把它作为一个张虚拟表根其他表关联</span><br><span class="line"></span><br><span class="line">&quot;&quot;&quot;</span><br><span class="line">多表查询就两种方式</span><br><span class="line">先拼接表再查询</span><br><span class="line">子查询 一步一步来</span><br><span class="line">&quot;&quot;&quot;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      虽然执行顺序和书写顺序不一致 你在写sql语句的时候可能不知道怎么写你就按照书写顺序的方式写sql,select * 先用*号占位之后去补全后面的sql语句,最后将*号替换后你想要的具体字段...
    
    </summary>
    
    
      <category term="数据库" scheme="http://yoursite.com/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/"/>
    
    
      <category term="MySQL" scheme="http://yoursite.com/tags/MySQL/"/>
    
  </entry>
  
  <entry>
    <title>[约束条件与表关系]</title>
    <link href="http://yoursite.com/2020/03/10/%E7%BA%A6%E6%9D%9F%E6%9D%A1%E4%BB%B6%E4%B8%8E%E8%A1%A8%E5%85%B3%E7%B3%BB/"/>
    <id>http://yoursite.com/2020/03/10/%E7%BA%A6%E6%9D%9F%E6%9D%A1%E4%BB%B6%E4%B8%8E%E8%A1%A8%E5%85%B3%E7%B3%BB/</id>
    <published>2020-03-09T17:58:29.000Z</published>
    <updated>2020-05-09T07:30:29.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="约束条件"><a href="#约束条件" class="headerlink" title="约束条件"></a>约束条件</h2><h3 id="default默认值"><a href="#default默认值" class="headerlink" title="default默认值"></a>default默认值</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 补充知识点  插入数据的时候可以指定字段</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> t1(</span><br><span class="line"><span class="keyword">id</span> <span class="built_in">int</span>,</span><br><span class="line">    <span class="keyword">name</span> <span class="built_in">char</span>(<span class="number">16</span>)</span><br><span class="line">);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> t1(<span class="keyword">name</span>,<span class="keyword">id</span>) <span class="keyword">values</span>(<span class="string">'jason'</span>,<span class="number">1</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> t2(</span><br><span class="line"><span class="keyword">id</span> <span class="built_in">int</span>,</span><br><span class="line">    <span class="keyword">name</span> <span class="built_in">char</span>(<span class="number">16</span>),</span><br><span class="line">    gender enum(<span class="string">'male'</span>,<span class="string">'female'</span>,<span class="string">'others'</span>) <span class="keyword">default</span> <span class="string">'male'</span></span><br><span class="line">);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> t2(<span class="keyword">id</span>,<span class="keyword">name</span>) <span class="keyword">values</span>(<span class="number">1</span>,<span class="string">'jason'</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> t2 <span class="keyword">values</span>(<span class="number">2</span>,<span class="string">'egon'</span>,<span class="string">'female'</span>);</span><br></pre></td></tr></table></figure><h3 id="unique唯一"><a href="#unique唯一" class="headerlink" title="unique唯一"></a>unique唯一</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 单列唯一</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> t3(</span><br><span class="line"><span class="keyword">id</span> <span class="built_in">int</span> <span class="keyword">unique</span>,</span><br><span class="line">    <span class="keyword">name</span> <span class="built_in">char</span>(<span class="number">16</span>)</span><br><span class="line">);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> t3 <span class="keyword">values</span>(<span class="number">1</span>,<span class="string">'jason'</span>),(<span class="number">1</span>,<span class="string">'egon'</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> t3 <span class="keyword">values</span>(<span class="number">1</span>,<span class="string">'jason'</span>),(<span class="number">2</span>,<span class="string">'egon'</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment"># 联合唯一</span></span><br><span class="line">"""</span><br><span class="line">ip和port</span><br><span class="line">单个都可以重复 但是加载一起必须是唯一的</span><br><span class="line">"""</span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> t4(</span><br><span class="line"><span class="keyword">id</span> <span class="built_in">int</span>,</span><br><span class="line">    ip <span class="built_in">char</span>(<span class="number">16</span>),</span><br><span class="line">    port <span class="built_in">int</span>,</span><br><span class="line">    <span class="keyword">unique</span>(ip,port)</span><br><span class="line">);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> t4 <span class="keyword">values</span>(<span class="number">1</span>,<span class="string">'127.0.0.1'</span>,<span class="number">8080</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> t4 <span class="keyword">values</span>(<span class="number">2</span>,<span class="string">'127.0.0.1'</span>,<span class="number">8081</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> t4 <span class="keyword">values</span>(<span class="number">3</span>,<span class="string">'127.0.0.2'</span>,<span class="number">8080</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> t4 <span class="keyword">values</span>(<span class="number">4</span>,<span class="string">'127.0.0.1'</span>,<span class="number">8080</span>);  报错</span><br></pre></td></tr></table></figure><h3 id="primary-key主键"><a href="#primary-key主键" class="headerlink" title="primary key主键"></a>primary key主键</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">"""</span><br><span class="line">1.单单从约束效果上来看primary key等价于not null + unique</span><br><span class="line">非空且唯一！！！</span><br><span class="line">"""</span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> t5(<span class="keyword">id</span> <span class="built_in">int</span> primary <span class="keyword">key</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> t5 <span class="keyword">values</span>(<span class="literal">null</span>);  报错</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> t5 <span class="keyword">values</span>(<span class="number">1</span>),(<span class="number">1</span>);  报错</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> t5 <span class="keyword">values</span>(<span class="number">1</span>),(<span class="number">2</span>); </span><br><span class="line"></span><br><span class="line">"""</span><br><span class="line">2.它除了有约束效果之外 它还是Innodb存储引擎组织数据的依据</span><br><span class="line">Innodb存储引擎在创建表的时候必须要有primary key</span><br><span class="line">因为它类似于书的目录 能够帮助提示查询效率并且也是建表的依据</span><br><span class="line">"""</span><br><span class="line"><span class="comment"># 1 一张表中有且只有一个主键 如果你没有设置主键 那么会从上往下搜索直到遇到一个非空且唯一的字段将它自动升级为主键</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> t6(</span><br><span class="line"><span class="keyword">id</span> <span class="built_in">int</span>,</span><br><span class="line">    <span class="keyword">name</span> <span class="built_in">char</span>(<span class="number">16</span>),</span><br><span class="line">    age <span class="built_in">int</span> <span class="keyword">not</span> <span class="literal">null</span> <span class="keyword">unique</span>,</span><br><span class="line">    addr <span class="built_in">char</span>(<span class="number">32</span>) <span class="keyword">not</span> <span class="literal">null</span> <span class="keyword">unique</span></span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="comment"># 2 如果表中没有主键也没有其他任何的非空且唯一字段 那么Innodb会采用自己内部提供的一个隐藏字段作为主键，隐藏意味着你无法使用到它 就无法提示查询速度</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 3 一张表中通常都应该有一个主键字段 并且通常将id/uid/sid字段作为主键</span></span><br><span class="line"><span class="comment"># 单个字段主键</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> t5(</span><br><span class="line">    <span class="keyword">id</span> <span class="built_in">int</span> primary <span class="keyword">key</span></span><br><span class="line"><span class="keyword">name</span> <span class="built_in">char</span>(<span class="number">16</span>)</span><br><span class="line">);</span><br><span class="line"><span class="comment"># 联合主键(多个字段联合起来作为表的主键 本质还是一个主键)</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> t7(</span><br><span class="line">    ip <span class="built_in">char</span>(<span class="number">16</span>),</span><br><span class="line">    port <span class="built_in">int</span>,</span><br><span class="line">    primary <span class="keyword">key</span>(ip,port)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">"""</span><br><span class="line">也意味着 以后我们在创建表的时候id字段一定要加primary key</span><br><span class="line">"""</span><br></pre></td></tr></table></figure><h3 id="auto-increment自增"><a href="#auto-increment自增" class="headerlink" title="auto_increment自增"></a>auto_increment自增</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 当编号特别多的时候 人为的去维护太麻烦</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> t8(</span><br><span class="line"><span class="keyword">id</span> <span class="built_in">int</span> primary <span class="keyword">key</span> auto_increment,</span><br><span class="line">    <span class="keyword">name</span> <span class="built_in">char</span>(<span class="number">16</span>)</span><br><span class="line">);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> t8(<span class="keyword">name</span>) <span class="keyword">values</span>(<span class="string">'jason'</span>),(<span class="string">'egon'</span>),(<span class="string">'kevin'</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment"># 注意auto_increment通常都是加在主键上的 不能给普通字段加</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> t9(</span><br><span class="line"><span class="keyword">id</span> <span class="built_in">int</span> primary <span class="keyword">key</span> auto_increment,</span><br><span class="line">    <span class="keyword">name</span> <span class="built_in">char</span>(<span class="number">16</span>),</span><br><span class="line">    cid <span class="built_in">int</span> auto_increment</span><br><span class="line">);</span><br><span class="line">ERROR 1075 (42000): Incorrect table definition; there can be only one auto column and it must be defined as a key</span><br></pre></td></tr></table></figure><p><strong>结论</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">"""以后在创建表的id(数据的唯一标识id、uid、sid)字段的时候id int primary key auto_increment"""</span><br></pre></td></tr></table></figure><p><strong>补充</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">delete</span> <span class="keyword">from</span> t1  删除表中数据后 主键的自增不会停止<span class="keyword">truncate</span> t1  清空表数据并且重置主键</span><br></pre></td></tr></table></figure><h2 id="表与表之间建关系"><a href="#表与表之间建关系" class="headerlink" title="表与表之间建关系"></a>表与表之间建关系</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">"""</span><br><span class="line">定义一张员工表 表中有很多字段</span><br><span class="line">id name gender dep_name dep_desc</span><br><span class="line">"""</span><br><span class="line"><span class="comment"># 1 该表的组织结构不是很清晰(可忽视)</span></span><br><span class="line"><span class="comment"># 2 浪费硬盘空间(可忽视)</span></span><br><span class="line"><span class="comment"># 3 数据的扩展性极差(无法忽视的)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 如何优化？</span></span><br><span class="line">"""上述问题就类似于你将所有的代码都写在了一个py文件中"""</span><br><span class="line">将员工表拆分  员工表和部门表</span><br></pre></td></tr></table></figure><h3 id="外键"><a href="#外键" class="headerlink" title="外键"></a>外键</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">"""</span><br><span class="line">外键就是用来帮助我们建立表与表之间关系的</span><br><span class="line">foreign key</span><br><span class="line">"""</span><br></pre></td></tr></table></figure><h3 id="表关系"><a href="#表关系" class="headerlink" title="表关系"></a>表关系</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&quot;&quot;&quot;</span><br><span class="line">表与表之间最多只有四种关系</span><br><span class="line">一对多关系</span><br><span class="line">在MySQL的关系中没有多对一一说</span><br><span class="line">一对多 多对一 都叫一对多！！！</span><br><span class="line">多对多关系</span><br><span class="line">一对一关系</span><br><span class="line">没有关系</span><br><span class="line">&quot;&quot;&quot;</span><br></pre></td></tr></table></figure><h3 id="一对多关系"><a href="#一对多关系" class="headerlink" title="一对多关系"></a>一对多关系</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line">"""</span><br><span class="line">判断表与表之间关系的时候 前期不熟悉的情况下 一定要按照我给你的建议</span><br><span class="line">换位思考  分别站在两张表的角度考虑</span><br><span class="line"></span><br><span class="line">员工表与部门表为例</span><br><span class="line">先站在员工表</span><br><span class="line">思考一个员工能否对应多个部门(一条员工数据能否对应多条部门数据)</span><br><span class="line">不能！！！</span><br><span class="line">(不能直接得出结论 一定要两张表都考虑完全)</span><br><span class="line">再站在部门表</span><br><span class="line">思考一个部门能否对应多个员工(一个部门数据能否对应多条员工数据)</span><br><span class="line">能！！！</span><br><span class="line">得出结论</span><br><span class="line">员工表与部门表示单向的一对多</span><br><span class="line">所以表关系就是一对多</span><br><span class="line">"""</span><br><span class="line">foreign key</span><br><span class="line">1 一对多表关系   外键字段建在多的一方</span><br><span class="line">    2 在创建表的时候 一定要先建被关联表 </span><br><span class="line">    3 在录入数据的时候 也必须先录入被关联表</span><br><span class="line"><span class="comment"># SQL语句建立表关系</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> dep(</span><br><span class="line"><span class="keyword">id</span> <span class="built_in">int</span> primary <span class="keyword">key</span> auto_increment,</span><br><span class="line">    dep_name <span class="built_in">char</span>(<span class="number">16</span>),</span><br><span class="line">    dep_desc <span class="built_in">char</span>(<span class="number">32</span>)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> emp(</span><br><span class="line"><span class="keyword">id</span> <span class="built_in">int</span> primary <span class="keyword">key</span> auto_increment,</span><br><span class="line">    <span class="keyword">name</span> <span class="built_in">char</span>(<span class="number">16</span>),</span><br><span class="line">    gender enum(<span class="string">'male'</span>,<span class="string">'female'</span>,<span class="string">'others'</span>) <span class="keyword">default</span> <span class="string">'male'</span>,</span><br><span class="line">    dep_id <span class="built_in">int</span>,</span><br><span class="line">    <span class="keyword">foreign</span> <span class="keyword">key</span>(dep_id) <span class="keyword">references</span> dep(<span class="keyword">id</span>)</span><br><span class="line">);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> dep(dep_name,dep_desc) <span class="keyword">values</span>(<span class="string">'sb教学部'</span>,<span class="string">'教书育人'</span>),(<span class="string">'外交部'</span>,<span class="string">'多人外交'</span>),(<span class="string">'nb技术部'</span>,<span class="string">'技术能力有限部门'</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> emp(<span class="keyword">name</span>,dep_id) <span class="keyword">values</span>(<span class="string">'jason'</span>,<span class="number">2</span>),(<span class="string">'egon'</span>,<span class="number">1</span>),(<span class="string">'tank'</span>,<span class="number">1</span>),(<span class="string">'kevin'</span>,<span class="number">3</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment"># 修改dep表里面的id字段</span></span><br><span class="line"><span class="keyword">update</span> dep <span class="keyword">set</span> <span class="keyword">id</span>=<span class="number">200</span> <span class="keyword">where</span> <span class="keyword">id</span>=<span class="number">2</span>;  不行</span><br><span class="line"><span class="comment"># 删除dep表里面的数据</span></span><br><span class="line"><span class="keyword">delete</span> <span class="keyword">from</span> dep;  不行</span><br><span class="line"></span><br><span class="line"><span class="comment"># 1 先删除教学部对应的员工数据 之后再删除部门</span></span><br><span class="line">操作太过繁琐</span><br><span class="line">    </span><br><span class="line"><span class="comment"># 2 真正做到数据之间有关系</span></span><br><span class="line">更新就同步更新</span><br><span class="line">    删除就同步删除</span><br><span class="line">"""</span><br><span class="line">级联更新   &gt;&gt;&gt;   同步更新</span><br><span class="line">级联删除   &gt;&gt;&gt;   同步删除</span><br><span class="line">"""</span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> dep(</span><br><span class="line"><span class="keyword">id</span> <span class="built_in">int</span> primary <span class="keyword">key</span> auto_increment,</span><br><span class="line">    dep_name <span class="built_in">char</span>(<span class="number">16</span>),</span><br><span class="line">    dep_desc <span class="built_in">char</span>(<span class="number">32</span>)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> emp(</span><br><span class="line"><span class="keyword">id</span> <span class="built_in">int</span> primary <span class="keyword">key</span> auto_increment,</span><br><span class="line">    <span class="keyword">name</span> <span class="built_in">char</span>(<span class="number">16</span>),</span><br><span class="line">    gender enum(<span class="string">'male'</span>,<span class="string">'female'</span>,<span class="string">'others'</span>) <span class="keyword">default</span> <span class="string">'male'</span>,</span><br><span class="line">    dep_id <span class="built_in">int</span>,</span><br><span class="line">    <span class="keyword">foreign</span> <span class="keyword">key</span>(dep_id) <span class="keyword">references</span> dep(<span class="keyword">id</span>) </span><br><span class="line">    <span class="keyword">on</span> <span class="keyword">update</span> <span class="keyword">cascade</span>  <span class="comment"># 同步更新</span></span><br><span class="line">    <span class="keyword">on</span> <span class="keyword">delete</span> <span class="keyword">cascade</span>  <span class="comment"># 同步删除</span></span><br><span class="line">);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> dep(dep_name,dep_desc) <span class="keyword">values</span>(<span class="string">'sb教学部'</span>,<span class="string">'教书育人'</span>),(<span class="string">'外交部'</span>,<span class="string">'多人外交'</span>),(<span class="string">'nb技术部'</span>,<span class="string">'技术能力有限部门'</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> emp(<span class="keyword">name</span>,dep_id) <span class="keyword">values</span>(<span class="string">'jason'</span>,<span class="number">2</span>),(<span class="string">'egon'</span>,<span class="number">1</span>),(<span class="string">'tank'</span>,<span class="number">1</span>),(<span class="string">'kevin'</span>,<span class="number">3</span>);</span><br></pre></td></tr></table></figure><h3 id="多对多"><a href="#多对多" class="headerlink" title="多对多"></a>多对多</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line">"""</span><br><span class="line">图书表和作者表</span><br><span class="line">"""</span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> book(</span><br><span class="line"><span class="keyword">id</span> <span class="built_in">int</span> primary <span class="keyword">key</span> auto_increment,</span><br><span class="line">    title <span class="built_in">varchar</span>(<span class="number">32</span>),</span><br><span class="line">    price <span class="built_in">int</span>,</span><br><span class="line">    author_id <span class="built_in">int</span>,</span><br><span class="line">    <span class="keyword">foreign</span> <span class="keyword">key</span>(author_id) <span class="keyword">references</span> author(<span class="keyword">id</span>) </span><br><span class="line">    <span class="keyword">on</span> <span class="keyword">update</span> <span class="keyword">cascade</span>  <span class="comment"># 同步更新</span></span><br><span class="line">    <span class="keyword">on</span> <span class="keyword">delete</span> <span class="keyword">cascade</span>  <span class="comment"># 同步删除</span></span><br><span class="line">);</span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> author(</span><br><span class="line"><span class="keyword">id</span> <span class="built_in">int</span> primary <span class="keyword">key</span> auto_increment,</span><br><span class="line">    <span class="keyword">name</span> <span class="built_in">varchar</span>(<span class="number">32</span>),</span><br><span class="line">    age <span class="built_in">int</span>,</span><br><span class="line">    book_id <span class="built_in">int</span>,</span><br><span class="line">    <span class="keyword">foreign</span> <span class="keyword">key</span>(book_id) <span class="keyword">references</span> book(<span class="keyword">id</span>) </span><br><span class="line">    <span class="keyword">on</span> <span class="keyword">update</span> <span class="keyword">cascade</span>  <span class="comment"># 同步更新</span></span><br><span class="line">    <span class="keyword">on</span> <span class="keyword">delete</span> <span class="keyword">cascade</span>  <span class="comment"># 同步删除</span></span><br><span class="line">);</span><br><span class="line">"""</span><br><span class="line">按照上述的方式创建 一个都别想成功！！！</span><br><span class="line">其实我们只是想记录书籍和作者的关系</span><br><span class="line">针对多对多字段表关系 不能在两张原有的表中创建外键</span><br><span class="line">需要你单独再开设一张 专门用来存储两张表数据之间的关系</span><br><span class="line">"""</span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> book(</span><br><span class="line"><span class="keyword">id</span> <span class="built_in">int</span> primary <span class="keyword">key</span> auto_increment,</span><br><span class="line">    title <span class="built_in">varchar</span>(<span class="number">32</span>),</span><br><span class="line">    price <span class="built_in">int</span></span><br><span class="line">);</span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> author(</span><br><span class="line"><span class="keyword">id</span> <span class="built_in">int</span> primary <span class="keyword">key</span> auto_increment,</span><br><span class="line">    <span class="keyword">name</span> <span class="built_in">varchar</span>(<span class="number">32</span>),</span><br><span class="line">    age <span class="built_in">int</span></span><br><span class="line">);</span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> book2author(</span><br><span class="line"><span class="keyword">id</span> <span class="built_in">int</span> primary <span class="keyword">key</span> auto_increment,</span><br><span class="line">    author_id <span class="built_in">int</span>,</span><br><span class="line">    book_id <span class="built_in">int</span>,</span><br><span class="line">    <span class="keyword">foreign</span> <span class="keyword">key</span>(author_id) <span class="keyword">references</span> author(<span class="keyword">id</span>) </span><br><span class="line">    <span class="keyword">on</span> <span class="keyword">update</span> <span class="keyword">cascade</span>  <span class="comment"># 同步更新</span></span><br><span class="line">    <span class="keyword">on</span> <span class="keyword">delete</span> <span class="keyword">cascade</span>,  <span class="comment"># 同步删除</span></span><br><span class="line">    <span class="keyword">foreign</span> <span class="keyword">key</span>(book_id) <span class="keyword">references</span> book(<span class="keyword">id</span>) </span><br><span class="line">    <span class="keyword">on</span> <span class="keyword">update</span> <span class="keyword">cascade</span>  <span class="comment"># 同步更新</span></span><br><span class="line">    <span class="keyword">on</span> <span class="keyword">delete</span> <span class="keyword">cascade</span>  <span class="comment"># 同步删除</span></span><br><span class="line">);</span><br></pre></td></tr></table></figure><h3 id="一对一"><a href="#一对一" class="headerlink" title="一对一"></a>一对一</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">"""</span><br><span class="line">id name age addr phone hobby email........</span><br><span class="line">如果一个表的字段特别多 每次查询又不是所有的字段都能用得到</span><br><span class="line">将表一分为二  </span><br><span class="line">用户表</span><br><span class="line">用户表</span><br><span class="line">id name age</span><br><span class="line">用户详情表</span><br><span class="line">id addr phone hobby email........</span><br><span class="line"></span><br><span class="line">站在用户表</span><br><span class="line">一个用户能否对应多个用户详情   不能！！！</span><br><span class="line">站在详情表</span><br><span class="line">一个详情能否属于多个用户      不能！！！</span><br><span class="line">结论:单向的一对多都不成立 那么这个时候两者之间的表关系</span><br><span class="line">就是一对一</span><br><span class="line">或者没有关系(好判断)</span><br><span class="line"></span><br><span class="line">客户表和学生表</span><br><span class="line">在你们报名之前你们是客户端</span><br><span class="line">报名之后是学生(期间有一些客户不会报名)</span><br><span class="line">"""</span><br><span class="line"></span><br><span class="line">一对一 外键字段建在任意一方都可以 但是推荐你建在查询频率比较高的表中</span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> authordetail(</span><br><span class="line"><span class="keyword">id</span> <span class="built_in">int</span> primary <span class="keyword">key</span> auto_increment,</span><br><span class="line">    phone <span class="built_in">int</span>,</span><br><span class="line">    addr <span class="built_in">varchar</span>(<span class="number">64</span>)</span><br><span class="line">);</span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> author(</span><br><span class="line"><span class="keyword">id</span> <span class="built_in">int</span> primary <span class="keyword">key</span> auto_increment,</span><br><span class="line">    <span class="keyword">name</span> <span class="built_in">varchar</span>(<span class="number">32</span>),</span><br><span class="line">    age <span class="built_in">int</span>,</span><br><span class="line">    authordetail_id <span class="built_in">int</span> <span class="keyword">unique</span>,</span><br><span class="line">    <span class="keyword">foreign</span> <span class="keyword">key</span>(authordetail_id) <span class="keyword">references</span> authordetail(<span class="keyword">id</span>) </span><br><span class="line">    <span class="keyword">on</span> <span class="keyword">update</span> <span class="keyword">cascade</span>  <span class="comment"># 同步更新</span></span><br><span class="line">    <span class="keyword">on</span> <span class="keyword">delete</span> <span class="keyword">cascade</span>  <span class="comment"># 同步删除</span></span><br><span class="line">)</span><br></pre></td></tr></table></figure><p><strong>总结</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&quot;&quot;&quot;</span><br><span class="line">表关系的建立需要用到foreign key</span><br><span class="line">一对多</span><br><span class="line">外键字段建在多的一方</span><br><span class="line">多对多</span><br><span class="line">自己开设第三张存储</span><br><span class="line">一对一</span><br><span class="line">建在任意一方都可以 但是推荐你建在查询频率较高的表中</span><br><span class="line"></span><br><span class="line">判断表之间关系的方式</span><br><span class="line">换位思考！！！</span><br><span class="line">员工与部门</span><br><span class="line"></span><br><span class="line">图书与作者</span><br><span class="line"></span><br><span class="line">作者与作者详情</span><br><span class="line">&quot;&quot;&quot;</span><br></pre></td></tr></table></figure><h3 id="修改表-了解"><a href="#修改表-了解" class="headerlink" title="修改表(了解)"></a>修改表(了解)</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># MySQL对大小写是不敏感的</span></span><br><span class="line">"""</span><br><span class="line">1 修改表名</span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> 表名 <span class="keyword">rename</span> 新表名;</span><br><span class="line"></span><br><span class="line">2 增加字段</span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> 表名 <span class="keyword">add</span> 字段名 字段类型(宽度)  约束条件;</span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> 表名 <span class="keyword">add</span> 字段名 字段类型(宽度)  约束条件 <span class="keyword">first</span>;</span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> 表名 <span class="keyword">add</span> 字段名 字段类型(宽度)  约束条件 <span class="keyword">after</span> 字段名;</span><br><span class="line"></span><br><span class="line">3 删除字段</span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> 表名 <span class="keyword">drop</span> 字段名;</span><br><span class="line"></span><br><span class="line">4 修改字段</span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> 表名 <span class="keyword">modify</span> 字段名 字段类型(宽度) 约束条件;</span><br><span class="line"></span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> 表名 <span class="keyword">change</span> 旧字段名 新字段名 字段类型(宽度) 约束条件;</span><br><span class="line"></span><br><span class="line">"""</span><br></pre></td></tr></table></figure><h3 id="复制表-了解"><a href="#复制表-了解" class="headerlink" title="复制表(了解)"></a>复制表(了解)</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">"""</span><br><span class="line">我们sql语句查询的结果其实也是一张虚拟表</span><br><span class="line">"""</span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> 表名 <span class="keyword">select</span> * <span class="keyword">from</span> 旧表;  不能复制主键 外键 ...</span><br><span class="line"></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> new_dep2 <span class="keyword">select</span> * <span class="keyword">from</span> dep <span class="keyword">where</span> <span class="keyword">id</span>&gt;<span class="number">3</span>;</span><br></pre></td></tr></table></figure><h3 id="练习："><a href="#练习：" class="headerlink" title="练习："></a>练习：</h3><p>练习：账号信息表，用户组，主机表，主机组</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#用户表</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> <span class="keyword">user</span>(</span><br><span class="line"><span class="keyword">id</span> <span class="built_in">int</span> <span class="keyword">not</span> <span class="literal">null</span> <span class="keyword">unique</span> auto_increment,</span><br><span class="line">username <span class="built_in">varchar</span>(<span class="number">20</span>) <span class="keyword">not</span> <span class="literal">null</span>,</span><br><span class="line"><span class="keyword">password</span> <span class="built_in">varchar</span>(<span class="number">50</span>) <span class="keyword">not</span> <span class="literal">null</span>,</span><br><span class="line">primary <span class="keyword">key</span>(username,<span class="keyword">password</span>)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="comment">#用户组表</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> usergroup(</span><br><span class="line"><span class="keyword">id</span> <span class="built_in">int</span> primary <span class="keyword">key</span> auto_increment,</span><br><span class="line">groupname <span class="built_in">varchar</span>(<span class="number">20</span>) <span class="keyword">not</span> <span class="literal">null</span> <span class="keyword">unique</span></span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="comment">#主机表</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> host(</span><br><span class="line"><span class="keyword">id</span> <span class="built_in">int</span> primary <span class="keyword">key</span> auto_increment,</span><br><span class="line">ip <span class="built_in">char</span>(<span class="number">15</span>) <span class="keyword">not</span> <span class="literal">null</span> <span class="keyword">unique</span> <span class="keyword">default</span> <span class="string">'127.0.0.1'</span></span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="comment">#业务线表</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> business(</span><br><span class="line"><span class="keyword">id</span> <span class="built_in">int</span> primary <span class="keyword">key</span> auto_increment,</span><br><span class="line">business <span class="built_in">varchar</span>(<span class="number">20</span>) <span class="keyword">not</span> <span class="literal">null</span> <span class="keyword">unique</span></span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="comment">#建关系：user与usergroup</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> user2usergroup(</span><br><span class="line"><span class="keyword">id</span> <span class="built_in">int</span> <span class="keyword">not</span> <span class="literal">null</span> <span class="keyword">unique</span> auto_increment,</span><br><span class="line">user_id <span class="built_in">int</span> <span class="keyword">not</span> <span class="literal">null</span>,</span><br><span class="line"><span class="keyword">group_id</span> <span class="built_in">int</span> <span class="keyword">not</span> <span class="literal">null</span>,</span><br><span class="line">primary <span class="keyword">key</span>(user_id,<span class="keyword">group_id</span>),</span><br><span class="line"><span class="keyword">foreign</span> <span class="keyword">key</span>(user_id) <span class="keyword">references</span> <span class="keyword">user</span>(<span class="keyword">id</span>),</span><br><span class="line"><span class="keyword">foreign</span> <span class="keyword">key</span>(<span class="keyword">group_id</span>) <span class="keyword">references</span> usergroup(<span class="keyword">id</span>)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="comment">#建关系：host与business</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> host2business(</span><br><span class="line"><span class="keyword">id</span> <span class="built_in">int</span> <span class="keyword">not</span> <span class="literal">null</span> <span class="keyword">unique</span> auto_increment,</span><br><span class="line">host_id <span class="built_in">int</span> <span class="keyword">not</span> <span class="literal">null</span>,</span><br><span class="line">business_id <span class="built_in">int</span> <span class="keyword">not</span> <span class="literal">null</span>,</span><br><span class="line">primary <span class="keyword">key</span>(host_id,business_id),</span><br><span class="line"><span class="keyword">foreign</span> <span class="keyword">key</span>(host_id) <span class="keyword">references</span> host(<span class="keyword">id</span>),</span><br><span class="line"><span class="keyword">foreign</span> <span class="keyword">key</span>(business_id) <span class="keyword">references</span> business(<span class="keyword">id</span>)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="comment">#建关系：user与host</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> user2host(</span><br><span class="line"><span class="keyword">id</span> <span class="built_in">int</span> <span class="keyword">not</span> <span class="literal">null</span> <span class="keyword">unique</span> auto_increment,</span><br><span class="line">user_id <span class="built_in">int</span> <span class="keyword">not</span> <span class="literal">null</span>,</span><br><span class="line">host_id <span class="built_in">int</span> <span class="keyword">not</span> <span class="literal">null</span>,</span><br><span class="line">primary <span class="keyword">key</span>(user_id,host_id),</span><br><span class="line"><span class="keyword">foreign</span> <span class="keyword">key</span>(user_id) <span class="keyword">references</span> <span class="keyword">user</span>(<span class="keyword">id</span>),</span><br><span class="line"><span class="keyword">foreign</span> <span class="keyword">key</span>(host_id) <span class="keyword">references</span> host(<span class="keyword">id</span>)</span><br><span class="line">);</span><br></pre></td></tr></table></figure><p>练习:</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 班级表</span></span><br><span class="line">cidcaption</span><br><span class="line"><span class="comment"># 学生表</span></span><br><span class="line">sid sname gender class_id</span><br><span class="line"><span class="comment"># 老师表</span></span><br><span class="line">tidtname</span><br><span class="line"><span class="comment"># 课程表</span></span><br><span class="line">cidcnameteacher_id</span><br><span class="line"><span class="comment"># 成绩表</span></span><br><span class="line">sidstudent_id course_id number</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      单单从约束效果上来看primary key等价于not null + unique非空且唯一！！！它除了有约束效果之外 它还是Innodb存储引擎组织数据的依据,Innodb存储引擎在创建表的时候必须要有primary key,因为它类似于书的目录 能够帮助提示查询效率并且也是建表的依据...
    
    </summary>
    
    
      <category term="数据库" scheme="http://yoursite.com/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/"/>
    
    
      <category term="MySQL" scheme="http://yoursite.com/tags/MySQL/"/>
    
  </entry>
  
</feed>
